#!/usr/bin/env node
var t_=Object.create;var mi=Object.defineProperty;var r_=Object.getOwnPropertyDescriptor;var n_=Object.getOwnPropertyNames;var o_=Object.getPrototypeOf,s_=Object.prototype.hasOwnProperty;var S=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),hi=(t,e)=>{for(var r in e)mi(t,r,{get:e[r],enumerable:!0})},i_=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of n_(e))!s_.call(t,o)&&o!==r&&mi(t,o,{get:()=>e[o],enumerable:!(n=r_(e,o))||n.enumerable});return t};var ed=(t,e,r)=>(r=t!=null?t_(o_(t)):{},i_(e||!t||!t.__esModule?mi(r,"default",{value:t,enumerable:!0}):r,t));var Un=S(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});Y.regexpCode=Y.getEsmExportName=Y.getProperty=Y.safeStringify=Y.stringify=Y.strConcat=Y.addCodeArg=Y.str=Y._=Y.nil=Y._Code=Y.Name=Y.IDENTIFIER=Y._CodeOrName=void 0;var Ln=class{};Y._CodeOrName=Ln;Y.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var br=class extends Ln{constructor(e){if(super(),!Y.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}};Y.Name=br;var Ye=class extends Ln{constructor(e){super(),this._items=typeof e=="string"?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let e=this._items[0];return e===""||e==='""'}get str(){var e;return(e=this._str)!==null&&e!==void 0?e:this._str=this._items.reduce((r,n)=>`${r}${n}`,"")}get names(){var e;return(e=this._names)!==null&&e!==void 0?e:this._names=this._items.reduce((r,n)=>(n instanceof br&&(r[n.str]=(r[n.str]||0)+1),r),{})}};Y._Code=Ye;Y.nil=new Ye("");function Wf(t,...e){let r=[t[0]],n=0;for(;n<e.length;)Qc(r,e[n]),r.push(t[++n]);return new Ye(r)}Y._=Wf;var Yc=new Ye("+");function Xf(t,...e){let r=[qn(t[0])],n=0;for(;n<e.length;)r.push(Yc),Qc(r,e[n]),r.push(Yc,qn(t[++n]));return n$(r),new Ye(r)}Y.str=Xf;function Qc(t,e){e instanceof Ye?t.push(...e._items):e instanceof br?t.push(e):t.push(i$(e))}Y.addCodeArg=Qc;function n$(t){let e=1;for(;e<t.length-1;){if(t[e]===Yc){let r=o$(t[e-1],t[e+1]);if(r!==void 0){t.splice(e-1,3,r);continue}t[e++]="+"}e++}}function o$(t,e){if(e==='""')return t;if(t==='""')return e;if(typeof t=="string")return e instanceof br||t[t.length-1]!=='"'?void 0:typeof e!="string"?`${t.slice(0,-1)}${e}"`:e[0]==='"'?t.slice(0,-1)+e.slice(1):void 0;if(typeof e=="string"&&e[0]==='"'&&!(t instanceof br))return`"${t}${e.slice(1)}`}function s$(t,e){return e.emptyStr()?t:t.emptyStr()?e:Xf`${t}${e}`}Y.strConcat=s$;function i$(t){return typeof t=="number"||typeof t=="boolean"||t===null?t:qn(Array.isArray(t)?t.join(","):t)}function a$(t){return new Ye(qn(t))}Y.stringify=a$;function qn(t){return JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}Y.safeStringify=qn;function c$(t){return typeof t=="string"&&Y.IDENTIFIER.test(t)?new Ye(`.${t}`):Wf`[${t}]`}Y.getProperty=c$;function u$(t){if(typeof t=="string"&&Y.IDENTIFIER.test(t))return new Ye(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)}Y.getEsmExportName=u$;function l$(t){return new Ye(t.toString())}Y.regexpCode=l$});var ru=S(De=>{"use strict";Object.defineProperty(De,"__esModule",{value:!0});De.ValueScope=De.ValueScopeName=De.Scope=De.varKinds=De.UsedValueState=void 0;var Me=Un(),eu=class extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}},vs;(function(t){t[t.Started=0]="Started",t[t.Completed=1]="Completed"})(vs||(De.UsedValueState=vs={}));De.varKinds={const:new Me.Name("const"),let:new Me.Name("let"),var:new Me.Name("var")};var bs=class{constructor({prefixes:e,parent:r}={}){this._names={},this._prefixes=e,this._parent=r}toName(e){return e instanceof Me.Name?e:this.name(e)}name(e){return new Me.Name(this._newName(e))}_newName(e){let r=this._names[e]||this._nameGroup(e);return`${e}${r.index++}`}_nameGroup(e){var r,n;if(!((n=(r=this._parent)===null||r===void 0?void 0:r._prefixes)===null||n===void 0)&&n.has(e)||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}};De.Scope=bs;var xs=class extends Me.Name{constructor(e,r){super(r),this.prefix=e}setValue(e,{property:r,itemIndex:n}){this.value=e,this.scopePath=(0,Me._)`.${new Me.Name(r)}[${n}]`}};De.ValueScopeName=xs;var d$=(0,Me._)`\n`,tu=class extends bs{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?d$:Me.nil}}get(){return this._scope}name(e){return new xs(e,this._newName(e))}value(e,r){var n;if(r.ref===void 0)throw new Error("CodeGen: ref must be passed in value");let o=this.toName(e),{prefix:s}=o,i=(n=r.key)!==null&&n!==void 0?n:r.ref,a=this._values[s];if(a){let l=a.get(i);if(l)return l}else a=this._values[s]=new Map;a.set(i,o);let c=this._scope[s]||(this._scope[s]=[]),u=c.length;return c[u]=r.ref,o.setValue(r,{property:s,itemIndex:u}),o}getValue(e,r){let n=this._values[e];if(n)return n.get(r)}scopeRefs(e,r=this._values){return this._reduceValues(r,n=>{if(n.scopePath===void 0)throw new Error(`CodeGen: name "${n}" has no value`);return(0,Me._)`${e}${n.scopePath}`})}scopeCode(e=this._values,r,n){return this._reduceValues(e,o=>{if(o.value===void 0)throw new Error(`CodeGen: name "${o}" has no value`);return o.value.code},r,n)}_reduceValues(e,r,n={},o){let s=Me.nil;for(let i in e){let a=e[i];if(!a)continue;let c=n[i]=n[i]||new Map;a.forEach(u=>{if(c.has(u))return;c.set(u,vs.Started);let l=r(u);if(l){let d=this.opts.es5?De.varKinds.var:De.varKinds.const;s=(0,Me._)`${s}${d} ${u} = ${l};${this.opts._n}`}else if(l=o?.(u))s=(0,Me._)`${s}${l}${this.opts._n}`;else throw new eu(u);c.set(u,vs.Completed)})}return s}};De.ValueScope=tu});var U=S(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});F.or=F.and=F.not=F.CodeGen=F.operators=F.varKinds=F.ValueScopeName=F.ValueScope=F.Scope=F.Name=F.regexpCode=F.stringify=F.getProperty=F.nil=F.strConcat=F.str=F._=void 0;var J=Un(),it=ru(),Ut=Un();Object.defineProperty(F,"_",{enumerable:!0,get:function(){return Ut._}});Object.defineProperty(F,"str",{enumerable:!0,get:function(){return Ut.str}});Object.defineProperty(F,"strConcat",{enumerable:!0,get:function(){return Ut.strConcat}});Object.defineProperty(F,"nil",{enumerable:!0,get:function(){return Ut.nil}});Object.defineProperty(F,"getProperty",{enumerable:!0,get:function(){return Ut.getProperty}});Object.defineProperty(F,"stringify",{enumerable:!0,get:function(){return Ut.stringify}});Object.defineProperty(F,"regexpCode",{enumerable:!0,get:function(){return Ut.regexpCode}});Object.defineProperty(F,"Name",{enumerable:!0,get:function(){return Ut.Name}});var Ss=ru();Object.defineProperty(F,"Scope",{enumerable:!0,get:function(){return Ss.Scope}});Object.defineProperty(F,"ValueScope",{enumerable:!0,get:function(){return Ss.ValueScope}});Object.defineProperty(F,"ValueScopeName",{enumerable:!0,get:function(){return Ss.ValueScopeName}});Object.defineProperty(F,"varKinds",{enumerable:!0,get:function(){return Ss.varKinds}});F.operators={GT:new J._Code(">"),GTE:new J._Code(">="),LT:new J._Code("<"),LTE:new J._Code("<="),EQ:new J._Code("==="),NEQ:new J._Code("!=="),NOT:new J._Code("!"),OR:new J._Code("||"),AND:new J._Code("&&"),ADD:new J._Code("+")};var Tt=class{optimizeNodes(){return this}optimizeNames(e,r){return this}},nu=class extends Tt{constructor(e,r,n){super(),this.varKind=e,this.name=r,this.rhs=n}render({es5:e,_n:r}){let n=e?it.varKinds.var:this.varKind,o=this.rhs===void 0?"":` = ${this.rhs}`;return`${n} ${this.name}${o};`+r}optimizeNames(e,r){if(e[this.name.str])return this.rhs&&(this.rhs=Gr(this.rhs,e,r)),this}get names(){return this.rhs instanceof J._CodeOrName?this.rhs.names:{}}},$s=class extends Tt{constructor(e,r,n){super(),this.lhs=e,this.rhs=r,this.sideEffects=n}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,r){if(!(this.lhs instanceof J.Name&&!e[this.lhs.str]&&!this.sideEffects))return this.rhs=Gr(this.rhs,e,r),this}get names(){let e=this.lhs instanceof J.Name?{}:{...this.lhs.names};return ks(e,this.rhs)}},ou=class extends $s{constructor(e,r,n,o){super(e,n,o),this.op=r}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}},su=class extends Tt{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}},iu=class extends Tt{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}},au=class extends Tt{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}},cu=class extends Tt{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,r){return this.code=Gr(this.code,e,r),this}get names(){return this.code instanceof J._CodeOrName?this.code.names:{}}},Fn=class extends Tt{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((r,n)=>r+n.render(e),"")}optimizeNodes(){let{nodes:e}=this,r=e.length;for(;r--;){let n=e[r].optimizeNodes();Array.isArray(n)?e.splice(r,1,...n):n?e[r]=n:e.splice(r,1)}return e.length>0?this:void 0}optimizeNames(e,r){let{nodes:n}=this,o=n.length;for(;o--;){let s=n[o];s.optimizeNames(e,r)||(p$(e,s.names),n.splice(o,1))}return n.length>0?this:void 0}get names(){return this.nodes.reduce((e,r)=>wr(e,r.names),{})}},Et=class extends Fn{render(e){return"{"+e._n+super.render(e)+"}"+e._n}},uu=class extends Fn{},Kr=class extends Et{};Kr.kind="else";var xr=class t extends Et{constructor(e,r){super(r),this.condition=e}render(e){let r=`if(${this.condition})`+super.render(e);return this.else&&(r+="else "+this.else.render(e)),r}optimizeNodes(){super.optimizeNodes();let e=this.condition;if(e===!0)return this.nodes;let r=this.else;if(r){let n=r.optimizeNodes();r=this.else=Array.isArray(n)?new Kr(n):n}if(r)return e===!1?r instanceof t?r:r.nodes:this.nodes.length?this:new t(Yf(e),r instanceof t?[r]:r.nodes);if(!(e===!1||!this.nodes.length))return this}optimizeNames(e,r){var n;if(this.else=(n=this.else)===null||n===void 0?void 0:n.optimizeNames(e,r),!!(super.optimizeNames(e,r)||this.else))return this.condition=Gr(this.condition,e,r),this}get names(){let e=super.names;return ks(e,this.condition),this.else&&wr(e,this.else.names),e}};xr.kind="if";var $r=class extends Et{};$r.kind="for";var lu=class extends $r{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iteration=Gr(this.iteration,e,r),this}get names(){return wr(super.names,this.iteration.names)}},du=class extends $r{constructor(e,r,n,o){super(),this.varKind=e,this.name=r,this.from=n,this.to=o}render(e){let r=e.es5?it.varKinds.var:this.varKind,{name:n,from:o,to:s}=this;return`for(${r} ${n}=${o}; ${n}<${s}; ${n}++)`+super.render(e)}get names(){let e=ks(super.names,this.from);return ks(e,this.to)}},ws=class extends $r{constructor(e,r,n,o){super(),this.loop=e,this.varKind=r,this.name=n,this.iterable=o}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iterable=Gr(this.iterable,e,r),this}get names(){return wr(super.names,this.iterable.names)}},Vn=class extends Et{constructor(e,r,n){super(),this.name=e,this.args=r,this.async=n}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}};Vn.kind="func";var Hn=class extends Fn{render(e){return"return "+super.render(e)}};Hn.kind="return";var pu=class extends Et{render(e){let r="try"+super.render(e);return this.catch&&(r+=this.catch.render(e)),this.finally&&(r+=this.finally.render(e)),r}optimizeNodes(){var e,r;return super.optimizeNodes(),(e=this.catch)===null||e===void 0||e.optimizeNodes(),(r=this.finally)===null||r===void 0||r.optimizeNodes(),this}optimizeNames(e,r){var n,o;return super.optimizeNames(e,r),(n=this.catch)===null||n===void 0||n.optimizeNames(e,r),(o=this.finally)===null||o===void 0||o.optimizeNames(e,r),this}get names(){let e=super.names;return this.catch&&wr(e,this.catch.names),this.finally&&wr(e,this.finally.names),e}},Bn=class extends Et{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}};Bn.kind="catch";var Kn=class extends Et{render(e){return"finally"+super.render(e)}};Kn.kind="finally";var fu=class{constructor(e,r={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...r,_n:r.lines?`
`:""},this._extScope=e,this._scope=new it.Scope({parent:e}),this._nodes=[new uu]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,r){let n=this._extScope.value(e,r);return(this._values[n.prefix]||(this._values[n.prefix]=new Set)).add(n),n}getScopeValue(e,r){return this._extScope.getValue(e,r)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,r,n,o){let s=this._scope.toName(r);return n!==void 0&&o&&(this._constants[s.str]=n),this._leafNode(new nu(e,s,n)),s}const(e,r,n){return this._def(it.varKinds.const,e,r,n)}let(e,r,n){return this._def(it.varKinds.let,e,r,n)}var(e,r,n){return this._def(it.varKinds.var,e,r,n)}assign(e,r,n){return this._leafNode(new $s(e,r,n))}add(e,r){return this._leafNode(new ou(e,F.operators.ADD,r))}code(e){return typeof e=="function"?e():e!==J.nil&&this._leafNode(new cu(e)),this}object(...e){let r=["{"];for(let[n,o]of e)r.length>1&&r.push(","),r.push(n),(n!==o||this.opts.es5)&&(r.push(":"),(0,J.addCodeArg)(r,o));return r.push("}"),new J._Code(r)}if(e,r,n){if(this._blockNode(new xr(e)),r&&n)this.code(r).else().code(n).endIf();else if(r)this.code(r).endIf();else if(n)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new xr(e))}else(){return this._elseNode(new Kr)}endIf(){return this._endBlockNode(xr,Kr)}_for(e,r){return this._blockNode(e),r&&this.code(r).endFor(),this}for(e,r){return this._for(new lu(e),r)}forRange(e,r,n,o,s=this.opts.es5?it.varKinds.var:it.varKinds.let){let i=this._scope.toName(e);return this._for(new du(s,i,r,n),()=>o(i))}forOf(e,r,n,o=it.varKinds.const){let s=this._scope.toName(e);if(this.opts.es5){let i=r instanceof J.Name?r:this.var("_arr",r);return this.forRange("_i",0,(0,J._)`${i}.length`,a=>{this.var(s,(0,J._)`${i}[${a}]`),n(s)})}return this._for(new ws("of",o,s,r),()=>n(s))}forIn(e,r,n,o=this.opts.es5?it.varKinds.var:it.varKinds.const){if(this.opts.ownProperties)return this.forOf(e,(0,J._)`Object.keys(${r})`,n);let s=this._scope.toName(e);return this._for(new ws("in",o,s,r),()=>n(s))}endFor(){return this._endBlockNode($r)}label(e){return this._leafNode(new su(e))}break(e){return this._leafNode(new iu(e))}return(e){let r=new Hn;if(this._blockNode(r),this.code(e),r.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(Hn)}try(e,r,n){if(!r&&!n)throw new Error('CodeGen: "try" without "catch" and "finally"');let o=new pu;if(this._blockNode(o),this.code(e),r){let s=this.name("e");this._currNode=o.catch=new Bn(s),r(s)}return n&&(this._currNode=o.finally=new Kn,this.code(n)),this._endBlockNode(Bn,Kn)}throw(e){return this._leafNode(new au(e))}block(e,r){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(r),this}endBlock(e){let r=this._blockStarts.pop();if(r===void 0)throw new Error("CodeGen: not in self-balancing block");let n=this._nodes.length-r;if(n<0||e!==void 0&&n!==e)throw new Error(`CodeGen: wrong number of nodes: ${n} vs ${e} expected`);return this._nodes.length=r,this}func(e,r=J.nil,n,o){return this._blockNode(new Vn(e,r,n)),o&&this.code(o).endFunc(),this}endFunc(){return this._endBlockNode(Vn)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,r){let n=this._currNode;if(n instanceof e||r&&n instanceof r)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${r?`${e.kind}/${r.kind}`:e.kind}"`)}_elseNode(e){let r=this._currNode;if(!(r instanceof xr))throw new Error('CodeGen: "else" without "if"');return this._currNode=r.else=e,this}get _root(){return this._nodes[0]}get _currNode(){let e=this._nodes;return e[e.length-1]}set _currNode(e){let r=this._nodes;r[r.length-1]=e}};F.CodeGen=fu;function wr(t,e){for(let r in e)t[r]=(t[r]||0)+(e[r]||0);return t}function ks(t,e){return e instanceof J._CodeOrName?wr(t,e.names):t}function Gr(t,e,r){if(t instanceof J.Name)return n(t);if(!o(t))return t;return new J._Code(t._items.reduce((s,i)=>(i instanceof J.Name&&(i=n(i)),i instanceof J._Code?s.push(...i._items):s.push(i),s),[]));function n(s){let i=r[s.str];return i===void 0||e[s.str]!==1?s:(delete e[s.str],i)}function o(s){return s instanceof J._Code&&s._items.some(i=>i instanceof J.Name&&e[i.str]===1&&r[i.str]!==void 0)}}function p$(t,e){for(let r in e)t[r]=(t[r]||0)-(e[r]||0)}function Yf(t){return typeof t=="boolean"||typeof t=="number"||t===null?!t:(0,J._)`!${mu(t)}`}F.not=Yf;var f$=Qf(F.operators.AND);function m$(...t){return t.reduce(f$)}F.and=m$;var h$=Qf(F.operators.OR);function g$(...t){return t.reduce(h$)}F.or=g$;function Qf(t){return(e,r)=>e===J.nil?r:r===J.nil?e:(0,J._)`${mu(e)} ${t} ${mu(r)}`}function mu(t){return t instanceof J.Name?t:(0,J._)`(${t})`}});var W=S(V=>{"use strict";Object.defineProperty(V,"__esModule",{value:!0});V.checkStrictMode=V.getErrorPath=V.Type=V.useFunc=V.setEvaluated=V.evaluatedPropsToName=V.mergeEvaluated=V.eachItem=V.unescapeJsonPointer=V.escapeJsonPointer=V.escapeFragment=V.unescapeFragment=V.schemaRefOrVal=V.schemaHasRulesButRef=V.schemaHasRules=V.checkUnknownRules=V.alwaysValidSchema=V.toHash=void 0;var re=U(),_$=Un();function y$(t){let e={};for(let r of t)e[r]=!0;return e}V.toHash=y$;function v$(t,e){return typeof e=="boolean"?e:Object.keys(e).length===0?!0:(rm(t,e),!nm(e,t.self.RULES.all))}V.alwaysValidSchema=v$;function rm(t,e=t.schema){let{opts:r,self:n}=t;if(!r.strictSchema||typeof e=="boolean")return;let o=n.RULES.keywords;for(let s in e)o[s]||im(t,`unknown keyword: "${s}"`)}V.checkUnknownRules=rm;function nm(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(e[r])return!0;return!1}V.schemaHasRules=nm;function b$(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(r!=="$ref"&&e.all[r])return!0;return!1}V.schemaHasRulesButRef=b$;function x$({topSchemaRef:t,schemaPath:e},r,n,o){if(!o){if(typeof r=="number"||typeof r=="boolean")return r;if(typeof r=="string")return(0,re._)`${r}`}return(0,re._)`${t}${e}${(0,re.getProperty)(n)}`}V.schemaRefOrVal=x$;function $$(t){return om(decodeURIComponent(t))}V.unescapeFragment=$$;function w$(t){return encodeURIComponent(gu(t))}V.escapeFragment=w$;function gu(t){return typeof t=="number"?`${t}`:t.replace(/~/g,"~0").replace(/\//g,"~1")}V.escapeJsonPointer=gu;function om(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}V.unescapeJsonPointer=om;function k$(t,e){if(Array.isArray(t))for(let r of t)e(r);else e(t)}V.eachItem=k$;function em({mergeNames:t,mergeToName:e,mergeValues:r,resultToName:n}){return(o,s,i,a)=>{let c=i===void 0?s:i instanceof re.Name?(s instanceof re.Name?t(o,s,i):e(o,s,i),i):s instanceof re.Name?(e(o,i,s),s):r(s,i);return a===re.Name&&!(c instanceof re.Name)?n(o,c):c}}V.mergeEvaluated={props:em({mergeNames:(t,e,r)=>t.if((0,re._)`${r} !== true && ${e} !== undefined`,()=>{t.if((0,re._)`${e} === true`,()=>t.assign(r,!0),()=>t.assign(r,(0,re._)`${r} || {}`).code((0,re._)`Object.assign(${r}, ${e})`))}),mergeToName:(t,e,r)=>t.if((0,re._)`${r} !== true`,()=>{e===!0?t.assign(r,!0):(t.assign(r,(0,re._)`${r} || {}`),_u(t,r,e))}),mergeValues:(t,e)=>t===!0?!0:{...t,...e},resultToName:sm}),items:em({mergeNames:(t,e,r)=>t.if((0,re._)`${r} !== true && ${e} !== undefined`,()=>t.assign(r,(0,re._)`${e} === true ? true : ${r} > ${e} ? ${r} : ${e}`)),mergeToName:(t,e,r)=>t.if((0,re._)`${r} !== true`,()=>t.assign(r,e===!0?!0:(0,re._)`${r} > ${e} ? ${r} : ${e}`)),mergeValues:(t,e)=>t===!0?!0:Math.max(t,e),resultToName:(t,e)=>t.var("items",e)})};function sm(t,e){if(e===!0)return t.var("props",!0);let r=t.var("props",(0,re._)`{}`);return e!==void 0&&_u(t,r,e),r}V.evaluatedPropsToName=sm;function _u(t,e,r){Object.keys(r).forEach(n=>t.assign((0,re._)`${e}${(0,re.getProperty)(n)}`,!0))}V.setEvaluated=_u;var tm={};function S$(t,e){return t.scopeValue("func",{ref:e,code:tm[e.code]||(tm[e.code]=new _$._Code(e.code))})}V.useFunc=S$;var hu;(function(t){t[t.Num=0]="Num",t[t.Str=1]="Str"})(hu||(V.Type=hu={}));function z$(t,e,r){if(t instanceof re.Name){let n=e===hu.Num;return r?n?(0,re._)`"[" + ${t} + "]"`:(0,re._)`"['" + ${t} + "']"`:n?(0,re._)`"/" + ${t}`:(0,re._)`"/" + ${t}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,re.getProperty)(t).toString():"/"+gu(t)}V.getErrorPath=z$;function im(t,e,r=t.opts.strictSchema){if(r){if(e=`strict mode: ${e}`,r===!0)throw new Error(e);t.self.logger.warn(e)}}V.checkStrictMode=im});var Pt=S(yu=>{"use strict";Object.defineProperty(yu,"__esModule",{value:!0});var ze=U(),T$={data:new ze.Name("data"),valCxt:new ze.Name("valCxt"),instancePath:new ze.Name("instancePath"),parentData:new ze.Name("parentData"),parentDataProperty:new ze.Name("parentDataProperty"),rootData:new ze.Name("rootData"),dynamicAnchors:new ze.Name("dynamicAnchors"),vErrors:new ze.Name("vErrors"),errors:new ze.Name("errors"),this:new ze.Name("this"),self:new ze.Name("self"),scope:new ze.Name("scope"),json:new ze.Name("json"),jsonPos:new ze.Name("jsonPos"),jsonLen:new ze.Name("jsonLen"),jsonPart:new ze.Name("jsonPart")};yu.default=T$});var Gn=S(Te=>{"use strict";Object.defineProperty(Te,"__esModule",{value:!0});Te.extendErrors=Te.resetErrorsCount=Te.reportExtraError=Te.reportError=Te.keyword$DataError=Te.keywordError=void 0;var X=U(),zs=W(),Oe=Pt();Te.keywordError={message:({keyword:t})=>(0,X.str)`must pass "${t}" keyword validation`};Te.keyword$DataError={message:({keyword:t,schemaType:e})=>e?(0,X.str)`"${t}" keyword must be ${e} ($data)`:(0,X.str)`"${t}" keyword is invalid ($data)`};function E$(t,e=Te.keywordError,r,n){let{it:o}=t,{gen:s,compositeRule:i,allErrors:a}=o,c=um(t,e,r);n??(i||a)?am(s,c):cm(o,(0,X._)`[${c}]`)}Te.reportError=E$;function P$(t,e=Te.keywordError,r){let{it:n}=t,{gen:o,compositeRule:s,allErrors:i}=n,a=um(t,e,r);am(o,a),s||i||cm(n,Oe.default.vErrors)}Te.reportExtraError=P$;function R$(t,e){t.assign(Oe.default.errors,e),t.if((0,X._)`${Oe.default.vErrors} !== null`,()=>t.if(e,()=>t.assign((0,X._)`${Oe.default.vErrors}.length`,e),()=>t.assign(Oe.default.vErrors,null)))}Te.resetErrorsCount=R$;function I$({gen:t,keyword:e,schemaValue:r,data:n,errsCount:o,it:s}){if(o===void 0)throw new Error("ajv implementation error");let i=t.name("err");t.forRange("i",o,Oe.default.errors,a=>{t.const(i,(0,X._)`${Oe.default.vErrors}[${a}]`),t.if((0,X._)`${i}.instancePath === undefined`,()=>t.assign((0,X._)`${i}.instancePath`,(0,X.strConcat)(Oe.default.instancePath,s.errorPath))),t.assign((0,X._)`${i}.schemaPath`,(0,X.str)`${s.errSchemaPath}/${e}`),s.opts.verbose&&(t.assign((0,X._)`${i}.schema`,r),t.assign((0,X._)`${i}.data`,n))})}Te.extendErrors=I$;function am(t,e){let r=t.const("err",e);t.if((0,X._)`${Oe.default.vErrors} === null`,()=>t.assign(Oe.default.vErrors,(0,X._)`[${r}]`),(0,X._)`${Oe.default.vErrors}.push(${r})`),t.code((0,X._)`${Oe.default.errors}++`)}function cm(t,e){let{gen:r,validateName:n,schemaEnv:o}=t;o.$async?r.throw((0,X._)`new ${t.ValidationError}(${e})`):(r.assign((0,X._)`${n}.errors`,e),r.return(!1))}var kr={keyword:new X.Name("keyword"),schemaPath:new X.Name("schemaPath"),params:new X.Name("params"),propertyName:new X.Name("propertyName"),message:new X.Name("message"),schema:new X.Name("schema"),parentSchema:new X.Name("parentSchema")};function um(t,e,r){let{createErrors:n}=t.it;return n===!1?(0,X._)`{}`:O$(t,e,r)}function O$(t,e,r={}){let{gen:n,it:o}=t,s=[N$(o,r),C$(t,r)];return Z$(t,e,s),n.object(...s)}function N$({errorPath:t},{instancePath:e}){let r=e?(0,X.str)`${t}${(0,zs.getErrorPath)(e,zs.Type.Str)}`:t;return[Oe.default.instancePath,(0,X.strConcat)(Oe.default.instancePath,r)]}function C$({keyword:t,it:{errSchemaPath:e}},{schemaPath:r,parentSchema:n}){let o=n?e:(0,X.str)`${e}/${t}`;return r&&(o=(0,X.str)`${o}${(0,zs.getErrorPath)(r,zs.Type.Str)}`),[kr.schemaPath,o]}function Z$(t,{params:e,message:r},n){let{keyword:o,data:s,schemaValue:i,it:a}=t,{opts:c,propertyName:u,topSchemaRef:l,schemaPath:d}=a;n.push([kr.keyword,o],[kr.params,typeof e=="function"?e(t):e||(0,X._)`{}`]),c.messages&&n.push([kr.message,typeof r=="function"?r(t):r]),c.verbose&&n.push([kr.schema,i],[kr.parentSchema,(0,X._)`${l}${d}`],[Oe.default.data,s]),u&&n.push([kr.propertyName,u])}});var dm=S(Jr=>{"use strict";Object.defineProperty(Jr,"__esModule",{value:!0});Jr.boolOrEmptySchema=Jr.topBoolOrEmptySchema=void 0;var j$=Gn(),A$=U(),M$=Pt(),D$={message:"boolean schema is false"};function L$(t){let{gen:e,schema:r,validateName:n}=t;r===!1?lm(t,!1):typeof r=="object"&&r.$async===!0?e.return(M$.default.data):(e.assign((0,A$._)`${n}.errors`,null),e.return(!0))}Jr.topBoolOrEmptySchema=L$;function q$(t,e){let{gen:r,schema:n}=t;n===!1?(r.var(e,!1),lm(t)):r.var(e,!0)}Jr.boolOrEmptySchema=q$;function lm(t,e){let{gen:r,data:n}=t,o={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,j$.reportError)(o,D$,void 0,e)}});var vu=S(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});Wr.getRules=Wr.isJSONType=void 0;var U$=["string","number","integer","boolean","null","object","array"],F$=new Set(U$);function V$(t){return typeof t=="string"&&F$.has(t)}Wr.isJSONType=V$;function H$(){let t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...t,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}Wr.getRules=H$});var bu=S(Ft=>{"use strict";Object.defineProperty(Ft,"__esModule",{value:!0});Ft.shouldUseRule=Ft.shouldUseGroup=Ft.schemaHasRulesForType=void 0;function B$({schema:t,self:e},r){let n=e.RULES.types[r];return n&&n!==!0&&pm(t,n)}Ft.schemaHasRulesForType=B$;function pm(t,e){return e.rules.some(r=>fm(t,r))}Ft.shouldUseGroup=pm;function fm(t,e){var r;return t[e.keyword]!==void 0||((r=e.definition.implements)===null||r===void 0?void 0:r.some(n=>t[n]!==void 0))}Ft.shouldUseRule=fm});var Jn=S(Ee=>{"use strict";Object.defineProperty(Ee,"__esModule",{value:!0});Ee.reportTypeError=Ee.checkDataTypes=Ee.checkDataType=Ee.coerceAndCheckDataType=Ee.getJSONTypes=Ee.getSchemaTypes=Ee.DataType=void 0;var K$=vu(),G$=bu(),J$=Gn(),L=U(),mm=W(),Xr;(function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong"})(Xr||(Ee.DataType=Xr={}));function W$(t){let e=hm(t.type);if(e.includes("null")){if(t.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!e.length&&t.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');t.nullable===!0&&e.push("null")}return e}Ee.getSchemaTypes=W$;function hm(t){let e=Array.isArray(t)?t:t?[t]:[];if(e.every(K$.isJSONType))return e;throw new Error("type must be JSONType or JSONType[]: "+e.join(","))}Ee.getJSONTypes=hm;function X$(t,e){let{gen:r,data:n,opts:o}=t,s=Y$(e,o.coerceTypes),i=e.length>0&&!(s.length===0&&e.length===1&&(0,G$.schemaHasRulesForType)(t,e[0]));if(i){let a=$u(e,n,o.strictNumbers,Xr.Wrong);r.if(a,()=>{s.length?Q$(t,e,s):wu(t)})}return i}Ee.coerceAndCheckDataType=X$;var gm=new Set(["string","number","integer","boolean","null"]);function Y$(t,e){return e?t.filter(r=>gm.has(r)||e==="array"&&r==="array"):[]}function Q$(t,e,r){let{gen:n,data:o,opts:s}=t,i=n.let("dataType",(0,L._)`typeof ${o}`),a=n.let("coerced",(0,L._)`undefined`);s.coerceTypes==="array"&&n.if((0,L._)`${i} == 'object' && Array.isArray(${o}) && ${o}.length == 1`,()=>n.assign(o,(0,L._)`${o}[0]`).assign(i,(0,L._)`typeof ${o}`).if($u(e,o,s.strictNumbers),()=>n.assign(a,o))),n.if((0,L._)`${a} !== undefined`);for(let u of r)(gm.has(u)||u==="array"&&s.coerceTypes==="array")&&c(u);n.else(),wu(t),n.endIf(),n.if((0,L._)`${a} !== undefined`,()=>{n.assign(o,a),e0(t,a)});function c(u){switch(u){case"string":n.elseIf((0,L._)`${i} == "number" || ${i} == "boolean"`).assign(a,(0,L._)`"" + ${o}`).elseIf((0,L._)`${o} === null`).assign(a,(0,L._)`""`);return;case"number":n.elseIf((0,L._)`${i} == "boolean" || ${o} === null
              || (${i} == "string" && ${o} && ${o} == +${o})`).assign(a,(0,L._)`+${o}`);return;case"integer":n.elseIf((0,L._)`${i} === "boolean" || ${o} === null
              || (${i} === "string" && ${o} && ${o} == +${o} && !(${o} % 1))`).assign(a,(0,L._)`+${o}`);return;case"boolean":n.elseIf((0,L._)`${o} === "false" || ${o} === 0 || ${o} === null`).assign(a,!1).elseIf((0,L._)`${o} === "true" || ${o} === 1`).assign(a,!0);return;case"null":n.elseIf((0,L._)`${o} === "" || ${o} === 0 || ${o} === false`),n.assign(a,null);return;case"array":n.elseIf((0,L._)`${i} === "string" || ${i} === "number"
              || ${i} === "boolean" || ${o} === null`).assign(a,(0,L._)`[${o}]`)}}}function e0({gen:t,parentData:e,parentDataProperty:r},n){t.if((0,L._)`${e} !== undefined`,()=>t.assign((0,L._)`${e}[${r}]`,n))}function xu(t,e,r,n=Xr.Correct){let o=n===Xr.Correct?L.operators.EQ:L.operators.NEQ,s;switch(t){case"null":return(0,L._)`${e} ${o} null`;case"array":s=(0,L._)`Array.isArray(${e})`;break;case"object":s=(0,L._)`${e} && typeof ${e} == "object" && !Array.isArray(${e})`;break;case"integer":s=i((0,L._)`!(${e} % 1) && !isNaN(${e})`);break;case"number":s=i();break;default:return(0,L._)`typeof ${e} ${o} ${t}`}return n===Xr.Correct?s:(0,L.not)(s);function i(a=L.nil){return(0,L.and)((0,L._)`typeof ${e} == "number"`,a,r?(0,L._)`isFinite(${e})`:L.nil)}}Ee.checkDataType=xu;function $u(t,e,r,n){if(t.length===1)return xu(t[0],e,r,n);let o,s=(0,mm.toHash)(t);if(s.array&&s.object){let i=(0,L._)`typeof ${e} != "object"`;o=s.null?i:(0,L._)`!${e} || ${i}`,delete s.null,delete s.array,delete s.object}else o=L.nil;s.number&&delete s.integer;for(let i in s)o=(0,L.and)(o,xu(i,e,r,n));return o}Ee.checkDataTypes=$u;var t0={message:({schema:t})=>`must be ${t}`,params:({schema:t,schemaValue:e})=>typeof t=="string"?(0,L._)`{type: ${t}}`:(0,L._)`{type: ${e}}`};function wu(t){let e=r0(t);(0,J$.reportError)(e,t0)}Ee.reportTypeError=wu;function r0(t){let{gen:e,data:r,schema:n}=t,o=(0,mm.schemaRefOrVal)(t,n,"type");return{gen:e,keyword:"type",data:r,schema:n.type,schemaCode:o,schemaValue:o,parentSchema:n,params:{},it:t}}});var ym=S(Ts=>{"use strict";Object.defineProperty(Ts,"__esModule",{value:!0});Ts.assignDefaults=void 0;var Yr=U(),n0=W();function o0(t,e){let{properties:r,items:n}=t.schema;if(e==="object"&&r)for(let o in r)_m(t,o,r[o].default);else e==="array"&&Array.isArray(n)&&n.forEach((o,s)=>_m(t,s,o.default))}Ts.assignDefaults=o0;function _m(t,e,r){let{gen:n,compositeRule:o,data:s,opts:i}=t;if(r===void 0)return;let a=(0,Yr._)`${s}${(0,Yr.getProperty)(e)}`;if(o){(0,n0.checkStrictMode)(t,`default is ignored for: ${a}`);return}let c=(0,Yr._)`${a} === undefined`;i.useDefaults==="empty"&&(c=(0,Yr._)`${c} || ${a} === null || ${a} === ""`),n.if(c,(0,Yr._)`${a} = ${(0,Yr.stringify)(r)}`)}});var Qe=S(te=>{"use strict";Object.defineProperty(te,"__esModule",{value:!0});te.validateUnion=te.validateArray=te.usePattern=te.callValidateCode=te.schemaProperties=te.allSchemaProperties=te.noPropertyInData=te.propertyInData=te.isOwnProperty=te.hasPropFunc=te.reportMissingProp=te.checkMissingProp=te.checkReportMissingProp=void 0;var ae=U(),ku=W(),Vt=Pt(),s0=W();function i0(t,e){let{gen:r,data:n,it:o}=t;r.if(zu(r,n,e,o.opts.ownProperties),()=>{t.setParams({missingProperty:(0,ae._)`${e}`},!0),t.error()})}te.checkReportMissingProp=i0;function a0({gen:t,data:e,it:{opts:r}},n,o){return(0,ae.or)(...n.map(s=>(0,ae.and)(zu(t,e,s,r.ownProperties),(0,ae._)`${o} = ${s}`)))}te.checkMissingProp=a0;function c0(t,e){t.setParams({missingProperty:e},!0),t.error()}te.reportMissingProp=c0;function vm(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,ae._)`Object.prototype.hasOwnProperty`})}te.hasPropFunc=vm;function Su(t,e,r){return(0,ae._)`${vm(t)}.call(${e}, ${r})`}te.isOwnProperty=Su;function u0(t,e,r,n){let o=(0,ae._)`${e}${(0,ae.getProperty)(r)} !== undefined`;return n?(0,ae._)`${o} && ${Su(t,e,r)}`:o}te.propertyInData=u0;function zu(t,e,r,n){let o=(0,ae._)`${e}${(0,ae.getProperty)(r)} === undefined`;return n?(0,ae.or)(o,(0,ae.not)(Su(t,e,r))):o}te.noPropertyInData=zu;function bm(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}te.allSchemaProperties=bm;function l0(t,e){return bm(e).filter(r=>!(0,ku.alwaysValidSchema)(t,e[r]))}te.schemaProperties=l0;function d0({schemaCode:t,data:e,it:{gen:r,topSchemaRef:n,schemaPath:o,errorPath:s},it:i},a,c,u){let l=u?(0,ae._)`${t}, ${e}, ${n}${o}`:e,d=[[Vt.default.instancePath,(0,ae.strConcat)(Vt.default.instancePath,s)],[Vt.default.parentData,i.parentData],[Vt.default.parentDataProperty,i.parentDataProperty],[Vt.default.rootData,Vt.default.rootData]];i.opts.dynamicRef&&d.push([Vt.default.dynamicAnchors,Vt.default.dynamicAnchors]);let m=(0,ae._)`${l}, ${r.object(...d)}`;return c!==ae.nil?(0,ae._)`${a}.call(${c}, ${m})`:(0,ae._)`${a}(${m})`}te.callValidateCode=d0;var p0=(0,ae._)`new RegExp`;function f0({gen:t,it:{opts:e}},r){let n=e.unicodeRegExp?"u":"",{regExp:o}=e.code,s=o(r,n);return t.scopeValue("pattern",{key:s.toString(),ref:s,code:(0,ae._)`${o.code==="new RegExp"?p0:(0,s0.useFunc)(t,o)}(${r}, ${n})`})}te.usePattern=f0;function m0(t){let{gen:e,data:r,keyword:n,it:o}=t,s=e.name("valid");if(o.allErrors){let a=e.let("valid",!0);return i(()=>e.assign(a,!1)),a}return e.var(s,!0),i(()=>e.break()),s;function i(a){let c=e.const("len",(0,ae._)`${r}.length`);e.forRange("i",0,c,u=>{t.subschema({keyword:n,dataProp:u,dataPropType:ku.Type.Num},s),e.if((0,ae.not)(s),a)})}}te.validateArray=m0;function h0(t){let{gen:e,schema:r,keyword:n,it:o}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(c=>(0,ku.alwaysValidSchema)(o,c))&&!o.opts.unevaluated)return;let i=e.let("valid",!1),a=e.name("_valid");e.block(()=>r.forEach((c,u)=>{let l=t.subschema({keyword:n,schemaProp:u,compositeRule:!0},a);e.assign(i,(0,ae._)`${i} || ${a}`),t.mergeValidEvaluated(l,a)||e.if((0,ae.not)(i))})),t.result(i,()=>t.reset(),()=>t.error(!0))}te.validateUnion=h0});var wm=S(ht=>{"use strict";Object.defineProperty(ht,"__esModule",{value:!0});ht.validateKeywordUsage=ht.validSchemaType=ht.funcKeywordCode=ht.macroKeywordCode=void 0;var Ne=U(),Sr=Pt(),g0=Qe(),_0=Gn();function y0(t,e){let{gen:r,keyword:n,schema:o,parentSchema:s,it:i}=t,a=e.macro.call(i.self,o,s,i),c=$m(r,n,a);i.opts.validateSchema!==!1&&i.self.validateSchema(a,!0);let u=r.name("valid");t.subschema({schema:a,schemaPath:Ne.nil,errSchemaPath:`${i.errSchemaPath}/${n}`,topSchemaRef:c,compositeRule:!0},u),t.pass(u,()=>t.error(!0))}ht.macroKeywordCode=y0;function v0(t,e){var r;let{gen:n,keyword:o,schema:s,parentSchema:i,$data:a,it:c}=t;x0(c,e);let u=!a&&e.compile?e.compile.call(c.self,s,i,c):e.validate,l=$m(n,o,u),d=n.let("valid");t.block$data(d,m),t.ok((r=e.valid)!==null&&r!==void 0?r:d);function m(){if(e.errors===!1)h(),e.modifying&&xm(t),g(()=>t.error());else{let v=e.async?f():p();e.modifying&&xm(t),g(()=>b0(t,v))}}function f(){let v=n.let("ruleErrs",null);return n.try(()=>h((0,Ne._)`await `),x=>n.assign(d,!1).if((0,Ne._)`${x} instanceof ${c.ValidationError}`,()=>n.assign(v,(0,Ne._)`${x}.errors`),()=>n.throw(x))),v}function p(){let v=(0,Ne._)`${l}.errors`;return n.assign(v,null),h(Ne.nil),v}function h(v=e.async?(0,Ne._)`await `:Ne.nil){let x=c.opts.passContext?Sr.default.this:Sr.default.self,w=!("compile"in e&&!a||e.schema===!1);n.assign(d,(0,Ne._)`${v}${(0,g0.callValidateCode)(t,l,x,w)}`,e.modifying)}function g(v){var x;n.if((0,Ne.not)((x=e.valid)!==null&&x!==void 0?x:d),v)}}ht.funcKeywordCode=v0;function xm(t){let{gen:e,data:r,it:n}=t;e.if(n.parentData,()=>e.assign(r,(0,Ne._)`${n.parentData}[${n.parentDataProperty}]`))}function b0(t,e){let{gen:r}=t;r.if((0,Ne._)`Array.isArray(${e})`,()=>{r.assign(Sr.default.vErrors,(0,Ne._)`${Sr.default.vErrors} === null ? ${e} : ${Sr.default.vErrors}.concat(${e})`).assign(Sr.default.errors,(0,Ne._)`${Sr.default.vErrors}.length`),(0,_0.extendErrors)(t)},()=>t.error())}function x0({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function $m(t,e,r){if(r===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,Ne.stringify)(r)})}function $0(t,e,r=!1){return!e.length||e.some(n=>n==="array"?Array.isArray(t):n==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==n||r&&typeof t>"u")}ht.validSchemaType=$0;function w0({schema:t,opts:e,self:r,errSchemaPath:n},o,s){if(Array.isArray(o.keyword)?!o.keyword.includes(s):o.keyword!==s)throw new Error("ajv implementation error");let i=o.dependencies;if(i?.some(a=>!Object.prototype.hasOwnProperty.call(t,a)))throw new Error(`parent schema must have dependencies of ${s}: ${i.join(",")}`);if(o.validateSchema&&!o.validateSchema(t[s])){let c=`keyword "${s}" value is invalid at path "${n}": `+r.errorsText(o.validateSchema.errors);if(e.validateSchema==="log")r.logger.error(c);else throw new Error(c)}}ht.validateKeywordUsage=w0});var Sm=S(Ht=>{"use strict";Object.defineProperty(Ht,"__esModule",{value:!0});Ht.extendSubschemaMode=Ht.extendSubschemaData=Ht.getSubschema=void 0;var gt=U(),km=W();function k0(t,{keyword:e,schemaProp:r,schema:n,schemaPath:o,errSchemaPath:s,topSchemaRef:i}){if(e!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){let a=t.schema[e];return r===void 0?{schema:a,schemaPath:(0,gt._)`${t.schemaPath}${(0,gt.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:a[r],schemaPath:(0,gt._)`${t.schemaPath}${(0,gt.getProperty)(e)}${(0,gt.getProperty)(r)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,km.escapeFragment)(r)}`}}if(n!==void 0){if(o===void 0||s===void 0||i===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:o,topSchemaRef:i,errSchemaPath:s}}throw new Error('either "keyword" or "schema" must be passed')}Ht.getSubschema=k0;function S0(t,e,{dataProp:r,dataPropType:n,data:o,dataTypes:s,propertyName:i}){if(o!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');let{gen:a}=e;if(r!==void 0){let{errorPath:u,dataPathArr:l,opts:d}=e,m=a.let("data",(0,gt._)`${e.data}${(0,gt.getProperty)(r)}`,!0);c(m),t.errorPath=(0,gt.str)`${u}${(0,km.getErrorPath)(r,n,d.jsPropertySyntax)}`,t.parentDataProperty=(0,gt._)`${r}`,t.dataPathArr=[...l,t.parentDataProperty]}if(o!==void 0){let u=o instanceof gt.Name?o:a.let("data",o,!0);c(u),i!==void 0&&(t.propertyName=i)}s&&(t.dataTypes=s);function c(u){t.data=u,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,u]}}Ht.extendSubschemaData=S0;function z0(t,{jtdDiscriminator:e,jtdMetadata:r,compositeRule:n,createErrors:o,allErrors:s}){n!==void 0&&(t.compositeRule=n),o!==void 0&&(t.createErrors=o),s!==void 0&&(t.allErrors=s),t.jtdDiscriminator=e,t.jtdMetadata=r}Ht.extendSubschemaMode=z0});var Tu=S((MO,zm)=>{"use strict";zm.exports=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,o,s;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(o=n;o--!==0;)if(!t(e[o],r[o]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(s=Object.keys(e),n=s.length,n!==Object.keys(r).length)return!1;for(o=n;o--!==0;)if(!Object.prototype.hasOwnProperty.call(r,s[o]))return!1;for(o=n;o--!==0;){var i=s[o];if(!t(e[i],r[i]))return!1}return!0}return e!==e&&r!==r}});var Em=S((DO,Tm)=>{"use strict";var Bt=Tm.exports=function(t,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var n=typeof r=="function"?r:r.pre||function(){},o=r.post||function(){};Es(e,n,o,t,"",t)};Bt.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};Bt.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};Bt.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};Bt.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function Es(t,e,r,n,o,s,i,a,c,u){if(n&&typeof n=="object"&&!Array.isArray(n)){e(n,o,s,i,a,c,u);for(var l in n){var d=n[l];if(Array.isArray(d)){if(l in Bt.arrayKeywords)for(var m=0;m<d.length;m++)Es(t,e,r,d[m],o+"/"+l+"/"+m,s,o,l,n,m)}else if(l in Bt.propsKeywords){if(d&&typeof d=="object")for(var f in d)Es(t,e,r,d[f],o+"/"+l+"/"+T0(f),s,o,l,n,f)}else(l in Bt.keywords||t.allKeys&&!(l in Bt.skipKeywords))&&Es(t,e,r,d,o+"/"+l,s,o,l,n)}r(n,o,s,i,a,c,u)}}function T0(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}});var Wn=S(Le=>{"use strict";Object.defineProperty(Le,"__esModule",{value:!0});Le.getSchemaRefs=Le.resolveUrl=Le.normalizeId=Le._getFullPath=Le.getFullPath=Le.inlineRef=void 0;var E0=W(),P0=Tu(),R0=Em(),I0=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function O0(t,e=!0){return typeof t=="boolean"?!0:e===!0?!Eu(t):e?Pm(t)<=e:!1}Le.inlineRef=O0;var N0=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function Eu(t){for(let e in t){if(N0.has(e))return!0;let r=t[e];if(Array.isArray(r)&&r.some(Eu)||typeof r=="object"&&Eu(r))return!0}return!1}function Pm(t){let e=0;for(let r in t){if(r==="$ref")return 1/0;if(e++,!I0.has(r)&&(typeof t[r]=="object"&&(0,E0.eachItem)(t[r],n=>e+=Pm(n)),e===1/0))return 1/0}return e}function Rm(t,e="",r){r!==!1&&(e=Qr(e));let n=t.parse(e);return Im(t,n)}Le.getFullPath=Rm;function Im(t,e){return t.serialize(e).split("#")[0]+"#"}Le._getFullPath=Im;var C0=/#\/?$/;function Qr(t){return t?t.replace(C0,""):""}Le.normalizeId=Qr;function Z0(t,e,r){return r=Qr(r),t.resolve(e,r)}Le.resolveUrl=Z0;var j0=/^[a-z_][-a-z0-9._]*$/i;function A0(t,e){if(typeof t=="boolean")return{};let{schemaId:r,uriResolver:n}=this.opts,o=Qr(t[r]||e),s={"":o},i=Rm(n,o,!1),a={},c=new Set;return R0(t,{allKeys:!0},(d,m,f,p)=>{if(p===void 0)return;let h=i+m,g=s[p];typeof d[r]=="string"&&(g=v.call(this,d[r])),x.call(this,d.$anchor),x.call(this,d.$dynamicAnchor),s[m]=g;function v(w){let E=this.opts.uriResolver.resolve;if(w=Qr(g?E(g,w):w),c.has(w))throw l(w);c.add(w);let C=this.refs[w];return typeof C=="string"&&(C=this.refs[C]),typeof C=="object"?u(d,C.schema,w):w!==Qr(h)&&(w[0]==="#"?(u(d,a[w],w),a[w]=d):this.refs[w]=h),w}function x(w){if(typeof w=="string"){if(!j0.test(w))throw new Error(`invalid anchor "${w}"`);v.call(this,`#${w}`)}}}),a;function u(d,m,f){if(m!==void 0&&!P0(d,m))throw l(f)}function l(d){return new Error(`reference "${d}" resolves to more than one schema`)}}Le.getSchemaRefs=A0});var Qn=S(Kt=>{"use strict";Object.defineProperty(Kt,"__esModule",{value:!0});Kt.getData=Kt.KeywordCxt=Kt.validateFunctionCode=void 0;var jm=dm(),Om=Jn(),Ru=bu(),Ps=Jn(),M0=ym(),Yn=wm(),Pu=Sm(),O=U(),M=Pt(),D0=Wn(),Rt=W(),Xn=Gn();function L0(t){if(Dm(t)&&(Lm(t),Mm(t))){F0(t);return}Am(t,()=>(0,jm.topBoolOrEmptySchema)(t))}Kt.validateFunctionCode=L0;function Am({gen:t,validateName:e,schema:r,schemaEnv:n,opts:o},s){o.code.es5?t.func(e,(0,O._)`${M.default.data}, ${M.default.valCxt}`,n.$async,()=>{t.code((0,O._)`"use strict"; ${Nm(r,o)}`),U0(t,o),t.code(s)}):t.func(e,(0,O._)`${M.default.data}, ${q0(o)}`,n.$async,()=>t.code(Nm(r,o)).code(s))}function q0(t){return(0,O._)`{${M.default.instancePath}="", ${M.default.parentData}, ${M.default.parentDataProperty}, ${M.default.rootData}=${M.default.data}${t.dynamicRef?(0,O._)`, ${M.default.dynamicAnchors}={}`:O.nil}}={}`}function U0(t,e){t.if(M.default.valCxt,()=>{t.var(M.default.instancePath,(0,O._)`${M.default.valCxt}.${M.default.instancePath}`),t.var(M.default.parentData,(0,O._)`${M.default.valCxt}.${M.default.parentData}`),t.var(M.default.parentDataProperty,(0,O._)`${M.default.valCxt}.${M.default.parentDataProperty}`),t.var(M.default.rootData,(0,O._)`${M.default.valCxt}.${M.default.rootData}`),e.dynamicRef&&t.var(M.default.dynamicAnchors,(0,O._)`${M.default.valCxt}.${M.default.dynamicAnchors}`)},()=>{t.var(M.default.instancePath,(0,O._)`""`),t.var(M.default.parentData,(0,O._)`undefined`),t.var(M.default.parentDataProperty,(0,O._)`undefined`),t.var(M.default.rootData,M.default.data),e.dynamicRef&&t.var(M.default.dynamicAnchors,(0,O._)`{}`)})}function F0(t){let{schema:e,opts:r,gen:n}=t;Am(t,()=>{r.$comment&&e.$comment&&Um(t),G0(t),n.let(M.default.vErrors,null),n.let(M.default.errors,0),r.unevaluated&&V0(t),qm(t),X0(t)})}function V0(t){let{gen:e,validateName:r}=t;t.evaluated=e.const("evaluated",(0,O._)`${r}.evaluated`),e.if((0,O._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,O._)`${t.evaluated}.props`,(0,O._)`undefined`)),e.if((0,O._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,O._)`${t.evaluated}.items`,(0,O._)`undefined`))}function Nm(t,e){let r=typeof t=="object"&&t[e.schemaId];return r&&(e.code.source||e.code.process)?(0,O._)`/*# sourceURL=${r} */`:O.nil}function H0(t,e){if(Dm(t)&&(Lm(t),Mm(t))){B0(t,e);return}(0,jm.boolOrEmptySchema)(t,e)}function Mm({schema:t,self:e}){if(typeof t=="boolean")return!t;for(let r in t)if(e.RULES.all[r])return!0;return!1}function Dm(t){return typeof t.schema!="boolean"}function B0(t,e){let{schema:r,gen:n,opts:o}=t;o.$comment&&r.$comment&&Um(t),J0(t),W0(t);let s=n.const("_errs",M.default.errors);qm(t,s),n.var(e,(0,O._)`${s} === ${M.default.errors}`)}function Lm(t){(0,Rt.checkUnknownRules)(t),K0(t)}function qm(t,e){if(t.opts.jtd)return Cm(t,[],!1,e);let r=(0,Om.getSchemaTypes)(t.schema),n=(0,Om.coerceAndCheckDataType)(t,r);Cm(t,r,!n,e)}function K0(t){let{schema:e,errSchemaPath:r,opts:n,self:o}=t;e.$ref&&n.ignoreKeywordsWithRef&&(0,Rt.schemaHasRulesButRef)(e,o.RULES)&&o.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function G0(t){let{schema:e,opts:r}=t;e.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,Rt.checkStrictMode)(t,"default is ignored in the schema root")}function J0(t){let e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,D0.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function W0(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function Um({gen:t,schemaEnv:e,schema:r,errSchemaPath:n,opts:o}){let s=r.$comment;if(o.$comment===!0)t.code((0,O._)`${M.default.self}.logger.log(${s})`);else if(typeof o.$comment=="function"){let i=(0,O.str)`${n}/$comment`,a=t.scopeValue("root",{ref:e.root});t.code((0,O._)`${M.default.self}.opts.$comment(${s}, ${i}, ${a}.schema)`)}}function X0(t){let{gen:e,schemaEnv:r,validateName:n,ValidationError:o,opts:s}=t;r.$async?e.if((0,O._)`${M.default.errors} === 0`,()=>e.return(M.default.data),()=>e.throw((0,O._)`new ${o}(${M.default.vErrors})`)):(e.assign((0,O._)`${n}.errors`,M.default.vErrors),s.unevaluated&&Y0(t),e.return((0,O._)`${M.default.errors} === 0`))}function Y0({gen:t,evaluated:e,props:r,items:n}){r instanceof O.Name&&t.assign((0,O._)`${e}.props`,r),n instanceof O.Name&&t.assign((0,O._)`${e}.items`,n)}function Cm(t,e,r,n){let{gen:o,schema:s,data:i,allErrors:a,opts:c,self:u}=t,{RULES:l}=u;if(s.$ref&&(c.ignoreKeywordsWithRef||!(0,Rt.schemaHasRulesButRef)(s,l))){o.block(()=>Vm(t,"$ref",l.all.$ref.definition));return}c.jtd||Q0(t,e),o.block(()=>{for(let m of l.rules)d(m);d(l.post)});function d(m){(0,Ru.shouldUseGroup)(s,m)&&(m.type?(o.if((0,Ps.checkDataType)(m.type,i,c.strictNumbers)),Zm(t,m),e.length===1&&e[0]===m.type&&r&&(o.else(),(0,Ps.reportTypeError)(t)),o.endIf()):Zm(t,m),a||o.if((0,O._)`${M.default.errors} === ${n||0}`))}}function Zm(t,e){let{gen:r,schema:n,opts:{useDefaults:o}}=t;o&&(0,M0.assignDefaults)(t,e.type),r.block(()=>{for(let s of e.rules)(0,Ru.shouldUseRule)(n,s)&&Vm(t,s.keyword,s.definition,e.type)})}function Q0(t,e){t.schemaEnv.meta||!t.opts.strictTypes||(ew(t,e),t.opts.allowUnionTypes||tw(t,e),rw(t,t.dataTypes))}function ew(t,e){if(e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(r=>{Fm(t.dataTypes,r)||Iu(t,`type "${r}" not allowed by context "${t.dataTypes.join(",")}"`)}),ow(t,e)}}function tw(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&Iu(t,"use allowUnionTypes to allow union type keyword")}function rw(t,e){let r=t.self.RULES.all;for(let n in r){let o=r[n];if(typeof o=="object"&&(0,Ru.shouldUseRule)(t.schema,o)){let{type:s}=o.definition;s.length&&!s.some(i=>nw(e,i))&&Iu(t,`missing type "${s.join(",")}" for keyword "${n}"`)}}}function nw(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function Fm(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function ow(t,e){let r=[];for(let n of t.dataTypes)Fm(e,n)?r.push(n):e.includes("integer")&&n==="number"&&r.push("integer");t.dataTypes=r}function Iu(t,e){let r=t.schemaEnv.baseId+t.errSchemaPath;e+=` at "${r}" (strictTypes)`,(0,Rt.checkStrictMode)(t,e,t.opts.strictTypes)}var Rs=class{constructor(e,r,n){if((0,Yn.validateKeywordUsage)(e,r,n),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=n,this.data=e.data,this.schema=e.schema[n],this.$data=r.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,Rt.schemaRefOrVal)(e,this.schema,n,this.$data),this.schemaType=r.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=r,this.$data)this.schemaCode=e.gen.const("vSchema",Hm(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,Yn.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=e.gen.const("_errs",M.default.errors))}result(e,r,n){this.failResult((0,O.not)(e),r,n)}failResult(e,r,n){this.gen.if(e),n?n():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,r){this.failResult((0,O.not)(e),void 0,r)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);let{schemaCode:r}=this;this.fail((0,O._)`${r} !== undefined && (${(0,O.or)(this.invalid$data(),e)})`)}error(e,r,n){if(r){this.setParams(r),this._error(e,n),this.setParams({});return}this._error(e,n)}_error(e,r){(e?Xn.reportExtraError:Xn.reportError)(this,this.def.error,r)}$dataError(){(0,Xn.reportError)(this,this.def.$dataError||Xn.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,Xn.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,r){r?Object.assign(this.params,e):this.params=e}block$data(e,r,n=O.nil){this.gen.block(()=>{this.check$data(e,n),r()})}check$data(e=O.nil,r=O.nil){if(!this.$data)return;let{gen:n,schemaCode:o,schemaType:s,def:i}=this;n.if((0,O.or)((0,O._)`${o} === undefined`,r)),e!==O.nil&&n.assign(e,!0),(s.length||i.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==O.nil&&n.assign(e,!1)),n.else()}invalid$data(){let{gen:e,schemaCode:r,schemaType:n,def:o,it:s}=this;return(0,O.or)(i(),a());function i(){if(n.length){if(!(r instanceof O.Name))throw new Error("ajv implementation error");let c=Array.isArray(n)?n:[n];return(0,O._)`${(0,Ps.checkDataTypes)(c,r,s.opts.strictNumbers,Ps.DataType.Wrong)}`}return O.nil}function a(){if(o.validateSchema){let c=e.scopeValue("validate$data",{ref:o.validateSchema});return(0,O._)`!${c}(${r})`}return O.nil}}subschema(e,r){let n=(0,Pu.getSubschema)(this.it,e);(0,Pu.extendSubschemaData)(n,this.it,e),(0,Pu.extendSubschemaMode)(n,e);let o={...this.it,...n,items:void 0,props:void 0};return H0(o,r),o}mergeEvaluated(e,r){let{it:n,gen:o}=this;n.opts.unevaluated&&(n.props!==!0&&e.props!==void 0&&(n.props=Rt.mergeEvaluated.props(o,e.props,n.props,r)),n.items!==!0&&e.items!==void 0&&(n.items=Rt.mergeEvaluated.items(o,e.items,n.items,r)))}mergeValidEvaluated(e,r){let{it:n,gen:o}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return o.if(r,()=>this.mergeEvaluated(e,O.Name)),!0}};Kt.KeywordCxt=Rs;function Vm(t,e,r,n){let o=new Rs(t,r,e);"code"in r?r.code(o,n):o.$data&&r.validate?(0,Yn.funcKeywordCode)(o,r):"macro"in r?(0,Yn.macroKeywordCode)(o,r):(r.compile||r.validate)&&(0,Yn.funcKeywordCode)(o,r)}var sw=/^\/(?:[^~]|~0|~1)*$/,iw=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function Hm(t,{dataLevel:e,dataNames:r,dataPathArr:n}){let o,s;if(t==="")return M.default.rootData;if(t[0]==="/"){if(!sw.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);o=t,s=M.default.rootData}else{let u=iw.exec(t);if(!u)throw new Error(`Invalid JSON-pointer: ${t}`);let l=+u[1];if(o=u[2],o==="#"){if(l>=e)throw new Error(c("property/index",l));return n[e-l]}if(l>e)throw new Error(c("data",l));if(s=r[e-l],!o)return s}let i=s,a=o.split("/");for(let u of a)u&&(s=(0,O._)`${s}${(0,O.getProperty)((0,Rt.unescapeJsonPointer)(u))}`,i=(0,O._)`${i} && ${s}`);return i;function c(u,l){return`Cannot access ${u} ${l} levels up, current level is ${e}`}}Kt.getData=Hm});var Is=S(Nu=>{"use strict";Object.defineProperty(Nu,"__esModule",{value:!0});var Ou=class extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}};Nu.default=Ou});var eo=S(ju=>{"use strict";Object.defineProperty(ju,"__esModule",{value:!0});var Cu=Wn(),Zu=class extends Error{constructor(e,r,n,o){super(o||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,Cu.resolveUrl)(e,r,n),this.missingSchema=(0,Cu.normalizeId)((0,Cu.getFullPath)(e,this.missingRef))}};ju.default=Zu});var Ns=S(et=>{"use strict";Object.defineProperty(et,"__esModule",{value:!0});et.resolveSchema=et.getCompilingSchema=et.resolveRef=et.compileSchema=et.SchemaEnv=void 0;var at=U(),aw=Is(),zr=Pt(),ct=Wn(),Bm=W(),cw=Qn(),en=class{constructor(e){var r;this.refs={},this.dynamicAnchors={};let n;typeof e.schema=="object"&&(n=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(r=e.baseId)!==null&&r!==void 0?r:(0,ct.normalizeId)(n?.[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=n?.$async,this.refs={}}};et.SchemaEnv=en;function Mu(t){let e=Km.call(this,t);if(e)return e;let r=(0,ct.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:n,lines:o}=this.opts.code,{ownProperties:s}=this.opts,i=new at.CodeGen(this.scope,{es5:n,lines:o,ownProperties:s}),a;t.$async&&(a=i.scopeValue("Error",{ref:aw.default,code:(0,at._)`require("ajv/dist/runtime/validation_error").default`}));let c=i.scopeName("validate");t.validateName=c;let u={gen:i,allErrors:this.opts.allErrors,data:zr.default.data,parentData:zr.default.parentData,parentDataProperty:zr.default.parentDataProperty,dataNames:[zr.default.data],dataPathArr:[at.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:i.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,at.stringify)(t.schema)}:{ref:t.schema}),validateName:c,ValidationError:a,schema:t.schema,schemaEnv:t,rootId:r,baseId:t.baseId||r,schemaPath:at.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,at._)`""`,opts:this.opts,self:this},l;try{this._compilations.add(t),(0,cw.validateFunctionCode)(u),i.optimize(this.opts.code.optimize);let d=i.toString();l=`${i.scopeRefs(zr.default.scope)}return ${d}`,this.opts.code.process&&(l=this.opts.code.process(l,t));let f=new Function(`${zr.default.self}`,`${zr.default.scope}`,l)(this,this.scope.get());if(this.scope.value(c,{ref:f}),f.errors=null,f.schema=t.schema,f.schemaEnv=t,t.$async&&(f.$async=!0),this.opts.code.source===!0&&(f.source={validateName:c,validateCode:d,scopeValues:i._values}),this.opts.unevaluated){let{props:p,items:h}=u;f.evaluated={props:p instanceof at.Name?void 0:p,items:h instanceof at.Name?void 0:h,dynamicProps:p instanceof at.Name,dynamicItems:h instanceof at.Name},f.source&&(f.source.evaluated=(0,at.stringify)(f.evaluated))}return t.validate=f,t}catch(d){throw delete t.validate,delete t.validateName,l&&this.logger.error("Error compiling schema, function code:",l),d}finally{this._compilations.delete(t)}}et.compileSchema=Mu;function uw(t,e,r){var n;r=(0,ct.resolveUrl)(this.opts.uriResolver,e,r);let o=t.refs[r];if(o)return o;let s=pw.call(this,t,r);if(s===void 0){let i=(n=t.localRefs)===null||n===void 0?void 0:n[r],{schemaId:a}=this.opts;i&&(s=new en({schema:i,schemaId:a,root:t,baseId:e}))}if(s!==void 0)return t.refs[r]=lw.call(this,s)}et.resolveRef=uw;function lw(t){return(0,ct.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:Mu.call(this,t)}function Km(t){for(let e of this._compilations)if(dw(e,t))return e}et.getCompilingSchema=Km;function dw(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function pw(t,e){let r;for(;typeof(r=this.refs[e])=="string";)e=r;return r||this.schemas[e]||Os.call(this,t,e)}function Os(t,e){let r=this.opts.uriResolver.parse(e),n=(0,ct._getFullPath)(this.opts.uriResolver,r),o=(0,ct.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&n===o)return Au.call(this,r,t);let s=(0,ct.normalizeId)(n),i=this.refs[s]||this.schemas[s];if(typeof i=="string"){let a=Os.call(this,t,i);return typeof a?.schema!="object"?void 0:Au.call(this,r,a)}if(typeof i?.schema=="object"){if(i.validate||Mu.call(this,i),s===(0,ct.normalizeId)(e)){let{schema:a}=i,{schemaId:c}=this.opts,u=a[c];return u&&(o=(0,ct.resolveUrl)(this.opts.uriResolver,o,u)),new en({schema:a,schemaId:c,root:t,baseId:o})}return Au.call(this,r,i)}}et.resolveSchema=Os;var fw=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Au(t,{baseId:e,schema:r,root:n}){var o;if(((o=t.fragment)===null||o===void 0?void 0:o[0])!=="/")return;for(let a of t.fragment.slice(1).split("/")){if(typeof r=="boolean")return;let c=r[(0,Bm.unescapeFragment)(a)];if(c===void 0)return;r=c;let u=typeof r=="object"&&r[this.opts.schemaId];!fw.has(a)&&u&&(e=(0,ct.resolveUrl)(this.opts.uriResolver,e,u))}let s;if(typeof r!="boolean"&&r.$ref&&!(0,Bm.schemaHasRulesButRef)(r,this.RULES)){let a=(0,ct.resolveUrl)(this.opts.uriResolver,e,r.$ref);s=Os.call(this,n,a)}let{schemaId:i}=this.opts;if(s=s||new en({schema:r,schemaId:i,root:n,baseId:e}),s.schema!==s.root.schema)return s}});var Gm=S((HO,mw)=>{mw.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var Lu=S((BO,Ym)=>{"use strict";var hw=RegExp.prototype.test.bind(/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu),Wm=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u);function Du(t){let e="",r=0,n=0;for(n=0;n<t.length;n++)if(r=t[n].charCodeAt(0),r!==48){if(!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";e+=t[n];break}for(n+=1;n<t.length;n++){if(r=t[n].charCodeAt(0),!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";e+=t[n]}return e}var gw=RegExp.prototype.test.bind(/[^!"$&'()*+,\-.;=_`a-z{}~]/u);function Jm(t){return t.length=0,!0}function _w(t,e,r){if(t.length){let n=Du(t);if(n!=="")e.push(n);else return r.error=!0,!1;t.length=0}return!0}function yw(t){let e=0,r={error:!1,address:"",zone:""},n=[],o=[],s=!1,i=!1,a=_w;for(let c=0;c<t.length;c++){let u=t[c];if(!(u==="["||u==="]"))if(u===":"){if(s===!0&&(i=!0),!a(o,n,r))break;if(++e>7){r.error=!0;break}c>0&&t[c-1]===":"&&(s=!0),n.push(":");continue}else if(u==="%"){if(!a(o,n,r))break;a=Jm}else{o.push(u);continue}}return o.length&&(a===Jm?r.zone=o.join(""):i?n.push(o.join("")):n.push(Du(o))),r.address=n.join(""),r}function Xm(t){if(vw(t,":")<2)return{host:t,isIPV6:!1};let e=yw(t);if(e.error)return{host:t,isIPV6:!1};{let r=e.address,n=e.address;return e.zone&&(r+="%"+e.zone,n+="%25"+e.zone),{host:r,isIPV6:!0,escapedHost:n}}}function vw(t,e){let r=0;for(let n=0;n<t.length;n++)t[n]===e&&r++;return r}function bw(t){let e=t,r=[],n=-1,o=0;for(;o=e.length;){if(o===1){if(e===".")break;if(e==="/"){r.push("/");break}else{r.push(e);break}}else if(o===2){if(e[0]==="."){if(e[1]===".")break;if(e[1]==="/"){e=e.slice(2);continue}}else if(e[0]==="/"&&(e[1]==="."||e[1]==="/")){r.push("/");break}}else if(o===3&&e==="/.."){r.length!==0&&r.pop(),r.push("/");break}if(e[0]==="."){if(e[1]==="."){if(e[2]==="/"){e=e.slice(3);continue}}else if(e[1]==="/"){e=e.slice(2);continue}}else if(e[0]==="/"&&e[1]==="."){if(e[2]==="/"){e=e.slice(2);continue}else if(e[2]==="."&&e[3]==="/"){e=e.slice(3),r.length!==0&&r.pop();continue}}if((n=e.indexOf("/",1))===-1){r.push(e);break}else r.push(e.slice(0,n)),e=e.slice(n)}return r.join("")}function xw(t,e){let r=e!==!0?escape:unescape;return t.scheme!==void 0&&(t.scheme=r(t.scheme)),t.userinfo!==void 0&&(t.userinfo=r(t.userinfo)),t.host!==void 0&&(t.host=r(t.host)),t.path!==void 0&&(t.path=r(t.path)),t.query!==void 0&&(t.query=r(t.query)),t.fragment!==void 0&&(t.fragment=r(t.fragment)),t}function $w(t){let e=[];if(t.userinfo!==void 0&&(e.push(t.userinfo),e.push("@")),t.host!==void 0){let r=unescape(t.host);if(!Wm(r)){let n=Xm(r);n.isIPV6===!0?r=`[${n.escapedHost}]`:r=t.host}e.push(r)}return(typeof t.port=="number"||typeof t.port=="string")&&(e.push(":"),e.push(String(t.port))),e.length?e.join(""):void 0}Ym.exports={nonSimpleDomain:gw,recomposeAuthority:$w,normalizeComponentEncoding:xw,removeDotSegments:bw,isIPv4:Wm,isUUID:hw,normalizeIPv6:Xm,stringArrayToHexStripped:Du}});var nh=S((KO,rh)=>{"use strict";var{isUUID:ww}=Lu(),kw=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu,Sw=["http","https","ws","wss","urn","urn:uuid"];function zw(t){return Sw.indexOf(t)!==-1}function qu(t){return t.secure===!0?!0:t.secure===!1?!1:t.scheme?t.scheme.length===3&&(t.scheme[0]==="w"||t.scheme[0]==="W")&&(t.scheme[1]==="s"||t.scheme[1]==="S")&&(t.scheme[2]==="s"||t.scheme[2]==="S"):!1}function Qm(t){return t.host||(t.error=t.error||"HTTP URIs must have a host."),t}function eh(t){let e=String(t.scheme).toLowerCase()==="https";return(t.port===(e?443:80)||t.port==="")&&(t.port=void 0),t.path||(t.path="/"),t}function Tw(t){return t.secure=qu(t),t.resourceName=(t.path||"/")+(t.query?"?"+t.query:""),t.path=void 0,t.query=void 0,t}function Ew(t){if((t.port===(qu(t)?443:80)||t.port==="")&&(t.port=void 0),typeof t.secure=="boolean"&&(t.scheme=t.secure?"wss":"ws",t.secure=void 0),t.resourceName){let[e,r]=t.resourceName.split("?");t.path=e&&e!=="/"?e:void 0,t.query=r,t.resourceName=void 0}return t.fragment=void 0,t}function Pw(t,e){if(!t.path)return t.error="URN can not be parsed",t;let r=t.path.match(kw);if(r){let n=e.scheme||t.scheme||"urn";t.nid=r[1].toLowerCase(),t.nss=r[2];let o=`${n}:${e.nid||t.nid}`,s=Uu(o);t.path=void 0,s&&(t=s.parse(t,e))}else t.error=t.error||"URN can not be parsed.";return t}function Rw(t,e){if(t.nid===void 0)throw new Error("URN without nid cannot be serialized");let r=e.scheme||t.scheme||"urn",n=t.nid.toLowerCase(),o=`${r}:${e.nid||n}`,s=Uu(o);s&&(t=s.serialize(t,e));let i=t,a=t.nss;return i.path=`${n||e.nid}:${a}`,e.skipEscape=!0,i}function Iw(t,e){let r=t;return r.uuid=r.nss,r.nss=void 0,!e.tolerant&&(!r.uuid||!ww(r.uuid))&&(r.error=r.error||"UUID is not valid."),r}function Ow(t){let e=t;return e.nss=(t.uuid||"").toLowerCase(),e}var th={scheme:"http",domainHost:!0,parse:Qm,serialize:eh},Nw={scheme:"https",domainHost:th.domainHost,parse:Qm,serialize:eh},Cs={scheme:"ws",domainHost:!0,parse:Tw,serialize:Ew},Cw={scheme:"wss",domainHost:Cs.domainHost,parse:Cs.parse,serialize:Cs.serialize},Zw={scheme:"urn",parse:Pw,serialize:Rw,skipNormalize:!0},jw={scheme:"urn:uuid",parse:Iw,serialize:Ow,skipNormalize:!0},Zs={http:th,https:Nw,ws:Cs,wss:Cw,urn:Zw,"urn:uuid":jw};Object.setPrototypeOf(Zs,null);function Uu(t){return t&&(Zs[t]||Zs[t.toLowerCase()])||void 0}rh.exports={wsIsSecure:qu,SCHEMES:Zs,isValidSchemeName:zw,getSchemeHandler:Uu}});var ih=S((GO,As)=>{"use strict";var{normalizeIPv6:Aw,removeDotSegments:to,recomposeAuthority:Mw,normalizeComponentEncoding:js,isIPv4:Dw,nonSimpleDomain:Lw}=Lu(),{SCHEMES:qw,getSchemeHandler:oh}=nh();function Uw(t,e){return typeof t=="string"?t=_t(It(t,e),e):typeof t=="object"&&(t=It(_t(t,e),e)),t}function Fw(t,e,r){let n=r?Object.assign({scheme:"null"},r):{scheme:"null"},o=sh(It(t,n),It(e,n),n,!0);return n.skipEscape=!0,_t(o,n)}function sh(t,e,r,n){let o={};return n||(t=It(_t(t,r),r),e=It(_t(e,r),r)),r=r||{},!r.tolerant&&e.scheme?(o.scheme=e.scheme,o.userinfo=e.userinfo,o.host=e.host,o.port=e.port,o.path=to(e.path||""),o.query=e.query):(e.userinfo!==void 0||e.host!==void 0||e.port!==void 0?(o.userinfo=e.userinfo,o.host=e.host,o.port=e.port,o.path=to(e.path||""),o.query=e.query):(e.path?(e.path[0]==="/"?o.path=to(e.path):((t.userinfo!==void 0||t.host!==void 0||t.port!==void 0)&&!t.path?o.path="/"+e.path:t.path?o.path=t.path.slice(0,t.path.lastIndexOf("/")+1)+e.path:o.path=e.path,o.path=to(o.path)),o.query=e.query):(o.path=t.path,e.query!==void 0?o.query=e.query:o.query=t.query),o.userinfo=t.userinfo,o.host=t.host,o.port=t.port),o.scheme=t.scheme),o.fragment=e.fragment,o}function Vw(t,e,r){return typeof t=="string"?(t=unescape(t),t=_t(js(It(t,r),!0),{...r,skipEscape:!0})):typeof t=="object"&&(t=_t(js(t,!0),{...r,skipEscape:!0})),typeof e=="string"?(e=unescape(e),e=_t(js(It(e,r),!0),{...r,skipEscape:!0})):typeof e=="object"&&(e=_t(js(e,!0),{...r,skipEscape:!0})),t.toLowerCase()===e.toLowerCase()}function _t(t,e){let r={host:t.host,scheme:t.scheme,userinfo:t.userinfo,port:t.port,path:t.path,query:t.query,nid:t.nid,nss:t.nss,uuid:t.uuid,fragment:t.fragment,reference:t.reference,resourceName:t.resourceName,secure:t.secure,error:""},n=Object.assign({},e),o=[],s=oh(n.scheme||r.scheme);s&&s.serialize&&s.serialize(r,n),r.path!==void 0&&(n.skipEscape?r.path=unescape(r.path):(r.path=escape(r.path),r.scheme!==void 0&&(r.path=r.path.split("%3A").join(":")))),n.reference!=="suffix"&&r.scheme&&o.push(r.scheme,":");let i=Mw(r);if(i!==void 0&&(n.reference!=="suffix"&&o.push("//"),o.push(i),r.path&&r.path[0]!=="/"&&o.push("/")),r.path!==void 0){let a=r.path;!n.absolutePath&&(!s||!s.absolutePath)&&(a=to(a)),i===void 0&&a[0]==="/"&&a[1]==="/"&&(a="/%2F"+a.slice(2)),o.push(a)}return r.query!==void 0&&o.push("?",r.query),r.fragment!==void 0&&o.push("#",r.fragment),o.join("")}var Hw=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function It(t,e){let r=Object.assign({},e),n={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},o=!1;r.reference==="suffix"&&(r.scheme?t=r.scheme+":"+t:t="//"+t);let s=t.match(Hw);if(s){if(n.scheme=s[1],n.userinfo=s[3],n.host=s[4],n.port=parseInt(s[5],10),n.path=s[6]||"",n.query=s[7],n.fragment=s[8],isNaN(n.port)&&(n.port=s[5]),n.host)if(Dw(n.host)===!1){let c=Aw(n.host);n.host=c.host.toLowerCase(),o=c.isIPV6}else o=!0;n.scheme===void 0&&n.userinfo===void 0&&n.host===void 0&&n.port===void 0&&n.query===void 0&&!n.path?n.reference="same-document":n.scheme===void 0?n.reference="relative":n.fragment===void 0?n.reference="absolute":n.reference="uri",r.reference&&r.reference!=="suffix"&&r.reference!==n.reference&&(n.error=n.error||"URI is not a "+r.reference+" reference.");let i=oh(r.scheme||n.scheme);if(!r.unicodeSupport&&(!i||!i.unicodeSupport)&&n.host&&(r.domainHost||i&&i.domainHost)&&o===!1&&Lw(n.host))try{n.host=URL.domainToASCII(n.host.toLowerCase())}catch(a){n.error=n.error||"Host's domain name can not be converted to ASCII: "+a}(!i||i&&!i.skipNormalize)&&(t.indexOf("%")!==-1&&(n.scheme!==void 0&&(n.scheme=unescape(n.scheme)),n.host!==void 0&&(n.host=unescape(n.host))),n.path&&(n.path=escape(unescape(n.path))),n.fragment&&(n.fragment=encodeURI(decodeURIComponent(n.fragment)))),i&&i.parse&&i.parse(n,r)}else n.error=n.error||"URI can not be parsed.";return n}var Fu={SCHEMES:qw,normalize:Uw,resolve:Fw,resolveComponent:sh,equal:Vw,serialize:_t,parse:It};As.exports=Fu;As.exports.default=Fu;As.exports.fastUri=Fu});var ch=S(Vu=>{"use strict";Object.defineProperty(Vu,"__esModule",{value:!0});var ah=ih();ah.code='require("ajv/dist/runtime/uri").default';Vu.default=ah});var gh=S(we=>{"use strict";Object.defineProperty(we,"__esModule",{value:!0});we.CodeGen=we.Name=we.nil=we.stringify=we.str=we._=we.KeywordCxt=void 0;var Bw=Qn();Object.defineProperty(we,"KeywordCxt",{enumerable:!0,get:function(){return Bw.KeywordCxt}});var tn=U();Object.defineProperty(we,"_",{enumerable:!0,get:function(){return tn._}});Object.defineProperty(we,"str",{enumerable:!0,get:function(){return tn.str}});Object.defineProperty(we,"stringify",{enumerable:!0,get:function(){return tn.stringify}});Object.defineProperty(we,"nil",{enumerable:!0,get:function(){return tn.nil}});Object.defineProperty(we,"Name",{enumerable:!0,get:function(){return tn.Name}});Object.defineProperty(we,"CodeGen",{enumerable:!0,get:function(){return tn.CodeGen}});var Kw=Is(),fh=eo(),Gw=vu(),ro=Ns(),Jw=U(),no=Wn(),Ms=Jn(),Bu=W(),uh=Gm(),Ww=ch(),mh=(t,e)=>new RegExp(t,e);mh.code="new RegExp";var Xw=["removeAdditional","useDefaults","coerceTypes"],Yw=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),Qw={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},ek={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},lh=200;function tk(t){var e,r,n,o,s,i,a,c,u,l,d,m,f,p,h,g,v,x,w,E,C,Pe,Be,Rr,pi;let pn=t.strict,fi=(e=t.code)===null||e===void 0?void 0:e.optimize,Yl=fi===!0||fi===void 0?1:fi||0,Ql=(n=(r=t.code)===null||r===void 0?void 0:r.regExp)!==null&&n!==void 0?n:mh,e_=(o=t.uriResolver)!==null&&o!==void 0?o:Ww.default;return{strictSchema:(i=(s=t.strictSchema)!==null&&s!==void 0?s:pn)!==null&&i!==void 0?i:!0,strictNumbers:(c=(a=t.strictNumbers)!==null&&a!==void 0?a:pn)!==null&&c!==void 0?c:!0,strictTypes:(l=(u=t.strictTypes)!==null&&u!==void 0?u:pn)!==null&&l!==void 0?l:"log",strictTuples:(m=(d=t.strictTuples)!==null&&d!==void 0?d:pn)!==null&&m!==void 0?m:"log",strictRequired:(p=(f=t.strictRequired)!==null&&f!==void 0?f:pn)!==null&&p!==void 0?p:!1,code:t.code?{...t.code,optimize:Yl,regExp:Ql}:{optimize:Yl,regExp:Ql},loopRequired:(h=t.loopRequired)!==null&&h!==void 0?h:lh,loopEnum:(g=t.loopEnum)!==null&&g!==void 0?g:lh,meta:(v=t.meta)!==null&&v!==void 0?v:!0,messages:(x=t.messages)!==null&&x!==void 0?x:!0,inlineRefs:(w=t.inlineRefs)!==null&&w!==void 0?w:!0,schemaId:(E=t.schemaId)!==null&&E!==void 0?E:"$id",addUsedSchema:(C=t.addUsedSchema)!==null&&C!==void 0?C:!0,validateSchema:(Pe=t.validateSchema)!==null&&Pe!==void 0?Pe:!0,validateFormats:(Be=t.validateFormats)!==null&&Be!==void 0?Be:!0,unicodeRegExp:(Rr=t.unicodeRegExp)!==null&&Rr!==void 0?Rr:!0,int32range:(pi=t.int32range)!==null&&pi!==void 0?pi:!0,uriResolver:e_}}var oo=class{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...tk(e)};let{es5:r,lines:n}=this.opts.code;this.scope=new Jw.ValueScope({scope:{},prefixes:Yw,es5:r,lines:n}),this.logger=ak(e.logger);let o=e.validateFormats;e.validateFormats=!1,this.RULES=(0,Gw.getRules)(),dh.call(this,Qw,e,"NOT SUPPORTED"),dh.call(this,ek,e,"DEPRECATED","warn"),this._metaOpts=sk.call(this),e.formats&&nk.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&ok.call(this,e.keywords),typeof e.meta=="object"&&this.addMetaSchema(e.meta),rk.call(this),e.validateFormats=o}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:e,meta:r,schemaId:n}=this.opts,o=uh;n==="id"&&(o={...uh},o.id=o.$id,delete o.$id),r&&e&&this.addMetaSchema(o,o[n],!1)}defaultMeta(){let{meta:e,schemaId:r}=this.opts;return this.opts.defaultMeta=typeof e=="object"?e[r]||e:void 0}validate(e,r){let n;if(typeof e=="string"){if(n=this.getSchema(e),!n)throw new Error(`no schema with key or ref "${e}"`)}else n=this.compile(e);let o=n(r);return"$async"in n||(this.errors=n.errors),o}compile(e,r){let n=this._addSchema(e,r);return n.validate||this._compileSchemaEnv(n)}compileAsync(e,r){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");let{loadSchema:n}=this.opts;return o.call(this,e,r);async function o(l,d){await s.call(this,l.$schema);let m=this._addSchema(l,d);return m.validate||i.call(this,m)}async function s(l){l&&!this.getSchema(l)&&await o.call(this,{$ref:l},!0)}async function i(l){try{return this._compileSchemaEnv(l)}catch(d){if(!(d instanceof fh.default))throw d;return a.call(this,d),await c.call(this,d.missingSchema),i.call(this,l)}}function a({missingSchema:l,missingRef:d}){if(this.refs[l])throw new Error(`AnySchema ${l} is loaded but ${d} cannot be resolved`)}async function c(l){let d=await u.call(this,l);this.refs[l]||await s.call(this,d.$schema),this.refs[l]||this.addSchema(d,l,r)}async function u(l){let d=this._loading[l];if(d)return d;try{return await(this._loading[l]=n(l))}finally{delete this._loading[l]}}}addSchema(e,r,n,o=this.opts.validateSchema){if(Array.isArray(e)){for(let i of e)this.addSchema(i,void 0,n,o);return this}let s;if(typeof e=="object"){let{schemaId:i}=this.opts;if(s=e[i],s!==void 0&&typeof s!="string")throw new Error(`schema ${i} must be string`)}return r=(0,no.normalizeId)(r||s),this._checkUnique(r),this.schemas[r]=this._addSchema(e,n,r,o,!0),this}addMetaSchema(e,r,n=this.opts.validateSchema){return this.addSchema(e,r,!0,n),this}validateSchema(e,r){if(typeof e=="boolean")return!0;let n;if(n=e.$schema,n!==void 0&&typeof n!="string")throw new Error("$schema must be a string");if(n=n||this.opts.defaultMeta||this.defaultMeta(),!n)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let o=this.validate(n,e);if(!o&&r){let s="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(s);else throw new Error(s)}return o}getSchema(e){let r;for(;typeof(r=ph.call(this,e))=="string";)e=r;if(r===void 0){let{schemaId:n}=this.opts,o=new ro.SchemaEnv({schema:{},schemaId:n});if(r=ro.resolveSchema.call(this,o,e),!r)return;this.refs[e]=r}return r.validate||this._compileSchemaEnv(r)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let r=ph.call(this,e);return typeof r=="object"&&this._cache.delete(r.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{let r=e;this._cache.delete(r);let n=e[this.opts.schemaId];return n&&(n=(0,no.normalizeId)(n),delete this.schemas[n],delete this.refs[n]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(let r of e)this.addKeyword(r);return this}addKeyword(e,r){let n;if(typeof e=="string")n=e,typeof r=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),r.keyword=n);else if(typeof e=="object"&&r===void 0){if(r=e,n=r.keyword,Array.isArray(n)&&!n.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(uk.call(this,n,r),!r)return(0,Bu.eachItem)(n,s=>Hu.call(this,s)),this;dk.call(this,r);let o={...r,type:(0,Ms.getJSONTypes)(r.type),schemaType:(0,Ms.getJSONTypes)(r.schemaType)};return(0,Bu.eachItem)(n,o.type.length===0?s=>Hu.call(this,s,o):s=>o.type.forEach(i=>Hu.call(this,s,o,i))),this}getKeyword(e){let r=this.RULES.all[e];return typeof r=="object"?r.definition:!!r}removeKeyword(e){let{RULES:r}=this;delete r.keywords[e],delete r.all[e];for(let n of r.rules){let o=n.rules.findIndex(s=>s.keyword===e);o>=0&&n.rules.splice(o,1)}return this}addFormat(e,r){return typeof r=="string"&&(r=new RegExp(r)),this.formats[e]=r,this}errorsText(e=this.errors,{separator:r=", ",dataVar:n="data"}={}){return!e||e.length===0?"No errors":e.map(o=>`${n}${o.instancePath} ${o.message}`).reduce((o,s)=>o+r+s)}$dataMetaSchema(e,r){let n=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(let o of r){let s=o.split("/").slice(1),i=e;for(let a of s)i=i[a];for(let a in n){let c=n[a];if(typeof c!="object")continue;let{$data:u}=c.definition,l=i[a];u&&l&&(i[a]=hh(l))}}return e}_removeAllSchemas(e,r){for(let n in e){let o=e[n];(!r||r.test(n))&&(typeof o=="string"?delete e[n]:o&&!o.meta&&(this._cache.delete(o.schema),delete e[n]))}}_addSchema(e,r,n,o=this.opts.validateSchema,s=this.opts.addUsedSchema){let i,{schemaId:a}=this.opts;if(typeof e=="object")i=e[a];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof e!="boolean")throw new Error("schema must be object or boolean")}let c=this._cache.get(e);if(c!==void 0)return c;n=(0,no.normalizeId)(i||n);let u=no.getSchemaRefs.call(this,e,n);return c=new ro.SchemaEnv({schema:e,schemaId:a,meta:r,baseId:n,localRefs:u}),this._cache.set(c.schema,c),s&&!n.startsWith("#")&&(n&&this._checkUnique(n),this.refs[n]=c),o&&this.validateSchema(e,!0),c}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):ro.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){let r=this.opts;this.opts=this._metaOpts;try{ro.compileSchema.call(this,e)}finally{this.opts=r}}};oo.ValidationError=Kw.default;oo.MissingRefError=fh.default;we.default=oo;function dh(t,e,r,n="error"){for(let o in t){let s=o;s in e&&this.logger[n](`${r}: option ${o}. ${t[s]}`)}}function ph(t){return t=(0,no.normalizeId)(t),this.schemas[t]||this.refs[t]}function rk(){let t=this.opts.schemas;if(t)if(Array.isArray(t))this.addSchema(t);else for(let e in t)this.addSchema(t[e],e)}function nk(){for(let t in this.opts.formats){let e=this.opts.formats[t];e&&this.addFormat(t,e)}}function ok(t){if(Array.isArray(t)){this.addVocabulary(t);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let e in t){let r=t[e];r.keyword||(r.keyword=e),this.addKeyword(r)}}function sk(){let t={...this.opts};for(let e of Xw)delete t[e];return t}var ik={log(){},warn(){},error(){}};function ak(t){if(t===!1)return ik;if(t===void 0)return console;if(t.log&&t.warn&&t.error)return t;throw new Error("logger must implement log, warn and error methods")}var ck=/^[a-z_$][a-z0-9_$:-]*$/i;function uk(t,e){let{RULES:r}=this;if((0,Bu.eachItem)(t,n=>{if(r.keywords[n])throw new Error(`Keyword ${n} is already defined`);if(!ck.test(n))throw new Error(`Keyword ${n} has invalid name`)}),!!e&&e.$data&&!("code"in e||"validate"in e))throw new Error('$data keyword must have "code" or "validate" function')}function Hu(t,e,r){var n;let o=e?.post;if(r&&o)throw new Error('keyword with "post" flag cannot have "type"');let{RULES:s}=this,i=o?s.post:s.rules.find(({type:c})=>c===r);if(i||(i={type:r,rules:[]},s.rules.push(i)),s.keywords[t]=!0,!e)return;let a={keyword:t,definition:{...e,type:(0,Ms.getJSONTypes)(e.type),schemaType:(0,Ms.getJSONTypes)(e.schemaType)}};e.before?lk.call(this,i,a,e.before):i.rules.push(a),s.all[t]=a,(n=e.implements)===null||n===void 0||n.forEach(c=>this.addKeyword(c))}function lk(t,e,r){let n=t.rules.findIndex(o=>o.keyword===r);n>=0?t.rules.splice(n,0,e):(t.rules.push(e),this.logger.warn(`rule ${r} is not defined`))}function dk(t){let{metaSchema:e}=t;e!==void 0&&(t.$data&&this.opts.$data&&(e=hh(e)),t.validateSchema=this.compile(e,!0))}var pk={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function hh(t){return{anyOf:[t,pk]}}});var _h=S(Ku=>{"use strict";Object.defineProperty(Ku,"__esModule",{value:!0});var fk={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};Ku.default=fk});var xh=S(Tr=>{"use strict";Object.defineProperty(Tr,"__esModule",{value:!0});Tr.callRef=Tr.getValidate=void 0;var mk=eo(),yh=Qe(),qe=U(),rn=Pt(),vh=Ns(),Ds=W(),hk={keyword:"$ref",schemaType:"string",code(t){let{gen:e,schema:r,it:n}=t,{baseId:o,schemaEnv:s,validateName:i,opts:a,self:c}=n,{root:u}=s;if((r==="#"||r==="#/")&&o===u.baseId)return d();let l=vh.resolveRef.call(c,u,o,r);if(l===void 0)throw new mk.default(n.opts.uriResolver,o,r);if(l instanceof vh.SchemaEnv)return m(l);return f(l);function d(){if(s===u)return Ls(t,i,s,s.$async);let p=e.scopeValue("root",{ref:u});return Ls(t,(0,qe._)`${p}.validate`,u,u.$async)}function m(p){let h=bh(t,p);Ls(t,h,p,p.$async)}function f(p){let h=e.scopeValue("schema",a.code.source===!0?{ref:p,code:(0,qe.stringify)(p)}:{ref:p}),g=e.name("valid"),v=t.subschema({schema:p,dataTypes:[],schemaPath:qe.nil,topSchemaRef:h,errSchemaPath:r},g);t.mergeEvaluated(v),t.ok(g)}}};function bh(t,e){let{gen:r}=t;return e.validate?r.scopeValue("validate",{ref:e.validate}):(0,qe._)`${r.scopeValue("wrapper",{ref:e})}.validate`}Tr.getValidate=bh;function Ls(t,e,r,n){let{gen:o,it:s}=t,{allErrors:i,schemaEnv:a,opts:c}=s,u=c.passContext?rn.default.this:qe.nil;n?l():d();function l(){if(!a.$async)throw new Error("async schema referenced by sync schema");let p=o.let("valid");o.try(()=>{o.code((0,qe._)`await ${(0,yh.callValidateCode)(t,e,u)}`),f(e),i||o.assign(p,!0)},h=>{o.if((0,qe._)`!(${h} instanceof ${s.ValidationError})`,()=>o.throw(h)),m(h),i||o.assign(p,!1)}),t.ok(p)}function d(){t.result((0,yh.callValidateCode)(t,e,u),()=>f(e),()=>m(e))}function m(p){let h=(0,qe._)`${p}.errors`;o.assign(rn.default.vErrors,(0,qe._)`${rn.default.vErrors} === null ? ${h} : ${rn.default.vErrors}.concat(${h})`),o.assign(rn.default.errors,(0,qe._)`${rn.default.vErrors}.length`)}function f(p){var h;if(!s.opts.unevaluated)return;let g=(h=r?.validate)===null||h===void 0?void 0:h.evaluated;if(s.props!==!0)if(g&&!g.dynamicProps)g.props!==void 0&&(s.props=Ds.mergeEvaluated.props(o,g.props,s.props));else{let v=o.var("props",(0,qe._)`${p}.evaluated.props`);s.props=Ds.mergeEvaluated.props(o,v,s.props,qe.Name)}if(s.items!==!0)if(g&&!g.dynamicItems)g.items!==void 0&&(s.items=Ds.mergeEvaluated.items(o,g.items,s.items));else{let v=o.var("items",(0,qe._)`${p}.evaluated.items`);s.items=Ds.mergeEvaluated.items(o,v,s.items,qe.Name)}}}Tr.callRef=Ls;Tr.default=hk});var $h=S(Gu=>{"use strict";Object.defineProperty(Gu,"__esModule",{value:!0});var gk=_h(),_k=xh(),yk=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",gk.default,_k.default];Gu.default=yk});var wh=S(Ju=>{"use strict";Object.defineProperty(Ju,"__esModule",{value:!0});var qs=U(),Gt=qs.operators,Us={maximum:{okStr:"<=",ok:Gt.LTE,fail:Gt.GT},minimum:{okStr:">=",ok:Gt.GTE,fail:Gt.LT},exclusiveMaximum:{okStr:"<",ok:Gt.LT,fail:Gt.GTE},exclusiveMinimum:{okStr:">",ok:Gt.GT,fail:Gt.LTE}},vk={message:({keyword:t,schemaCode:e})=>(0,qs.str)`must be ${Us[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,qs._)`{comparison: ${Us[t].okStr}, limit: ${e}}`},bk={keyword:Object.keys(Us),type:"number",schemaType:"number",$data:!0,error:vk,code(t){let{keyword:e,data:r,schemaCode:n}=t;t.fail$data((0,qs._)`${r} ${Us[e].fail} ${n} || isNaN(${r})`)}};Ju.default=bk});var kh=S(Wu=>{"use strict";Object.defineProperty(Wu,"__esModule",{value:!0});var so=U(),xk={message:({schemaCode:t})=>(0,so.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,so._)`{multipleOf: ${t}}`},$k={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:xk,code(t){let{gen:e,data:r,schemaCode:n,it:o}=t,s=o.opts.multipleOfPrecision,i=e.let("res"),a=s?(0,so._)`Math.abs(Math.round(${i}) - ${i}) > 1e-${s}`:(0,so._)`${i} !== parseInt(${i})`;t.fail$data((0,so._)`(${n} === 0 || (${i} = ${r}/${n}, ${a}))`)}};Wu.default=$k});var zh=S(Xu=>{"use strict";Object.defineProperty(Xu,"__esModule",{value:!0});function Sh(t){let e=t.length,r=0,n=0,o;for(;n<e;)r++,o=t.charCodeAt(n++),o>=55296&&o<=56319&&n<e&&(o=t.charCodeAt(n),(o&64512)===56320&&n++);return r}Xu.default=Sh;Sh.code='require("ajv/dist/runtime/ucs2length").default'});var Th=S(Yu=>{"use strict";Object.defineProperty(Yu,"__esModule",{value:!0});var Er=U(),wk=W(),kk=zh(),Sk={message({keyword:t,schemaCode:e}){let r=t==="maxLength"?"more":"fewer";return(0,Er.str)`must NOT have ${r} than ${e} characters`},params:({schemaCode:t})=>(0,Er._)`{limit: ${t}}`},zk={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:Sk,code(t){let{keyword:e,data:r,schemaCode:n,it:o}=t,s=e==="maxLength"?Er.operators.GT:Er.operators.LT,i=o.opts.unicode===!1?(0,Er._)`${r}.length`:(0,Er._)`${(0,wk.useFunc)(t.gen,kk.default)}(${r})`;t.fail$data((0,Er._)`${i} ${s} ${n}`)}};Yu.default=zk});var Eh=S(Qu=>{"use strict";Object.defineProperty(Qu,"__esModule",{value:!0});var Tk=Qe(),Ek=W(),nn=U(),Pk={message:({schemaCode:t})=>(0,nn.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,nn._)`{pattern: ${t}}`},Rk={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:Pk,code(t){let{gen:e,data:r,$data:n,schema:o,schemaCode:s,it:i}=t,a=i.opts.unicodeRegExp?"u":"";if(n){let{regExp:c}=i.opts.code,u=c.code==="new RegExp"?(0,nn._)`new RegExp`:(0,Ek.useFunc)(e,c),l=e.let("valid");e.try(()=>e.assign(l,(0,nn._)`${u}(${s}, ${a}).test(${r})`),()=>e.assign(l,!1)),t.fail$data((0,nn._)`!${l}`)}else{let c=(0,Tk.usePattern)(t,o);t.fail$data((0,nn._)`!${c}.test(${r})`)}}};Qu.default=Rk});var Ph=S(el=>{"use strict";Object.defineProperty(el,"__esModule",{value:!0});var io=U(),Ik={message({keyword:t,schemaCode:e}){let r=t==="maxProperties"?"more":"fewer";return(0,io.str)`must NOT have ${r} than ${e} properties`},params:({schemaCode:t})=>(0,io._)`{limit: ${t}}`},Ok={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:Ik,code(t){let{keyword:e,data:r,schemaCode:n}=t,o=e==="maxProperties"?io.operators.GT:io.operators.LT;t.fail$data((0,io._)`Object.keys(${r}).length ${o} ${n}`)}};el.default=Ok});var Rh=S(tl=>{"use strict";Object.defineProperty(tl,"__esModule",{value:!0});var ao=Qe(),co=U(),Nk=W(),Ck={message:({params:{missingProperty:t}})=>(0,co.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,co._)`{missingProperty: ${t}}`},Zk={keyword:"required",type:"object",schemaType:"array",$data:!0,error:Ck,code(t){let{gen:e,schema:r,schemaCode:n,data:o,$data:s,it:i}=t,{opts:a}=i;if(!s&&r.length===0)return;let c=r.length>=a.loopRequired;if(i.allErrors?u():l(),a.strictRequired){let f=t.parentSchema.properties,{definedProperties:p}=t.it;for(let h of r)if(f?.[h]===void 0&&!p.has(h)){let g=i.schemaEnv.baseId+i.errSchemaPath,v=`required property "${h}" is not defined at "${g}" (strictRequired)`;(0,Nk.checkStrictMode)(i,v,i.opts.strictRequired)}}function u(){if(c||s)t.block$data(co.nil,d);else for(let f of r)(0,ao.checkReportMissingProp)(t,f)}function l(){let f=e.let("missing");if(c||s){let p=e.let("valid",!0);t.block$data(p,()=>m(f,p)),t.ok(p)}else e.if((0,ao.checkMissingProp)(t,r,f)),(0,ao.reportMissingProp)(t,f),e.else()}function d(){e.forOf("prop",n,f=>{t.setParams({missingProperty:f}),e.if((0,ao.noPropertyInData)(e,o,f,a.ownProperties),()=>t.error())})}function m(f,p){t.setParams({missingProperty:f}),e.forOf(f,n,()=>{e.assign(p,(0,ao.propertyInData)(e,o,f,a.ownProperties)),e.if((0,co.not)(p),()=>{t.error(),e.break()})},co.nil)}}};tl.default=Zk});var Ih=S(rl=>{"use strict";Object.defineProperty(rl,"__esModule",{value:!0});var uo=U(),jk={message({keyword:t,schemaCode:e}){let r=t==="maxItems"?"more":"fewer";return(0,uo.str)`must NOT have ${r} than ${e} items`},params:({schemaCode:t})=>(0,uo._)`{limit: ${t}}`},Ak={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:jk,code(t){let{keyword:e,data:r,schemaCode:n}=t,o=e==="maxItems"?uo.operators.GT:uo.operators.LT;t.fail$data((0,uo._)`${r}.length ${o} ${n}`)}};rl.default=Ak});var Fs=S(nl=>{"use strict";Object.defineProperty(nl,"__esModule",{value:!0});var Oh=Tu();Oh.code='require("ajv/dist/runtime/equal").default';nl.default=Oh});var Nh=S(sl=>{"use strict";Object.defineProperty(sl,"__esModule",{value:!0});var ol=Jn(),ke=U(),Mk=W(),Dk=Fs(),Lk={message:({params:{i:t,j:e}})=>(0,ke.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,ke._)`{i: ${t}, j: ${e}}`},qk={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:Lk,code(t){let{gen:e,data:r,$data:n,schema:o,parentSchema:s,schemaCode:i,it:a}=t;if(!n&&!o)return;let c=e.let("valid"),u=s.items?(0,ol.getSchemaTypes)(s.items):[];t.block$data(c,l,(0,ke._)`${i} === false`),t.ok(c);function l(){let p=e.let("i",(0,ke._)`${r}.length`),h=e.let("j");t.setParams({i:p,j:h}),e.assign(c,!0),e.if((0,ke._)`${p} > 1`,()=>(d()?m:f)(p,h))}function d(){return u.length>0&&!u.some(p=>p==="object"||p==="array")}function m(p,h){let g=e.name("item"),v=(0,ol.checkDataTypes)(u,g,a.opts.strictNumbers,ol.DataType.Wrong),x=e.const("indices",(0,ke._)`{}`);e.for((0,ke._)`;${p}--;`,()=>{e.let(g,(0,ke._)`${r}[${p}]`),e.if(v,(0,ke._)`continue`),u.length>1&&e.if((0,ke._)`typeof ${g} == "string"`,(0,ke._)`${g} += "_"`),e.if((0,ke._)`typeof ${x}[${g}] == "number"`,()=>{e.assign(h,(0,ke._)`${x}[${g}]`),t.error(),e.assign(c,!1).break()}).code((0,ke._)`${x}[${g}] = ${p}`)})}function f(p,h){let g=(0,Mk.useFunc)(e,Dk.default),v=e.name("outer");e.label(v).for((0,ke._)`;${p}--;`,()=>e.for((0,ke._)`${h} = ${p}; ${h}--;`,()=>e.if((0,ke._)`${g}(${r}[${p}], ${r}[${h}])`,()=>{t.error(),e.assign(c,!1).break(v)})))}}};sl.default=qk});var Ch=S(al=>{"use strict";Object.defineProperty(al,"__esModule",{value:!0});var il=U(),Uk=W(),Fk=Fs(),Vk={message:"must be equal to constant",params:({schemaCode:t})=>(0,il._)`{allowedValue: ${t}}`},Hk={keyword:"const",$data:!0,error:Vk,code(t){let{gen:e,data:r,$data:n,schemaCode:o,schema:s}=t;n||s&&typeof s=="object"?t.fail$data((0,il._)`!${(0,Uk.useFunc)(e,Fk.default)}(${r}, ${o})`):t.fail((0,il._)`${s} !== ${r}`)}};al.default=Hk});var Zh=S(cl=>{"use strict";Object.defineProperty(cl,"__esModule",{value:!0});var lo=U(),Bk=W(),Kk=Fs(),Gk={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,lo._)`{allowedValues: ${t}}`},Jk={keyword:"enum",schemaType:"array",$data:!0,error:Gk,code(t){let{gen:e,data:r,$data:n,schema:o,schemaCode:s,it:i}=t;if(!n&&o.length===0)throw new Error("enum must have non-empty array");let a=o.length>=i.opts.loopEnum,c,u=()=>c??(c=(0,Bk.useFunc)(e,Kk.default)),l;if(a||n)l=e.let("valid"),t.block$data(l,d);else{if(!Array.isArray(o))throw new Error("ajv implementation error");let f=e.const("vSchema",s);l=(0,lo.or)(...o.map((p,h)=>m(f,h)))}t.pass(l);function d(){e.assign(l,!1),e.forOf("v",s,f=>e.if((0,lo._)`${u()}(${r}, ${f})`,()=>e.assign(l,!0).break()))}function m(f,p){let h=o[p];return typeof h=="object"&&h!==null?(0,lo._)`${u()}(${r}, ${f}[${p}])`:(0,lo._)`${r} === ${h}`}}};cl.default=Jk});var jh=S(ul=>{"use strict";Object.defineProperty(ul,"__esModule",{value:!0});var Wk=wh(),Xk=kh(),Yk=Th(),Qk=Eh(),eS=Ph(),tS=Rh(),rS=Ih(),nS=Nh(),oS=Ch(),sS=Zh(),iS=[Wk.default,Xk.default,Yk.default,Qk.default,eS.default,tS.default,rS.default,nS.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},oS.default,sS.default];ul.default=iS});var dl=S(po=>{"use strict";Object.defineProperty(po,"__esModule",{value:!0});po.validateAdditionalItems=void 0;var Pr=U(),ll=W(),aS={message:({params:{len:t}})=>(0,Pr.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,Pr._)`{limit: ${t}}`},cS={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:aS,code(t){let{parentSchema:e,it:r}=t,{items:n}=e;if(!Array.isArray(n)){(0,ll.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}Ah(t,n)}};function Ah(t,e){let{gen:r,schema:n,data:o,keyword:s,it:i}=t;i.items=!0;let a=r.const("len",(0,Pr._)`${o}.length`);if(n===!1)t.setParams({len:e.length}),t.pass((0,Pr._)`${a} <= ${e.length}`);else if(typeof n=="object"&&!(0,ll.alwaysValidSchema)(i,n)){let u=r.var("valid",(0,Pr._)`${a} <= ${e.length}`);r.if((0,Pr.not)(u),()=>c(u)),t.ok(u)}function c(u){r.forRange("i",e.length,a,l=>{t.subschema({keyword:s,dataProp:l,dataPropType:ll.Type.Num},u),i.allErrors||r.if((0,Pr.not)(u),()=>r.break())})}}po.validateAdditionalItems=Ah;po.default=cS});var pl=S(fo=>{"use strict";Object.defineProperty(fo,"__esModule",{value:!0});fo.validateTuple=void 0;var Mh=U(),Vs=W(),uS=Qe(),lS={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){let{schema:e,it:r}=t;if(Array.isArray(e))return Dh(t,"additionalItems",e);r.items=!0,!(0,Vs.alwaysValidSchema)(r,e)&&t.ok((0,uS.validateArray)(t))}};function Dh(t,e,r=t.schema){let{gen:n,parentSchema:o,data:s,keyword:i,it:a}=t;l(o),a.opts.unevaluated&&r.length&&a.items!==!0&&(a.items=Vs.mergeEvaluated.items(n,r.length,a.items));let c=n.name("valid"),u=n.const("len",(0,Mh._)`${s}.length`);r.forEach((d,m)=>{(0,Vs.alwaysValidSchema)(a,d)||(n.if((0,Mh._)`${u} > ${m}`,()=>t.subschema({keyword:i,schemaProp:m,dataProp:m},c)),t.ok(c))});function l(d){let{opts:m,errSchemaPath:f}=a,p=r.length,h=p===d.minItems&&(p===d.maxItems||d[e]===!1);if(m.strictTuples&&!h){let g=`"${i}" is ${p}-tuple, but minItems or maxItems/${e} are not specified or different at path "${f}"`;(0,Vs.checkStrictMode)(a,g,m.strictTuples)}}}fo.validateTuple=Dh;fo.default=lS});var Lh=S(fl=>{"use strict";Object.defineProperty(fl,"__esModule",{value:!0});var dS=pl(),pS={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,dS.validateTuple)(t,"items")};fl.default=pS});var Uh=S(ml=>{"use strict";Object.defineProperty(ml,"__esModule",{value:!0});var qh=U(),fS=W(),mS=Qe(),hS=dl(),gS={message:({params:{len:t}})=>(0,qh.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,qh._)`{limit: ${t}}`},_S={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:gS,code(t){let{schema:e,parentSchema:r,it:n}=t,{prefixItems:o}=r;n.items=!0,!(0,fS.alwaysValidSchema)(n,e)&&(o?(0,hS.validateAdditionalItems)(t,o):t.ok((0,mS.validateArray)(t)))}};ml.default=_S});var Fh=S(hl=>{"use strict";Object.defineProperty(hl,"__esModule",{value:!0});var tt=U(),Hs=W(),yS={message:({params:{min:t,max:e}})=>e===void 0?(0,tt.str)`must contain at least ${t} valid item(s)`:(0,tt.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,tt._)`{minContains: ${t}}`:(0,tt._)`{minContains: ${t}, maxContains: ${e}}`},vS={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:yS,code(t){let{gen:e,schema:r,parentSchema:n,data:o,it:s}=t,i,a,{minContains:c,maxContains:u}=n;s.opts.next?(i=c===void 0?1:c,a=u):i=1;let l=e.const("len",(0,tt._)`${o}.length`);if(t.setParams({min:i,max:a}),a===void 0&&i===0){(0,Hs.checkStrictMode)(s,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&i>a){(0,Hs.checkStrictMode)(s,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,Hs.alwaysValidSchema)(s,r)){let h=(0,tt._)`${l} >= ${i}`;a!==void 0&&(h=(0,tt._)`${h} && ${l} <= ${a}`),t.pass(h);return}s.items=!0;let d=e.name("valid");a===void 0&&i===1?f(d,()=>e.if(d,()=>e.break())):i===0?(e.let(d,!0),a!==void 0&&e.if((0,tt._)`${o}.length > 0`,m)):(e.let(d,!1),m()),t.result(d,()=>t.reset());function m(){let h=e.name("_valid"),g=e.let("count",0);f(h,()=>e.if(h,()=>p(g)))}function f(h,g){e.forRange("i",0,l,v=>{t.subschema({keyword:"contains",dataProp:v,dataPropType:Hs.Type.Num,compositeRule:!0},h),g()})}function p(h){e.code((0,tt._)`${h}++`),a===void 0?e.if((0,tt._)`${h} >= ${i}`,()=>e.assign(d,!0).break()):(e.if((0,tt._)`${h} > ${a}`,()=>e.assign(d,!1).break()),i===1?e.assign(d,!0):e.if((0,tt._)`${h} >= ${i}`,()=>e.assign(d,!0)))}}};hl.default=vS});var Bh=S(yt=>{"use strict";Object.defineProperty(yt,"__esModule",{value:!0});yt.validateSchemaDeps=yt.validatePropertyDeps=yt.error=void 0;var gl=U(),bS=W(),mo=Qe();yt.error={message:({params:{property:t,depsCount:e,deps:r}})=>{let n=e===1?"property":"properties";return(0,gl.str)`must have ${n} ${r} when property ${t} is present`},params:({params:{property:t,depsCount:e,deps:r,missingProperty:n}})=>(0,gl._)`{property: ${t},
    missingProperty: ${n},
    depsCount: ${e},
    deps: ${r}}`};var xS={keyword:"dependencies",type:"object",schemaType:"object",error:yt.error,code(t){let[e,r]=$S(t);Vh(t,e),Hh(t,r)}};function $S({schema:t}){let e={},r={};for(let n in t){if(n==="__proto__")continue;let o=Array.isArray(t[n])?e:r;o[n]=t[n]}return[e,r]}function Vh(t,e=t.schema){let{gen:r,data:n,it:o}=t;if(Object.keys(e).length===0)return;let s=r.let("missing");for(let i in e){let a=e[i];if(a.length===0)continue;let c=(0,mo.propertyInData)(r,n,i,o.opts.ownProperties);t.setParams({property:i,depsCount:a.length,deps:a.join(", ")}),o.allErrors?r.if(c,()=>{for(let u of a)(0,mo.checkReportMissingProp)(t,u)}):(r.if((0,gl._)`${c} && (${(0,mo.checkMissingProp)(t,a,s)})`),(0,mo.reportMissingProp)(t,s),r.else())}}yt.validatePropertyDeps=Vh;function Hh(t,e=t.schema){let{gen:r,data:n,keyword:o,it:s}=t,i=r.name("valid");for(let a in e)(0,bS.alwaysValidSchema)(s,e[a])||(r.if((0,mo.propertyInData)(r,n,a,s.opts.ownProperties),()=>{let c=t.subschema({keyword:o,schemaProp:a},i);t.mergeValidEvaluated(c,i)},()=>r.var(i,!0)),t.ok(i))}yt.validateSchemaDeps=Hh;yt.default=xS});var Gh=S(_l=>{"use strict";Object.defineProperty(_l,"__esModule",{value:!0});var Kh=U(),wS=W(),kS={message:"property name must be valid",params:({params:t})=>(0,Kh._)`{propertyName: ${t.propertyName}}`},SS={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:kS,code(t){let{gen:e,schema:r,data:n,it:o}=t;if((0,wS.alwaysValidSchema)(o,r))return;let s=e.name("valid");e.forIn("key",n,i=>{t.setParams({propertyName:i}),t.subschema({keyword:"propertyNames",data:i,dataTypes:["string"],propertyName:i,compositeRule:!0},s),e.if((0,Kh.not)(s),()=>{t.error(!0),o.allErrors||e.break()})}),t.ok(s)}};_l.default=SS});var vl=S(yl=>{"use strict";Object.defineProperty(yl,"__esModule",{value:!0});var Bs=Qe(),ut=U(),zS=Pt(),Ks=W(),TS={message:"must NOT have additional properties",params:({params:t})=>(0,ut._)`{additionalProperty: ${t.additionalProperty}}`},ES={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:TS,code(t){let{gen:e,schema:r,parentSchema:n,data:o,errsCount:s,it:i}=t;if(!s)throw new Error("ajv implementation error");let{allErrors:a,opts:c}=i;if(i.props=!0,c.removeAdditional!=="all"&&(0,Ks.alwaysValidSchema)(i,r))return;let u=(0,Bs.allSchemaProperties)(n.properties),l=(0,Bs.allSchemaProperties)(n.patternProperties);d(),t.ok((0,ut._)`${s} === ${zS.default.errors}`);function d(){e.forIn("key",o,g=>{!u.length&&!l.length?p(g):e.if(m(g),()=>p(g))})}function m(g){let v;if(u.length>8){let x=(0,Ks.schemaRefOrVal)(i,n.properties,"properties");v=(0,Bs.isOwnProperty)(e,x,g)}else u.length?v=(0,ut.or)(...u.map(x=>(0,ut._)`${g} === ${x}`)):v=ut.nil;return l.length&&(v=(0,ut.or)(v,...l.map(x=>(0,ut._)`${(0,Bs.usePattern)(t,x)}.test(${g})`))),(0,ut.not)(v)}function f(g){e.code((0,ut._)`delete ${o}[${g}]`)}function p(g){if(c.removeAdditional==="all"||c.removeAdditional&&r===!1){f(g);return}if(r===!1){t.setParams({additionalProperty:g}),t.error(),a||e.break();return}if(typeof r=="object"&&!(0,Ks.alwaysValidSchema)(i,r)){let v=e.name("valid");c.removeAdditional==="failing"?(h(g,v,!1),e.if((0,ut.not)(v),()=>{t.reset(),f(g)})):(h(g,v),a||e.if((0,ut.not)(v),()=>e.break()))}}function h(g,v,x){let w={keyword:"additionalProperties",dataProp:g,dataPropType:Ks.Type.Str};x===!1&&Object.assign(w,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema(w,v)}}};yl.default=ES});var Xh=S(xl=>{"use strict";Object.defineProperty(xl,"__esModule",{value:!0});var PS=Qn(),Jh=Qe(),bl=W(),Wh=vl(),RS={keyword:"properties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,parentSchema:n,data:o,it:s}=t;s.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&Wh.default.code(new PS.KeywordCxt(s,Wh.default,"additionalProperties"));let i=(0,Jh.allSchemaProperties)(r);for(let d of i)s.definedProperties.add(d);s.opts.unevaluated&&i.length&&s.props!==!0&&(s.props=bl.mergeEvaluated.props(e,(0,bl.toHash)(i),s.props));let a=i.filter(d=>!(0,bl.alwaysValidSchema)(s,r[d]));if(a.length===0)return;let c=e.name("valid");for(let d of a)u(d)?l(d):(e.if((0,Jh.propertyInData)(e,o,d,s.opts.ownProperties)),l(d),s.allErrors||e.else().var(c,!0),e.endIf()),t.it.definedProperties.add(d),t.ok(c);function u(d){return s.opts.useDefaults&&!s.compositeRule&&r[d].default!==void 0}function l(d){t.subschema({keyword:"properties",schemaProp:d,dataProp:d},c)}}};xl.default=RS});var tg=S($l=>{"use strict";Object.defineProperty($l,"__esModule",{value:!0});var Yh=Qe(),Gs=U(),Qh=W(),eg=W(),IS={keyword:"patternProperties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,data:n,parentSchema:o,it:s}=t,{opts:i}=s,a=(0,Yh.allSchemaProperties)(r),c=a.filter(h=>(0,Qh.alwaysValidSchema)(s,r[h]));if(a.length===0||c.length===a.length&&(!s.opts.unevaluated||s.props===!0))return;let u=i.strictSchema&&!i.allowMatchingProperties&&o.properties,l=e.name("valid");s.props!==!0&&!(s.props instanceof Gs.Name)&&(s.props=(0,eg.evaluatedPropsToName)(e,s.props));let{props:d}=s;m();function m(){for(let h of a)u&&f(h),s.allErrors?p(h):(e.var(l,!0),p(h),e.if(l))}function f(h){for(let g in u)new RegExp(h).test(g)&&(0,Qh.checkStrictMode)(s,`property ${g} matches pattern ${h} (use allowMatchingProperties)`)}function p(h){e.forIn("key",n,g=>{e.if((0,Gs._)`${(0,Yh.usePattern)(t,h)}.test(${g})`,()=>{let v=c.includes(h);v||t.subschema({keyword:"patternProperties",schemaProp:h,dataProp:g,dataPropType:eg.Type.Str},l),s.opts.unevaluated&&d!==!0?e.assign((0,Gs._)`${d}[${g}]`,!0):!v&&!s.allErrors&&e.if((0,Gs.not)(l),()=>e.break())})})}}};$l.default=IS});var rg=S(wl=>{"use strict";Object.defineProperty(wl,"__esModule",{value:!0});var OS=W(),NS={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){let{gen:e,schema:r,it:n}=t;if((0,OS.alwaysValidSchema)(n,r)){t.fail();return}let o=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},o),t.failResult(o,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};wl.default=NS});var ng=S(kl=>{"use strict";Object.defineProperty(kl,"__esModule",{value:!0});var CS=Qe(),ZS={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:CS.validateUnion,error:{message:"must match a schema in anyOf"}};kl.default=ZS});var og=S(Sl=>{"use strict";Object.defineProperty(Sl,"__esModule",{value:!0});var Js=U(),jS=W(),AS={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,Js._)`{passingSchemas: ${t.passing}}`},MS={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:AS,code(t){let{gen:e,schema:r,parentSchema:n,it:o}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(o.opts.discriminator&&n.discriminator)return;let s=r,i=e.let("valid",!1),a=e.let("passing",null),c=e.name("_valid");t.setParams({passing:a}),e.block(u),t.result(i,()=>t.reset(),()=>t.error(!0));function u(){s.forEach((l,d)=>{let m;(0,jS.alwaysValidSchema)(o,l)?e.var(c,!0):m=t.subschema({keyword:"oneOf",schemaProp:d,compositeRule:!0},c),d>0&&e.if((0,Js._)`${c} && ${i}`).assign(i,!1).assign(a,(0,Js._)`[${a}, ${d}]`).else(),e.if(c,()=>{e.assign(i,!0),e.assign(a,d),m&&t.mergeEvaluated(m,Js.Name)})})}}};Sl.default=MS});var sg=S(zl=>{"use strict";Object.defineProperty(zl,"__esModule",{value:!0});var DS=W(),LS={keyword:"allOf",schemaType:"array",code(t){let{gen:e,schema:r,it:n}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");let o=e.name("valid");r.forEach((s,i)=>{if((0,DS.alwaysValidSchema)(n,s))return;let a=t.subschema({keyword:"allOf",schemaProp:i},o);t.ok(o),t.mergeEvaluated(a)})}};zl.default=LS});var cg=S(Tl=>{"use strict";Object.defineProperty(Tl,"__esModule",{value:!0});var Ws=U(),ag=W(),qS={message:({params:t})=>(0,Ws.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,Ws._)`{failingKeyword: ${t.ifClause}}`},US={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:qS,code(t){let{gen:e,parentSchema:r,it:n}=t;r.then===void 0&&r.else===void 0&&(0,ag.checkStrictMode)(n,'"if" without "then" and "else" is ignored');let o=ig(n,"then"),s=ig(n,"else");if(!o&&!s)return;let i=e.let("valid",!0),a=e.name("_valid");if(c(),t.reset(),o&&s){let l=e.let("ifClause");t.setParams({ifClause:l}),e.if(a,u("then",l),u("else",l))}else o?e.if(a,u("then")):e.if((0,Ws.not)(a),u("else"));t.pass(i,()=>t.error(!0));function c(){let l=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);t.mergeEvaluated(l)}function u(l,d){return()=>{let m=t.subschema({keyword:l},a);e.assign(i,a),t.mergeValidEvaluated(m,i),d?e.assign(d,(0,Ws._)`${l}`):t.setParams({ifClause:l})}}}};function ig(t,e){let r=t.schema[e];return r!==void 0&&!(0,ag.alwaysValidSchema)(t,r)}Tl.default=US});var ug=S(El=>{"use strict";Object.defineProperty(El,"__esModule",{value:!0});var FS=W(),VS={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:r}){e.if===void 0&&(0,FS.checkStrictMode)(r,`"${t}" without "if" is ignored`)}};El.default=VS});var lg=S(Pl=>{"use strict";Object.defineProperty(Pl,"__esModule",{value:!0});var HS=dl(),BS=Lh(),KS=pl(),GS=Uh(),JS=Fh(),WS=Bh(),XS=Gh(),YS=vl(),QS=Xh(),ez=tg(),tz=rg(),rz=ng(),nz=og(),oz=sg(),sz=cg(),iz=ug();function az(t=!1){let e=[tz.default,rz.default,nz.default,oz.default,sz.default,iz.default,XS.default,YS.default,WS.default,QS.default,ez.default];return t?e.push(BS.default,GS.default):e.push(HS.default,KS.default),e.push(JS.default),e}Pl.default=az});var dg=S(Rl=>{"use strict";Object.defineProperty(Rl,"__esModule",{value:!0});var he=U(),cz={message:({schemaCode:t})=>(0,he.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,he._)`{format: ${t}}`},uz={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:cz,code(t,e){let{gen:r,data:n,$data:o,schema:s,schemaCode:i,it:a}=t,{opts:c,errSchemaPath:u,schemaEnv:l,self:d}=a;if(!c.validateFormats)return;o?m():f();function m(){let p=r.scopeValue("formats",{ref:d.formats,code:c.code.formats}),h=r.const("fDef",(0,he._)`${p}[${i}]`),g=r.let("fType"),v=r.let("format");r.if((0,he._)`typeof ${h} == "object" && !(${h} instanceof RegExp)`,()=>r.assign(g,(0,he._)`${h}.type || "string"`).assign(v,(0,he._)`${h}.validate`),()=>r.assign(g,(0,he._)`"string"`).assign(v,h)),t.fail$data((0,he.or)(x(),w()));function x(){return c.strictSchema===!1?he.nil:(0,he._)`${i} && !${v}`}function w(){let E=l.$async?(0,he._)`(${h}.async ? await ${v}(${n}) : ${v}(${n}))`:(0,he._)`${v}(${n})`,C=(0,he._)`(typeof ${v} == "function" ? ${E} : ${v}.test(${n}))`;return(0,he._)`${v} && ${v} !== true && ${g} === ${e} && !${C}`}}function f(){let p=d.formats[s];if(!p){x();return}if(p===!0)return;let[h,g,v]=w(p);h===e&&t.pass(E());function x(){if(c.strictSchema===!1){d.logger.warn(C());return}throw new Error(C());function C(){return`unknown format "${s}" ignored in schema at path "${u}"`}}function w(C){let Pe=C instanceof RegExp?(0,he.regexpCode)(C):c.code.formats?(0,he._)`${c.code.formats}${(0,he.getProperty)(s)}`:void 0,Be=r.scopeValue("formats",{key:s,ref:C,code:Pe});return typeof C=="object"&&!(C instanceof RegExp)?[C.type||"string",C.validate,(0,he._)`${Be}.validate`]:["string",C,Be]}function E(){if(typeof p=="object"&&!(p instanceof RegExp)&&p.async){if(!l.$async)throw new Error("async format in sync schema");return(0,he._)`await ${v}(${n})`}return typeof g=="function"?(0,he._)`${v}(${n})`:(0,he._)`${v}.test(${n})`}}}};Rl.default=uz});var pg=S(Il=>{"use strict";Object.defineProperty(Il,"__esModule",{value:!0});var lz=dg(),dz=[lz.default];Il.default=dz});var fg=S(on=>{"use strict";Object.defineProperty(on,"__esModule",{value:!0});on.contentVocabulary=on.metadataVocabulary=void 0;on.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];on.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var hg=S(Ol=>{"use strict";Object.defineProperty(Ol,"__esModule",{value:!0});var pz=$h(),fz=jh(),mz=lg(),hz=pg(),mg=fg(),gz=[pz.default,fz.default,(0,mz.default)(),hz.default,mg.metadataVocabulary,mg.contentVocabulary];Ol.default=gz});var _g=S(Xs=>{"use strict";Object.defineProperty(Xs,"__esModule",{value:!0});Xs.DiscrError=void 0;var gg;(function(t){t.Tag="tag",t.Mapping="mapping"})(gg||(Xs.DiscrError=gg={}))});var vg=S(Cl=>{"use strict";Object.defineProperty(Cl,"__esModule",{value:!0});var sn=U(),Nl=_g(),yg=Ns(),_z=eo(),yz=W(),vz={message:({params:{discrError:t,tagName:e}})=>t===Nl.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:r}})=>(0,sn._)`{error: ${t}, tag: ${r}, tagValue: ${e}}`},bz={keyword:"discriminator",type:"object",schemaType:"object",error:vz,code(t){let{gen:e,data:r,schema:n,parentSchema:o,it:s}=t,{oneOf:i}=o;if(!s.opts.discriminator)throw new Error("discriminator: requires discriminator option");let a=n.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!i)throw new Error("discriminator: requires oneOf keyword");let c=e.let("valid",!1),u=e.const("tag",(0,sn._)`${r}${(0,sn.getProperty)(a)}`);e.if((0,sn._)`typeof ${u} == "string"`,()=>l(),()=>t.error(!1,{discrError:Nl.DiscrError.Tag,tag:u,tagName:a})),t.ok(c);function l(){let f=m();e.if(!1);for(let p in f)e.elseIf((0,sn._)`${u} === ${p}`),e.assign(c,d(f[p]));e.else(),t.error(!1,{discrError:Nl.DiscrError.Mapping,tag:u,tagName:a}),e.endIf()}function d(f){let p=e.name("valid"),h=t.subschema({keyword:"oneOf",schemaProp:f},p);return t.mergeEvaluated(h,sn.Name),p}function m(){var f;let p={},h=v(o),g=!0;for(let E=0;E<i.length;E++){let C=i[E];if(C?.$ref&&!(0,yz.schemaHasRulesButRef)(C,s.self.RULES)){let Be=C.$ref;if(C=yg.resolveRef.call(s.self,s.schemaEnv.root,s.baseId,Be),C instanceof yg.SchemaEnv&&(C=C.schema),C===void 0)throw new _z.default(s.opts.uriResolver,s.baseId,Be)}let Pe=(f=C?.properties)===null||f===void 0?void 0:f[a];if(typeof Pe!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);g=g&&(h||v(C)),x(Pe,E)}if(!g)throw new Error(`discriminator: "${a}" must be required`);return p;function v({required:E}){return Array.isArray(E)&&E.includes(a)}function x(E,C){if(E.const)w(E.const,C);else if(E.enum)for(let Pe of E.enum)w(Pe,C);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function w(E,C){if(typeof E!="string"||E in p)throw new Error(`discriminator: "${a}" values must be unique strings`);p[E]=C}}}};Cl.default=bz});var bg=S((jN,xz)=>{xz.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var jl=S((ce,Zl)=>{"use strict";Object.defineProperty(ce,"__esModule",{value:!0});ce.MissingRefError=ce.ValidationError=ce.CodeGen=ce.Name=ce.nil=ce.stringify=ce.str=ce._=ce.KeywordCxt=ce.Ajv=void 0;var $z=gh(),wz=hg(),kz=vg(),xg=bg(),Sz=["/properties"],Ys="http://json-schema.org/draft-07/schema",an=class extends $z.default{_addVocabularies(){super._addVocabularies(),wz.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(kz.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let e=this.opts.$data?this.$dataMetaSchema(xg,Sz):xg;this.addMetaSchema(e,Ys,!1),this.refs["http://json-schema.org/schema"]=Ys}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(Ys)?Ys:void 0)}};ce.Ajv=an;Zl.exports=ce=an;Zl.exports.Ajv=an;Object.defineProperty(ce,"__esModule",{value:!0});ce.default=an;var zz=Qn();Object.defineProperty(ce,"KeywordCxt",{enumerable:!0,get:function(){return zz.KeywordCxt}});var cn=U();Object.defineProperty(ce,"_",{enumerable:!0,get:function(){return cn._}});Object.defineProperty(ce,"str",{enumerable:!0,get:function(){return cn.str}});Object.defineProperty(ce,"stringify",{enumerable:!0,get:function(){return cn.stringify}});Object.defineProperty(ce,"nil",{enumerable:!0,get:function(){return cn.nil}});Object.defineProperty(ce,"Name",{enumerable:!0,get:function(){return cn.Name}});Object.defineProperty(ce,"CodeGen",{enumerable:!0,get:function(){return cn.CodeGen}});var Tz=Is();Object.defineProperty(ce,"ValidationError",{enumerable:!0,get:function(){return Tz.default}});var Ez=eo();Object.defineProperty(ce,"MissingRefError",{enumerable:!0,get:function(){return Ez.default}})});var Pg=S(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});bt.formatNames=bt.fastFormats=bt.fullFormats=void 0;function vt(t,e){return{validate:t,compare:e}}bt.fullFormats={date:vt(Sg,Ll),time:vt(Ml(!0),ql),"date-time":vt($g(!0),Tg),"iso-time":vt(Ml(),zg),"iso-date-time":vt($g(),Eg),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:Cz,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:qz,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:Zz,int32:{type:"number",validate:Mz},int64:{type:"number",validate:Dz},float:{type:"number",validate:kg},double:{type:"number",validate:kg},password:!0,binary:!0};bt.fastFormats={...bt.fullFormats,date:vt(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,Ll),time:vt(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,ql),"date-time":vt(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,Tg),"iso-time":vt(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,zg),"iso-date-time":vt(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,Eg),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i};bt.formatNames=Object.keys(bt.fullFormats);function Pz(t){return t%4===0&&(t%100!==0||t%400===0)}var Rz=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,Iz=[0,31,28,31,30,31,30,31,31,30,31,30,31];function Sg(t){let e=Rz.exec(t);if(!e)return!1;let r=+e[1],n=+e[2],o=+e[3];return n>=1&&n<=12&&o>=1&&o<=(n===2&&Pz(r)?29:Iz[n])}function Ll(t,e){if(t&&e)return t>e?1:t<e?-1:0}var Al=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function Ml(t){return function(r){let n=Al.exec(r);if(!n)return!1;let o=+n[1],s=+n[2],i=+n[3],a=n[4],c=n[5]==="-"?-1:1,u=+(n[6]||0),l=+(n[7]||0);if(u>23||l>59||t&&!a)return!1;if(o<=23&&s<=59&&i<60)return!0;let d=s-l*c,m=o-u*c-(d<0?1:0);return(m===23||m===-1)&&(d===59||d===-1)&&i<61}}function ql(t,e){if(!(t&&e))return;let r=new Date("2020-01-01T"+t).valueOf(),n=new Date("2020-01-01T"+e).valueOf();if(r&&n)return r-n}function zg(t,e){if(!(t&&e))return;let r=Al.exec(t),n=Al.exec(e);if(r&&n)return t=r[1]+r[2]+r[3],e=n[1]+n[2]+n[3],t>e?1:t<e?-1:0}var Dl=/t|\s/i;function $g(t){let e=Ml(t);return function(n){let o=n.split(Dl);return o.length===2&&Sg(o[0])&&e(o[1])}}function Tg(t,e){if(!(t&&e))return;let r=new Date(t).valueOf(),n=new Date(e).valueOf();if(r&&n)return r-n}function Eg(t,e){if(!(t&&e))return;let[r,n]=t.split(Dl),[o,s]=e.split(Dl),i=Ll(r,o);if(i!==void 0)return i||ql(n,s)}var Oz=/\/|:/,Nz=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function Cz(t){return Oz.test(t)&&Nz.test(t)}var wg=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function Zz(t){return wg.lastIndex=0,wg.test(t)}var jz=-(2**31),Az=2**31-1;function Mz(t){return Number.isInteger(t)&&t<=Az&&t>=jz}function Dz(t){return Number.isInteger(t)}function kg(){return!0}var Lz=/[^\\]\\Z/;function qz(t){if(Lz.test(t))return!1;try{return new RegExp(t),!0}catch{return!1}}});var Rg=S(un=>{"use strict";Object.defineProperty(un,"__esModule",{value:!0});un.formatLimitDefinition=void 0;var Uz=jl(),lt=U(),Jt=lt.operators,Qs={formatMaximum:{okStr:"<=",ok:Jt.LTE,fail:Jt.GT},formatMinimum:{okStr:">=",ok:Jt.GTE,fail:Jt.LT},formatExclusiveMaximum:{okStr:"<",ok:Jt.LT,fail:Jt.GTE},formatExclusiveMinimum:{okStr:">",ok:Jt.GT,fail:Jt.LTE}},Fz={message:({keyword:t,schemaCode:e})=>(0,lt.str)`should be ${Qs[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,lt._)`{comparison: ${Qs[t].okStr}, limit: ${e}}`};un.formatLimitDefinition={keyword:Object.keys(Qs),type:"string",schemaType:"string",$data:!0,error:Fz,code(t){let{gen:e,data:r,schemaCode:n,keyword:o,it:s}=t,{opts:i,self:a}=s;if(!i.validateFormats)return;let c=new Uz.KeywordCxt(s,a.RULES.all.format.definition,"format");c.$data?u():l();function u(){let m=e.scopeValue("formats",{ref:a.formats,code:i.code.formats}),f=e.const("fmt",(0,lt._)`${m}[${c.schemaCode}]`);t.fail$data((0,lt.or)((0,lt._)`typeof ${f} != "object"`,(0,lt._)`${f} instanceof RegExp`,(0,lt._)`typeof ${f}.compare != "function"`,d(f)))}function l(){let m=c.schema,f=a.formats[m];if(!f||f===!0)return;if(typeof f!="object"||f instanceof RegExp||typeof f.compare!="function")throw new Error(`"${o}": format "${m}" does not define "compare" function`);let p=e.scopeValue("formats",{key:m,ref:f,code:i.code.formats?(0,lt._)`${i.code.formats}${(0,lt.getProperty)(m)}`:void 0});t.fail$data(d(p))}function d(m){return(0,lt._)`${m}.compare(${r}, ${n}) ${Qs[o].fail} 0`}},dependencies:["format"]};var Vz=t=>(t.addKeyword(un.formatLimitDefinition),t);un.default=Vz});var Cg=S((ho,Ng)=>{"use strict";Object.defineProperty(ho,"__esModule",{value:!0});var ln=Pg(),Hz=Rg(),Ul=U(),Ig=new Ul.Name("fullFormats"),Bz=new Ul.Name("fastFormats"),Fl=(t,e={keywords:!0})=>{if(Array.isArray(e))return Og(t,e,ln.fullFormats,Ig),t;let[r,n]=e.mode==="fast"?[ln.fastFormats,Bz]:[ln.fullFormats,Ig],o=e.formats||ln.formatNames;return Og(t,o,r,n),e.keywords&&(0,Hz.default)(t),t};Fl.get=(t,e="full")=>{let n=(e==="fast"?ln.fastFormats:ln.fullFormats)[t];if(!n)throw new Error(`Unknown format "${t}"`);return n};function Og(t,e,r,n){var o,s;(o=(s=t.opts.code).formats)!==null&&o!==void 0||(s.formats=(0,Ul._)`require("ajv-formats/dist/formats").${n}`);for(let i of e)t.addFormat(i,r[i])}Ng.exports=ho=Fl;Object.defineProperty(ho,"__esModule",{value:!0});ho.default=Fl});var ie={};hi(ie,{BRAND:()=>O_,DIRTY:()=>Xt,EMPTY_PATH:()=>l_,INVALID:()=>Z,NEVER:()=>hy,OK:()=>Se,ParseStatus:()=>ye,Schema:()=>q,ZodAny:()=>Ct,ZodArray:()=>St,ZodBigInt:()=>Qt,ZodBoolean:()=>er,ZodBranded:()=>mn,ZodCatch:()=>dr,ZodDate:()=>tr,ZodDefault:()=>lr,ZodDiscriminatedUnion:()=>bo,ZodEffects:()=>Ge,ZodEnum:()=>cr,ZodError:()=>Ce,ZodFirstPartyTypeKind:()=>$,ZodFunction:()=>$o,ZodIntersection:()=>sr,ZodIssueCode:()=>b,ZodLazy:()=>ir,ZodLiteral:()=>ar,ZodMap:()=>jr,ZodNaN:()=>Mr,ZodNativeEnum:()=>ur,ZodNever:()=>rt,ZodNull:()=>nr,ZodNullable:()=>ft,ZodNumber:()=>Yt,ZodObject:()=>je,ZodOptional:()=>Ze,ZodParsedType:()=>z,ZodPipeline:()=>hn,ZodPromise:()=>Zt,ZodReadonly:()=>pr,ZodRecord:()=>xo,ZodSchema:()=>q,ZodSet:()=>Ar,ZodString:()=>Nt,ZodSymbol:()=>Cr,ZodTransformer:()=>Ge,ZodTuple:()=>pt,ZodType:()=>q,ZodUndefined:()=>rr,ZodUnion:()=>or,ZodUnknown:()=>kt,ZodVoid:()=>Zr,addIssueToContext:()=>k,any:()=>q_,array:()=>H_,bigint:()=>j_,boolean:()=>dd,coerce:()=>my,custom:()=>cd,date:()=>A_,datetimeRegex:()=>id,defaultErrorMap:()=>$t,discriminatedUnion:()=>G_,effect:()=>iy,enum:()=>ny,function:()=>ey,getErrorMap:()=>Ir,getParsedType:()=>dt,instanceof:()=>C_,intersection:()=>J_,isAborted:()=>yo,isAsync:()=>Or,isDirty:()=>vo,isValid:()=>Ot,late:()=>N_,lazy:()=>ty,literal:()=>ry,makeIssue:()=>fn,map:()=>Y_,nan:()=>Z_,nativeEnum:()=>oy,never:()=>F_,null:()=>L_,nullable:()=>cy,number:()=>ld,object:()=>vi,objectUtil:()=>gi,oboolean:()=>fy,onumber:()=>py,optional:()=>ay,ostring:()=>dy,pipeline:()=>ly,preprocess:()=>uy,promise:()=>sy,quotelessJson:()=>a_,record:()=>X_,set:()=>Q_,setErrorMap:()=>u_,strictObject:()=>B_,string:()=>ud,symbol:()=>M_,transformer:()=>iy,tuple:()=>W_,undefined:()=>D_,union:()=>K_,unknown:()=>U_,util:()=>H,void:()=>V_});var H;(function(t){t.assertEqual=o=>{};function e(o){}t.assertIs=e;function r(o){throw new Error}t.assertNever=r,t.arrayToEnum=o=>{let s={};for(let i of o)s[i]=i;return s},t.getValidEnumValues=o=>{let s=t.objectKeys(o).filter(a=>typeof o[o[a]]!="number"),i={};for(let a of s)i[a]=o[a];return t.objectValues(i)},t.objectValues=o=>t.objectKeys(o).map(function(s){return o[s]}),t.objectKeys=typeof Object.keys=="function"?o=>Object.keys(o):o=>{let s=[];for(let i in o)Object.prototype.hasOwnProperty.call(o,i)&&s.push(i);return s},t.find=(o,s)=>{for(let i of o)if(s(i))return i},t.isInteger=typeof Number.isInteger=="function"?o=>Number.isInteger(o):o=>typeof o=="number"&&Number.isFinite(o)&&Math.floor(o)===o;function n(o,s=" | "){return o.map(i=>typeof i=="string"?`'${i}'`:i).join(s)}t.joinValues=n,t.jsonStringifyReplacer=(o,s)=>typeof s=="bigint"?s.toString():s})(H||(H={}));var gi;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(gi||(gi={}));var z=H.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),dt=t=>{switch(typeof t){case"undefined":return z.undefined;case"string":return z.string;case"number":return Number.isNaN(t)?z.nan:z.number;case"boolean":return z.boolean;case"function":return z.function;case"bigint":return z.bigint;case"symbol":return z.symbol;case"object":return Array.isArray(t)?z.array:t===null?z.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?z.promise:typeof Map<"u"&&t instanceof Map?z.map:typeof Set<"u"&&t instanceof Set?z.set:typeof Date<"u"&&t instanceof Date?z.date:z.object;default:return z.unknown}};var b=H.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),a_=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),Ce=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(s){return s.message},n={_errors:[]},o=s=>{for(let i of s.issues)if(i.code==="invalid_union")i.unionErrors.map(o);else if(i.code==="invalid_return_type")o(i.returnTypeError);else if(i.code==="invalid_arguments")o(i.argumentsError);else if(i.path.length===0)n._errors.push(r(i));else{let a=n,c=0;for(;c<i.path.length;){let u=i.path[c];c===i.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(r(i))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return o(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,H.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let o of this.issues)if(o.path.length>0){let s=o.path[0];r[s]=r[s]||[],r[s].push(e(o))}else n.push(e(o));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};Ce.create=t=>new Ce(t);var c_=(t,e)=>{let r;switch(t.code){case b.invalid_type:t.received===z.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case b.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,H.jsonStringifyReplacer)}`;break;case b.unrecognized_keys:r=`Unrecognized key(s) in object: ${H.joinValues(t.keys,", ")}`;break;case b.invalid_union:r="Invalid input";break;case b.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${H.joinValues(t.options)}`;break;case b.invalid_enum_value:r=`Invalid enum value. Expected ${H.joinValues(t.options)}, received '${t.received}'`;break;case b.invalid_arguments:r="Invalid function arguments";break;case b.invalid_return_type:r="Invalid function return type";break;case b.invalid_date:r="Invalid date";break;case b.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:H.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case b.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case b.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case b.custom:r="Invalid input";break;case b.invalid_intersection_types:r="Intersection results could not be merged";break;case b.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case b.not_finite:r="Number must be finite";break;default:r=e.defaultError,H.assertNever(t)}return{message:r}},$t=c_;var td=$t;function u_(t){td=t}function Ir(){return td}var fn=t=>{let{data:e,path:r,errorMaps:n,issueData:o}=t,s=[...r,...o.path||[]],i={...o,path:s};if(o.message!==void 0)return{...o,path:s,message:o.message};let a="",c=n.filter(u=>!!u).slice().reverse();for(let u of c)a=u(i,{data:e,defaultError:a}).message;return{...o,path:s,message:a}},l_=[];function k(t,e){let r=Ir(),n=fn({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===$t?void 0:$t].filter(o=>!!o)});t.common.issues.push(n)}var ye=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let n=[];for(let o of r){if(o.status==="aborted")return Z;o.status==="dirty"&&e.dirty(),n.push(o.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let o of r){let s=await o.key,i=await o.value;n.push({key:s,value:i})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let o of r){let{key:s,value:i}=o;if(s.status==="aborted"||i.status==="aborted")return Z;s.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof i.value<"u"||o.alwaysSet)&&(n[s.value]=i.value)}return{status:e.value,value:n}}},Z=Object.freeze({status:"aborted"}),Xt=t=>({status:"dirty",value:t}),Se=t=>({status:"valid",value:t}),yo=t=>t.status==="aborted",vo=t=>t.status==="dirty",Ot=t=>t.status==="valid",Or=t=>typeof Promise<"u"&&t instanceof Promise;var P;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(P||(P={}));var Ke=class{constructor(e,r,n,o){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=o}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},rd=(t,e)=>{if(Ot(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new Ce(t.common.issues);return this._error=r,this._error}}};function D(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:o}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:o}:{errorMap:(i,a)=>{let{message:c}=t;return i.code==="invalid_enum_value"?{message:c??a.defaultError}:typeof a.data>"u"?{message:c??n??a.defaultError}:i.code!=="invalid_type"?{message:a.defaultError}:{message:c??r??a.defaultError}},description:o}}var q=class{get description(){return this._def.description}_getType(e){return dt(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:dt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ye,ctx:{common:e.parent.common,data:e.data,parsedType:dt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(Or(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:dt(e)},o=this._parseSync({data:e,path:n.path,parent:n});return rd(n,o)}"~validate"(e){let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:dt(e)};if(!this["~standard"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return Ot(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>Ot(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:dt(e)},o=this._parse({data:e,path:n.path,parent:n}),s=await(Or(o)?o:Promise.resolve(o));return rd(n,s)}refine(e,r){let n=o=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(o):r;return this._refinement((o,s)=>{let i=e(o),a=()=>s.addIssue({code:b.custom,...n(o)});return typeof Promise<"u"&&i instanceof Promise?i.then(c=>c?!0:(a(),!1)):i?!0:(a(),!1)})}refinement(e,r){return this._refinement((n,o)=>e(n)?!0:(o.addIssue(typeof r=="function"?r(n,o):r),!1))}_refinement(e){return new Ge({schema:this,typeName:$.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Ze.create(this,this._def)}nullable(){return ft.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return St.create(this)}promise(){return Zt.create(this,this._def)}or(e){return or.create([this,e],this._def)}and(e){return sr.create(this,e,this._def)}transform(e){return new Ge({...D(this._def),schema:this,typeName:$.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new lr({...D(this._def),innerType:this,defaultValue:r,typeName:$.ZodDefault})}brand(){return new mn({typeName:$.ZodBranded,type:this,...D(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new dr({...D(this._def),innerType:this,catchValue:r,typeName:$.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return hn.create(this,e)}readonly(){return pr.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},d_=/^c[^\s-]{8,}$/i,p_=/^[0-9a-z]+$/,f_=/^[0-9A-HJKMNP-TV-Z]{26}$/i,m_=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,h_=/^[a-z0-9_-]{21}$/i,g_=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,__=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,y_=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,v_="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",_i,b_=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,x_=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,$_=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,w_=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,k_=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,S_=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,od="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",z_=new RegExp(`^${od}$`);function sd(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);let r=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${r}`}function T_(t){return new RegExp(`^${sd(t)}$`)}function id(t){let e=`${od}T${sd(t)}`,r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function E_(t,e){return!!((e==="v4"||!e)&&b_.test(t)||(e==="v6"||!e)&&$_.test(t))}function P_(t,e){if(!g_.test(t))return!1;try{let[r]=t.split(".");if(!r)return!1;let n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),o=JSON.parse(atob(n));return!(typeof o!="object"||o===null||"typ"in o&&o?.typ!=="JWT"||!o.alg||e&&o.alg!==e)}catch{return!1}}function R_(t,e){return!!((e==="v4"||!e)&&x_.test(t)||(e==="v6"||!e)&&w_.test(t))}var Nt=class t extends q{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==z.string){let s=this._getOrReturnCtx(e);return k(s,{code:b.invalid_type,expected:z.string,received:s.parsedType}),Z}let n=new ye,o;for(let s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(o=this._getOrReturnCtx(e,o),k(o,{code:b.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="max")e.data.length>s.value&&(o=this._getOrReturnCtx(e,o),k(o,{code:b.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="length"){let i=e.data.length>s.value,a=e.data.length<s.value;(i||a)&&(o=this._getOrReturnCtx(e,o),i?k(o,{code:b.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):a&&k(o,{code:b.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),n.dirty())}else if(s.kind==="email")y_.test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"email",code:b.invalid_string,message:s.message}),n.dirty());else if(s.kind==="emoji")_i||(_i=new RegExp(v_,"u")),_i.test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"emoji",code:b.invalid_string,message:s.message}),n.dirty());else if(s.kind==="uuid")m_.test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"uuid",code:b.invalid_string,message:s.message}),n.dirty());else if(s.kind==="nanoid")h_.test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"nanoid",code:b.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid")d_.test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"cuid",code:b.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid2")p_.test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"cuid2",code:b.invalid_string,message:s.message}),n.dirty());else if(s.kind==="ulid")f_.test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"ulid",code:b.invalid_string,message:s.message}),n.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{o=this._getOrReturnCtx(e,o),k(o,{validation:"url",code:b.invalid_string,message:s.message}),n.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"regex",code:b.invalid_string,message:s.message}),n.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(o=this._getOrReturnCtx(e,o),k(o,{code:b.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),n.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(o=this._getOrReturnCtx(e,o),k(o,{code:b.invalid_string,validation:{startsWith:s.value},message:s.message}),n.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(o=this._getOrReturnCtx(e,o),k(o,{code:b.invalid_string,validation:{endsWith:s.value},message:s.message}),n.dirty()):s.kind==="datetime"?id(s).test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{code:b.invalid_string,validation:"datetime",message:s.message}),n.dirty()):s.kind==="date"?z_.test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{code:b.invalid_string,validation:"date",message:s.message}),n.dirty()):s.kind==="time"?T_(s).test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{code:b.invalid_string,validation:"time",message:s.message}),n.dirty()):s.kind==="duration"?__.test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"duration",code:b.invalid_string,message:s.message}),n.dirty()):s.kind==="ip"?E_(e.data,s.version)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"ip",code:b.invalid_string,message:s.message}),n.dirty()):s.kind==="jwt"?P_(e.data,s.alg)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"jwt",code:b.invalid_string,message:s.message}),n.dirty()):s.kind==="cidr"?R_(e.data,s.version)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"cidr",code:b.invalid_string,message:s.message}),n.dirty()):s.kind==="base64"?k_.test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"base64",code:b.invalid_string,message:s.message}),n.dirty()):s.kind==="base64url"?S_.test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"base64url",code:b.invalid_string,message:s.message}),n.dirty()):H.assertNever(s);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(o=>e.test(o),{validation:r,code:b.invalid_string,...P.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...P.errToObj(e)})}url(e){return this._addCheck({kind:"url",...P.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...P.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...P.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...P.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...P.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...P.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...P.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...P.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...P.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...P.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...P.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...P.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...P.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...P.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...P.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...P.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...P.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...P.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...P.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...P.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...P.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...P.errToObj(r)})}nonempty(e){return this.min(1,P.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Nt.create=t=>new Nt({checks:[],typeName:$.ZodString,coerce:t?.coerce??!1,...D(t)});function I_(t,e){let r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,o=r>n?r:n,s=Number.parseInt(t.toFixed(o).replace(".","")),i=Number.parseInt(e.toFixed(o).replace(".",""));return s%i/10**o}var Yt=class t extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==z.number){let s=this._getOrReturnCtx(e);return k(s,{code:b.invalid_type,expected:z.number,received:s.parsedType}),Z}let n,o=new ye;for(let s of this._def.checks)s.kind==="int"?H.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:b.invalid_type,expected:"integer",received:"float",message:s.message}),o.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:b.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),o.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:b.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),o.dirty()):s.kind==="multipleOf"?I_(e.data,s.value)!==0&&(n=this._getOrReturnCtx(e,n),k(n,{code:b.not_multiple_of,multipleOf:s.value,message:s.message}),o.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:b.not_finite,message:s.message}),o.dirty()):H.assertNever(s);return{status:o.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,P.toString(r))}gt(e,r){return this.setLimit("min",e,!1,P.toString(r))}lte(e,r){return this.setLimit("max",e,!0,P.toString(r))}lt(e,r){return this.setLimit("max",e,!1,P.toString(r))}setLimit(e,r,n,o){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:P.toString(o)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:P.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:P.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:P.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:P.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:P.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:P.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:P.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:P.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:P.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&H.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}};Yt.create=t=>new Yt({checks:[],typeName:$.ZodNumber,coerce:t?.coerce||!1,...D(t)});var Qt=class t extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==z.bigint)return this._getInvalidInput(e);let n,o=new ye;for(let s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:b.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),o.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:b.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),o.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),k(n,{code:b.not_multiple_of,multipleOf:s.value,message:s.message}),o.dirty()):H.assertNever(s);return{status:o.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return k(r,{code:b.invalid_type,expected:z.bigint,received:r.parsedType}),Z}gte(e,r){return this.setLimit("min",e,!0,P.toString(r))}gt(e,r){return this.setLimit("min",e,!1,P.toString(r))}lte(e,r){return this.setLimit("max",e,!0,P.toString(r))}lt(e,r){return this.setLimit("max",e,!1,P.toString(r))}setLimit(e,r,n,o){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:P.toString(o)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:P.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:P.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:P.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:P.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:P.toString(r)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Qt.create=t=>new Qt({checks:[],typeName:$.ZodBigInt,coerce:t?.coerce??!1,...D(t)});var er=class extends q{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==z.boolean){let n=this._getOrReturnCtx(e);return k(n,{code:b.invalid_type,expected:z.boolean,received:n.parsedType}),Z}return Se(e.data)}};er.create=t=>new er({typeName:$.ZodBoolean,coerce:t?.coerce||!1,...D(t)});var tr=class t extends q{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==z.date){let s=this._getOrReturnCtx(e);return k(s,{code:b.invalid_type,expected:z.date,received:s.parsedType}),Z}if(Number.isNaN(e.data.getTime())){let s=this._getOrReturnCtx(e);return k(s,{code:b.invalid_date}),Z}let n=new ye,o;for(let s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(o=this._getOrReturnCtx(e,o),k(o,{code:b.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),n.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(o=this._getOrReturnCtx(e,o),k(o,{code:b.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),n.dirty()):H.assertNever(s);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:P.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:P.toString(r)})}get minDate(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}};tr.create=t=>new tr({checks:[],coerce:t?.coerce||!1,typeName:$.ZodDate,...D(t)});var Cr=class extends q{_parse(e){if(this._getType(e)!==z.symbol){let n=this._getOrReturnCtx(e);return k(n,{code:b.invalid_type,expected:z.symbol,received:n.parsedType}),Z}return Se(e.data)}};Cr.create=t=>new Cr({typeName:$.ZodSymbol,...D(t)});var rr=class extends q{_parse(e){if(this._getType(e)!==z.undefined){let n=this._getOrReturnCtx(e);return k(n,{code:b.invalid_type,expected:z.undefined,received:n.parsedType}),Z}return Se(e.data)}};rr.create=t=>new rr({typeName:$.ZodUndefined,...D(t)});var nr=class extends q{_parse(e){if(this._getType(e)!==z.null){let n=this._getOrReturnCtx(e);return k(n,{code:b.invalid_type,expected:z.null,received:n.parsedType}),Z}return Se(e.data)}};nr.create=t=>new nr({typeName:$.ZodNull,...D(t)});var Ct=class extends q{constructor(){super(...arguments),this._any=!0}_parse(e){return Se(e.data)}};Ct.create=t=>new Ct({typeName:$.ZodAny,...D(t)});var kt=class extends q{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Se(e.data)}};kt.create=t=>new kt({typeName:$.ZodUnknown,...D(t)});var rt=class extends q{_parse(e){let r=this._getOrReturnCtx(e);return k(r,{code:b.invalid_type,expected:z.never,received:r.parsedType}),Z}};rt.create=t=>new rt({typeName:$.ZodNever,...D(t)});var Zr=class extends q{_parse(e){if(this._getType(e)!==z.undefined){let n=this._getOrReturnCtx(e);return k(n,{code:b.invalid_type,expected:z.void,received:n.parsedType}),Z}return Se(e.data)}};Zr.create=t=>new Zr({typeName:$.ZodVoid,...D(t)});var St=class t extends q{_parse(e){let{ctx:r,status:n}=this._processInputParams(e),o=this._def;if(r.parsedType!==z.array)return k(r,{code:b.invalid_type,expected:z.array,received:r.parsedType}),Z;if(o.exactLength!==null){let i=r.data.length>o.exactLength.value,a=r.data.length<o.exactLength.value;(i||a)&&(k(r,{code:i?b.too_big:b.too_small,minimum:a?o.exactLength.value:void 0,maximum:i?o.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:o.exactLength.message}),n.dirty())}if(o.minLength!==null&&r.data.length<o.minLength.value&&(k(r,{code:b.too_small,minimum:o.minLength.value,type:"array",inclusive:!0,exact:!1,message:o.minLength.message}),n.dirty()),o.maxLength!==null&&r.data.length>o.maxLength.value&&(k(r,{code:b.too_big,maximum:o.maxLength.value,type:"array",inclusive:!0,exact:!1,message:o.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((i,a)=>o.type._parseAsync(new Ke(r,i,r.path,a)))).then(i=>ye.mergeArray(n,i));let s=[...r.data].map((i,a)=>o.type._parseSync(new Ke(r,i,r.path,a)));return ye.mergeArray(n,s)}get element(){return this._def.type}min(e,r){return new t({...this._def,minLength:{value:e,message:P.toString(r)}})}max(e,r){return new t({...this._def,maxLength:{value:e,message:P.toString(r)}})}length(e,r){return new t({...this._def,exactLength:{value:e,message:P.toString(r)}})}nonempty(e){return this.min(1,e)}};St.create=(t,e)=>new St({type:t,minLength:null,maxLength:null,exactLength:null,typeName:$.ZodArray,...D(e)});function Nr(t){if(t instanceof je){let e={};for(let r in t.shape){let n=t.shape[r];e[r]=Ze.create(Nr(n))}return new je({...t._def,shape:()=>e})}else return t instanceof St?new St({...t._def,type:Nr(t.element)}):t instanceof Ze?Ze.create(Nr(t.unwrap())):t instanceof ft?ft.create(Nr(t.unwrap())):t instanceof pt?pt.create(t.items.map(e=>Nr(e))):t}var je=class t extends q{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),r=H.objectKeys(e);return this._cached={shape:e,keys:r},this._cached}_parse(e){if(this._getType(e)!==z.object){let u=this._getOrReturnCtx(e);return k(u,{code:b.invalid_type,expected:z.object,received:u.parsedType}),Z}let{status:n,ctx:o}=this._processInputParams(e),{shape:s,keys:i}=this._getCached(),a=[];if(!(this._def.catchall instanceof rt&&this._def.unknownKeys==="strip"))for(let u in o.data)i.includes(u)||a.push(u);let c=[];for(let u of i){let l=s[u],d=o.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new Ke(o,d,o.path,u)),alwaysSet:u in o.data})}if(this._def.catchall instanceof rt){let u=this._def.unknownKeys;if(u==="passthrough")for(let l of a)c.push({key:{status:"valid",value:l},value:{status:"valid",value:o.data[l]}});else if(u==="strict")a.length>0&&(k(o,{code:b.unrecognized_keys,keys:a}),n.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let l of a){let d=o.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new Ke(o,d,o.path,l)),alwaysSet:l in o.data})}}return o.common.async?Promise.resolve().then(async()=>{let u=[];for(let l of c){let d=await l.key,m=await l.value;u.push({key:d,value:m,alwaysSet:l.alwaysSet})}return u}).then(u=>ye.mergeObjectSync(n,u)):ye.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(e){return P.errToObj,new t({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,n)=>{let o=this._def.errorMap?.(r,n).message??n.defaultError;return r.code==="unrecognized_keys"?{message:P.errToObj(e).message??o}:{message:o}}}:{}})}strip(){return new t({...this._def,unknownKeys:"strip"})}passthrough(){return new t({...this._def,unknownKeys:"passthrough"})}extend(e){return new t({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new t({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:$.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new t({...this._def,catchall:e})}pick(e){let r={};for(let n of H.objectKeys(e))e[n]&&this.shape[n]&&(r[n]=this.shape[n]);return new t({...this._def,shape:()=>r})}omit(e){let r={};for(let n of H.objectKeys(this.shape))e[n]||(r[n]=this.shape[n]);return new t({...this._def,shape:()=>r})}deepPartial(){return Nr(this)}partial(e){let r={};for(let n of H.objectKeys(this.shape)){let o=this.shape[n];e&&!e[n]?r[n]=o:r[n]=o.optional()}return new t({...this._def,shape:()=>r})}required(e){let r={};for(let n of H.objectKeys(this.shape))if(e&&!e[n])r[n]=this.shape[n];else{let s=this.shape[n];for(;s instanceof Ze;)s=s._def.innerType;r[n]=s}return new t({...this._def,shape:()=>r})}keyof(){return ad(H.objectKeys(this.shape))}};je.create=(t,e)=>new je({shape:()=>t,unknownKeys:"strip",catchall:rt.create(),typeName:$.ZodObject,...D(e)});je.strictCreate=(t,e)=>new je({shape:()=>t,unknownKeys:"strict",catchall:rt.create(),typeName:$.ZodObject,...D(e)});je.lazycreate=(t,e)=>new je({shape:t,unknownKeys:"strip",catchall:rt.create(),typeName:$.ZodObject,...D(e)});var or=class extends q{_parse(e){let{ctx:r}=this._processInputParams(e),n=this._def.options;function o(s){for(let a of s)if(a.result.status==="valid")return a.result;for(let a of s)if(a.result.status==="dirty")return r.common.issues.push(...a.ctx.common.issues),a.result;let i=s.map(a=>new Ce(a.ctx.common.issues));return k(r,{code:b.invalid_union,unionErrors:i}),Z}if(r.common.async)return Promise.all(n.map(async s=>{let i={...r,common:{...r.common,issues:[]},parent:null};return{result:await s._parseAsync({data:r.data,path:r.path,parent:i}),ctx:i}})).then(o);{let s,i=[];for(let c of n){let u={...r,common:{...r.common,issues:[]},parent:null},l=c._parseSync({data:r.data,path:r.path,parent:u});if(l.status==="valid")return l;l.status==="dirty"&&!s&&(s={result:l,ctx:u}),u.common.issues.length&&i.push(u.common.issues)}if(s)return r.common.issues.push(...s.ctx.common.issues),s.result;let a=i.map(c=>new Ce(c));return k(r,{code:b.invalid_union,unionErrors:a}),Z}}get options(){return this._def.options}};or.create=(t,e)=>new or({options:t,typeName:$.ZodUnion,...D(e)});var wt=t=>t instanceof ir?wt(t.schema):t instanceof Ge?wt(t.innerType()):t instanceof ar?[t.value]:t instanceof cr?t.options:t instanceof ur?H.objectValues(t.enum):t instanceof lr?wt(t._def.innerType):t instanceof rr?[void 0]:t instanceof nr?[null]:t instanceof Ze?[void 0,...wt(t.unwrap())]:t instanceof ft?[null,...wt(t.unwrap())]:t instanceof mn||t instanceof pr?wt(t.unwrap()):t instanceof dr?wt(t._def.innerType):[],bo=class t extends q{_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==z.object)return k(r,{code:b.invalid_type,expected:z.object,received:r.parsedType}),Z;let n=this.discriminator,o=r.data[n],s=this.optionsMap.get(o);return s?r.common.async?s._parseAsync({data:r.data,path:r.path,parent:r}):s._parseSync({data:r.data,path:r.path,parent:r}):(k(r,{code:b.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),Z)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,n){let o=new Map;for(let s of r){let i=wt(s.shape[e]);if(!i.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of i){if(o.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);o.set(a,s)}}return new t({typeName:$.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:o,...D(n)})}};function yi(t,e){let r=dt(t),n=dt(e);if(t===e)return{valid:!0,data:t};if(r===z.object&&n===z.object){let o=H.objectKeys(e),s=H.objectKeys(t).filter(a=>o.indexOf(a)!==-1),i={...t,...e};for(let a of s){let c=yi(t[a],e[a]);if(!c.valid)return{valid:!1};i[a]=c.data}return{valid:!0,data:i}}else if(r===z.array&&n===z.array){if(t.length!==e.length)return{valid:!1};let o=[];for(let s=0;s<t.length;s++){let i=t[s],a=e[s],c=yi(i,a);if(!c.valid)return{valid:!1};o.push(c.data)}return{valid:!0,data:o}}else return r===z.date&&n===z.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var sr=class extends q{_parse(e){let{status:r,ctx:n}=this._processInputParams(e),o=(s,i)=>{if(yo(s)||yo(i))return Z;let a=yi(s.value,i.value);return a.valid?((vo(s)||vo(i))&&r.dirty(),{status:r.value,value:a.data}):(k(n,{code:b.invalid_intersection_types}),Z)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([s,i])=>o(s,i)):o(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};sr.create=(t,e,r)=>new sr({left:t,right:e,typeName:$.ZodIntersection,...D(r)});var pt=class t extends q{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==z.array)return k(n,{code:b.invalid_type,expected:z.array,received:n.parsedType}),Z;if(n.data.length<this._def.items.length)return k(n,{code:b.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Z;!this._def.rest&&n.data.length>this._def.items.length&&(k(n,{code:b.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());let s=[...n.data].map((i,a)=>{let c=this._def.items[a]||this._def.rest;return c?c._parse(new Ke(n,i,n.path,a)):null}).filter(i=>!!i);return n.common.async?Promise.all(s).then(i=>ye.mergeArray(r,i)):ye.mergeArray(r,s)}get items(){return this._def.items}rest(e){return new t({...this._def,rest:e})}};pt.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new pt({items:t,typeName:$.ZodTuple,rest:null,...D(e)})};var xo=class t extends q{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==z.object)return k(n,{code:b.invalid_type,expected:z.object,received:n.parsedType}),Z;let o=[],s=this._def.keyType,i=this._def.valueType;for(let a in n.data)o.push({key:s._parse(new Ke(n,a,n.path,a)),value:i._parse(new Ke(n,n.data[a],n.path,a)),alwaysSet:a in n.data});return n.common.async?ye.mergeObjectAsync(r,o):ye.mergeObjectSync(r,o)}get element(){return this._def.valueType}static create(e,r,n){return r instanceof q?new t({keyType:e,valueType:r,typeName:$.ZodRecord,...D(n)}):new t({keyType:Nt.create(),valueType:e,typeName:$.ZodRecord,...D(r)})}},jr=class extends q{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==z.map)return k(n,{code:b.invalid_type,expected:z.map,received:n.parsedType}),Z;let o=this._def.keyType,s=this._def.valueType,i=[...n.data.entries()].map(([a,c],u)=>({key:o._parse(new Ke(n,a,n.path,[u,"key"])),value:s._parse(new Ke(n,c,n.path,[u,"value"]))}));if(n.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of i){let u=await c.key,l=await c.value;if(u.status==="aborted"||l.status==="aborted")return Z;(u.status==="dirty"||l.status==="dirty")&&r.dirty(),a.set(u.value,l.value)}return{status:r.value,value:a}})}else{let a=new Map;for(let c of i){let u=c.key,l=c.value;if(u.status==="aborted"||l.status==="aborted")return Z;(u.status==="dirty"||l.status==="dirty")&&r.dirty(),a.set(u.value,l.value)}return{status:r.value,value:a}}}};jr.create=(t,e,r)=>new jr({valueType:e,keyType:t,typeName:$.ZodMap,...D(r)});var Ar=class t extends q{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==z.set)return k(n,{code:b.invalid_type,expected:z.set,received:n.parsedType}),Z;let o=this._def;o.minSize!==null&&n.data.size<o.minSize.value&&(k(n,{code:b.too_small,minimum:o.minSize.value,type:"set",inclusive:!0,exact:!1,message:o.minSize.message}),r.dirty()),o.maxSize!==null&&n.data.size>o.maxSize.value&&(k(n,{code:b.too_big,maximum:o.maxSize.value,type:"set",inclusive:!0,exact:!1,message:o.maxSize.message}),r.dirty());let s=this._def.valueType;function i(c){let u=new Set;for(let l of c){if(l.status==="aborted")return Z;l.status==="dirty"&&r.dirty(),u.add(l.value)}return{status:r.value,value:u}}let a=[...n.data.values()].map((c,u)=>s._parse(new Ke(n,c,n.path,u)));return n.common.async?Promise.all(a).then(c=>i(c)):i(a)}min(e,r){return new t({...this._def,minSize:{value:e,message:P.toString(r)}})}max(e,r){return new t({...this._def,maxSize:{value:e,message:P.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}};Ar.create=(t,e)=>new Ar({valueType:t,minSize:null,maxSize:null,typeName:$.ZodSet,...D(e)});var $o=class t extends q{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==z.function)return k(r,{code:b.invalid_type,expected:z.function,received:r.parsedType}),Z;function n(a,c){return fn({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Ir(),$t].filter(u=>!!u),issueData:{code:b.invalid_arguments,argumentsError:c}})}function o(a,c){return fn({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Ir(),$t].filter(u=>!!u),issueData:{code:b.invalid_return_type,returnTypeError:c}})}let s={errorMap:r.common.contextualErrorMap},i=r.data;if(this._def.returns instanceof Zt){let a=this;return Se(async function(...c){let u=new Ce([]),l=await a._def.args.parseAsync(c,s).catch(f=>{throw u.addIssue(n(c,f)),u}),d=await Reflect.apply(i,this,l);return await a._def.returns._def.type.parseAsync(d,s).catch(f=>{throw u.addIssue(o(d,f)),u})})}else{let a=this;return Se(function(...c){let u=a._def.args.safeParse(c,s);if(!u.success)throw new Ce([n(c,u.error)]);let l=Reflect.apply(i,this,u.data),d=a._def.returns.safeParse(l,s);if(!d.success)throw new Ce([o(l,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new t({...this._def,args:pt.create(e).rest(kt.create())})}returns(e){return new t({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,n){return new t({args:e||pt.create([]).rest(kt.create()),returns:r||kt.create(),typeName:$.ZodFunction,...D(n)})}},ir=class extends q{get schema(){return this._def.getter()}_parse(e){let{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}};ir.create=(t,e)=>new ir({getter:t,typeName:$.ZodLazy,...D(e)});var ar=class extends q{_parse(e){if(e.data!==this._def.value){let r=this._getOrReturnCtx(e);return k(r,{received:r.data,code:b.invalid_literal,expected:this._def.value}),Z}return{status:"valid",value:e.data}}get value(){return this._def.value}};ar.create=(t,e)=>new ar({value:t,typeName:$.ZodLiteral,...D(e)});function ad(t,e){return new cr({values:t,typeName:$.ZodEnum,...D(e)})}var cr=class t extends q{_parse(e){if(typeof e.data!="string"){let r=this._getOrReturnCtx(e),n=this._def.values;return k(r,{expected:H.joinValues(n),received:r.parsedType,code:b.invalid_type}),Z}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let r=this._getOrReturnCtx(e),n=this._def.values;return k(r,{received:r.data,code:b.invalid_enum_value,options:n}),Z}return Se(e.data)}get options(){return this._def.values}get enum(){let e={};for(let r of this._def.values)e[r]=r;return e}get Values(){let e={};for(let r of this._def.values)e[r]=r;return e}get Enum(){let e={};for(let r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return t.create(e,{...this._def,...r})}exclude(e,r=this._def){return t.create(this.options.filter(n=>!e.includes(n)),{...this._def,...r})}};cr.create=ad;var ur=class extends q{_parse(e){let r=H.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==z.string&&n.parsedType!==z.number){let o=H.objectValues(r);return k(n,{expected:H.joinValues(o),received:n.parsedType,code:b.invalid_type}),Z}if(this._cache||(this._cache=new Set(H.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let o=H.objectValues(r);return k(n,{received:n.data,code:b.invalid_enum_value,options:o}),Z}return Se(e.data)}get enum(){return this._def.values}};ur.create=(t,e)=>new ur({values:t,typeName:$.ZodNativeEnum,...D(e)});var Zt=class extends q{unwrap(){return this._def.type}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==z.promise&&r.common.async===!1)return k(r,{code:b.invalid_type,expected:z.promise,received:r.parsedType}),Z;let n=r.parsedType===z.promise?r.data:Promise.resolve(r.data);return Se(n.then(o=>this._def.type.parseAsync(o,{path:r.path,errorMap:r.common.contextualErrorMap})))}};Zt.create=(t,e)=>new Zt({type:t,typeName:$.ZodPromise,...D(e)});var Ge=class extends q{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===$.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:r,ctx:n}=this._processInputParams(e),o=this._def.effect||null,s={addIssue:i=>{k(n,i),i.fatal?r.abort():r.dirty()},get path(){return n.path}};if(s.addIssue=s.addIssue.bind(s),o.type==="preprocess"){let i=o.transform(n.data,s);if(n.common.async)return Promise.resolve(i).then(async a=>{if(r.value==="aborted")return Z;let c=await this._def.schema._parseAsync({data:a,path:n.path,parent:n});return c.status==="aborted"?Z:c.status==="dirty"?Xt(c.value):r.value==="dirty"?Xt(c.value):c});{if(r.value==="aborted")return Z;let a=this._def.schema._parseSync({data:i,path:n.path,parent:n});return a.status==="aborted"?Z:a.status==="dirty"?Xt(a.value):r.value==="dirty"?Xt(a.value):a}}if(o.type==="refinement"){let i=a=>{let c=o.refinement(a,s);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(n.common.async===!1){let a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?Z:(a.status==="dirty"&&r.dirty(),i(a.value),{status:r.value,value:a.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>a.status==="aborted"?Z:(a.status==="dirty"&&r.dirty(),i(a.value).then(()=>({status:r.value,value:a.value}))))}if(o.type==="transform")if(n.common.async===!1){let i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Ot(i))return Z;let a=o.transform(i.value,s);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:a}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>Ot(i)?Promise.resolve(o.transform(i.value,s)).then(a=>({status:r.value,value:a})):Z);H.assertNever(o)}};Ge.create=(t,e,r)=>new Ge({schema:t,typeName:$.ZodEffects,effect:e,...D(r)});Ge.createWithPreprocess=(t,e,r)=>new Ge({schema:e,effect:{type:"preprocess",transform:t},typeName:$.ZodEffects,...D(r)});var Ze=class extends q{_parse(e){return this._getType(e)===z.undefined?Se(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Ze.create=(t,e)=>new Ze({innerType:t,typeName:$.ZodOptional,...D(e)});var ft=class extends q{_parse(e){return this._getType(e)===z.null?Se(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};ft.create=(t,e)=>new ft({innerType:t,typeName:$.ZodNullable,...D(e)});var lr=class extends q{_parse(e){let{ctx:r}=this._processInputParams(e),n=r.data;return r.parsedType===z.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}};lr.create=(t,e)=>new lr({innerType:t,typeName:$.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...D(e)});var dr=class extends q{_parse(e){let{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},o=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Or(o)?o.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Ce(n.common.issues)},input:n.data})})):{status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new Ce(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};dr.create=(t,e)=>new dr({innerType:t,typeName:$.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...D(e)});var Mr=class extends q{_parse(e){if(this._getType(e)!==z.nan){let n=this._getOrReturnCtx(e);return k(n,{code:b.invalid_type,expected:z.nan,received:n.parsedType}),Z}return{status:"valid",value:e.data}}};Mr.create=t=>new Mr({typeName:$.ZodNaN,...D(t)});var O_=Symbol("zod_brand"),mn=class extends q{_parse(e){let{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}},hn=class t extends q{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{let s=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?Z:s.status==="dirty"?(r.dirty(),Xt(s.value)):this._def.out._parseAsync({data:s.value,path:n.path,parent:n})})();{let o=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?Z:o.status==="dirty"?(r.dirty(),{status:"dirty",value:o.value}):this._def.out._parseSync({data:o.value,path:n.path,parent:n})}}static create(e,r){return new t({in:e,out:r,typeName:$.ZodPipeline})}},pr=class extends q{_parse(e){let r=this._def.innerType._parse(e),n=o=>(Ot(o)&&(o.value=Object.freeze(o.value)),o);return Or(r)?r.then(o=>n(o)):n(r)}unwrap(){return this._def.innerType}};pr.create=(t,e)=>new pr({innerType:t,typeName:$.ZodReadonly,...D(e)});function nd(t,e){let r=typeof t=="function"?t(e):typeof t=="string"?{message:t}:t;return typeof r=="string"?{message:r}:r}function cd(t,e={},r){return t?Ct.create().superRefine((n,o)=>{let s=t(n);if(s instanceof Promise)return s.then(i=>{if(!i){let a=nd(e,n),c=a.fatal??r??!0;o.addIssue({code:"custom",...a,fatal:c})}});if(!s){let i=nd(e,n),a=i.fatal??r??!0;o.addIssue({code:"custom",...i,fatal:a})}}):Ct.create()}var N_={object:je.lazycreate},$;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})($||($={}));var C_=(t,e={message:`Input not instance of ${t.name}`})=>cd(r=>r instanceof t,e),ud=Nt.create,ld=Yt.create,Z_=Mr.create,j_=Qt.create,dd=er.create,A_=tr.create,M_=Cr.create,D_=rr.create,L_=nr.create,q_=Ct.create,U_=kt.create,F_=rt.create,V_=Zr.create,H_=St.create,vi=je.create,B_=je.strictCreate,K_=or.create,G_=bo.create,J_=sr.create,W_=pt.create,X_=xo.create,Y_=jr.create,Q_=Ar.create,ey=$o.create,ty=ir.create,ry=ar.create,ny=cr.create,oy=ur.create,sy=Zt.create,iy=Ge.create,ay=Ze.create,cy=ft.create,uy=Ge.createWithPreprocess,ly=hn.create,dy=()=>ud().optional(),py=()=>ld().optional(),fy=()=>dd().optional(),my={string:(t=>Nt.create({...t,coerce:!0})),number:(t=>Yt.create({...t,coerce:!0})),boolean:(t=>er.create({...t,coerce:!0})),bigint:(t=>Qt.create({...t,coerce:!0})),date:(t=>tr.create({...t,coerce:!0}))};var hy=Z;var gy=Object.freeze({status:"aborted"});function y(t,e,r){function n(a,c){var u;Object.defineProperty(a,"_zod",{value:a._zod??{},enumerable:!1}),(u=a._zod).traits??(u.traits=new Set),a._zod.traits.add(t),e(a,c);for(let l in i.prototype)l in a||Object.defineProperty(a,l,{value:i.prototype[l].bind(a)});a._zod.constr=i,a._zod.def=c}let o=r?.Parent??Object;class s extends o{}Object.defineProperty(s,"name",{value:t});function i(a){var c;let u=r?.Parent?new s:this;n(u,a),(c=u._zod).deferred??(c.deferred=[]);for(let l of u._zod.deferred)l();return u}return Object.defineProperty(i,"init",{value:n}),Object.defineProperty(i,Symbol.hasInstance,{value:a=>r?.Parent&&a instanceof r.Parent?!0:a?._zod?.traits?.has(t)}),Object.defineProperty(i,"name",{value:t}),i}var zt=class extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}},wo={};function Fe(t){return t&&Object.assign(wo,t),wo}var B={};hi(B,{BIGINT_FORMAT_RANGES:()=>fd,Class:()=>xi,NUMBER_FORMAT_RANGES:()=>Ei,aborted:()=>mr,allowsEval:()=>Si,assert:()=>xy,assertEqual:()=>_y,assertIs:()=>vy,assertNever:()=>by,assertNotEqual:()=>yy,assignProp:()=>ki,cached:()=>yn,captureStackTrace:()=>So,cleanEnum:()=>Cy,cleanRegex:()=>bn,clone:()=>Ve,createTransparentProxy:()=>Ty,defineLazy:()=>ne,esc:()=>fr,escapeRegex:()=>jt,extend:()=>Ry,finalizeIssue:()=>nt,floatSafeRemainder:()=>wi,getElementAtPath:()=>$y,getEnumValues:()=>_n,getLengthableOrigin:()=>xn,getParsedType:()=>zy,getSizableOrigin:()=>md,isObject:()=>Dr,isPlainObject:()=>Lr,issue:()=>Pi,joinValues:()=>ko,jsonStringifyReplacer:()=>$i,merge:()=>Iy,normalizeParams:()=>j,nullish:()=>vn,numKeys:()=>Sy,omit:()=>Py,optionalKeys:()=>Ti,partial:()=>Oy,pick:()=>Ey,prefixIssues:()=>mt,primitiveTypes:()=>pd,promiseAllObject:()=>wy,propertyKeyTypes:()=>zi,randomString:()=>ky,required:()=>Ny,stringifyPrimitive:()=>zo,unwrapMessage:()=>gn});function _y(t){return t}function yy(t){return t}function vy(t){}function by(t){throw new Error}function xy(t){}function _n(t){let e=Object.values(t).filter(n=>typeof n=="number");return Object.entries(t).filter(([n,o])=>e.indexOf(+n)===-1).map(([n,o])=>o)}function ko(t,e="|"){return t.map(r=>zo(r)).join(e)}function $i(t,e){return typeof e=="bigint"?e.toString():e}function yn(t){return{get value(){{let r=t();return Object.defineProperty(this,"value",{value:r}),r}throw new Error("cached value already set")}}}function vn(t){return t==null}function bn(t){let e=t.startsWith("^")?1:0,r=t.endsWith("$")?t.length-1:t.length;return t.slice(e,r)}function wi(t,e){let r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,o=r>n?r:n,s=Number.parseInt(t.toFixed(o).replace(".","")),i=Number.parseInt(e.toFixed(o).replace(".",""));return s%i/10**o}function ne(t,e,r){Object.defineProperty(t,e,{get(){{let o=r();return t[e]=o,o}throw new Error("cached value already set")},set(o){Object.defineProperty(t,e,{value:o})},configurable:!0})}function ki(t,e,r){Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0})}function $y(t,e){return e?e.reduce((r,n)=>r?.[n],t):t}function wy(t){let e=Object.keys(t),r=e.map(n=>t[n]);return Promise.all(r).then(n=>{let o={};for(let s=0;s<e.length;s++)o[e[s]]=n[s];return o})}function ky(t=10){let e="abcdefghijklmnopqrstuvwxyz",r="";for(let n=0;n<t;n++)r+=e[Math.floor(Math.random()*e.length)];return r}function fr(t){return JSON.stringify(t)}var So=Error.captureStackTrace?Error.captureStackTrace:(...t)=>{};function Dr(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}var Si=yn(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{let t=Function;return new t(""),!0}catch{return!1}});function Lr(t){if(Dr(t)===!1)return!1;let e=t.constructor;if(e===void 0)return!0;let r=e.prototype;return!(Dr(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function Sy(t){let e=0;for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}var zy=t=>{let e=typeof t;switch(e){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(t)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":return Array.isArray(t)?"array":t===null?"null":t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?"promise":typeof Map<"u"&&t instanceof Map?"map":typeof Set<"u"&&t instanceof Set?"set":typeof Date<"u"&&t instanceof Date?"date":typeof File<"u"&&t instanceof File?"file":"object";default:throw new Error(`Unknown data type: ${e}`)}},zi=new Set(["string","number","symbol"]),pd=new Set(["string","number","bigint","boolean","symbol","undefined"]);function jt(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ve(t,e,r){let n=new t._zod.constr(e??t._zod.def);return(!e||r?.parent)&&(n._zod.parent=t),n}function j(t){let e=t;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function Ty(t){let e;return new Proxy({},{get(r,n,o){return e??(e=t()),Reflect.get(e,n,o)},set(r,n,o,s){return e??(e=t()),Reflect.set(e,n,o,s)},has(r,n){return e??(e=t()),Reflect.has(e,n)},deleteProperty(r,n){return e??(e=t()),Reflect.deleteProperty(e,n)},ownKeys(r){return e??(e=t()),Reflect.ownKeys(e)},getOwnPropertyDescriptor(r,n){return e??(e=t()),Reflect.getOwnPropertyDescriptor(e,n)},defineProperty(r,n,o){return e??(e=t()),Reflect.defineProperty(e,n,o)}})}function zo(t){return typeof t=="bigint"?t.toString()+"n":typeof t=="string"?`"${t}"`:`${t}`}function Ti(t){return Object.keys(t).filter(e=>t[e]._zod.optin==="optional"&&t[e]._zod.optout==="optional")}var Ei={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},fd={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function Ey(t,e){let r={},n=t._zod.def;for(let o in e){if(!(o in n.shape))throw new Error(`Unrecognized key: "${o}"`);e[o]&&(r[o]=n.shape[o])}return Ve(t,{...t._zod.def,shape:r,checks:[]})}function Py(t,e){let r={...t._zod.def.shape},n=t._zod.def;for(let o in e){if(!(o in n.shape))throw new Error(`Unrecognized key: "${o}"`);e[o]&&delete r[o]}return Ve(t,{...t._zod.def,shape:r,checks:[]})}function Ry(t,e){if(!Lr(e))throw new Error("Invalid input to extend: expected a plain object");let r={...t._zod.def,get shape(){let n={...t._zod.def.shape,...e};return ki(this,"shape",n),n},checks:[]};return Ve(t,r)}function Iy(t,e){return Ve(t,{...t._zod.def,get shape(){let r={...t._zod.def.shape,...e._zod.def.shape};return ki(this,"shape",r),r},catchall:e._zod.def.catchall,checks:[]})}function Oy(t,e,r){let n=e._zod.def.shape,o={...n};if(r)for(let s in r){if(!(s in n))throw new Error(`Unrecognized key: "${s}"`);r[s]&&(o[s]=t?new t({type:"optional",innerType:n[s]}):n[s])}else for(let s in n)o[s]=t?new t({type:"optional",innerType:n[s]}):n[s];return Ve(e,{...e._zod.def,shape:o,checks:[]})}function Ny(t,e,r){let n=e._zod.def.shape,o={...n};if(r)for(let s in r){if(!(s in o))throw new Error(`Unrecognized key: "${s}"`);r[s]&&(o[s]=new t({type:"nonoptional",innerType:n[s]}))}else for(let s in n)o[s]=new t({type:"nonoptional",innerType:n[s]});return Ve(e,{...e._zod.def,shape:o,checks:[]})}function mr(t,e=0){for(let r=e;r<t.issues.length;r++)if(t.issues[r]?.continue!==!0)return!0;return!1}function mt(t,e){return e.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(t),r})}function gn(t){return typeof t=="string"?t:t?.message}function nt(t,e,r){let n={...t,path:t.path??[]};if(!t.message){let o=gn(t.inst?._zod.def?.error?.(t))??gn(e?.error?.(t))??gn(r.customError?.(t))??gn(r.localeError?.(t))??"Invalid input";n.message=o}return delete n.inst,delete n.continue,e?.reportInput||delete n.input,n}function md(t){return t instanceof Set?"set":t instanceof Map?"map":t instanceof File?"file":"unknown"}function xn(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function Pi(...t){let[e,r,n]=t;return typeof e=="string"?{message:e,code:"custom",input:r,inst:n}:{...e}}function Cy(t){return Object.entries(t).filter(([e,r])=>Number.isNaN(Number.parseInt(e,10))).map(e=>e[1])}var xi=class{constructor(...e){}};var hd=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),Object.defineProperty(t,"message",{get(){return JSON.stringify(e,$i,2)},enumerable:!0}),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},To=y("$ZodError",hd),$n=y("$ZodError",hd,{Parent:Error});function Ri(t,e=r=>r.message){let r={},n=[];for(let o of t.issues)o.path.length>0?(r[o.path[0]]=r[o.path[0]]||[],r[o.path[0]].push(e(o))):n.push(e(o));return{formErrors:n,fieldErrors:r}}function Ii(t,e){let r=e||function(s){return s.message},n={_errors:[]},o=s=>{for(let i of s.issues)if(i.code==="invalid_union"&&i.errors.length)i.errors.map(a=>o({issues:a}));else if(i.code==="invalid_key")o({issues:i.issues});else if(i.code==="invalid_element")o({issues:i.issues});else if(i.path.length===0)n._errors.push(r(i));else{let a=n,c=0;for(;c<i.path.length;){let u=i.path[c];c===i.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(r(i))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return o(t),n}var Oi=t=>(e,r,n,o)=>{let s=n?Object.assign(n,{async:!1}):{async:!1},i=e._zod.run({value:r,issues:[]},s);if(i instanceof Promise)throw new zt;if(i.issues.length){let a=new(o?.Err??t)(i.issues.map(c=>nt(c,s,Fe())));throw So(a,o?.callee),a}return i.value},Ni=Oi($n),Ci=t=>async(e,r,n,o)=>{let s=n?Object.assign(n,{async:!0}):{async:!0},i=e._zod.run({value:r,issues:[]},s);if(i instanceof Promise&&(i=await i),i.issues.length){let a=new(o?.Err??t)(i.issues.map(c=>nt(c,s,Fe())));throw So(a,o?.callee),a}return i.value},Zi=Ci($n),ji=t=>(e,r,n)=>{let o=n?{...n,async:!1}:{async:!1},s=e._zod.run({value:r,issues:[]},o);if(s instanceof Promise)throw new zt;return s.issues.length?{success:!1,error:new(t??To)(s.issues.map(i=>nt(i,o,Fe())))}:{success:!0,data:s.value}},hr=ji($n),Ai=t=>async(e,r,n)=>{let o=n?Object.assign(n,{async:!0}):{async:!0},s=e._zod.run({value:r,issues:[]},o);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new t(s.issues.map(i=>nt(i,o,Fe())))}:{success:!0,data:s.value}},gr=Ai($n);var gd=/^[cC][^\s-]{8,}$/,_d=/^[0-9a-z]+$/,yd=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,vd=/^[0-9a-vA-V]{20}$/,bd=/^[A-Za-z0-9]{27}$/,xd=/^[a-zA-Z0-9_-]{21}$/,$d=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/;var wd=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Mi=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/;var kd=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/;var jy="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function Sd(){return new RegExp(jy,"u")}var zd=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Td=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,Ed=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Pd=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Rd=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Di=/^[A-Za-z0-9_-]*$/,Id=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/;var Od=/^\+(?:[0-9]){6,14}[0-9]$/,Nd="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Cd=new RegExp(`^${Nd}$`);function Zd(t){let e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${e}`:t.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function jd(t){return new RegExp(`^${Zd(t)}$`)}function Ad(t){let e=Zd({precision:t.precision}),r=["Z"];t.local&&r.push(""),t.offset&&r.push("([+-]\\d{2}:\\d{2})");let n=`${e}(?:${r.join("|")})`;return new RegExp(`^${Nd}T(?:${n})$`)}var Md=t=>{let e=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)};var Dd=/^\d+$/,Ld=/^-?\d+(?:\.\d+)?/i,qd=/true|false/i,Ud=/null/i;var Fd=/^[^A-Z]*$/,Vd=/^[^a-z]*$/;var ve=y("$ZodCheck",(t,e)=>{var r;t._zod??(t._zod={}),t._zod.def=e,(r=t._zod).onattach??(r.onattach=[])}),Hd={number:"number",bigint:"bigint",object:"date"},Li=y("$ZodCheckLessThan",(t,e)=>{ve.init(t,e);let r=Hd[typeof e.value];t._zod.onattach.push(n=>{let o=n._zod.bag,s=(e.inclusive?o.maximum:o.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<s&&(e.inclusive?o.maximum=e.value:o.exclusiveMaximum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value<=e.value:n.value<e.value)||n.issues.push({origin:r,code:"too_big",maximum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),qi=y("$ZodCheckGreaterThan",(t,e)=>{ve.init(t,e);let r=Hd[typeof e.value];t._zod.onattach.push(n=>{let o=n._zod.bag,s=(e.inclusive?o.minimum:o.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>s&&(e.inclusive?o.minimum=e.value:o.exclusiveMinimum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value>=e.value:n.value>e.value)||n.issues.push({origin:r,code:"too_small",minimum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),Bd=y("$ZodCheckMultipleOf",(t,e)=>{ve.init(t,e),t._zod.onattach.push(r=>{var n;(n=r._zod.bag).multipleOf??(n.multipleOf=e.value)}),t._zod.check=r=>{if(typeof r.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%e.value===BigInt(0):wi(r.value,e.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:e.value,input:r.value,inst:t,continue:!e.abort})}}),Kd=y("$ZodCheckNumberFormat",(t,e)=>{ve.init(t,e),e.format=e.format||"float64";let r=e.format?.includes("int"),n=r?"int":"number",[o,s]=Ei[e.format];t._zod.onattach.push(i=>{let a=i._zod.bag;a.format=e.format,a.minimum=o,a.maximum=s,r&&(a.pattern=Dd)}),t._zod.check=i=>{let a=i.value;if(r){if(!Number.isInteger(a)){i.issues.push({expected:n,format:e.format,code:"invalid_type",input:a,inst:t});return}if(!Number.isSafeInteger(a)){a>0?i.issues.push({input:a,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort}):i.issues.push({input:a,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort});return}}a<o&&i.issues.push({origin:"number",input:a,code:"too_small",minimum:o,inclusive:!0,inst:t,continue:!e.abort}),a>s&&i.issues.push({origin:"number",input:a,code:"too_big",maximum:s,inst:t})}});var Gd=y("$ZodCheckMaxLength",(t,e)=>{var r;ve.init(t,e),(r=t._zod.def).when??(r.when=n=>{let o=n.value;return!vn(o)&&o.length!==void 0}),t._zod.onattach.push(n=>{let o=n._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<o&&(n._zod.bag.maximum=e.maximum)}),t._zod.check=n=>{let o=n.value;if(o.length<=e.maximum)return;let i=xn(o);n.issues.push({origin:i,code:"too_big",maximum:e.maximum,inclusive:!0,input:o,inst:t,continue:!e.abort})}}),Jd=y("$ZodCheckMinLength",(t,e)=>{var r;ve.init(t,e),(r=t._zod.def).when??(r.when=n=>{let o=n.value;return!vn(o)&&o.length!==void 0}),t._zod.onattach.push(n=>{let o=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>o&&(n._zod.bag.minimum=e.minimum)}),t._zod.check=n=>{let o=n.value;if(o.length>=e.minimum)return;let i=xn(o);n.issues.push({origin:i,code:"too_small",minimum:e.minimum,inclusive:!0,input:o,inst:t,continue:!e.abort})}}),Wd=y("$ZodCheckLengthEquals",(t,e)=>{var r;ve.init(t,e),(r=t._zod.def).when??(r.when=n=>{let o=n.value;return!vn(o)&&o.length!==void 0}),t._zod.onattach.push(n=>{let o=n._zod.bag;o.minimum=e.length,o.maximum=e.length,o.length=e.length}),t._zod.check=n=>{let o=n.value,s=o.length;if(s===e.length)return;let i=xn(o),a=s>e.length;n.issues.push({origin:i,...a?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:n.value,inst:t,continue:!e.abort})}}),wn=y("$ZodCheckStringFormat",(t,e)=>{var r,n;ve.init(t,e),t._zod.onattach.push(o=>{let s=o._zod.bag;s.format=e.format,e.pattern&&(s.patterns??(s.patterns=new Set),s.patterns.add(e.pattern))}),e.pattern?(r=t._zod).check??(r.check=o=>{e.pattern.lastIndex=0,!e.pattern.test(o.value)&&o.issues.push({origin:"string",code:"invalid_format",format:e.format,input:o.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(n=t._zod).check??(n.check=()=>{})}),Xd=y("$ZodCheckRegex",(t,e)=>{wn.init(t,e),t._zod.check=r=>{e.pattern.lastIndex=0,!e.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),Yd=y("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=Fd),wn.init(t,e)}),Qd=y("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=Vd),wn.init(t,e)}),ep=y("$ZodCheckIncludes",(t,e)=>{ve.init(t,e);let r=jt(e.includes),n=new RegExp(typeof e.position=="number"?`^.{${e.position}}${r}`:r);e.pattern=n,t._zod.onattach.push(o=>{let s=o._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(n)}),t._zod.check=o=>{o.value.includes(e.includes,e.position)||o.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:o.value,inst:t,continue:!e.abort})}}),tp=y("$ZodCheckStartsWith",(t,e)=>{ve.init(t,e);let r=new RegExp(`^${jt(e.prefix)}.*`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{let o=n._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(r)}),t._zod.check=n=>{n.value.startsWith(e.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:n.value,inst:t,continue:!e.abort})}}),rp=y("$ZodCheckEndsWith",(t,e)=>{ve.init(t,e);let r=new RegExp(`.*${jt(e.suffix)}$`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{let o=n._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(r)}),t._zod.check=n=>{n.value.endsWith(e.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:n.value,inst:t,continue:!e.abort})}});var np=y("$ZodCheckOverwrite",(t,e)=>{ve.init(t,e),t._zod.check=r=>{r.value=e.tx(r.value)}});var Po=class{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}let n=e.split(`
`).filter(i=>i),o=Math.min(...n.map(i=>i.length-i.trimStart().length)),s=n.map(i=>i.slice(o)).map(i=>" ".repeat(this.indent*2)+i);for(let i of s)this.content.push(i)}compile(){let e=Function,r=this?.args,o=[...(this?.content??[""]).map(s=>`  ${s}`)];return new e(...r,o.join(`
`))}};var sp={major:4,minor:0,patch:0};var ee=y("$ZodType",(t,e)=>{var r;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=sp;let n=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&n.unshift(t);for(let o of n)for(let s of o._zod.onattach)s(t);if(n.length===0)(r=t._zod).deferred??(r.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{let o=(s,i,a)=>{let c=mr(s),u;for(let l of i){if(l._zod.def.when){if(!l._zod.def.when(s))continue}else if(c)continue;let d=s.issues.length,m=l._zod.check(s);if(m instanceof Promise&&a?.async===!1)throw new zt;if(u||m instanceof Promise)u=(u??Promise.resolve()).then(async()=>{await m,s.issues.length!==d&&(c||(c=mr(s,d)))});else{if(s.issues.length===d)continue;c||(c=mr(s,d))}}return u?u.then(()=>s):s};t._zod.run=(s,i)=>{let a=t._zod.parse(s,i);if(a instanceof Promise){if(i.async===!1)throw new zt;return a.then(c=>o(c,n,i))}return o(a,n,i)}}t["~standard"]={validate:o=>{try{let s=hr(t,o);return s.success?{value:s.data}:{issues:s.error?.issues}}catch{return gr(t,o).then(i=>i.success?{value:i.data}:{issues:i.error?.issues})}},vendor:"zod",version:1}}),kn=y("$ZodString",(t,e)=>{ee.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??Md(t._zod.bag),t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:t}),r}}),oe=y("$ZodStringFormat",(t,e)=>{wn.init(t,e),kn.init(t,e)}),Fi=y("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=wd),oe.init(t,e)}),Vi=y("$ZodUUID",(t,e)=>{if(e.version){let n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(n===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=Mi(n))}else e.pattern??(e.pattern=Mi());oe.init(t,e)}),Hi=y("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=kd),oe.init(t,e)}),Bi=y("$ZodURL",(t,e)=>{oe.init(t,e),t._zod.check=r=>{try{let n=r.value,o=new URL(n),s=o.href;e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(o.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:Id.source,input:r.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(o.protocol.endsWith(":")?o.protocol.slice(0,-1):o.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:r.value,inst:t,continue:!e.abort})),!n.endsWith("/")&&s.endsWith("/")?r.value=s.slice(0,-1):r.value=s;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:t,continue:!e.abort})}}}),Ki=y("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=Sd()),oe.init(t,e)}),Gi=y("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=xd),oe.init(t,e)}),Ji=y("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=gd),oe.init(t,e)}),Wi=y("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=_d),oe.init(t,e)}),Xi=y("$ZodULID",(t,e)=>{e.pattern??(e.pattern=yd),oe.init(t,e)}),Yi=y("$ZodXID",(t,e)=>{e.pattern??(e.pattern=vd),oe.init(t,e)}),Qi=y("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=bd),oe.init(t,e)}),hp=y("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=Ad(e)),oe.init(t,e)}),gp=y("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=Cd),oe.init(t,e)}),_p=y("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=jd(e)),oe.init(t,e)}),yp=y("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=$d),oe.init(t,e)}),ea=y("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=zd),oe.init(t,e),t._zod.onattach.push(r=>{let n=r._zod.bag;n.format="ipv4"})}),ta=y("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=Td),oe.init(t,e),t._zod.onattach.push(r=>{let n=r._zod.bag;n.format="ipv6"}),t._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:t,continue:!e.abort})}}}),ra=y("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=Ed),oe.init(t,e)}),na=y("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=Pd),oe.init(t,e),t._zod.check=r=>{let[n,o]=r.value.split("/");try{if(!o)throw new Error;let s=Number(o);if(`${s}`!==o)throw new Error;if(s<0||s>128)throw new Error;new URL(`http://[${n}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:t,continue:!e.abort})}}});function vp(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}var oa=y("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=Rd),oe.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64"}),t._zod.check=r=>{vp(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:t,continue:!e.abort})}});function Ay(t){if(!Di.test(t))return!1;let e=t.replace(/[-_]/g,n=>n==="-"?"+":"/"),r=e.padEnd(Math.ceil(e.length/4)*4,"=");return vp(r)}var sa=y("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=Di),oe.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64url"}),t._zod.check=r=>{Ay(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:t,continue:!e.abort})}}),ia=y("$ZodE164",(t,e)=>{e.pattern??(e.pattern=Od),oe.init(t,e)});function My(t,e=null){try{let r=t.split(".");if(r.length!==3)return!1;let[n]=r;if(!n)return!1;let o=JSON.parse(atob(n));return!("typ"in o&&o?.typ!=="JWT"||!o.alg||e&&(!("alg"in o)||o.alg!==e))}catch{return!1}}var aa=y("$ZodJWT",(t,e)=>{oe.init(t,e),t._zod.check=r=>{My(r.value,e.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:t,continue:!e.abort})}});var Io=y("$ZodNumber",(t,e)=>{ee.init(t,e),t._zod.pattern=t._zod.bag.pattern??Ld,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=Number(r.value)}catch{}let o=r.value;if(typeof o=="number"&&!Number.isNaN(o)&&Number.isFinite(o))return r;let s=typeof o=="number"?Number.isNaN(o)?"NaN":Number.isFinite(o)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:o,inst:t,...s?{received:s}:{}}),r}}),ca=y("$ZodNumber",(t,e)=>{Kd.init(t,e),Io.init(t,e)}),ua=y("$ZodBoolean",(t,e)=>{ee.init(t,e),t._zod.pattern=qd,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=!!r.value}catch{}let o=r.value;return typeof o=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:o,inst:t}),r}});var la=y("$ZodNull",(t,e)=>{ee.init(t,e),t._zod.pattern=Ud,t._zod.values=new Set([null]),t._zod.parse=(r,n)=>{let o=r.value;return o===null||r.issues.push({expected:"null",code:"invalid_type",input:o,inst:t}),r}});var da=y("$ZodUnknown",(t,e)=>{ee.init(t,e),t._zod.parse=r=>r}),pa=y("$ZodNever",(t,e)=>{ee.init(t,e),t._zod.parse=(r,n)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:t}),r)});function ip(t,e,r){t.issues.length&&e.issues.push(...mt(r,t.issues)),e.value[r]=t.value}var fa=y("$ZodArray",(t,e)=>{ee.init(t,e),t._zod.parse=(r,n)=>{let o=r.value;if(!Array.isArray(o))return r.issues.push({expected:"array",code:"invalid_type",input:o,inst:t}),r;r.value=Array(o.length);let s=[];for(let i=0;i<o.length;i++){let a=o[i],c=e.element._zod.run({value:a,issues:[]},n);c instanceof Promise?s.push(c.then(u=>ip(u,r,i))):ip(c,r,i)}return s.length?Promise.all(s).then(()=>r):r}});function Ro(t,e,r){t.issues.length&&e.issues.push(...mt(r,t.issues)),e.value[r]=t.value}function ap(t,e,r,n){t.issues.length?n[r]===void 0?r in n?e.value[r]=void 0:e.value[r]=t.value:e.issues.push(...mt(r,t.issues)):t.value===void 0?r in n&&(e.value[r]=void 0):e.value[r]=t.value}var Oo=y("$ZodObject",(t,e)=>{ee.init(t,e);let r=yn(()=>{let d=Object.keys(e.shape);for(let f of d)if(!(e.shape[f]instanceof ee))throw new Error(`Invalid element at key "${f}": expected a Zod schema`);let m=Ti(e.shape);return{shape:e.shape,keys:d,keySet:new Set(d),numKeys:d.length,optionalKeys:new Set(m)}});ne(t._zod,"propValues",()=>{let d=e.shape,m={};for(let f in d){let p=d[f]._zod;if(p.values){m[f]??(m[f]=new Set);for(let h of p.values)m[f].add(h)}}return m});let n=d=>{let m=new Po(["shape","payload","ctx"]),f=r.value,p=x=>{let w=fr(x);return`shape[${w}]._zod.run({ value: input[${w}], issues: [] }, ctx)`};m.write("const input = payload.value;");let h=Object.create(null),g=0;for(let x of f.keys)h[x]=`key_${g++}`;m.write("const newResult = {}");for(let x of f.keys)if(f.optionalKeys.has(x)){let w=h[x];m.write(`const ${w} = ${p(x)};`);let E=fr(x);m.write(`
        if (${w}.issues.length) {
          if (input[${E}] === undefined) {
            if (${E} in input) {
              newResult[${E}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${w}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${E}, ...iss.path] : [${E}],
              }))
            );
          }
        } else if (${w}.value === undefined) {
          if (${E} in input) newResult[${E}] = undefined;
        } else {
          newResult[${E}] = ${w}.value;
        }
        `)}else{let w=h[x];m.write(`const ${w} = ${p(x)};`),m.write(`
          if (${w}.issues.length) payload.issues = payload.issues.concat(${w}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${fr(x)}, ...iss.path] : [${fr(x)}]
          })));`),m.write(`newResult[${fr(x)}] = ${w}.value`)}m.write("payload.value = newResult;"),m.write("return payload;");let v=m.compile();return(x,w)=>v(d,x,w)},o,s=Dr,i=!wo.jitless,c=i&&Si.value,u=e.catchall,l;t._zod.parse=(d,m)=>{l??(l=r.value);let f=d.value;if(!s(f))return d.issues.push({expected:"object",code:"invalid_type",input:f,inst:t}),d;let p=[];if(i&&c&&m?.async===!1&&m.jitless!==!0)o||(o=n(e.shape)),d=o(d,m);else{d.value={};let w=l.shape;for(let E of l.keys){let C=w[E],Pe=C._zod.run({value:f[E],issues:[]},m),Be=C._zod.optin==="optional"&&C._zod.optout==="optional";Pe instanceof Promise?p.push(Pe.then(Rr=>Be?ap(Rr,d,E,f):Ro(Rr,d,E))):Be?ap(Pe,d,E,f):Ro(Pe,d,E)}}if(!u)return p.length?Promise.all(p).then(()=>d):d;let h=[],g=l.keySet,v=u._zod,x=v.def.type;for(let w of Object.keys(f)){if(g.has(w))continue;if(x==="never"){h.push(w);continue}let E=v.run({value:f[w],issues:[]},m);E instanceof Promise?p.push(E.then(C=>Ro(C,d,w))):Ro(E,d,w)}return h.length&&d.issues.push({code:"unrecognized_keys",keys:h,input:f,inst:t}),p.length?Promise.all(p).then(()=>d):d}});function cp(t,e,r,n){for(let o of t)if(o.issues.length===0)return e.value=o.value,e;return e.issues.push({code:"invalid_union",input:e.value,inst:r,errors:t.map(o=>o.issues.map(s=>nt(s,n,Fe())))}),e}var No=y("$ZodUnion",(t,e)=>{ee.init(t,e),ne(t._zod,"optin",()=>e.options.some(r=>r._zod.optin==="optional")?"optional":void 0),ne(t._zod,"optout",()=>e.options.some(r=>r._zod.optout==="optional")?"optional":void 0),ne(t._zod,"values",()=>{if(e.options.every(r=>r._zod.values))return new Set(e.options.flatMap(r=>Array.from(r._zod.values)))}),ne(t._zod,"pattern",()=>{if(e.options.every(r=>r._zod.pattern)){let r=e.options.map(n=>n._zod.pattern);return new RegExp(`^(${r.map(n=>bn(n.source)).join("|")})$`)}}),t._zod.parse=(r,n)=>{let o=!1,s=[];for(let i of e.options){let a=i._zod.run({value:r.value,issues:[]},n);if(a instanceof Promise)s.push(a),o=!0;else{if(a.issues.length===0)return a;s.push(a)}}return o?Promise.all(s).then(i=>cp(i,r,t,n)):cp(s,r,t,n)}}),ma=y("$ZodDiscriminatedUnion",(t,e)=>{No.init(t,e);let r=t._zod.parse;ne(t._zod,"propValues",()=>{let o={};for(let s of e.options){let i=s._zod.propValues;if(!i||Object.keys(i).length===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(s)}"`);for(let[a,c]of Object.entries(i)){o[a]||(o[a]=new Set);for(let u of c)o[a].add(u)}}return o});let n=yn(()=>{let o=e.options,s=new Map;for(let i of o){let a=i._zod.propValues[e.discriminator];if(!a||a.size===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(i)}"`);for(let c of a){if(s.has(c))throw new Error(`Duplicate discriminator value "${String(c)}"`);s.set(c,i)}}return s});t._zod.parse=(o,s)=>{let i=o.value;if(!Dr(i))return o.issues.push({code:"invalid_type",expected:"object",input:i,inst:t}),o;let a=n.value.get(i?.[e.discriminator]);return a?a._zod.run(o,s):e.unionFallback?r(o,s):(o.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:i,path:[e.discriminator],inst:t}),o)}}),ha=y("$ZodIntersection",(t,e)=>{ee.init(t,e),t._zod.parse=(r,n)=>{let o=r.value,s=e.left._zod.run({value:o,issues:[]},n),i=e.right._zod.run({value:o,issues:[]},n);return s instanceof Promise||i instanceof Promise?Promise.all([s,i]).then(([c,u])=>up(r,c,u)):up(r,s,i)}});function Ui(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t==+e)return{valid:!0,data:t};if(Lr(t)&&Lr(e)){let r=Object.keys(e),n=Object.keys(t).filter(s=>r.indexOf(s)!==-1),o={...t,...e};for(let s of n){let i=Ui(t[s],e[s]);if(!i.valid)return{valid:!1,mergeErrorPath:[s,...i.mergeErrorPath]};o[s]=i.data}return{valid:!0,data:o}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};let r=[];for(let n=0;n<t.length;n++){let o=t[n],s=e[n],i=Ui(o,s);if(!i.valid)return{valid:!1,mergeErrorPath:[n,...i.mergeErrorPath]};r.push(i.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function up(t,e,r){if(e.issues.length&&t.issues.push(...e.issues),r.issues.length&&t.issues.push(...r.issues),mr(t))return t;let n=Ui(e.value,r.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return t.value=n.data,t}var ga=y("$ZodRecord",(t,e)=>{ee.init(t,e),t._zod.parse=(r,n)=>{let o=r.value;if(!Lr(o))return r.issues.push({expected:"record",code:"invalid_type",input:o,inst:t}),r;let s=[];if(e.keyType._zod.values){let i=e.keyType._zod.values;r.value={};for(let c of i)if(typeof c=="string"||typeof c=="number"||typeof c=="symbol"){let u=e.valueType._zod.run({value:o[c],issues:[]},n);u instanceof Promise?s.push(u.then(l=>{l.issues.length&&r.issues.push(...mt(c,l.issues)),r.value[c]=l.value})):(u.issues.length&&r.issues.push(...mt(c,u.issues)),r.value[c]=u.value)}let a;for(let c in o)i.has(c)||(a=a??[],a.push(c));a&&a.length>0&&r.issues.push({code:"unrecognized_keys",input:o,inst:t,keys:a})}else{r.value={};for(let i of Reflect.ownKeys(o)){if(i==="__proto__")continue;let a=e.keyType._zod.run({value:i,issues:[]},n);if(a instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(a.issues.length){r.issues.push({origin:"record",code:"invalid_key",issues:a.issues.map(u=>nt(u,n,Fe())),input:i,path:[i],inst:t}),r.value[a.value]=a.value;continue}let c=e.valueType._zod.run({value:o[i],issues:[]},n);c instanceof Promise?s.push(c.then(u=>{u.issues.length&&r.issues.push(...mt(i,u.issues)),r.value[a.value]=u.value})):(c.issues.length&&r.issues.push(...mt(i,c.issues)),r.value[a.value]=c.value)}}return s.length?Promise.all(s).then(()=>r):r}});var _a=y("$ZodEnum",(t,e)=>{ee.init(t,e);let r=_n(e.entries);t._zod.values=new Set(r),t._zod.pattern=new RegExp(`^(${r.filter(n=>zi.has(typeof n)).map(n=>typeof n=="string"?jt(n):n.toString()).join("|")})$`),t._zod.parse=(n,o)=>{let s=n.value;return t._zod.values.has(s)||n.issues.push({code:"invalid_value",values:r,input:s,inst:t}),n}}),ya=y("$ZodLiteral",(t,e)=>{ee.init(t,e),t._zod.values=new Set(e.values),t._zod.pattern=new RegExp(`^(${e.values.map(r=>typeof r=="string"?jt(r):r?r.toString():String(r)).join("|")})$`),t._zod.parse=(r,n)=>{let o=r.value;return t._zod.values.has(o)||r.issues.push({code:"invalid_value",values:e.values,input:o,inst:t}),r}});var va=y("$ZodTransform",(t,e)=>{ee.init(t,e),t._zod.parse=(r,n)=>{let o=e.transform(r.value,r);if(n.async)return(o instanceof Promise?o:Promise.resolve(o)).then(i=>(r.value=i,r));if(o instanceof Promise)throw new zt;return r.value=o,r}}),ba=y("$ZodOptional",(t,e)=>{ee.init(t,e),t._zod.optin="optional",t._zod.optout="optional",ne(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),ne(t._zod,"pattern",()=>{let r=e.innerType._zod.pattern;return r?new RegExp(`^(${bn(r.source)})?$`):void 0}),t._zod.parse=(r,n)=>e.innerType._zod.optin==="optional"?e.innerType._zod.run(r,n):r.value===void 0?r:e.innerType._zod.run(r,n)}),xa=y("$ZodNullable",(t,e)=>{ee.init(t,e),ne(t._zod,"optin",()=>e.innerType._zod.optin),ne(t._zod,"optout",()=>e.innerType._zod.optout),ne(t._zod,"pattern",()=>{let r=e.innerType._zod.pattern;return r?new RegExp(`^(${bn(r.source)}|null)$`):void 0}),ne(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(r,n)=>r.value===null?r:e.innerType._zod.run(r,n)}),$a=y("$ZodDefault",(t,e)=>{ee.init(t,e),t._zod.optin="optional",ne(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{if(r.value===void 0)return r.value=e.defaultValue,r;let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>lp(s,e)):lp(o,e)}});function lp(t,e){return t.value===void 0&&(t.value=e.defaultValue),t}var wa=y("$ZodPrefault",(t,e)=>{ee.init(t,e),t._zod.optin="optional",ne(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>(r.value===void 0&&(r.value=e.defaultValue),e.innerType._zod.run(r,n))}),ka=y("$ZodNonOptional",(t,e)=>{ee.init(t,e),ne(t._zod,"values",()=>{let r=e.innerType._zod.values;return r?new Set([...r].filter(n=>n!==void 0)):void 0}),t._zod.parse=(r,n)=>{let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>dp(s,t)):dp(o,t)}});function dp(t,e){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}var Sa=y("$ZodCatch",(t,e)=>{ee.init(t,e),t._zod.optin="optional",ne(t._zod,"optout",()=>e.innerType._zod.optout),ne(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>(r.value=s.value,s.issues.length&&(r.value=e.catchValue({...r,error:{issues:s.issues.map(i=>nt(i,n,Fe()))},input:r.value}),r.issues=[]),r)):(r.value=o.value,o.issues.length&&(r.value=e.catchValue({...r,error:{issues:o.issues.map(s=>nt(s,n,Fe()))},input:r.value}),r.issues=[]),r)}});var za=y("$ZodPipe",(t,e)=>{ee.init(t,e),ne(t._zod,"values",()=>e.in._zod.values),ne(t._zod,"optin",()=>e.in._zod.optin),ne(t._zod,"optout",()=>e.out._zod.optout),t._zod.parse=(r,n)=>{let o=e.in._zod.run(r,n);return o instanceof Promise?o.then(s=>pp(s,e,n)):pp(o,e,n)}});function pp(t,e,r){return mr(t)?t:e.out._zod.run({value:t.value,issues:t.issues},r)}var Ta=y("$ZodReadonly",(t,e)=>{ee.init(t,e),ne(t._zod,"propValues",()=>e.innerType._zod.propValues),ne(t._zod,"values",()=>e.innerType._zod.values),ne(t._zod,"optin",()=>e.innerType._zod.optin),ne(t._zod,"optout",()=>e.innerType._zod.optout),t._zod.parse=(r,n)=>{let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(fp):fp(o)}});function fp(t){return t.value=Object.freeze(t.value),t}var Ea=y("$ZodCustom",(t,e)=>{ve.init(t,e),ee.init(t,e),t._zod.parse=(r,n)=>r,t._zod.check=r=>{let n=r.value,o=e.fn(n);if(o instanceof Promise)return o.then(s=>mp(s,r,n,t));mp(o,r,n,t)}});function mp(t,e,r,n){if(!t){let o={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(o.params=n._zod.def.params),e.issues.push(Pi(o))}}var Dy=t=>{let e=typeof t;switch(e){case"number":return Number.isNaN(t)?"NaN":"number";case"object":{if(Array.isArray(t))return"array";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return e},Ly=()=>{let t={string:{unit:"characters",verb:"to have"},file:{unit:"bytes",verb:"to have"},array:{unit:"items",verb:"to have"},set:{unit:"items",verb:"to have"}};function e(n){return t[n]??null}let r={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"};return n=>{switch(n.code){case"invalid_type":return`Invalid input: expected ${n.expected}, received ${Dy(n.input)}`;case"invalid_value":return n.values.length===1?`Invalid input: expected ${zo(n.values[0])}`:`Invalid option: expected one of ${ko(n.values,"|")}`;case"too_big":{let o=n.inclusive?"<=":"<",s=e(n.origin);return s?`Too big: expected ${n.origin??"value"} to have ${o}${n.maximum.toString()} ${s.unit??"elements"}`:`Too big: expected ${n.origin??"value"} to be ${o}${n.maximum.toString()}`}case"too_small":{let o=n.inclusive?">=":">",s=e(n.origin);return s?`Too small: expected ${n.origin} to have ${o}${n.minimum.toString()} ${s.unit}`:`Too small: expected ${n.origin} to be ${o}${n.minimum.toString()}`}case"invalid_format":{let o=n;return o.format==="starts_with"?`Invalid string: must start with "${o.prefix}"`:o.format==="ends_with"?`Invalid string: must end with "${o.suffix}"`:o.format==="includes"?`Invalid string: must include "${o.includes}"`:o.format==="regex"?`Invalid string: must match pattern ${o.pattern}`:`Invalid ${r[o.format]??n.format}`}case"not_multiple_of":return`Invalid number: must be a multiple of ${n.divisor}`;case"unrecognized_keys":return`Unrecognized key${n.keys.length>1?"s":""}: ${ko(n.keys,", ")}`;case"invalid_key":return`Invalid key in ${n.origin}`;case"invalid_union":return"Invalid input";case"invalid_element":return`Invalid value in ${n.origin}`;default:return"Invalid input"}}};function bp(){return{localeError:Ly()}}var Sn=class{constructor(){this._map=new Map,this._idmap=new Map}add(e,...r){let n=r[0];if(this._map.set(e,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){let r=this._map.get(e);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(e),this}get(e){let r=e._zod.parent;if(r){let n={...this.get(r)??{}};return delete n.id,{...n,...this._map.get(e)}}return this._map.get(e)}has(e){return this._map.has(e)}};function xp(){return new Sn}var At=xp();function Pa(t,e){return new t({type:"string",...j(e)})}function Ra(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,...j(e)})}function Co(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...j(e)})}function Ia(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...j(e)})}function Oa(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...j(e)})}function Na(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...j(e)})}function Ca(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...j(e)})}function Za(t,e){return new t({type:"string",format:"url",check:"string_format",abort:!1,...j(e)})}function ja(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...j(e)})}function Aa(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...j(e)})}function Ma(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...j(e)})}function Da(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...j(e)})}function La(t,e){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...j(e)})}function qa(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...j(e)})}function Ua(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...j(e)})}function Fa(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...j(e)})}function Va(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...j(e)})}function Ha(t,e){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...j(e)})}function Ba(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...j(e)})}function Ka(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...j(e)})}function Ga(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...j(e)})}function Ja(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...j(e)})}function Wa(t,e){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...j(e)})}function $p(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...j(e)})}function wp(t,e){return new t({type:"string",format:"date",check:"string_format",...j(e)})}function kp(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,...j(e)})}function Sp(t,e){return new t({type:"string",format:"duration",check:"string_format",...j(e)})}function Xa(t,e){return new t({type:"number",checks:[],...j(e)})}function Ya(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...j(e)})}function Qa(t,e){return new t({type:"boolean",...j(e)})}function ec(t,e){return new t({type:"null",...j(e)})}function tc(t){return new t({type:"unknown"})}function rc(t,e){return new t({type:"never",...j(e)})}function Zo(t,e){return new Li({check:"less_than",...j(e),value:t,inclusive:!1})}function zn(t,e){return new Li({check:"less_than",...j(e),value:t,inclusive:!0})}function jo(t,e){return new qi({check:"greater_than",...j(e),value:t,inclusive:!1})}function Tn(t,e){return new qi({check:"greater_than",...j(e),value:t,inclusive:!0})}function Ao(t,e){return new Bd({check:"multiple_of",...j(e),value:t})}function Mo(t,e){return new Gd({check:"max_length",...j(e),maximum:t})}function qr(t,e){return new Jd({check:"min_length",...j(e),minimum:t})}function Do(t,e){return new Wd({check:"length_equals",...j(e),length:t})}function nc(t,e){return new Xd({check:"string_format",format:"regex",...j(e),pattern:t})}function oc(t){return new Yd({check:"string_format",format:"lowercase",...j(t)})}function sc(t){return new Qd({check:"string_format",format:"uppercase",...j(t)})}function ic(t,e){return new ep({check:"string_format",format:"includes",...j(e),includes:t})}function ac(t,e){return new tp({check:"string_format",format:"starts_with",...j(e),prefix:t})}function cc(t,e){return new rp({check:"string_format",format:"ends_with",...j(e),suffix:t})}function _r(t){return new np({check:"overwrite",tx:t})}function uc(t){return _r(e=>e.normalize(t))}function lc(){return _r(t=>t.trim())}function dc(){return _r(t=>t.toLowerCase())}function pc(){return _r(t=>t.toUpperCase())}function zp(t,e,r){return new t({type:"array",element:e,...j(r)})}function fc(t,e,r){let n=j(r);return n.abort??(n.abort=!0),new t({type:"custom",check:"custom",fn:e,...n})}function mc(t,e,r){return new t({type:"custom",check:"custom",fn:e,...j(r)})}var Lo=class{constructor(e){this.counter=0,this.metadataRegistry=e?.metadata??At,this.target=e?.target??"draft-2020-12",this.unrepresentable=e?.unrepresentable??"throw",this.override=e?.override??(()=>{}),this.io=e?.io??"output",this.seen=new Map}process(e,r={path:[],schemaPath:[]}){var n;let o=e._zod.def,s={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},i=this.seen.get(e);if(i)return i.count++,r.schemaPath.includes(e)&&(i.cycle=r.path),i.schema;let a={schema:{},count:1,cycle:void 0,path:r.path};this.seen.set(e,a);let c=e._zod.toJSONSchema?.();if(c)a.schema=c;else{let d={...r,schemaPath:[...r.schemaPath,e],path:r.path},m=e._zod.parent;if(m)a.ref=m,this.process(m,d),this.seen.get(m).isParent=!0;else{let f=a.schema;switch(o.type){case"string":{let p=f;p.type="string";let{minimum:h,maximum:g,format:v,patterns:x,contentEncoding:w}=e._zod.bag;if(typeof h=="number"&&(p.minLength=h),typeof g=="number"&&(p.maxLength=g),v&&(p.format=s[v]??v,p.format===""&&delete p.format),w&&(p.contentEncoding=w),x&&x.size>0){let E=[...x];E.length===1?p.pattern=E[0].source:E.length>1&&(a.schema.allOf=[...E.map(C=>({...this.target==="draft-7"?{type:"string"}:{},pattern:C.source}))])}break}case"number":{let p=f,{minimum:h,maximum:g,format:v,multipleOf:x,exclusiveMaximum:w,exclusiveMinimum:E}=e._zod.bag;typeof v=="string"&&v.includes("int")?p.type="integer":p.type="number",typeof E=="number"&&(p.exclusiveMinimum=E),typeof h=="number"&&(p.minimum=h,typeof E=="number"&&(E>=h?delete p.minimum:delete p.exclusiveMinimum)),typeof w=="number"&&(p.exclusiveMaximum=w),typeof g=="number"&&(p.maximum=g,typeof w=="number"&&(w<=g?delete p.maximum:delete p.exclusiveMaximum)),typeof x=="number"&&(p.multipleOf=x);break}case"boolean":{let p=f;p.type="boolean";break}case"bigint":{if(this.unrepresentable==="throw")throw new Error("BigInt cannot be represented in JSON Schema");break}case"symbol":{if(this.unrepresentable==="throw")throw new Error("Symbols cannot be represented in JSON Schema");break}case"null":{f.type="null";break}case"any":break;case"unknown":break;case"undefined":{if(this.unrepresentable==="throw")throw new Error("Undefined cannot be represented in JSON Schema");break}case"void":{if(this.unrepresentable==="throw")throw new Error("Void cannot be represented in JSON Schema");break}case"never":{f.not={};break}case"date":{if(this.unrepresentable==="throw")throw new Error("Date cannot be represented in JSON Schema");break}case"array":{let p=f,{minimum:h,maximum:g}=e._zod.bag;typeof h=="number"&&(p.minItems=h),typeof g=="number"&&(p.maxItems=g),p.type="array",p.items=this.process(o.element,{...d,path:[...d.path,"items"]});break}case"object":{let p=f;p.type="object",p.properties={};let h=o.shape;for(let x in h)p.properties[x]=this.process(h[x],{...d,path:[...d.path,"properties",x]});let g=new Set(Object.keys(h)),v=new Set([...g].filter(x=>{let w=o.shape[x]._zod;return this.io==="input"?w.optin===void 0:w.optout===void 0}));v.size>0&&(p.required=Array.from(v)),o.catchall?._zod.def.type==="never"?p.additionalProperties=!1:o.catchall?o.catchall&&(p.additionalProperties=this.process(o.catchall,{...d,path:[...d.path,"additionalProperties"]})):this.io==="output"&&(p.additionalProperties=!1);break}case"union":{let p=f;p.anyOf=o.options.map((h,g)=>this.process(h,{...d,path:[...d.path,"anyOf",g]}));break}case"intersection":{let p=f,h=this.process(o.left,{...d,path:[...d.path,"allOf",0]}),g=this.process(o.right,{...d,path:[...d.path,"allOf",1]}),v=w=>"allOf"in w&&Object.keys(w).length===1,x=[...v(h)?h.allOf:[h],...v(g)?g.allOf:[g]];p.allOf=x;break}case"tuple":{let p=f;p.type="array";let h=o.items.map((x,w)=>this.process(x,{...d,path:[...d.path,"prefixItems",w]}));if(this.target==="draft-2020-12"?p.prefixItems=h:p.items=h,o.rest){let x=this.process(o.rest,{...d,path:[...d.path,"items"]});this.target==="draft-2020-12"?p.items=x:p.additionalItems=x}o.rest&&(p.items=this.process(o.rest,{...d,path:[...d.path,"items"]}));let{minimum:g,maximum:v}=e._zod.bag;typeof g=="number"&&(p.minItems=g),typeof v=="number"&&(p.maxItems=v);break}case"record":{let p=f;p.type="object",p.propertyNames=this.process(o.keyType,{...d,path:[...d.path,"propertyNames"]}),p.additionalProperties=this.process(o.valueType,{...d,path:[...d.path,"additionalProperties"]});break}case"map":{if(this.unrepresentable==="throw")throw new Error("Map cannot be represented in JSON Schema");break}case"set":{if(this.unrepresentable==="throw")throw new Error("Set cannot be represented in JSON Schema");break}case"enum":{let p=f,h=_n(o.entries);h.every(g=>typeof g=="number")&&(p.type="number"),h.every(g=>typeof g=="string")&&(p.type="string"),p.enum=h;break}case"literal":{let p=f,h=[];for(let g of o.values)if(g===void 0){if(this.unrepresentable==="throw")throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof g=="bigint"){if(this.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");h.push(Number(g))}else h.push(g);if(h.length!==0)if(h.length===1){let g=h[0];p.type=g===null?"null":typeof g,p.const=g}else h.every(g=>typeof g=="number")&&(p.type="number"),h.every(g=>typeof g=="string")&&(p.type="string"),h.every(g=>typeof g=="boolean")&&(p.type="string"),h.every(g=>g===null)&&(p.type="null"),p.enum=h;break}case"file":{let p=f,h={type:"string",format:"binary",contentEncoding:"binary"},{minimum:g,maximum:v,mime:x}=e._zod.bag;g!==void 0&&(h.minLength=g),v!==void 0&&(h.maxLength=v),x?x.length===1?(h.contentMediaType=x[0],Object.assign(p,h)):p.anyOf=x.map(w=>({...h,contentMediaType:w})):Object.assign(p,h);break}case"transform":{if(this.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema");break}case"nullable":{let p=this.process(o.innerType,d);f.anyOf=[p,{type:"null"}];break}case"nonoptional":{this.process(o.innerType,d),a.ref=o.innerType;break}case"success":{let p=f;p.type="boolean";break}case"default":{this.process(o.innerType,d),a.ref=o.innerType,f.default=JSON.parse(JSON.stringify(o.defaultValue));break}case"prefault":{this.process(o.innerType,d),a.ref=o.innerType,this.io==="input"&&(f._prefault=JSON.parse(JSON.stringify(o.defaultValue)));break}case"catch":{this.process(o.innerType,d),a.ref=o.innerType;let p;try{p=o.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}f.default=p;break}case"nan":{if(this.unrepresentable==="throw")throw new Error("NaN cannot be represented in JSON Schema");break}case"template_literal":{let p=f,h=e._zod.pattern;if(!h)throw new Error("Pattern not found in template literal");p.type="string",p.pattern=h.source;break}case"pipe":{let p=this.io==="input"?o.in._zod.def.type==="transform"?o.out:o.in:o.out;this.process(p,d),a.ref=p;break}case"readonly":{this.process(o.innerType,d),a.ref=o.innerType,f.readOnly=!0;break}case"promise":{this.process(o.innerType,d),a.ref=o.innerType;break}case"optional":{this.process(o.innerType,d),a.ref=o.innerType;break}case"lazy":{let p=e._zod.innerType;this.process(p,d),a.ref=p;break}case"custom":{if(this.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema");break}default:}}}let u=this.metadataRegistry.get(e);return u&&Object.assign(a.schema,u),this.io==="input"&&ge(e)&&(delete a.schema.examples,delete a.schema.default),this.io==="input"&&a.schema._prefault&&((n=a.schema).default??(n.default=a.schema._prefault)),delete a.schema._prefault,this.seen.get(e).schema}emit(e,r){let n={cycles:r?.cycles??"ref",reused:r?.reused??"inline",external:r?.external??void 0},o=this.seen.get(e);if(!o)throw new Error("Unprocessed schema. This is a bug in Zod.");let s=l=>{let d=this.target==="draft-2020-12"?"$defs":"definitions";if(n.external){let h=n.external.registry.get(l[0])?.id,g=n.external.uri??(x=>x);if(h)return{ref:g(h)};let v=l[1].defId??l[1].schema.id??`schema${this.counter++}`;return l[1].defId=v,{defId:v,ref:`${g("__shared")}#/${d}/${v}`}}if(l[1]===o)return{ref:"#"};let f=`#/${d}/`,p=l[1].schema.id??`__schema${this.counter++}`;return{defId:p,ref:f+p}},i=l=>{if(l[1].schema.$ref)return;let d=l[1],{ref:m,defId:f}=s(l);d.def={...d.schema},f&&(d.defId=f);let p=d.schema;for(let h in p)delete p[h];p.$ref=m};if(n.cycles==="throw")for(let l of this.seen.entries()){let d=l[1];if(d.cycle)throw new Error(`Cycle detected: #/${d.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(let l of this.seen.entries()){let d=l[1];if(e===l[0]){i(l);continue}if(n.external){let f=n.external.registry.get(l[0])?.id;if(e!==l[0]&&f){i(l);continue}}if(this.metadataRegistry.get(l[0])?.id){i(l);continue}if(d.cycle){i(l);continue}if(d.count>1&&n.reused==="ref"){i(l);continue}}let a=(l,d)=>{let m=this.seen.get(l),f=m.def??m.schema,p={...f};if(m.ref===null)return;let h=m.ref;if(m.ref=null,h){a(h,d);let g=this.seen.get(h).schema;g.$ref&&d.target==="draft-7"?(f.allOf=f.allOf??[],f.allOf.push(g)):(Object.assign(f,g),Object.assign(f,p))}m.isParent||this.override({zodSchema:l,jsonSchema:f,path:m.path??[]})};for(let l of[...this.seen.entries()].reverse())a(l[0],{target:this.target});let c={};if(this.target==="draft-2020-12"?c.$schema="https://json-schema.org/draft/2020-12/schema":this.target==="draft-7"?c.$schema="http://json-schema.org/draft-07/schema#":console.warn(`Invalid target: ${this.target}`),n.external?.uri){let l=n.external.registry.get(e)?.id;if(!l)throw new Error("Schema is missing an `id` property");c.$id=n.external.uri(l)}Object.assign(c,o.def);let u=n.external?.defs??{};for(let l of this.seen.entries()){let d=l[1];d.def&&d.defId&&(u[d.defId]=d.def)}n.external||Object.keys(u).length>0&&(this.target==="draft-2020-12"?c.$defs=u:c.definitions=u);try{return JSON.parse(JSON.stringify(c))}catch{throw new Error("Error converting schema to JSON.")}}};function hc(t,e){if(t instanceof Sn){let n=new Lo(e),o={};for(let a of t._idmap.entries()){let[c,u]=a;n.process(u)}let s={},i={registry:t,uri:e?.uri,defs:o};for(let a of t._idmap.entries()){let[c,u]=a;s[c]=n.emit(u,{...e,external:i})}if(Object.keys(o).length>0){let a=n.target==="draft-2020-12"?"$defs":"definitions";s.__shared={[a]:o}}return{schemas:s}}let r=new Lo(e);return r.process(t),r.emit(t,e)}function ge(t,e){let r=e??{seen:new Set};if(r.seen.has(t))return!1;r.seen.add(t);let o=t._zod.def;switch(o.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":return!1;case"array":return ge(o.element,r);case"object":{for(let s in o.shape)if(ge(o.shape[s],r))return!0;return!1}case"union":{for(let s of o.options)if(ge(s,r))return!0;return!1}case"intersection":return ge(o.left,r)||ge(o.right,r);case"tuple":{for(let s of o.items)if(ge(s,r))return!0;return!!(o.rest&&ge(o.rest,r))}case"record":return ge(o.keyType,r)||ge(o.valueType,r);case"map":return ge(o.keyType,r)||ge(o.valueType,r);case"set":return ge(o.valueType,r);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":return ge(o.innerType,r);case"lazy":return ge(o.getter(),r);case"default":return ge(o.innerType,r);case"prefault":return ge(o.innerType,r);case"custom":return!1;case"transform":return!0;case"pipe":return ge(o.in,r)||ge(o.out,r);case"success":return!1;case"catch":return!1;default:}throw new Error(`Unknown schema type: ${o.type}`)}var xv=y("ZodMiniType",(t,e)=>{if(!t._zod)throw new Error("Uninitialized schema in ZodMiniType.");ee.init(t,e),t.def=e,t.parse=(r,n)=>Ni(t,r,n,{callee:t.parse}),t.safeParse=(r,n)=>hr(t,r,n),t.parseAsync=async(r,n)=>Zi(t,r,n,{callee:t.parseAsync}),t.safeParseAsync=async(r,n)=>gr(t,r,n),t.check=(...r)=>t.clone({...e,checks:[...e.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]}),t.clone=(r,n)=>Ve(t,r,n),t.brand=()=>t,t.register=((r,n)=>(r.add(t,n),t))});var $v=y("ZodMiniObject",(t,e)=>{Oo.init(t,e),xv.init(t,e),B.defineLazy(t,"shape",()=>e.shape)});function gc(t,e){let r={type:"object",get shape(){return B.assignProp(this,"shape",{...t}),this.shape},...B.normalizeParams(e)};return new $v(r)}function Je(t){return!!t._zod}function vr(t){let e=Object.values(t);if(e.length===0)return gc({});let r=e.every(Je),n=e.every(o=>!Je(o));if(r)return gc(t);if(n)return vi(t);throw new Error("Mixed Zod versions detected in object shape.")}function Mt(t,e){return Je(t)?hr(t,e):t.safeParse(e)}async function qo(t,e){return Je(t)?await gr(t,e):await t.safeParseAsync(e)}function Dt(t){if(!t)return;let e;if(Je(t)?e=t._zod?.def?.shape:e=t.shape,!!e){if(typeof e=="function")try{return e()}catch{return}return e}}function Ur(t){if(t){if(typeof t=="object"){let e=t,r=t;if(!e._def&&!r._zod){let n=Object.values(t);if(n.length>0&&n.every(o=>typeof o=="object"&&o!==null&&(o._def!==void 0||o._zod!==void 0||typeof o.parse=="function")))return vr(t)}}if(Je(t)){let r=t._zod?.def;if(r&&(r.type==="object"||r.shape!==void 0))return t}else if(t.shape!==void 0)return t}}function Uo(t){if(t&&typeof t=="object"){if("message"in t&&typeof t.message=="string")return t.message;if("issues"in t&&Array.isArray(t.issues)&&t.issues.length>0){let e=t.issues[0];if(e&&typeof e=="object"&&"message"in e)return String(e.message)}try{return JSON.stringify(t)}catch{return String(t)}}return String(t)}function Ep(t){return t.description}function Pp(t){if(Je(t))return t._zod?.def?.type==="optional";let e=t;return typeof t.isOptional=="function"?t.isOptional():e._def?.typeName==="ZodOptional"}function Fo(t){if(Je(t)){let s=t._zod?.def;if(s){if(s.value!==void 0)return s.value;if(Array.isArray(s.values)&&s.values.length>0)return s.values[0]}}let r=t._def;if(r){if(r.value!==void 0)return r.value;if(Array.isArray(r.values)&&r.values.length>0)return r.values[0]}let n=t.value;if(n!==void 0)return n}var En={};hi(En,{ZodISODate:()=>Ip,ZodISODateTime:()=>Rp,ZodISODuration:()=>Np,ZodISOTime:()=>Op,date:()=>yc,datetime:()=>_c,duration:()=>bc,time:()=>vc});var Rp=y("ZodISODateTime",(t,e)=>{hp.init(t,e),ue.init(t,e)});function _c(t){return $p(Rp,t)}var Ip=y("ZodISODate",(t,e)=>{gp.init(t,e),ue.init(t,e)});function yc(t){return wp(Ip,t)}var Op=y("ZodISOTime",(t,e)=>{_p.init(t,e),ue.init(t,e)});function vc(t){return kp(Op,t)}var Np=y("ZodISODuration",(t,e)=>{yp.init(t,e),ue.init(t,e)});function bc(t){return Sp(Np,t)}var Cp=(t,e)=>{To.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:r=>Ii(t,r)},flatten:{value:r=>Ri(t,r)},addIssue:{value:r=>t.issues.push(r)},addIssues:{value:r=>t.issues.push(...r)},isEmpty:{get(){return t.issues.length===0}}})},YE=y("ZodError",Cp),Pn=y("ZodError",Cp,{Parent:Error});var Zp=Oi(Pn),jp=Ci(Pn),Ap=ji(Pn),Mp=Ai(Pn);var me=y("ZodType",(t,e)=>(ee.init(t,e),t.def=e,Object.defineProperty(t,"_def",{value:e}),t.check=(...r)=>t.clone({...e,checks:[...e.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]}),t.clone=(r,n)=>Ve(t,r,n),t.brand=()=>t,t.register=((r,n)=>(r.add(t,n),t)),t.parse=(r,n)=>Zp(t,r,n,{callee:t.parse}),t.safeParse=(r,n)=>Ap(t,r,n),t.parseAsync=async(r,n)=>jp(t,r,n,{callee:t.parseAsync}),t.safeParseAsync=async(r,n)=>Mp(t,r,n),t.spa=t.safeParseAsync,t.refine=(r,n)=>t.check(vb(r,n)),t.superRefine=r=>t.check(bb(r)),t.overwrite=r=>t.check(_r(r)),t.optional=()=>fe(t),t.nullable=()=>qp(t),t.nullish=()=>fe(qp(t)),t.nonoptional=r=>pb(t,r),t.array=()=>K(t),t.or=r=>se([t,r]),t.and=r=>Ho(t,r),t.transform=r=>$c(t,Bp(r)),t.default=r=>ub(t,r),t.prefault=r=>db(t,r),t.catch=r=>mb(t,r),t.pipe=r=>$c(t,r),t.readonly=()=>_b(t),t.describe=r=>{let n=t.clone();return At.add(n,{description:r}),n},Object.defineProperty(t,"description",{get(){return At.get(t)?.description},configurable:!0}),t.meta=(...r)=>{if(r.length===0)return At.get(t);let n=t.clone();return At.add(n,r[0]),n},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),Up=y("_ZodString",(t,e)=>{kn.init(t,e),me.init(t,e);let r=t._zod.bag;t.format=r.format??null,t.minLength=r.minimum??null,t.maxLength=r.maximum??null,t.regex=(...n)=>t.check(nc(...n)),t.includes=(...n)=>t.check(ic(...n)),t.startsWith=(...n)=>t.check(ac(...n)),t.endsWith=(...n)=>t.check(cc(...n)),t.min=(...n)=>t.check(qr(...n)),t.max=(...n)=>t.check(Mo(...n)),t.length=(...n)=>t.check(Do(...n)),t.nonempty=(...n)=>t.check(qr(1,...n)),t.lowercase=n=>t.check(oc(n)),t.uppercase=n=>t.check(sc(n)),t.trim=()=>t.check(lc()),t.normalize=(...n)=>t.check(uc(...n)),t.toLowerCase=()=>t.check(dc()),t.toUpperCase=()=>t.check(pc())}),Iv=y("ZodString",(t,e)=>{kn.init(t,e),Up.init(t,e),t.email=r=>t.check(Ra(Ov,r)),t.url=r=>t.check(Za(Nv,r)),t.jwt=r=>t.check(Wa(Gv,r)),t.emoji=r=>t.check(ja(Cv,r)),t.guid=r=>t.check(Co(Dp,r)),t.uuid=r=>t.check(Ia(Vo,r)),t.uuidv4=r=>t.check(Oa(Vo,r)),t.uuidv6=r=>t.check(Na(Vo,r)),t.uuidv7=r=>t.check(Ca(Vo,r)),t.nanoid=r=>t.check(Aa(Zv,r)),t.guid=r=>t.check(Co(Dp,r)),t.cuid=r=>t.check(Ma(jv,r)),t.cuid2=r=>t.check(Da(Av,r)),t.ulid=r=>t.check(La(Mv,r)),t.base64=r=>t.check(Ka(Hv,r)),t.base64url=r=>t.check(Ga(Bv,r)),t.xid=r=>t.check(qa(Dv,r)),t.ksuid=r=>t.check(Ua(Lv,r)),t.ipv4=r=>t.check(Fa(qv,r)),t.ipv6=r=>t.check(Va(Uv,r)),t.cidrv4=r=>t.check(Ha(Fv,r)),t.cidrv6=r=>t.check(Ba(Vv,r)),t.e164=r=>t.check(Ja(Kv,r)),t.datetime=r=>t.check(_c(r)),t.date=r=>t.check(yc(r)),t.time=r=>t.check(vc(r)),t.duration=r=>t.check(bc(r))});function _(t){return Pa(Iv,t)}var ue=y("ZodStringFormat",(t,e)=>{oe.init(t,e),Up.init(t,e)}),Ov=y("ZodEmail",(t,e)=>{Hi.init(t,e),ue.init(t,e)});var Dp=y("ZodGUID",(t,e)=>{Fi.init(t,e),ue.init(t,e)});var Vo=y("ZodUUID",(t,e)=>{Vi.init(t,e),ue.init(t,e)});var Nv=y("ZodURL",(t,e)=>{Bi.init(t,e),ue.init(t,e)});var Cv=y("ZodEmoji",(t,e)=>{Ki.init(t,e),ue.init(t,e)});var Zv=y("ZodNanoID",(t,e)=>{Gi.init(t,e),ue.init(t,e)});var jv=y("ZodCUID",(t,e)=>{Ji.init(t,e),ue.init(t,e)});var Av=y("ZodCUID2",(t,e)=>{Wi.init(t,e),ue.init(t,e)});var Mv=y("ZodULID",(t,e)=>{Xi.init(t,e),ue.init(t,e)});var Dv=y("ZodXID",(t,e)=>{Yi.init(t,e),ue.init(t,e)});var Lv=y("ZodKSUID",(t,e)=>{Qi.init(t,e),ue.init(t,e)});var qv=y("ZodIPv4",(t,e)=>{ea.init(t,e),ue.init(t,e)});var Uv=y("ZodIPv6",(t,e)=>{ta.init(t,e),ue.init(t,e)});var Fv=y("ZodCIDRv4",(t,e)=>{ra.init(t,e),ue.init(t,e)});var Vv=y("ZodCIDRv6",(t,e)=>{na.init(t,e),ue.init(t,e)});var Hv=y("ZodBase64",(t,e)=>{oa.init(t,e),ue.init(t,e)});var Bv=y("ZodBase64URL",(t,e)=>{sa.init(t,e),ue.init(t,e)});var Kv=y("ZodE164",(t,e)=>{ia.init(t,e),ue.init(t,e)});var Gv=y("ZodJWT",(t,e)=>{aa.init(t,e),ue.init(t,e)});var Fp=y("ZodNumber",(t,e)=>{Io.init(t,e),me.init(t,e),t.gt=(n,o)=>t.check(jo(n,o)),t.gte=(n,o)=>t.check(Tn(n,o)),t.min=(n,o)=>t.check(Tn(n,o)),t.lt=(n,o)=>t.check(Zo(n,o)),t.lte=(n,o)=>t.check(zn(n,o)),t.max=(n,o)=>t.check(zn(n,o)),t.int=n=>t.check(Lp(n)),t.safe=n=>t.check(Lp(n)),t.positive=n=>t.check(jo(0,n)),t.nonnegative=n=>t.check(Tn(0,n)),t.negative=n=>t.check(Zo(0,n)),t.nonpositive=n=>t.check(zn(0,n)),t.multipleOf=(n,o)=>t.check(Ao(n,o)),t.step=(n,o)=>t.check(Ao(n,o)),t.finite=()=>t;let r=t._zod.bag;t.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),t.isFinite=!0,t.format=r.format??null});function Q(t){return Xa(Fp,t)}var Jv=y("ZodNumberFormat",(t,e)=>{ca.init(t,e),Fp.init(t,e)});function Lp(t){return Ya(Jv,t)}var Wv=y("ZodBoolean",(t,e)=>{ua.init(t,e),me.init(t,e)});function _e(t){return Qa(Wv,t)}var Xv=y("ZodNull",(t,e)=>{la.init(t,e),me.init(t,e)});function wc(t){return ec(Xv,t)}var Yv=y("ZodUnknown",(t,e)=>{da.init(t,e),me.init(t,e)});function le(){return tc(Yv)}var Qv=y("ZodNever",(t,e)=>{pa.init(t,e),me.init(t,e)});function eb(t){return rc(Qv,t)}var tb=y("ZodArray",(t,e)=>{fa.init(t,e),me.init(t,e),t.element=e.element,t.min=(r,n)=>t.check(qr(r,n)),t.nonempty=r=>t.check(qr(1,r)),t.max=(r,n)=>t.check(Mo(r,n)),t.length=(r,n)=>t.check(Do(r,n)),t.unwrap=()=>t.element});function K(t,e){return zp(tb,t,e)}var Vp=y("ZodObject",(t,e)=>{Oo.init(t,e),me.init(t,e),B.defineLazy(t,"shape",()=>e.shape),t.keyof=()=>Ae(Object.keys(t._zod.def.shape)),t.catchall=r=>t.clone({...t._zod.def,catchall:r}),t.passthrough=()=>t.clone({...t._zod.def,catchall:le()}),t.loose=()=>t.clone({...t._zod.def,catchall:le()}),t.strict=()=>t.clone({...t._zod.def,catchall:eb()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=r=>B.extend(t,r),t.merge=r=>B.merge(t,r),t.pick=r=>B.pick(t,r),t.omit=r=>B.omit(t,r),t.partial=(...r)=>B.partial(Kp,t,r[0]),t.required=(...r)=>B.required(Gp,t,r[0])});function T(t,e){let r={type:"object",get shape(){return B.assignProp(this,"shape",{...t}),this.shape},...B.normalizeParams(e)};return new Vp(r)}function Re(t,e){return new Vp({type:"object",get shape(){return B.assignProp(this,"shape",{...t}),this.shape},catchall:le(),...B.normalizeParams(e)})}var Hp=y("ZodUnion",(t,e)=>{No.init(t,e),me.init(t,e),t.options=e.options});function se(t,e){return new Hp({type:"union",options:t,...B.normalizeParams(e)})}var rb=y("ZodDiscriminatedUnion",(t,e)=>{Hp.init(t,e),ma.init(t,e)});function kc(t,e,r){return new rb({type:"union",options:e,discriminator:t,...B.normalizeParams(r)})}var nb=y("ZodIntersection",(t,e)=>{ha.init(t,e),me.init(t,e)});function Ho(t,e){return new nb({type:"intersection",left:t,right:e})}var ob=y("ZodRecord",(t,e)=>{ga.init(t,e),me.init(t,e),t.keyType=e.keyType,t.valueType=e.valueType});function de(t,e,r){return new ob({type:"record",keyType:t,valueType:e,...B.normalizeParams(r)})}var xc=y("ZodEnum",(t,e)=>{_a.init(t,e),me.init(t,e),t.enum=e.entries,t.options=Object.values(e.entries);let r=new Set(Object.keys(e.entries));t.extract=(n,o)=>{let s={};for(let i of n)if(r.has(i))s[i]=e.entries[i];else throw new Error(`Key ${i} not found in enum`);return new xc({...e,checks:[],...B.normalizeParams(o),entries:s})},t.exclude=(n,o)=>{let s={...e.entries};for(let i of n)if(r.has(i))delete s[i];else throw new Error(`Key ${i} not found in enum`);return new xc({...e,checks:[],...B.normalizeParams(o),entries:s})}});function Ae(t,e){let r=Array.isArray(t)?Object.fromEntries(t.map(n=>[n,n])):t;return new xc({type:"enum",entries:r,...B.normalizeParams(e)})}var sb=y("ZodLiteral",(t,e)=>{ya.init(t,e),me.init(t,e),t.values=new Set(e.values),Object.defineProperty(t,"value",{get(){if(e.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return e.values[0]}})});function I(t,e){return new sb({type:"literal",values:Array.isArray(t)?t:[t],...B.normalizeParams(e)})}var ib=y("ZodTransform",(t,e)=>{va.init(t,e),me.init(t,e),t._zod.parse=(r,n)=>{r.addIssue=s=>{if(typeof s=="string")r.issues.push(B.issue(s,r.value,e));else{let i=s;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=r.value),i.inst??(i.inst=t),i.continue??(i.continue=!0),r.issues.push(B.issue(i))}};let o=e.transform(r.value,r);return o instanceof Promise?o.then(s=>(r.value=s,r)):(r.value=o,r)}});function Bp(t){return new ib({type:"transform",transform:t})}var Kp=y("ZodOptional",(t,e)=>{ba.init(t,e),me.init(t,e),t.unwrap=()=>t._zod.def.innerType});function fe(t){return new Kp({type:"optional",innerType:t})}var ab=y("ZodNullable",(t,e)=>{xa.init(t,e),me.init(t,e),t.unwrap=()=>t._zod.def.innerType});function qp(t){return new ab({type:"nullable",innerType:t})}var cb=y("ZodDefault",(t,e)=>{$a.init(t,e),me.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function ub(t,e){return new cb({type:"default",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}var lb=y("ZodPrefault",(t,e)=>{wa.init(t,e),me.init(t,e),t.unwrap=()=>t._zod.def.innerType});function db(t,e){return new lb({type:"prefault",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}var Gp=y("ZodNonOptional",(t,e)=>{ka.init(t,e),me.init(t,e),t.unwrap=()=>t._zod.def.innerType});function pb(t,e){return new Gp({type:"nonoptional",innerType:t,...B.normalizeParams(e)})}var fb=y("ZodCatch",(t,e)=>{Sa.init(t,e),me.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function mb(t,e){return new fb({type:"catch",innerType:t,catchValue:typeof e=="function"?e:()=>e})}var hb=y("ZodPipe",(t,e)=>{za.init(t,e),me.init(t,e),t.in=e.in,t.out=e.out});function $c(t,e){return new hb({type:"pipe",in:t,out:e})}var gb=y("ZodReadonly",(t,e)=>{Ta.init(t,e),me.init(t,e)});function _b(t){return new gb({type:"readonly",innerType:t})}var Jp=y("ZodCustom",(t,e)=>{Ea.init(t,e),me.init(t,e)});function yb(t){let e=new ve({check:"custom"});return e._zod.check=t,e}function Wp(t,e){return fc(Jp,t??(()=>!0),e)}function vb(t,e={}){return mc(Jp,t,e)}function bb(t){let e=yb(r=>(r.addIssue=n=>{if(typeof n=="string")r.issues.push(B.issue(n,r.value,e._zod.def));else{let o=n;o.fatal&&(o.continue=!1),o.code??(o.code="custom"),o.input??(o.input=r.value),o.inst??(o.inst=e),o.continue??(o.continue=!e._zod.def.abort),r.issues.push(B.issue(o))}},t(r.value,r)));return e}function Sc(t,e){return $c(Bp(t),e)}Fe(bp());var Tc="2025-11-25";var Xp=[Tc,"2025-06-18","2025-03-26","2024-11-05","2024-10-07"],Lt="io.modelcontextprotocol/related-task",Ko="2.0",be=Wp(t=>t!==null&&(typeof t=="object"||typeof t=="function")),Yp=se([_(),Q().int()]),Qp=_(),pP=Re({ttl:se([Q(),wc()]).optional(),pollInterval:Q().optional()}),xb=T({ttl:Q().optional()}),$b=T({taskId:_()}),Ec=Re({progressToken:Yp.optional(),[Lt]:$b.optional()}),He=T({_meta:Ec.optional()}),Rn=He.extend({task:xb.optional()}),ef=t=>Rn.safeParse(t).success,xe=T({method:_(),params:He.loose().optional()}),We=T({_meta:Ec.optional()}),Xe=T({method:_(),params:We.loose().optional()}),$e=Re({_meta:Ec.optional()}),Go=se([_(),Q().int()]),tf=T({jsonrpc:I(Ko),id:Go,...xe.shape}).strict(),Pc=t=>tf.safeParse(t).success,rf=T({jsonrpc:I(Ko),...Xe.shape}).strict(),nf=t=>rf.safeParse(t).success,Rc=T({jsonrpc:I(Ko),id:Go,result:$e}).strict(),In=t=>Rc.safeParse(t).success;var N;(function(t){t[t.ConnectionClosed=-32e3]="ConnectionClosed",t[t.RequestTimeout=-32001]="RequestTimeout",t[t.ParseError=-32700]="ParseError",t[t.InvalidRequest=-32600]="InvalidRequest",t[t.MethodNotFound=-32601]="MethodNotFound",t[t.InvalidParams=-32602]="InvalidParams",t[t.InternalError=-32603]="InternalError",t[t.UrlElicitationRequired=-32042]="UrlElicitationRequired"})(N||(N={}));var Ic=T({jsonrpc:I(Ko),id:Go.optional(),error:T({code:Q().int(),message:_(),data:le().optional()})}).strict();var of=t=>Ic.safeParse(t).success;var sf=se([tf,rf,Rc,Ic]),fP=se([Rc,Ic]),Jo=$e.strict(),wb=We.extend({requestId:Go.optional(),reason:_().optional()}),Wo=Xe.extend({method:I("notifications/cancelled"),params:wb}),kb=T({src:_(),mimeType:_().optional(),sizes:K(_()).optional(),theme:Ae(["light","dark"]).optional()}),On=T({icons:K(kb).optional()}),Fr=T({name:_(),title:_().optional()}),af=Fr.extend({...Fr.shape,...On.shape,version:_(),websiteUrl:_().optional(),description:_().optional()}),Sb=Ho(T({applyDefaults:_e().optional()}),de(_(),le())),zb=Sc(t=>t&&typeof t=="object"&&!Array.isArray(t)&&Object.keys(t).length===0?{form:{}}:t,Ho(T({form:Sb.optional(),url:be.optional()}),de(_(),le()).optional())),Tb=Re({list:be.optional(),cancel:be.optional(),requests:Re({sampling:Re({createMessage:be.optional()}).optional(),elicitation:Re({create:be.optional()}).optional()}).optional()}),Eb=Re({list:be.optional(),cancel:be.optional(),requests:Re({tools:Re({call:be.optional()}).optional()}).optional()}),Pb=T({experimental:de(_(),be).optional(),sampling:T({context:be.optional(),tools:be.optional()}).optional(),elicitation:zb.optional(),roots:T({listChanged:_e().optional()}).optional(),tasks:Tb.optional()}),Rb=He.extend({protocolVersion:_(),capabilities:Pb,clientInfo:af}),Oc=xe.extend({method:I("initialize"),params:Rb});var Ib=T({experimental:de(_(),be).optional(),logging:be.optional(),completions:be.optional(),prompts:T({listChanged:_e().optional()}).optional(),resources:T({subscribe:_e().optional(),listChanged:_e().optional()}).optional(),tools:T({listChanged:_e().optional()}).optional(),tasks:Eb.optional()}),Ob=$e.extend({protocolVersion:_(),capabilities:Ib,serverInfo:af,instructions:_().optional()}),Nc=Xe.extend({method:I("notifications/initialized"),params:We.optional()});var Xo=xe.extend({method:I("ping"),params:He.optional()}),Nb=T({progress:Q(),total:fe(Q()),message:fe(_())}),Cb=T({...We.shape,...Nb.shape,progressToken:Yp}),Yo=Xe.extend({method:I("notifications/progress"),params:Cb}),Zb=He.extend({cursor:Qp.optional()}),Nn=xe.extend({params:Zb.optional()}),Cn=$e.extend({nextCursor:Qp.optional()}),jb=Ae(["working","input_required","completed","failed","cancelled"]),Zn=T({taskId:_(),status:jb,ttl:se([Q(),wc()]),createdAt:_(),lastUpdatedAt:_(),pollInterval:fe(Q()),statusMessage:fe(_())}),Vr=$e.extend({task:Zn}),Ab=We.merge(Zn),jn=Xe.extend({method:I("notifications/tasks/status"),params:Ab}),Qo=xe.extend({method:I("tasks/get"),params:He.extend({taskId:_()})}),es=$e.merge(Zn),ts=xe.extend({method:I("tasks/result"),params:He.extend({taskId:_()})}),mP=$e.loose(),rs=Nn.extend({method:I("tasks/list")}),ns=Cn.extend({tasks:K(Zn)}),os=xe.extend({method:I("tasks/cancel"),params:He.extend({taskId:_()})}),cf=$e.merge(Zn),uf=T({uri:_(),mimeType:fe(_()),_meta:de(_(),le()).optional()}),lf=uf.extend({text:_()}),Cc=_().refine(t=>{try{return atob(t),!0}catch{return!1}},{message:"Invalid Base64 string"}),df=uf.extend({blob:Cc}),An=Ae(["user","assistant"]),Hr=T({audience:K(An).optional(),priority:Q().min(0).max(1).optional(),lastModified:En.datetime({offset:!0}).optional()}),pf=T({...Fr.shape,...On.shape,uri:_(),description:fe(_()),mimeType:fe(_()),annotations:Hr.optional(),_meta:fe(Re({}))}),Mb=T({...Fr.shape,...On.shape,uriTemplate:_(),description:fe(_()),mimeType:fe(_()),annotations:Hr.optional(),_meta:fe(Re({}))}),ss=Nn.extend({method:I("resources/list")}),Db=Cn.extend({resources:K(pf)}),is=Nn.extend({method:I("resources/templates/list")}),Lb=Cn.extend({resourceTemplates:K(Mb)}),Zc=He.extend({uri:_()}),qb=Zc,as=xe.extend({method:I("resources/read"),params:qb}),Ub=$e.extend({contents:K(se([lf,df]))}),Fb=Xe.extend({method:I("notifications/resources/list_changed"),params:We.optional()}),Vb=Zc,Hb=xe.extend({method:I("resources/subscribe"),params:Vb}),Bb=Zc,Kb=xe.extend({method:I("resources/unsubscribe"),params:Bb}),Gb=We.extend({uri:_()}),Jb=Xe.extend({method:I("notifications/resources/updated"),params:Gb}),Wb=T({name:_(),description:fe(_()),required:fe(_e())}),Xb=T({...Fr.shape,...On.shape,description:fe(_()),arguments:fe(K(Wb)),_meta:fe(Re({}))}),cs=Nn.extend({method:I("prompts/list")}),Yb=Cn.extend({prompts:K(Xb)}),Qb=He.extend({name:_(),arguments:de(_(),_()).optional()}),us=xe.extend({method:I("prompts/get"),params:Qb}),jc=T({type:I("text"),text:_(),annotations:Hr.optional(),_meta:de(_(),le()).optional()}),Ac=T({type:I("image"),data:Cc,mimeType:_(),annotations:Hr.optional(),_meta:de(_(),le()).optional()}),Mc=T({type:I("audio"),data:Cc,mimeType:_(),annotations:Hr.optional(),_meta:de(_(),le()).optional()}),ex=T({type:I("tool_use"),name:_(),id:_(),input:de(_(),le()),_meta:de(_(),le()).optional()}),tx=T({type:I("resource"),resource:se([lf,df]),annotations:Hr.optional(),_meta:de(_(),le()).optional()}),rx=pf.extend({type:I("resource_link")}),Dc=se([jc,Ac,Mc,rx,tx]),nx=T({role:An,content:Dc}),ox=$e.extend({description:_().optional(),messages:K(nx)}),sx=Xe.extend({method:I("notifications/prompts/list_changed"),params:We.optional()}),ix=T({title:_().optional(),readOnlyHint:_e().optional(),destructiveHint:_e().optional(),idempotentHint:_e().optional(),openWorldHint:_e().optional()}),ax=T({taskSupport:Ae(["required","optional","forbidden"]).optional()}),ff=T({...Fr.shape,...On.shape,description:_().optional(),inputSchema:T({type:I("object"),properties:de(_(),be).optional(),required:K(_()).optional()}).catchall(le()),outputSchema:T({type:I("object"),properties:de(_(),be).optional(),required:K(_()).optional()}).catchall(le()).optional(),annotations:ix.optional(),execution:ax.optional(),_meta:de(_(),le()).optional()}),ls=Nn.extend({method:I("tools/list")}),cx=Cn.extend({tools:K(ff)}),ds=$e.extend({content:K(Dc).default([]),structuredContent:de(_(),le()).optional(),isError:_e().optional()}),hP=ds.or($e.extend({toolResult:le()})),ux=Rn.extend({name:_(),arguments:de(_(),le()).optional()}),Br=xe.extend({method:I("tools/call"),params:ux}),lx=Xe.extend({method:I("notifications/tools/list_changed"),params:We.optional()}),gP=T({autoRefresh:_e().default(!0),debounceMs:Q().int().nonnegative().default(300)}),Mn=Ae(["debug","info","notice","warning","error","critical","alert","emergency"]),dx=He.extend({level:Mn}),Lc=xe.extend({method:I("logging/setLevel"),params:dx}),px=We.extend({level:Mn,logger:_().optional(),data:le()}),fx=Xe.extend({method:I("notifications/message"),params:px}),mx=T({name:_().optional()}),hx=T({hints:K(mx).optional(),costPriority:Q().min(0).max(1).optional(),speedPriority:Q().min(0).max(1).optional(),intelligencePriority:Q().min(0).max(1).optional()}),gx=T({mode:Ae(["auto","required","none"]).optional()}),_x=T({type:I("tool_result"),toolUseId:_().describe("The unique identifier for the corresponding tool call."),content:K(Dc).default([]),structuredContent:T({}).loose().optional(),isError:_e().optional(),_meta:de(_(),le()).optional()}),yx=kc("type",[jc,Ac,Mc]),Bo=kc("type",[jc,Ac,Mc,ex,_x]),vx=T({role:An,content:se([Bo,K(Bo)]),_meta:de(_(),le()).optional()}),bx=Rn.extend({messages:K(vx),modelPreferences:hx.optional(),systemPrompt:_().optional(),includeContext:Ae(["none","thisServer","allServers"]).optional(),temperature:Q().optional(),maxTokens:Q().int(),stopSequences:K(_()).optional(),metadata:be.optional(),tools:K(ff).optional(),toolChoice:gx.optional()}),xx=xe.extend({method:I("sampling/createMessage"),params:bx}),qc=$e.extend({model:_(),stopReason:fe(Ae(["endTurn","stopSequence","maxTokens"]).or(_())),role:An,content:yx}),Uc=$e.extend({model:_(),stopReason:fe(Ae(["endTurn","stopSequence","maxTokens","toolUse"]).or(_())),role:An,content:se([Bo,K(Bo)])}),$x=T({type:I("boolean"),title:_().optional(),description:_().optional(),default:_e().optional()}),wx=T({type:I("string"),title:_().optional(),description:_().optional(),minLength:Q().optional(),maxLength:Q().optional(),format:Ae(["email","uri","date","date-time"]).optional(),default:_().optional()}),kx=T({type:Ae(["number","integer"]),title:_().optional(),description:_().optional(),minimum:Q().optional(),maximum:Q().optional(),default:Q().optional()}),Sx=T({type:I("string"),title:_().optional(),description:_().optional(),enum:K(_()),default:_().optional()}),zx=T({type:I("string"),title:_().optional(),description:_().optional(),oneOf:K(T({const:_(),title:_()})),default:_().optional()}),Tx=T({type:I("string"),title:_().optional(),description:_().optional(),enum:K(_()),enumNames:K(_()).optional(),default:_().optional()}),Ex=se([Sx,zx]),Px=T({type:I("array"),title:_().optional(),description:_().optional(),minItems:Q().optional(),maxItems:Q().optional(),items:T({type:I("string"),enum:K(_())}),default:K(_()).optional()}),Rx=T({type:I("array"),title:_().optional(),description:_().optional(),minItems:Q().optional(),maxItems:Q().optional(),items:T({anyOf:K(T({const:_(),title:_()}))}),default:K(_()).optional()}),Ix=se([Px,Rx]),Ox=se([Tx,Ex,Ix]),Nx=se([Ox,$x,wx,kx]),Cx=Rn.extend({mode:I("form").optional(),message:_(),requestedSchema:T({type:I("object"),properties:de(_(),Nx),required:K(_()).optional()})}),Zx=Rn.extend({mode:I("url"),message:_(),elicitationId:_(),url:_().url()}),jx=se([Cx,Zx]),Ax=xe.extend({method:I("elicitation/create"),params:jx}),Mx=We.extend({elicitationId:_()}),Dx=Xe.extend({method:I("notifications/elicitation/complete"),params:Mx}),ps=$e.extend({action:Ae(["accept","decline","cancel"]),content:Sc(t=>t===null?void 0:t,de(_(),se([_(),Q(),_e(),K(_())])).optional())}),Lx=T({type:I("ref/resource"),uri:_()});var qx=T({type:I("ref/prompt"),name:_()}),Ux=He.extend({ref:se([qx,Lx]),argument:T({name:_(),value:_()}),context:T({arguments:de(_(),_()).optional()}).optional()}),fs=xe.extend({method:I("completion/complete"),params:Ux});function mf(t){if(t.params.ref.type!=="ref/prompt")throw new TypeError(`Expected CompleteRequestPrompt, but got ${t.params.ref.type}`)}function hf(t){if(t.params.ref.type!=="ref/resource")throw new TypeError(`Expected CompleteRequestResourceTemplate, but got ${t.params.ref.type}`)}var Fx=$e.extend({completion:Re({values:K(_()).max(100),total:fe(Q().int()),hasMore:fe(_e())})}),Vx=T({uri:_().startsWith("file://"),name:_().optional(),_meta:de(_(),le()).optional()}),Hx=xe.extend({method:I("roots/list"),params:He.optional()}),Fc=$e.extend({roots:K(Vx)}),Bx=Xe.extend({method:I("notifications/roots/list_changed"),params:We.optional()}),_P=se([Xo,Oc,fs,Lc,us,cs,ss,is,as,Hb,Kb,Br,ls,Qo,ts,rs,os]),yP=se([Wo,Yo,Nc,Bx,jn]),vP=se([Jo,qc,Uc,ps,Fc,es,ns,Vr]),bP=se([Xo,xx,Ax,Hx,Qo,ts,rs,os]),xP=se([Wo,Yo,fx,Jb,Fb,lx,sx,jn,Dx]),$P=se([Jo,Ob,Fx,ox,Yb,Db,Lb,Ub,ds,cx,es,ns,Vr]),R=class t extends Error{constructor(e,r,n){super(`MCP error ${e}: ${r}`),this.code=e,this.data=n,this.name="McpError"}static fromError(e,r,n){if(e===N.UrlElicitationRequired&&n){let o=n;if(o.elicitations)return new zc(o.elicitations,r)}return new t(e,r,n)}},zc=class extends R{constructor(e,r=`URL elicitation${e.length>1?"s":""} required`){super(N.UrlElicitationRequired,r,{elicitations:e})}get elicitations(){return this.data?.elicitations??[]}};function qt(t){return t==="completed"||t==="failed"||t==="cancelled"}var _f=Symbol("Let zodToJsonSchema decide on which parser to use");var gf={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},yf=t=>typeof t=="string"?{...gf,name:t}:{...gf,...t};var vf=t=>{let e=yf(t),r=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,flags:{hasReferencedOpenAiAnyType:!1},currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([n,o])=>[o._def,{def:o._def,path:[...e.basePath,e.definitionPath,n],jsonSchema:void 0}]))}};function Vc(t,e,r,n){n?.errorMessages&&r&&(t.errorMessage={...t.errorMessage,[e]:r})}function G(t,e,r,n,o){t[e]=r,Vc(t,e,n,o)}var ms=(t,e)=>{let r=0;for(;r<t.length&&r<e.length&&t[r]===e[r];r++);return[(t.length-r).toString(),...e.slice(r)].join("/")};function pe(t){if(t.target!=="openAi")return{};let e=[...t.basePath,t.definitionPath,t.openAiAnyTypeName];return t.flags.hasReferencedOpenAiAnyType=!0,{$ref:t.$refStrategy==="relative"?ms(e,t.currentPath):e.join("/")}}function bf(t,e){let r={type:"array"};return t.type?._def&&t.type?._def?.typeName!==$.ZodAny&&(r.items=A(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&G(r,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&G(r,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&(G(r,"minItems",t.exactLength.value,t.exactLength.message,e),G(r,"maxItems",t.exactLength.value,t.exactLength.message,e)),r}function xf(t,e){let r={type:"integer",format:"int64"};if(!t.checks)return r;for(let n of t.checks)switch(n.kind){case"min":e.target==="jsonSchema7"?n.inclusive?G(r,"minimum",n.value,n.message,e):G(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),G(r,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?G(r,"maximum",n.value,n.message,e):G(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),G(r,"maximum",n.value,n.message,e));break;case"multipleOf":G(r,"multipleOf",n.value,n.message,e);break}return r}function $f(){return{type:"boolean"}}function hs(t,e){return A(t.type._def,e)}var wf=(t,e)=>A(t.innerType._def,e);function Hc(t,e,r){let n=r??e.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((o,s)=>Hc(t,e,o))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return Kx(t,e)}}var Kx=(t,e)=>{let r={type:"integer",format:"unix-time"};if(e.target==="openApi3")return r;for(let n of t.checks)switch(n.kind){case"min":G(r,"minimum",n.value,n.message,e);break;case"max":G(r,"maximum",n.value,n.message,e);break}return r};function kf(t,e){return{...A(t.innerType._def,e),default:t.defaultValue()}}function Sf(t,e){return e.effectStrategy==="input"?A(t.schema._def,e):pe(e)}function zf(t){return{type:"string",enum:Array.from(t.values)}}var Gx=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function Tf(t,e){let r=[A(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),A(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(s=>!!s),n=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0,o=[];return r.forEach(s=>{if(Gx(s))o.push(...s.allOf),s.unevaluatedProperties===void 0&&(n=void 0);else{let i=s;if("additionalProperties"in s&&s.additionalProperties===!1){let{additionalProperties:a,...c}=s;i=c}else n=void 0;o.push(i)}}),o.length?{allOf:o,...n}:void 0}function Ef(t,e){let r=typeof t.value;return r!=="bigint"&&r!=="number"&&r!=="boolean"&&r!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:r==="bigint"?"integer":r,enum:[t.value]}:{type:r==="bigint"?"integer":r,const:t.value}}var Bc,ot={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Bc===void 0&&(Bc=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Bc),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function gs(t,e){let r={type:"string"};if(t.checks)for(let n of t.checks)switch(n.kind){case"min":G(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,n.value):n.value,n.message,e);break;case"max":G(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,n.value):n.value,n.message,e);break;case"email":switch(e.emailStrategy){case"format:email":st(r,"email",n.message,e);break;case"format:idn-email":st(r,"idn-email",n.message,e);break;case"pattern:zod":Ie(r,ot.email,n.message,e);break}break;case"url":st(r,"uri",n.message,e);break;case"uuid":st(r,"uuid",n.message,e);break;case"regex":Ie(r,n.regex,n.message,e);break;case"cuid":Ie(r,ot.cuid,n.message,e);break;case"cuid2":Ie(r,ot.cuid2,n.message,e);break;case"startsWith":Ie(r,RegExp(`^${Kc(n.value,e)}`),n.message,e);break;case"endsWith":Ie(r,RegExp(`${Kc(n.value,e)}$`),n.message,e);break;case"datetime":st(r,"date-time",n.message,e);break;case"date":st(r,"date",n.message,e);break;case"time":st(r,"time",n.message,e);break;case"duration":st(r,"duration",n.message,e);break;case"length":G(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,n.value):n.value,n.message,e),G(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,n.value):n.value,n.message,e);break;case"includes":{Ie(r,RegExp(Kc(n.value,e)),n.message,e);break}case"ip":{n.version!=="v6"&&st(r,"ipv4",n.message,e),n.version!=="v4"&&st(r,"ipv6",n.message,e);break}case"base64url":Ie(r,ot.base64url,n.message,e);break;case"jwt":Ie(r,ot.jwt,n.message,e);break;case"cidr":{n.version!=="v6"&&Ie(r,ot.ipv4Cidr,n.message,e),n.version!=="v4"&&Ie(r,ot.ipv6Cidr,n.message,e);break}case"emoji":Ie(r,ot.emoji(),n.message,e);break;case"ulid":{Ie(r,ot.ulid,n.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{st(r,"binary",n.message,e);break}case"contentEncoding:base64":{G(r,"contentEncoding","base64",n.message,e);break}case"pattern:zod":{Ie(r,ot.base64,n.message,e);break}}break}case"nanoid":Ie(r,ot.nanoid,n.message,e);case"toLowerCase":case"toUpperCase":case"trim":break;default:}return r}function Kc(t,e){return e.patternStrategy==="escape"?Wx(t):t}var Jx=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function Wx(t){let e="";for(let r=0;r<t.length;r++)Jx.has(t[r])||(e+="\\"),e+=t[r];return e}function st(t,e,r,n){t.format||t.anyOf?.some(o=>o.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&n.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...r&&n.errorMessages&&{errorMessage:{format:r}}})):G(t,"format",e,r,n)}function Ie(t,e,r,n){t.pattern||t.allOf?.some(o=>o.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push({pattern:t.pattern,...t.errorMessage&&n.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:Pf(e,n),...r&&n.errorMessages&&{errorMessage:{pattern:r}}})):G(t,"pattern",Pf(e,n),r,n)}function Pf(t,e){if(!e.applyRegexFlags||!t.flags)return t.source;let r={i:t.flags.includes("i"),m:t.flags.includes("m"),s:t.flags.includes("s")},n=r.i?t.source.toLowerCase():t.source,o="",s=!1,i=!1,a=!1;for(let c=0;c<n.length;c++){if(s){o+=n[c],s=!1;continue}if(r.i){if(i){if(n[c].match(/[a-z]/)){a?(o+=n[c],o+=`${n[c-2]}-${n[c]}`.toUpperCase(),a=!1):n[c+1]==="-"&&n[c+2]?.match(/[a-z]/)?(o+=n[c],a=!0):o+=`${n[c]}${n[c].toUpperCase()}`;continue}}else if(n[c].match(/[a-z]/)){o+=`[${n[c]}${n[c].toUpperCase()}]`;continue}}if(r.m){if(n[c]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(n[c]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&n[c]==="."){o+=i?`${n[c]}\r
`:`[${n[c]}\r
]`;continue}o+=n[c],n[c]==="\\"?s=!0:i&&n[c]==="]"?i=!1:!i&&n[c]==="["&&(i=!0)}try{new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),t.source}return o}function _s(t,e){if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&t.keyType?._def.typeName===$.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((n,o)=>({...n,[o]:A(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",o]})??pe(e)}),{}),additionalProperties:e.rejectedAdditionalProperties};let r={type:"object",additionalProperties:A(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??e.allowedAdditionalProperties};if(e.target==="openApi3")return r;if(t.keyType?._def.typeName===$.ZodString&&t.keyType._def.checks?.length){let{type:n,...o}=gs(t.keyType._def,e);return{...r,propertyNames:o}}else{if(t.keyType?._def.typeName===$.ZodEnum)return{...r,propertyNames:{enum:t.keyType._def.values}};if(t.keyType?._def.typeName===$.ZodBranded&&t.keyType._def.type._def.typeName===$.ZodString&&t.keyType._def.type._def.checks?.length){let{type:n,...o}=hs(t.keyType._def,e);return{...r,propertyNames:o}}}return r}function Rf(t,e){if(e.mapStrategy==="record")return _s(t,e);let r=A(t.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||pe(e),n=A(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||pe(e);return{type:"array",maxItems:125,items:{type:"array",items:[r,n],minItems:2,maxItems:2}}}function If(t){let e=t.values,n=Object.keys(t.values).filter(s=>typeof e[e[s]]!="number").map(s=>e[s]),o=Array.from(new Set(n.map(s=>typeof s)));return{type:o.length===1?o[0]==="string"?"string":"number":["string","number"],enum:n}}function Of(t){return t.target==="openAi"?void 0:{not:pe({...t,currentPath:[...t.currentPath,"not"]})}}function Nf(t){return t.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}var Dn={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Zf(t,e){if(e.target==="openApi3")return Cf(t,e);let r=t.options instanceof Map?Array.from(t.options.values()):t.options;if(r.every(n=>n._def.typeName in Dn&&(!n._def.checks||!n._def.checks.length))){let n=r.reduce((o,s)=>{let i=Dn[s._def.typeName];return i&&!o.includes(i)?[...o,i]:o},[]);return{type:n.length>1?n:n[0]}}else if(r.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){let n=r.reduce((o,s)=>{let i=typeof s._def.value;switch(i){case"string":case"number":case"boolean":return[...o,i];case"bigint":return[...o,"integer"];case"object":if(s._def.value===null)return[...o,"null"];default:return o}},[]);if(n.length===r.length){let o=n.filter((s,i,a)=>a.indexOf(s)===i);return{type:o.length>1?o:o[0],enum:r.reduce((s,i)=>s.includes(i._def.value)?s:[...s,i._def.value],[])}}}else if(r.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:r.reduce((n,o)=>[...n,...o._def.values.filter(s=>!n.includes(s))],[])};return Cf(t,e)}var Cf=(t,e)=>{let r=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((n,o)=>A(n._def,{...e,currentPath:[...e.currentPath,"anyOf",`${o}`]})).filter(n=>!!n&&(!e.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return r.length?{anyOf:r}:void 0};function jf(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"?{type:Dn[t.innerType._def.typeName],nullable:!0}:{type:[Dn[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){let n=A(t.innerType._def,{...e,currentPath:[...e.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}let r=A(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}function Af(t,e){let r={type:"number"};if(!t.checks)return r;for(let n of t.checks)switch(n.kind){case"int":r.type="integer",Vc(r,"type",n.message,e);break;case"min":e.target==="jsonSchema7"?n.inclusive?G(r,"minimum",n.value,n.message,e):G(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),G(r,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?G(r,"maximum",n.value,n.message,e):G(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),G(r,"maximum",n.value,n.message,e));break;case"multipleOf":G(r,"multipleOf",n.value,n.message,e);break}return r}function Mf(t,e){let r=e.target==="openAi",n={type:"object",properties:{}},o=[],s=t.shape();for(let a in s){let c=s[a];if(c===void 0||c._def===void 0)continue;let u=Yx(c);u&&r&&(c._def.typeName==="ZodOptional"&&(c=c._def.innerType),c.isNullable()||(c=c.nullable()),u=!1);let l=A(c._def,{...e,currentPath:[...e.currentPath,"properties",a],propertyPath:[...e.currentPath,"properties",a]});l!==void 0&&(n.properties[a]=l,u||o.push(a))}o.length&&(n.required=o);let i=Xx(t,e);return i!==void 0&&(n.additionalProperties=i),n}function Xx(t,e){if(t.catchall._def.typeName!=="ZodNever")return A(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]});switch(t.unknownKeys){case"passthrough":return e.allowedAdditionalProperties;case"strict":return e.rejectedAdditionalProperties;case"strip":return e.removeAdditionalStrategy==="strict"?e.allowedAdditionalProperties:e.rejectedAdditionalProperties}}function Yx(t){try{return t.isOptional()}catch{return!0}}var Df=(t,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return A(t.innerType._def,e);let r=A(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return r?{anyOf:[{not:pe(e)},r]}:pe(e)};var Lf=(t,e)=>{if(e.pipeStrategy==="input")return A(t.in._def,e);if(e.pipeStrategy==="output")return A(t.out._def,e);let r=A(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),n=A(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,n].filter(o=>o!==void 0)}};function qf(t,e){return A(t.type._def,e)}function Uf(t,e){let n={type:"array",uniqueItems:!0,items:A(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&G(n,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&G(n,"maxItems",t.maxSize.value,t.maxSize.message,e),n}function Ff(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((r,n)=>A(r._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[]),additionalItems:A(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((r,n)=>A(r._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[])}}function Vf(t){return{not:pe(t)}}function Hf(t){return pe(t)}var Bf=(t,e)=>A(t.innerType._def,e);var Kf=(t,e,r)=>{switch(e){case $.ZodString:return gs(t,r);case $.ZodNumber:return Af(t,r);case $.ZodObject:return Mf(t,r);case $.ZodBigInt:return xf(t,r);case $.ZodBoolean:return $f();case $.ZodDate:return Hc(t,r);case $.ZodUndefined:return Vf(r);case $.ZodNull:return Nf(r);case $.ZodArray:return bf(t,r);case $.ZodUnion:case $.ZodDiscriminatedUnion:return Zf(t,r);case $.ZodIntersection:return Tf(t,r);case $.ZodTuple:return Ff(t,r);case $.ZodRecord:return _s(t,r);case $.ZodLiteral:return Ef(t,r);case $.ZodEnum:return zf(t);case $.ZodNativeEnum:return If(t);case $.ZodNullable:return jf(t,r);case $.ZodOptional:return Df(t,r);case $.ZodMap:return Rf(t,r);case $.ZodSet:return Uf(t,r);case $.ZodLazy:return()=>t.getter()._def;case $.ZodPromise:return qf(t,r);case $.ZodNaN:case $.ZodNever:return Of(r);case $.ZodEffects:return Sf(t,r);case $.ZodAny:return pe(r);case $.ZodUnknown:return Hf(r);case $.ZodDefault:return kf(t,r);case $.ZodBranded:return hs(t,r);case $.ZodReadonly:return Bf(t,r);case $.ZodCatch:return wf(t,r);case $.ZodPipeline:return Lf(t,r);case $.ZodFunction:case $.ZodVoid:case $.ZodSymbol:return;default:return(n=>{})(e)}};function A(t,e,r=!1){let n=e.seen.get(t);if(e.override){let a=e.override?.(t,e,n,r);if(a!==_f)return a}if(n&&!r){let a=Qx(n,e);if(a!==void 0)return a}let o={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,o);let s=Kf(t,t.typeName,e),i=typeof s=="function"?A(s(),e):s;if(i&&e$(t,e,i),e.postProcess){let a=e.postProcess(i,t,e);return o.jsonSchema=i,a}return o.jsonSchema=i,i}var Qx=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"relative":return{$ref:ms(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((r,n)=>e.currentPath[n]===r)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),pe(e)):e.$refStrategy==="seen"?pe(e):void 0}},e$=(t,e,r)=>(t.description&&(r.description=t.description,e.markdownDescription&&(r.markdownDescription=t.description)),r);var Gc=(t,e)=>{let r=vf(e),n=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((c,[u,l])=>({...c,[u]:A(l._def,{...r,currentPath:[...r.basePath,r.definitionPath,u]},!0)??pe(r)}),{}):void 0,o=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,s=A(t._def,o===void 0?r:{...r,currentPath:[...r.basePath,r.definitionPath,o]},!1)??pe(r),i=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;i!==void 0&&(s.title=i),r.flags.hasReferencedOpenAiAnyType&&(n||(n={}),n[r.openAiAnyTypeName]||(n[r.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:r.$refStrategy==="relative"?"1":[...r.basePath,r.definitionPath,r.openAiAnyTypeName].join("/")}}));let a=o===void 0?n?{...s,[r.definitionPath]:n}:s:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,o].join("/"),[r.definitionPath]:{...n,[o]:s}};return r.target==="jsonSchema7"?a.$schema="http://json-schema.org/draft-07/schema#":(r.target==="jsonSchema2019-09"||r.target==="openAi")&&(a.$schema="https://json-schema.org/draft/2019-09/schema#"),r.target==="openAi"&&("anyOf"in a||"oneOf"in a||"allOf"in a||"type"in a&&Array.isArray(a.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),a};function t$(t){return!t||t==="jsonSchema7"||t==="draft-7"?"draft-7":t==="jsonSchema2019-09"||t==="draft-2020-12"?"draft-2020-12":"draft-7"}function Jc(t,e){return Je(t)?hc(t,{target:t$(e?.target),io:e?.pipeStrategy??"input"}):Gc(t,{strictUnions:e?.strictUnions??!0,pipeStrategy:e?.pipeStrategy??"input"})}function Wc(t){let r=Dt(t)?.method;if(!r)throw new Error("Schema is missing a method literal");let n=Fo(r);if(typeof n!="string")throw new Error("Schema method literal must be a string");return n}function Xc(t,e){let r=Mt(t,e);if(!r.success)throw r.error;return r.data}var r$=6e4,ys=class{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this._taskProgressTokens=new Map,this._requestResolvers=new Map,this.setNotificationHandler(Wo,r=>{this._oncancel(r)}),this.setNotificationHandler(Yo,r=>{this._onprogress(r)}),this.setRequestHandler(Xo,r=>({})),this._taskStore=e?.taskStore,this._taskMessageQueue=e?.taskMessageQueue,this._taskStore&&(this.setRequestHandler(Qo,async(r,n)=>{let o=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!o)throw new R(N.InvalidParams,"Failed to retrieve task: Task not found");return{...o}}),this.setRequestHandler(ts,async(r,n)=>{let o=async()=>{let s=r.params.taskId;if(this._taskMessageQueue){let a;for(;a=await this._taskMessageQueue.dequeue(s,n.sessionId);){if(a.type==="response"||a.type==="error"){let c=a.message,u=c.id,l=this._requestResolvers.get(u);if(l)if(this._requestResolvers.delete(u),a.type==="response")l(c);else{let d=c,m=new R(d.error.code,d.error.message,d.error.data);l(m)}else{let d=a.type==="response"?"Response":"Error";this._onerror(new Error(`${d} handler missing for request ${u}`))}continue}await this._transport?.send(a.message,{relatedRequestId:n.requestId})}}let i=await this._taskStore.getTask(s,n.sessionId);if(!i)throw new R(N.InvalidParams,`Task not found: ${s}`);if(!qt(i.status))return await this._waitForTaskUpdate(s,n.signal),await o();if(qt(i.status)){let a=await this._taskStore.getTaskResult(s,n.sessionId);return this._clearTaskQueue(s),{...a,_meta:{...a._meta,[Lt]:{taskId:s}}}}return await o()};return await o()}),this.setRequestHandler(rs,async(r,n)=>{try{let{tasks:o,nextCursor:s}=await this._taskStore.listTasks(r.params?.cursor,n.sessionId);return{tasks:o,nextCursor:s,_meta:{}}}catch(o){throw new R(N.InvalidParams,`Failed to list tasks: ${o instanceof Error?o.message:String(o)}`)}}),this.setRequestHandler(os,async(r,n)=>{try{let o=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!o)throw new R(N.InvalidParams,`Task not found: ${r.params.taskId}`);if(qt(o.status))throw new R(N.InvalidParams,`Cannot cancel task in terminal status: ${o.status}`);await this._taskStore.updateTaskStatus(r.params.taskId,"cancelled","Client cancelled task execution.",n.sessionId),this._clearTaskQueue(r.params.taskId);let s=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!s)throw new R(N.InvalidParams,`Task not found after cancellation: ${r.params.taskId}`);return{_meta:{},...s}}catch(o){throw o instanceof R?o:new R(N.InvalidRequest,`Failed to cancel task: ${o instanceof Error?o.message:String(o)}`)}}))}async _oncancel(e){if(!e.params.requestId)return;this._requestHandlerAbortControllers.get(e.params.requestId)?.abort(e.params.reason)}_setupTimeout(e,r,n,o,s=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(o,r),startTime:Date.now(),timeout:r,maxTotalTimeout:n,resetTimeoutOnProgress:s,onTimeout:o})}_resetTimeout(e){let r=this._timeoutInfo.get(e);if(!r)return!1;let n=Date.now()-r.startTime;if(r.maxTotalTimeout&&n>=r.maxTotalTimeout)throw this._timeoutInfo.delete(e),R.fromError(N.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:r.maxTotalTimeout,totalElapsed:n});return clearTimeout(r.timeoutId),r.timeoutId=setTimeout(r.onTimeout,r.timeout),!0}_cleanupTimeout(e){let r=this._timeoutInfo.get(e);r&&(clearTimeout(r.timeoutId),this._timeoutInfo.delete(e))}async connect(e){if(this._transport)throw new Error("Already connected to a transport. Call close() before connecting to a new transport, or use a separate Protocol instance per connection.");this._transport=e;let r=this.transport?.onclose;this._transport.onclose=()=>{r?.(),this._onclose()};let n=this.transport?.onerror;this._transport.onerror=s=>{n?.(s),this._onerror(s)};let o=this._transport?.onmessage;this._transport.onmessage=(s,i)=>{o?.(s,i),In(s)||of(s)?this._onresponse(s):Pc(s)?this._onrequest(s,i):nf(s)?this._onnotification(s):this._onerror(new Error(`Unknown message type: ${JSON.stringify(s)}`))},await this._transport.start()}_onclose(){let e=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._taskProgressTokens.clear(),this._pendingDebouncedNotifications.clear();for(let n of this._requestHandlerAbortControllers.values())n.abort();this._requestHandlerAbortControllers.clear();let r=R.fromError(N.ConnectionClosed,"Connection closed");this._transport=void 0,this.onclose?.();for(let n of e.values())n(r)}_onerror(e){this.onerror?.(e)}_onnotification(e){let r=this._notificationHandlers.get(e.method)??this.fallbackNotificationHandler;r!==void 0&&Promise.resolve().then(()=>r(e)).catch(n=>this._onerror(new Error(`Uncaught error in notification handler: ${n}`)))}_onrequest(e,r){let n=this._requestHandlers.get(e.method)??this.fallbackRequestHandler,o=this._transport,s=e.params?._meta?.[Lt]?.taskId;if(n===void 0){let l={jsonrpc:"2.0",id:e.id,error:{code:N.MethodNotFound,message:"Method not found"}};s&&this._taskMessageQueue?this._enqueueTaskMessage(s,{type:"error",message:l,timestamp:Date.now()},o?.sessionId).catch(d=>this._onerror(new Error(`Failed to enqueue error response: ${d}`))):o?.send(l).catch(d=>this._onerror(new Error(`Failed to send an error response: ${d}`)));return}let i=new AbortController;this._requestHandlerAbortControllers.set(e.id,i);let a=ef(e.params)?e.params.task:void 0,c=this._taskStore?this.requestTaskStore(e,o?.sessionId):void 0,u={signal:i.signal,sessionId:o?.sessionId,_meta:e.params?._meta,sendNotification:async l=>{if(i.signal.aborted)return;let d={relatedRequestId:e.id};s&&(d.relatedTask={taskId:s}),await this.notification(l,d)},sendRequest:async(l,d,m)=>{if(i.signal.aborted)throw new R(N.ConnectionClosed,"Request was cancelled");let f={...m,relatedRequestId:e.id};s&&!f.relatedTask&&(f.relatedTask={taskId:s});let p=f.relatedTask?.taskId??s;return p&&c&&await c.updateTaskStatus(p,"input_required"),await this.request(l,d,f)},authInfo:r?.authInfo,requestId:e.id,requestInfo:r?.requestInfo,taskId:s,taskStore:c,taskRequestedTtl:a?.ttl,closeSSEStream:r?.closeSSEStream,closeStandaloneSSEStream:r?.closeStandaloneSSEStream};Promise.resolve().then(()=>{a&&this.assertTaskHandlerCapability(e.method)}).then(()=>n(e,u)).then(async l=>{if(i.signal.aborted)return;let d={result:l,jsonrpc:"2.0",id:e.id};s&&this._taskMessageQueue?await this._enqueueTaskMessage(s,{type:"response",message:d,timestamp:Date.now()},o?.sessionId):await o?.send(d)},async l=>{if(i.signal.aborted)return;let d={jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(l.code)?l.code:N.InternalError,message:l.message??"Internal error",...l.data!==void 0&&{data:l.data}}};s&&this._taskMessageQueue?await this._enqueueTaskMessage(s,{type:"error",message:d,timestamp:Date.now()},o?.sessionId):await o?.send(d)}).catch(l=>this._onerror(new Error(`Failed to send response: ${l}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){let{progressToken:r,...n}=e.params,o=Number(r),s=this._progressHandlers.get(o);if(!s){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}let i=this._responseHandlers.get(o),a=this._timeoutInfo.get(o);if(a&&i&&a.resetTimeoutOnProgress)try{this._resetTimeout(o)}catch(c){this._responseHandlers.delete(o),this._progressHandlers.delete(o),this._cleanupTimeout(o),i(c);return}s(n)}_onresponse(e){let r=Number(e.id),n=this._requestResolvers.get(r);if(n){if(this._requestResolvers.delete(r),In(e))n(e);else{let i=new R(e.error.code,e.error.message,e.error.data);n(i)}return}let o=this._responseHandlers.get(r);if(o===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}this._responseHandlers.delete(r),this._cleanupTimeout(r);let s=!1;if(In(e)&&e.result&&typeof e.result=="object"){let i=e.result;if(i.task&&typeof i.task=="object"){let a=i.task;typeof a.taskId=="string"&&(s=!0,this._taskProgressTokens.set(a.taskId,r))}}if(s||this._progressHandlers.delete(r),In(e))o(e);else{let i=R.fromError(e.error.code,e.error.message,e.error.data);o(i)}}get transport(){return this._transport}async close(){await this._transport?.close()}async*requestStream(e,r,n){let{task:o}=n??{};if(!o){try{yield{type:"result",result:await this.request(e,r,n)}}catch(i){yield{type:"error",error:i instanceof R?i:new R(N.InternalError,String(i))}}return}let s;try{let i=await this.request(e,Vr,n);if(i.task)s=i.task.taskId,yield{type:"taskCreated",task:i.task};else throw new R(N.InternalError,"Task creation did not return a task");for(;;){let a=await this.getTask({taskId:s},n);if(yield{type:"taskStatus",task:a},qt(a.status)){a.status==="completed"?yield{type:"result",result:await this.getTaskResult({taskId:s},r,n)}:a.status==="failed"?yield{type:"error",error:new R(N.InternalError,`Task ${s} failed`)}:a.status==="cancelled"&&(yield{type:"error",error:new R(N.InternalError,`Task ${s} was cancelled`)});return}if(a.status==="input_required"){yield{type:"result",result:await this.getTaskResult({taskId:s},r,n)};return}let c=a.pollInterval??this._options?.defaultTaskPollInterval??1e3;await new Promise(u=>setTimeout(u,c)),n?.signal?.throwIfAborted()}}catch(i){yield{type:"error",error:i instanceof R?i:new R(N.InternalError,String(i))}}}request(e,r,n){let{relatedRequestId:o,resumptionToken:s,onresumptiontoken:i,task:a,relatedTask:c}=n??{};return new Promise((u,l)=>{let d=x=>{l(x)};if(!this._transport){d(new Error("Not connected"));return}if(this._options?.enforceStrictCapabilities===!0)try{this.assertCapabilityForMethod(e.method),a&&this.assertTaskCapability(e.method)}catch(x){d(x);return}n?.signal?.throwIfAborted();let m=this._requestMessageId++,f={...e,jsonrpc:"2.0",id:m};n?.onprogress&&(this._progressHandlers.set(m,n.onprogress),f.params={...e.params,_meta:{...e.params?._meta||{},progressToken:m}}),a&&(f.params={...f.params,task:a}),c&&(f.params={...f.params,_meta:{...f.params?._meta||{},[Lt]:c}});let p=x=>{this._responseHandlers.delete(m),this._progressHandlers.delete(m),this._cleanupTimeout(m),this._transport?.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:m,reason:String(x)}},{relatedRequestId:o,resumptionToken:s,onresumptiontoken:i}).catch(E=>this._onerror(new Error(`Failed to send cancellation: ${E}`)));let w=x instanceof R?x:new R(N.RequestTimeout,String(x));l(w)};this._responseHandlers.set(m,x=>{if(!n?.signal?.aborted){if(x instanceof Error)return l(x);try{let w=Mt(r,x.result);w.success?u(w.data):l(w.error)}catch(w){l(w)}}}),n?.signal?.addEventListener("abort",()=>{p(n?.signal?.reason)});let h=n?.timeout??r$,g=()=>p(R.fromError(N.RequestTimeout,"Request timed out",{timeout:h}));this._setupTimeout(m,h,n?.maxTotalTimeout,g,n?.resetTimeoutOnProgress??!1);let v=c?.taskId;if(v){let x=w=>{let E=this._responseHandlers.get(m);E?E(w):this._onerror(new Error(`Response handler missing for side-channeled request ${m}`))};this._requestResolvers.set(m,x),this._enqueueTaskMessage(v,{type:"request",message:f,timestamp:Date.now()}).catch(w=>{this._cleanupTimeout(m),l(w)})}else this._transport.send(f,{relatedRequestId:o,resumptionToken:s,onresumptiontoken:i}).catch(x=>{this._cleanupTimeout(m),l(x)})})}async getTask(e,r){return this.request({method:"tasks/get",params:e},es,r)}async getTaskResult(e,r,n){return this.request({method:"tasks/result",params:e},r,n)}async listTasks(e,r){return this.request({method:"tasks/list",params:e},ns,r)}async cancelTask(e,r){return this.request({method:"tasks/cancel",params:e},cf,r)}async notification(e,r){if(!this._transport)throw new Error("Not connected");this.assertNotificationCapability(e.method);let n=r?.relatedTask?.taskId;if(n){let a={...e,jsonrpc:"2.0",params:{...e.params,_meta:{...e.params?._meta||{},[Lt]:r.relatedTask}}};await this._enqueueTaskMessage(n,{type:"notification",message:a,timestamp:Date.now()});return}if((this._options?.debouncedNotificationMethods??[]).includes(e.method)&&!e.params&&!r?.relatedRequestId&&!r?.relatedTask){if(this._pendingDebouncedNotifications.has(e.method))return;this._pendingDebouncedNotifications.add(e.method),Promise.resolve().then(()=>{if(this._pendingDebouncedNotifications.delete(e.method),!this._transport)return;let a={...e,jsonrpc:"2.0"};r?.relatedTask&&(a={...a,params:{...a.params,_meta:{...a.params?._meta||{},[Lt]:r.relatedTask}}}),this._transport?.send(a,r).catch(c=>this._onerror(c))});return}let i={...e,jsonrpc:"2.0"};r?.relatedTask&&(i={...i,params:{...i.params,_meta:{...i.params?._meta||{},[Lt]:r.relatedTask}}}),await this._transport.send(i,r)}setRequestHandler(e,r){let n=Wc(e);this.assertRequestHandlerCapability(n),this._requestHandlers.set(n,(o,s)=>{let i=Xc(e,o);return Promise.resolve(r(i,s))})}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,r){let n=Wc(e);this._notificationHandlers.set(n,o=>{let s=Xc(e,o);return Promise.resolve(r(s))})}removeNotificationHandler(e){this._notificationHandlers.delete(e)}_cleanupTaskProgressHandler(e){let r=this._taskProgressTokens.get(e);r!==void 0&&(this._progressHandlers.delete(r),this._taskProgressTokens.delete(e))}async _enqueueTaskMessage(e,r,n){if(!this._taskStore||!this._taskMessageQueue)throw new Error("Cannot enqueue task message: taskStore and taskMessageQueue are not configured");let o=this._options?.maxTaskQueueSize;await this._taskMessageQueue.enqueue(e,r,n,o)}async _clearTaskQueue(e,r){if(this._taskMessageQueue){let n=await this._taskMessageQueue.dequeueAll(e,r);for(let o of n)if(o.type==="request"&&Pc(o.message)){let s=o.message.id,i=this._requestResolvers.get(s);i?(i(new R(N.InternalError,"Task cancelled or completed")),this._requestResolvers.delete(s)):this._onerror(new Error(`Resolver missing for request ${s} during task ${e} cleanup`))}}}async _waitForTaskUpdate(e,r){let n=this._options?.defaultTaskPollInterval??1e3;try{let o=await this._taskStore?.getTask(e);o?.pollInterval&&(n=o.pollInterval)}catch{}return new Promise((o,s)=>{if(r.aborted){s(new R(N.InvalidRequest,"Request cancelled"));return}let i=setTimeout(o,n);r.addEventListener("abort",()=>{clearTimeout(i),s(new R(N.InvalidRequest,"Request cancelled"))},{once:!0})})}requestTaskStore(e,r){let n=this._taskStore;if(!n)throw new Error("No task store configured");return{createTask:async o=>{if(!e)throw new Error("No request provided");return await n.createTask(o,e.id,{method:e.method,params:e.params},r)},getTask:async o=>{let s=await n.getTask(o,r);if(!s)throw new R(N.InvalidParams,"Failed to retrieve task: Task not found");return s},storeTaskResult:async(o,s,i)=>{await n.storeTaskResult(o,s,i,r);let a=await n.getTask(o,r);if(a){let c=jn.parse({method:"notifications/tasks/status",params:a});await this.notification(c),qt(a.status)&&this._cleanupTaskProgressHandler(o)}},getTaskResult:o=>n.getTaskResult(o,r),updateTaskStatus:async(o,s,i)=>{let a=await n.getTask(o,r);if(!a)throw new R(N.InvalidParams,`Task "${o}" not found - it may have been cleaned up`);if(qt(a.status))throw new R(N.InvalidParams,`Cannot update task "${o}" from terminal status "${a.status}" to "${s}". Terminal states (completed, failed, cancelled) cannot transition to other states.`);await n.updateTaskStatus(o,s,i,r);let c=await n.getTask(o,r);if(c){let u=jn.parse({method:"notifications/tasks/status",params:c});await this.notification(u),qt(c.status)&&this._cleanupTaskProgressHandler(o)}},listTasks:o=>n.listTasks(o,r)}}};function Gf(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function Jf(t,e){let r={...t};for(let n in e){let o=n,s=e[o];if(s===void 0)continue;let i=r[o];Gf(i)&&Gf(s)?r[o]={...i,...s}:r[o]=s}return r}var Zg=ed(jl(),1),jg=ed(Cg(),1);function Kz(){let t=new Zg.default({strict:!1,validateFormats:!0,validateSchema:!1,allErrors:!0});return(0,jg.default)(t),t}var ei=class{constructor(e){this._ajv=e??Kz()}getValidator(e){let r="$id"in e&&typeof e.$id=="string"?this._ajv.getSchema(e.$id)??this._ajv.compile(e):this._ajv.compile(e);return n=>r(n)?{valid:!0,data:n,errorMessage:void 0}:{valid:!1,data:void 0,errorMessage:this._ajv.errorsText(r.errors)}}};var ti=class{constructor(e){this._server=e}requestStream(e,r,n){return this._server.requestStream(e,r,n)}async getTask(e,r){return this._server.getTask({taskId:e},r)}async getTaskResult(e,r,n){return this._server.getTaskResult({taskId:e},r,n)}async listTasks(e,r){return this._server.listTasks(e?{cursor:e}:void 0,r)}async cancelTask(e,r){return this._server.cancelTask({taskId:e},r)}};function Ag(t,e,r){if(!t)throw new Error(`${r} does not support task creation (required for ${e})`);switch(e){case"tools/call":if(!t.tools?.call)throw new Error(`${r} does not support task creation for tools/call (required for ${e})`);break;default:break}}function Mg(t,e,r){if(!t)throw new Error(`${r} does not support task creation (required for ${e})`);switch(e){case"sampling/createMessage":if(!t.sampling?.createMessage)throw new Error(`${r} does not support task creation for sampling/createMessage (required for ${e})`);break;case"elicitation/create":if(!t.elicitation?.create)throw new Error(`${r} does not support task creation for elicitation/create (required for ${e})`);break;default:break}}var ri=class extends ys{constructor(e,r){super(r),this._serverInfo=e,this._loggingLevels=new Map,this.LOG_LEVEL_SEVERITY=new Map(Mn.options.map((n,o)=>[n,o])),this.isMessageIgnored=(n,o)=>{let s=this._loggingLevels.get(o);return s?this.LOG_LEVEL_SEVERITY.get(n)<this.LOG_LEVEL_SEVERITY.get(s):!1},this._capabilities=r?.capabilities??{},this._instructions=r?.instructions,this._jsonSchemaValidator=r?.jsonSchemaValidator??new ei,this.setRequestHandler(Oc,n=>this._oninitialize(n)),this.setNotificationHandler(Nc,()=>this.oninitialized?.()),this._capabilities.logging&&this.setRequestHandler(Lc,async(n,o)=>{let s=o.sessionId||o.requestInfo?.headers["mcp-session-id"]||void 0,{level:i}=n.params,a=Mn.safeParse(i);return a.success&&this._loggingLevels.set(s,a.data),{}})}get experimental(){return this._experimental||(this._experimental={tasks:new ti(this)}),this._experimental}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=Jf(this._capabilities,e)}setRequestHandler(e,r){let o=Dt(e)?.method;if(!o)throw new Error("Schema is missing a method literal");let s;if(Je(o)){let a=o;s=a._zod?.def?.value??a.value}else{let a=o;s=a._def?.value??a.value}if(typeof s!="string")throw new Error("Schema method literal must be a string");if(s==="tools/call"){let a=async(c,u)=>{let l=Mt(Br,c);if(!l.success){let p=l.error instanceof Error?l.error.message:String(l.error);throw new R(N.InvalidParams,`Invalid tools/call request: ${p}`)}let{params:d}=l.data,m=await Promise.resolve(r(c,u));if(d.task){let p=Mt(Vr,m);if(!p.success){let h=p.error instanceof Error?p.error.message:String(p.error);throw new R(N.InvalidParams,`Invalid task creation result: ${h}`)}return p.data}let f=Mt(ds,m);if(!f.success){let p=f.error instanceof Error?f.error.message:String(f.error);throw new R(N.InvalidParams,`Invalid tools/call result: ${p}`)}return f.data};return super.setRequestHandler(e,a)}return super.setRequestHandler(e,r)}assertCapabilityForMethod(e){switch(e){case"sampling/createMessage":if(!this._clientCapabilities?.sampling)throw new Error(`Client does not support sampling (required for ${e})`);break;case"elicitation/create":if(!this._clientCapabilities?.elicitation)throw new Error(`Client does not support elicitation (required for ${e})`);break;case"roots/list":if(!this._clientCapabilities?.roots)throw new Error(`Client does not support listing roots (required for ${e})`);break;case"ping":break}}assertNotificationCapability(e){switch(e){case"notifications/message":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"notifications/resources/updated":case"notifications/resources/list_changed":if(!this._capabilities.resources)throw new Error(`Server does not support notifying about resources (required for ${e})`);break;case"notifications/tools/list_changed":if(!this._capabilities.tools)throw new Error(`Server does not support notifying of tool list changes (required for ${e})`);break;case"notifications/prompts/list_changed":if(!this._capabilities.prompts)throw new Error(`Server does not support notifying of prompt list changes (required for ${e})`);break;case"notifications/elicitation/complete":if(!this._clientCapabilities?.elicitation?.url)throw new Error(`Client does not support URL elicitation (required for ${e})`);break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(e){if(this._capabilities)switch(e){case"completion/complete":if(!this._capabilities.completions)throw new Error(`Server does not support completions (required for ${e})`);break;case"logging/setLevel":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!this._capabilities.prompts)throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":if(!this._capabilities.resources)throw new Error(`Server does not support resources (required for ${e})`);break;case"tools/call":case"tools/list":if(!this._capabilities.tools)throw new Error(`Server does not support tools (required for ${e})`);break;case"tasks/get":case"tasks/list":case"tasks/result":case"tasks/cancel":if(!this._capabilities.tasks)throw new Error(`Server does not support tasks capability (required for ${e})`);break;case"ping":case"initialize":break}}assertTaskCapability(e){Mg(this._clientCapabilities?.tasks?.requests,e,"Client")}assertTaskHandlerCapability(e){this._capabilities&&Ag(this._capabilities.tasks?.requests,e,"Server")}async _oninitialize(e){let r=e.params.protocolVersion;return this._clientCapabilities=e.params.capabilities,this._clientVersion=e.params.clientInfo,{protocolVersion:Xp.includes(r)?r:Tc,capabilities:this.getCapabilities(),serverInfo:this._serverInfo,...this._instructions&&{instructions:this._instructions}}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return this._capabilities}async ping(){return this.request({method:"ping"},Jo)}async createMessage(e,r){if((e.tools||e.toolChoice)&&!this._clientCapabilities?.sampling?.tools)throw new Error("Client does not support sampling tools capability.");if(e.messages.length>0){let n=e.messages[e.messages.length-1],o=Array.isArray(n.content)?n.content:[n.content],s=o.some(u=>u.type==="tool_result"),i=e.messages.length>1?e.messages[e.messages.length-2]:void 0,a=i?Array.isArray(i.content)?i.content:[i.content]:[],c=a.some(u=>u.type==="tool_use");if(s){if(o.some(u=>u.type!=="tool_result"))throw new Error("The last message must contain only tool_result content if any is present");if(!c)throw new Error("tool_result blocks are not matching any tool_use from the previous message")}if(c){let u=new Set(a.filter(d=>d.type==="tool_use").map(d=>d.id)),l=new Set(o.filter(d=>d.type==="tool_result").map(d=>d.toolUseId));if(u.size!==l.size||![...u].every(d=>l.has(d)))throw new Error("ids of tool_result blocks and tool_use blocks from previous message do not match")}}return e.tools?this.request({method:"sampling/createMessage",params:e},Uc,r):this.request({method:"sampling/createMessage",params:e},qc,r)}async elicitInput(e,r){switch(e.mode??"form"){case"url":{if(!this._clientCapabilities?.elicitation?.url)throw new Error("Client does not support url elicitation.");let o=e;return this.request({method:"elicitation/create",params:o},ps,r)}case"form":{if(!this._clientCapabilities?.elicitation?.form)throw new Error("Client does not support form elicitation.");let o=e.mode==="form"?e:{...e,mode:"form"},s=await this.request({method:"elicitation/create",params:o},ps,r);if(s.action==="accept"&&s.content&&o.requestedSchema)try{let a=this._jsonSchemaValidator.getValidator(o.requestedSchema)(s.content);if(!a.valid)throw new R(N.InvalidParams,`Elicitation response content does not match requested schema: ${a.errorMessage}`)}catch(i){throw i instanceof R?i:new R(N.InternalError,`Error validating elicitation response: ${i instanceof Error?i.message:String(i)}`)}return s}}}createElicitationCompletionNotifier(e,r){if(!this._clientCapabilities?.elicitation?.url)throw new Error("Client does not support URL elicitation (required for notifications/elicitation/complete)");return()=>this.notification({method:"notifications/elicitation/complete",params:{elicitationId:e}},r)}async listRoots(e,r){return this.request({method:"roots/list",params:e},Fc,r)}async sendLoggingMessage(e,r){if(this._capabilities.logging&&!this.isMessageIgnored(e.level,r))return this.notification({method:"notifications/message",params:e})}async sendResourceUpdated(e){return this.notification({method:"notifications/resources/updated",params:e})}async sendResourceListChanged(){return this.notification({method:"notifications/resources/list_changed"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}};var Lg=Symbol.for("mcp.completable");function Vl(t){return!!t&&typeof t=="object"&&Lg in t}function qg(t){return t[Lg]?.complete}var Dg;(function(t){t.Completable="McpCompletable"})(Dg||(Dg={}));var Gz=/^[A-Za-z0-9._-]{1,128}$/;function Jz(t){let e=[];if(t.length===0)return{isValid:!1,warnings:["Tool name cannot be empty"]};if(t.length>128)return{isValid:!1,warnings:[`Tool name exceeds maximum length of 128 characters (current: ${t.length})`]};if(t.includes(" ")&&e.push("Tool name contains spaces, which may cause parsing issues"),t.includes(",")&&e.push("Tool name contains commas, which may cause parsing issues"),(t.startsWith("-")||t.endsWith("-"))&&e.push("Tool name starts or ends with a dash, which may cause parsing issues in some contexts"),(t.startsWith(".")||t.endsWith("."))&&e.push("Tool name starts or ends with a dot, which may cause parsing issues in some contexts"),!Gz.test(t)){let r=t.split("").filter(n=>!/[A-Za-z0-9._-]/.test(n)).filter((n,o,s)=>s.indexOf(n)===o);return e.push(`Tool name contains invalid characters: ${r.map(n=>`"${n}"`).join(", ")}`,"Allowed characters are: A-Z, a-z, 0-9, underscore (_), dash (-), and dot (.)"),{isValid:!1,warnings:e}}return{isValid:!0,warnings:e}}function Wz(t,e){if(e.length>0){console.warn(`Tool name validation warning for "${t}":`);for(let r of e)console.warn(`  - ${r}`);console.warn("Tool registration will proceed, but this may cause compatibility issues."),console.warn("Consider updating the tool name to conform to the MCP tool naming standard."),console.warn("See SEP: Specify Format for Tool Names (https://github.com/modelcontextprotocol/modelcontextprotocol/issues/986) for more details.")}}function Hl(t){let e=Jz(t);return Wz(t,e.warnings),e.isValid}var ni=class{constructor(e){this._mcpServer=e}registerToolTask(e,r,n){let o={taskSupport:"required",...r.execution};if(o.taskSupport==="forbidden")throw new Error(`Cannot register task-based tool '${e}' with taskSupport 'forbidden'. Use registerTool() instead.`);return this._mcpServer._createRegisteredTool(e,r.title,r.description,r.inputSchema,r.outputSchema,r.annotations,o,r._meta,n)}};var oi=class{constructor(e,r){this._registeredResources={},this._registeredResourceTemplates={},this._registeredTools={},this._registeredPrompts={},this._toolHandlersInitialized=!1,this._completionHandlerInitialized=!1,this._resourceHandlersInitialized=!1,this._promptHandlersInitialized=!1,this.server=new ri(e,r)}get experimental(){return this._experimental||(this._experimental={tasks:new ni(this)}),this._experimental}async connect(e){return await this.server.connect(e)}async close(){await this.server.close()}setToolRequestHandlers(){this._toolHandlersInitialized||(this.server.assertCanSetRequestHandler(Wt(ls)),this.server.assertCanSetRequestHandler(Wt(Br)),this.server.registerCapabilities({tools:{listChanged:!0}}),this.server.setRequestHandler(ls,()=>({tools:Object.entries(this._registeredTools).filter(([,e])=>e.enabled).map(([e,r])=>{let n={name:e,title:r.title,description:r.description,inputSchema:(()=>{let o=Ur(r.inputSchema);return o?Jc(o,{strictUnions:!0,pipeStrategy:"input"}):Xz})(),annotations:r.annotations,execution:r.execution,_meta:r._meta};if(r.outputSchema){let o=Ur(r.outputSchema);o&&(n.outputSchema=Jc(o,{strictUnions:!0,pipeStrategy:"output"}))}return n})})),this.server.setRequestHandler(Br,async(e,r)=>{try{let n=this._registeredTools[e.params.name];if(!n)throw new R(N.InvalidParams,`Tool ${e.params.name} not found`);if(!n.enabled)throw new R(N.InvalidParams,`Tool ${e.params.name} disabled`);let o=!!e.params.task,s=n.execution?.taskSupport,i="createTask"in n.handler;if((s==="required"||s==="optional")&&!i)throw new R(N.InternalError,`Tool ${e.params.name} has taskSupport '${s}' but was not registered with registerToolTask`);if(s==="required"&&!o)throw new R(N.MethodNotFound,`Tool ${e.params.name} requires task augmentation (taskSupport: 'required')`);if(s==="optional"&&!o&&i)return await this.handleAutomaticTaskPolling(n,e,r);let a=await this.validateToolInput(n,e.params.arguments,e.params.name),c=await this.executeToolHandler(n,a,r);return o||await this.validateToolOutput(n,c,e.params.name),c}catch(n){if(n instanceof R&&n.code===N.UrlElicitationRequired)throw n;return this.createToolError(n instanceof Error?n.message:String(n))}}),this._toolHandlersInitialized=!0)}createToolError(e){return{content:[{type:"text",text:e}],isError:!0}}async validateToolInput(e,r,n){if(!e.inputSchema)return;let s=Ur(e.inputSchema)??e.inputSchema,i=await qo(s,r);if(!i.success){let a="error"in i?i.error:"Unknown error",c=Uo(a);throw new R(N.InvalidParams,`Input validation error: Invalid arguments for tool ${n}: ${c}`)}return i.data}async validateToolOutput(e,r,n){if(!e.outputSchema||!("content"in r)||r.isError)return;if(!r.structuredContent)throw new R(N.InvalidParams,`Output validation error: Tool ${n} has an output schema but no structured content was provided`);let o=Ur(e.outputSchema),s=await qo(o,r.structuredContent);if(!s.success){let i="error"in s?s.error:"Unknown error",a=Uo(i);throw new R(N.InvalidParams,`Output validation error: Invalid structured content for tool ${n}: ${a}`)}}async executeToolHandler(e,r,n){let o=e.handler;if("createTask"in o){if(!n.taskStore)throw new Error("No task store provided.");let i={...n,taskStore:n.taskStore};if(e.inputSchema){let a=o;return await Promise.resolve(a.createTask(r,i))}else{let a=o;return await Promise.resolve(a.createTask(i))}}if(e.inputSchema){let i=o;return await Promise.resolve(i(r,n))}else{let i=o;return await Promise.resolve(i(n))}}async handleAutomaticTaskPolling(e,r,n){if(!n.taskStore)throw new Error("No task store provided for task-capable tool.");let o=await this.validateToolInput(e,r.params.arguments,r.params.name),s=e.handler,i={...n,taskStore:n.taskStore},a=o?await Promise.resolve(s.createTask(o,i)):await Promise.resolve(s.createTask(i)),c=a.task.taskId,u=a.task,l=u.pollInterval??5e3;for(;u.status!=="completed"&&u.status!=="failed"&&u.status!=="cancelled";){await new Promise(m=>setTimeout(m,l));let d=await n.taskStore.getTask(c);if(!d)throw new R(N.InternalError,`Task ${c} not found during polling`);u=d}return await n.taskStore.getTaskResult(c)}setCompletionRequestHandler(){this._completionHandlerInitialized||(this.server.assertCanSetRequestHandler(Wt(fs)),this.server.registerCapabilities({completions:{}}),this.server.setRequestHandler(fs,async e=>{switch(e.params.ref.type){case"ref/prompt":return mf(e),this.handlePromptCompletion(e,e.params.ref);case"ref/resource":return hf(e),this.handleResourceCompletion(e,e.params.ref);default:throw new R(N.InvalidParams,`Invalid completion reference: ${e.params.ref}`)}}),this._completionHandlerInitialized=!0)}async handlePromptCompletion(e,r){let n=this._registeredPrompts[r.name];if(!n)throw new R(N.InvalidParams,`Prompt ${r.name} not found`);if(!n.enabled)throw new R(N.InvalidParams,`Prompt ${r.name} disabled`);if(!n.argsSchema)return go;let s=Dt(n.argsSchema)?.[e.params.argument.name];if(!Vl(s))return go;let i=qg(s);if(!i)return go;let a=await i(e.params.argument.value,e.params.context);return Fg(a)}async handleResourceCompletion(e,r){let n=Object.values(this._registeredResourceTemplates).find(i=>i.resourceTemplate.uriTemplate.toString()===r.uri);if(!n){if(this._registeredResources[r.uri])return go;throw new R(N.InvalidParams,`Resource template ${e.params.ref.uri} not found`)}let o=n.resourceTemplate.completeCallback(e.params.argument.name);if(!o)return go;let s=await o(e.params.argument.value,e.params.context);return Fg(s)}setResourceRequestHandlers(){this._resourceHandlersInitialized||(this.server.assertCanSetRequestHandler(Wt(ss)),this.server.assertCanSetRequestHandler(Wt(is)),this.server.assertCanSetRequestHandler(Wt(as)),this.server.registerCapabilities({resources:{listChanged:!0}}),this.server.setRequestHandler(ss,async(e,r)=>{let n=Object.entries(this._registeredResources).filter(([s,i])=>i.enabled).map(([s,i])=>({uri:s,name:i.name,...i.metadata})),o=[];for(let s of Object.values(this._registeredResourceTemplates)){if(!s.resourceTemplate.listCallback)continue;let i=await s.resourceTemplate.listCallback(r);for(let a of i.resources)o.push({...s.metadata,...a})}return{resources:[...n,...o]}}),this.server.setRequestHandler(is,async()=>({resourceTemplates:Object.entries(this._registeredResourceTemplates).map(([r,n])=>({name:r,uriTemplate:n.resourceTemplate.uriTemplate.toString(),...n.metadata}))})),this.server.setRequestHandler(as,async(e,r)=>{let n=new URL(e.params.uri),o=this._registeredResources[n.toString()];if(o){if(!o.enabled)throw new R(N.InvalidParams,`Resource ${n} disabled`);return o.readCallback(n,r)}for(let s of Object.values(this._registeredResourceTemplates)){let i=s.resourceTemplate.uriTemplate.match(n.toString());if(i)return s.readCallback(n,i,r)}throw new R(N.InvalidParams,`Resource ${n} not found`)}),this._resourceHandlersInitialized=!0)}setPromptRequestHandlers(){this._promptHandlersInitialized||(this.server.assertCanSetRequestHandler(Wt(cs)),this.server.assertCanSetRequestHandler(Wt(us)),this.server.registerCapabilities({prompts:{listChanged:!0}}),this.server.setRequestHandler(cs,()=>({prompts:Object.entries(this._registeredPrompts).filter(([,e])=>e.enabled).map(([e,r])=>({name:e,title:r.title,description:r.description,arguments:r.argsSchema?Qz(r.argsSchema):void 0}))})),this.server.setRequestHandler(us,async(e,r)=>{let n=this._registeredPrompts[e.params.name];if(!n)throw new R(N.InvalidParams,`Prompt ${e.params.name} not found`);if(!n.enabled)throw new R(N.InvalidParams,`Prompt ${e.params.name} disabled`);if(n.argsSchema){let o=Ur(n.argsSchema),s=await qo(o,e.params.arguments);if(!s.success){let c="error"in s?s.error:"Unknown error",u=Uo(c);throw new R(N.InvalidParams,`Invalid arguments for prompt ${e.params.name}: ${u}`)}let i=s.data,a=n.callback;return await Promise.resolve(a(i,r))}else{let o=n.callback;return await Promise.resolve(o(r))}}),this._promptHandlersInitialized=!0)}resource(e,r,...n){let o;typeof n[0]=="object"&&(o=n.shift());let s=n[0];if(typeof r=="string"){if(this._registeredResources[r])throw new Error(`Resource ${r} is already registered`);let i=this._createRegisteredResource(e,void 0,r,o,s);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),i}else{if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);let i=this._createRegisteredResourceTemplate(e,void 0,r,o,s);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),i}}registerResource(e,r,n,o){if(typeof r=="string"){if(this._registeredResources[r])throw new Error(`Resource ${r} is already registered`);let s=this._createRegisteredResource(e,n.title,r,n,o);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),s}else{if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);let s=this._createRegisteredResourceTemplate(e,n.title,r,n,o);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),s}}_createRegisteredResource(e,r,n,o,s){let i={name:e,title:r,metadata:o,readCallback:s,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({uri:null}),update:a=>{typeof a.uri<"u"&&a.uri!==n&&(delete this._registeredResources[n],a.uri&&(this._registeredResources[a.uri]=i)),typeof a.name<"u"&&(i.name=a.name),typeof a.title<"u"&&(i.title=a.title),typeof a.metadata<"u"&&(i.metadata=a.metadata),typeof a.callback<"u"&&(i.readCallback=a.callback),typeof a.enabled<"u"&&(i.enabled=a.enabled),this.sendResourceListChanged()}};return this._registeredResources[n]=i,i}_createRegisteredResourceTemplate(e,r,n,o,s){let i={resourceTemplate:n,title:r,metadata:o,readCallback:s,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({name:null}),update:u=>{typeof u.name<"u"&&u.name!==e&&(delete this._registeredResourceTemplates[e],u.name&&(this._registeredResourceTemplates[u.name]=i)),typeof u.title<"u"&&(i.title=u.title),typeof u.template<"u"&&(i.resourceTemplate=u.template),typeof u.metadata<"u"&&(i.metadata=u.metadata),typeof u.callback<"u"&&(i.readCallback=u.callback),typeof u.enabled<"u"&&(i.enabled=u.enabled),this.sendResourceListChanged()}};this._registeredResourceTemplates[e]=i;let a=n.uriTemplate.variableNames;return Array.isArray(a)&&a.some(u=>!!n.completeCallback(u))&&this.setCompletionRequestHandler(),i}_createRegisteredPrompt(e,r,n,o,s){let i={title:r,description:n,argsSchema:o===void 0?void 0:vr(o),callback:s,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({name:null}),update:a=>{typeof a.name<"u"&&a.name!==e&&(delete this._registeredPrompts[e],a.name&&(this._registeredPrompts[a.name]=i)),typeof a.title<"u"&&(i.title=a.title),typeof a.description<"u"&&(i.description=a.description),typeof a.argsSchema<"u"&&(i.argsSchema=vr(a.argsSchema)),typeof a.callback<"u"&&(i.callback=a.callback),typeof a.enabled<"u"&&(i.enabled=a.enabled),this.sendPromptListChanged()}};return this._registeredPrompts[e]=i,o&&Object.values(o).some(c=>{let u=c instanceof Ze?c._def?.innerType:c;return Vl(u)})&&this.setCompletionRequestHandler(),i}_createRegisteredTool(e,r,n,o,s,i,a,c,u){Hl(e);let l={title:r,description:n,inputSchema:Ug(o),outputSchema:Ug(s),annotations:i,execution:a,_meta:c,handler:u,enabled:!0,disable:()=>l.update({enabled:!1}),enable:()=>l.update({enabled:!0}),remove:()=>l.update({name:null}),update:d=>{typeof d.name<"u"&&d.name!==e&&(typeof d.name=="string"&&Hl(d.name),delete this._registeredTools[e],d.name&&(this._registeredTools[d.name]=l)),typeof d.title<"u"&&(l.title=d.title),typeof d.description<"u"&&(l.description=d.description),typeof d.paramsSchema<"u"&&(l.inputSchema=vr(d.paramsSchema)),typeof d.outputSchema<"u"&&(l.outputSchema=vr(d.outputSchema)),typeof d.callback<"u"&&(l.handler=d.callback),typeof d.annotations<"u"&&(l.annotations=d.annotations),typeof d._meta<"u"&&(l._meta=d._meta),typeof d.enabled<"u"&&(l.enabled=d.enabled),this.sendToolListChanged()}};return this._registeredTools[e]=l,this.setToolRequestHandlers(),this.sendToolListChanged(),l}tool(e,...r){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);let n,o,s,i;if(typeof r[0]=="string"&&(n=r.shift()),r.length>1){let c=r[0];Bl(c)?(o=r.shift(),r.length>1&&typeof r[0]=="object"&&r[0]!==null&&!Bl(r[0])&&(i=r.shift())):typeof c=="object"&&c!==null&&(i=r.shift())}let a=r[0];return this._createRegisteredTool(e,void 0,n,o,s,i,{taskSupport:"forbidden"},void 0,a)}registerTool(e,r,n){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);let{title:o,description:s,inputSchema:i,outputSchema:a,annotations:c,_meta:u}=r;return this._createRegisteredTool(e,o,s,i,a,c,{taskSupport:"forbidden"},u,n)}prompt(e,...r){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);let n;typeof r[0]=="string"&&(n=r.shift());let o;r.length>1&&(o=r.shift());let s=r[0],i=this._createRegisteredPrompt(e,void 0,n,o,s);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),i}registerPrompt(e,r,n){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);let{title:o,description:s,argsSchema:i}=r,a=this._createRegisteredPrompt(e,o,s,i,n);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),a}isConnected(){return this.server.transport!==void 0}async sendLoggingMessage(e,r){return this.server.sendLoggingMessage(e,r)}sendResourceListChanged(){this.isConnected()&&this.server.sendResourceListChanged()}sendToolListChanged(){this.isConnected()&&this.server.sendToolListChanged()}sendPromptListChanged(){this.isConnected()&&this.server.sendPromptListChanged()}};var Xz={type:"object",properties:{}};function Vg(t){return t!==null&&typeof t=="object"&&"parse"in t&&typeof t.parse=="function"&&"safeParse"in t&&typeof t.safeParse=="function"}function Yz(t){return"_def"in t||"_zod"in t||Vg(t)}function Bl(t){return typeof t!="object"||t===null||Yz(t)?!1:Object.keys(t).length===0?!0:Object.values(t).some(Vg)}function Ug(t){if(t)return Bl(t)?vr(t):t}function Qz(t){let e=Dt(t);return e?Object.entries(e).map(([r,n])=>{let o=Ep(n),s=Pp(n);return{name:r,description:o,required:!s}}):[]}function Wt(t){let r=Dt(t)?.method;if(!r)throw new Error("Schema is missing a method literal");let n=Fo(r);if(typeof n=="string")return n;throw new Error("Schema method literal must be a string")}function Fg(t){return{completion:{values:t.slice(0,100),total:t.length,hasMore:t.length>100}}}var go={completion:{values:[],hasMore:!1}};import Bg from"node:process";var si=class{append(e){this._buffer=this._buffer?Buffer.concat([this._buffer,e]):e}readMessage(){if(!this._buffer)return null;let e=this._buffer.indexOf(`
`);if(e===-1)return null;let r=this._buffer.toString("utf8",0,e).replace(/\r$/,"");return this._buffer=this._buffer.subarray(e+1),eT(r)}clear(){this._buffer=void 0}};function eT(t){return sf.parse(JSON.parse(t))}function Hg(t){return JSON.stringify(t)+`
`}var ii=class{constructor(e=Bg.stdin,r=Bg.stdout){this._stdin=e,this._stdout=r,this._readBuffer=new si,this._started=!1,this._ondata=n=>{this._readBuffer.append(n),this.processReadBuffer()},this._onerror=n=>{this.onerror?.(n)}}async start(){if(this._started)throw new Error("StdioServerTransport already started! If using Server class, note that connect() calls start() automatically.");this._started=!0,this._stdin.on("data",this._ondata),this._stdin.on("error",this._onerror)}processReadBuffer(){for(;;)try{let e=this._readBuffer.readMessage();if(e===null)break;this.onmessage?.(e)}catch(e){this.onerror?.(e)}}async close(){this._stdin.off("data",this._ondata),this._stdin.off("error",this._onerror),this._stdin.listenerCount("data")===0&&this._stdin.pause(),this._readBuffer.clear(),this.onclose?.()}send(e){return new Promise(r=>{let n=Hg(e);this._stdout.write(n)?r():this._stdout.once("drain",r)})}};import{spawn as tT,execSync as rT}from"node:child_process";import{mkdtempSync as nT,writeFileSync as Xg,rmSync as oT}from"node:fs";import{join as Yg,resolve as sT}from"node:path";import{tmpdir as iT}from"node:os";import{execSync as Kg}from"node:child_process";function Ue(t){try{return Kg(`command -v ${t} 2>/dev/null`,{stdio:"pipe"}),!0}catch{return!1}}function xt(t){try{return Kg(`${t} --version 2>/dev/null`,{encoding:"utf-8",timeout:5e3}).trim().split(`
`)[0]}catch{return"unknown"}}function ai(){let t=Ue("bun");return{javascript:t?"bun":"node",typescript:t?"bun":Ue("tsx")?"tsx":Ue("ts-node")?"ts-node":null,python:Ue("python3")?"python3":Ue("python")?"python":null,shell:Ue("bash")?"bash":"sh",ruby:Ue("ruby")?"ruby":null,go:Ue("go")?"go":null,rust:Ue("rustc")?"rustc":null,php:Ue("php")?"php":null,perl:Ue("perl")?"perl":null,r:Ue("Rscript")?"Rscript":Ue("r")?"r":null}}function Kl(){return Ue("bun")}function Gg(t){let e=[],r=t.javascript==="bun";return e.push(`  JavaScript: ${t.javascript} (${xt(t.javascript)})${r?" \u26A1":""}`),t.typescript?e.push(`  TypeScript: ${t.typescript} (${xt(t.typescript)})`):e.push("  TypeScript: not available (install bun, tsx, or ts-node)"),t.python?e.push(`  Python:     ${t.python} (${xt(t.python)})`):e.push("  Python:     not available"),e.push(`  Shell:      ${t.shell} (${xt(t.shell)})`),t.ruby&&e.push(`  Ruby:       ${t.ruby} (${xt(t.ruby)})`),t.go&&e.push(`  Go:         ${t.go} (${xt(t.go)})`),t.rust&&e.push(`  Rust:       ${t.rust} (${xt(t.rust)})`),t.php&&e.push(`  PHP:        ${t.php} (${xt(t.php)})`),t.perl&&e.push(`  Perl:       ${t.perl} (${xt(t.perl)})`),t.r&&e.push(`  R:          ${t.r} (${xt(t.r)})`),r||(e.push(""),e.push("  Tip: Install Bun for 3-5x faster JS/TS execution \u2192 https://bun.sh")),e.join(`
`)}function Jg(t){let e=["javascript","shell"];return t.typescript&&e.push("typescript"),t.python&&e.push("python"),t.ruby&&e.push("ruby"),t.go&&e.push("go"),t.rust&&e.push("rust"),t.php&&e.push("php"),t.perl&&e.push("perl"),t.r&&e.push("r"),e}function Wg(t,e,r){switch(e){case"javascript":return t.javascript==="bun"?["bun","run",r]:["node",r];case"typescript":if(!t.typescript)throw new Error("No TypeScript runtime available. Install one of: bun (recommended), tsx (npm i -g tsx), or ts-node.");return t.typescript==="bun"?["bun","run",r]:t.typescript==="tsx"?["tsx",r]:["ts-node",r];case"python":if(!t.python)throw new Error("No Python runtime available. Install python3 or python.");return[t.python,r];case"shell":return[t.shell,r];case"ruby":if(!t.ruby)throw new Error("Ruby not available. Install ruby.");return[t.ruby,r];case"go":if(!t.go)throw new Error("Go not available. Install go.");return["go","run",r];case"rust":{if(!t.rust)throw new Error("Rust not available. Install rustc via https://rustup.rs");return["__rust_compile_run__",r]}case"php":if(!t.php)throw new Error("PHP not available. Install php.");return["php",r];case"perl":if(!t.perl)throw new Error("Perl not available. Install perl.");return["perl",r];case"r":if(!t.r)throw new Error("R not available. Install R / Rscript.");return[t.r,r]}}var ci=class t{#e;#r;#t;constructor(e){this.#e=e?.maxOutputBytes??102400,this.#r=e?.projectRoot??process.cwd(),this.#t=e?.runtimes??ai()}get runtimes(){return{...this.#t}}async execute(e){let{language:r,code:n,timeout:o=3e4}=e,s=nT(Yg(iT(),"ctx-mode-"));try{let i=this.#n(s,n,r),a=Wg(this.#t,r,i);return a[0]==="__rust_compile_run__"?await this.#o(i,s,o):await this.#i(a,s,o)}finally{oT(s,{recursive:!0,force:!0})}}async executeFile(e){let{path:r,language:n,code:o,timeout:s=3e4}=e,i=sT(this.#r,r),a=this.#c(i,n,o);return this.execute({language:n,code:a,timeout:s})}#n(e,r,n){let o={javascript:"js",typescript:"ts",python:"py",shell:"sh",ruby:"rb",go:"go",rust:"rs",php:"php",perl:"pl",r:"R"};n==="go"&&!r.includes("package ")&&(r=`package main

import "fmt"

func main() {
${r}
}
`),n==="php"&&!r.trimStart().startsWith("<?")&&(r=`<?php
${r}`);let s=Yg(e,`script.${o[n]}`);return n==="shell"?Xg(s,r,{encoding:"utf-8",mode:448}):Xg(s,r,"utf-8"),s}async#o(e,r,n){let o=e.replace(/\.rs$/,"");try{rT(`rustc ${e} -o ${o} 2>&1`,{cwd:r,timeout:Math.min(n,3e4),encoding:"utf-8"})}catch(s){return{stdout:"",stderr:`Compilation failed:
${s instanceof Error?s.stderr||s.message:String(s)}`,exitCode:1,timedOut:!1}}return this.#i([o],r,n)}static#s(e,r){if(Buffer.byteLength(e)<=r)return e;let n=e.split(`
`),o=Math.floor(r*.6),s=r-o,i=[],a=0;for(let f of n){let p=Buffer.byteLength(f)+1;if(a+p>o)break;i.push(f),a+=p}let c=[],u=0;for(let f=n.length-1;f>=i.length;f--){let p=Buffer.byteLength(n[f])+1;if(u+p>s)break;c.unshift(n[f]),u+=p}let l=n.length-i.length-c.length,d=Buffer.byteLength(e)-a-u,m=`

... [${l} lines / ${(d/1024).toFixed(1)}KB truncated \u2014 showing first ${i.length} + last ${c.length} lines] ...

`;return i.join(`
`)+m+c.join(`
`)}async#i(e,r,n){return new Promise(o=>{let s=tT(e[0],e.slice(1),{cwd:r,stdio:["ignore","pipe","pipe"],env:this.#a(r)}),i=!1,a=setTimeout(()=>{i=!0,s.kill("SIGKILL")},n),c=[],u=[];s.stdout.on("data",l=>{c.push(l)}),s.stderr.on("data",l=>{u.push(l)}),s.on("close",l=>{clearTimeout(a);let d=Buffer.concat(c).toString("utf-8"),m=Buffer.concat(u).toString("utf-8"),f=this.#e,p=t.#s(d,f),h=t.#s(m,f);o({stdout:p,stderr:h,exitCode:i?1:l??1,timedOut:i})}),s.on("error",l=>{clearTimeout(a),o({stdout:"",stderr:l.message,exitCode:1,timedOut:!1})})})}#a(e){let r=process.env.HOME??process.env.USERPROFILE??e,n=["GH_TOKEN","GITHUB_TOKEN","GH_HOST","AWS_ACCESS_KEY_ID","AWS_SECRET_ACCESS_KEY","AWS_SESSION_TOKEN","AWS_REGION","AWS_DEFAULT_REGION","AWS_PROFILE","GOOGLE_APPLICATION_CREDENTIALS","CLOUDSDK_CONFIG","DOCKER_HOST","KUBECONFIG","NPM_TOKEN","NODE_AUTH_TOKEN","npm_config_registry","HTTP_PROXY","HTTPS_PROXY","NO_PROXY","SSL_CERT_FILE","CURL_CA_BUNDLE","XDG_CONFIG_HOME","XDG_DATA_HOME"],o={PATH:process.env.PATH??"/usr/local/bin:/usr/bin:/bin",HOME:r,TMPDIR:e,LANG:"en_US.UTF-8",PYTHONDONTWRITEBYTECODE:"1",PYTHONUNBUFFERED:"1",NO_COLOR:"1"};for(let s of n)process.env[s]&&(o[s]=process.env[s]);return o}#c(e,r,n){let o=JSON.stringify(e);switch(r){case"javascript":case"typescript":return`const FILE_CONTENT_PATH = ${o};
const FILE_CONTENT = require("fs").readFileSync(FILE_CONTENT_PATH, "utf-8");
${n}`;case"python":return`FILE_CONTENT_PATH = ${o}
with open(FILE_CONTENT_PATH, "r") as _f:
    FILE_CONTENT = _f.read()
${n}`;case"shell":return`FILE_CONTENT_PATH=${o}
FILE_CONTENT=$(cat ${o})
${n}`;case"ruby":return`FILE_CONTENT_PATH = ${o}
FILE_CONTENT = File.read(FILE_CONTENT_PATH)
${n}`;case"go":return`package main

import (
	"fmt"
	"os"
)

var FILE_CONTENT_PATH = ${o}

func main() {
	b, _ := os.ReadFile(FILE_CONTENT_PATH)
	FILE_CONTENT := string(b)
	_ = FILE_CONTENT
	_ = fmt.Sprint()
${n}
}
`;case"rust":return`use std::fs;

fn main() {
    let file_content_path = ${o};
    let file_content = fs::read_to_string(file_content_path).unwrap();
${n}
}
`;case"php":return`<?php
$FILE_CONTENT_PATH = ${o};
$FILE_CONTENT = file_get_contents($FILE_CONTENT_PATH);
${n}`;case"perl":return`my $FILE_CONTENT_PATH = ${o};
open(my $fh, '<', $FILE_CONTENT_PATH) or die "Cannot open: $!";
my $FILE_CONTENT = do { local $/; <$fh> };
close($fh);
${n}`;case"r":return`FILE_CONTENT_PATH <- ${o}
FILE_CONTENT <- readLines(FILE_CONTENT_PATH, warn=FALSE)
FILE_CONTENT <- paste(FILE_CONTENT, collapse="\\n")
${n}`}}};import{createRequire as aT}from"node:module";import{readFileSync as cT}from"node:fs";import{tmpdir as uT}from"node:os";import{join as lT}from"node:path";var Gl=null;function dT(){return Gl||(Gl=aT(import.meta.url)("better-sqlite3")),Gl}var pT=new Set(["the","and","for","are","but","not","you","all","can","had","her","was","one","our","out","has","his","how","its","may","new","now","old","see","way","who","did","get","got","let","say","she","too","use","will","with","this","that","from","they","been","have","many","some","them","than","each","make","like","just","over","such","take","into","year","your","good","could","would","about","which","their","there","other","after","should","through","also","more","most","only","very","when","what","then","these","those","being","does","done","both","same","still","while","where","here","were","much","update","updates","updated","deps","dev","tests","test","add","added","fix","fixed","run","running","using"]);function fT(t){let e=t.replace(/['"(){}[\]*:^~]/g," ").split(/\s+/).filter(r=>r.length>0&&!["AND","OR","NOT","NEAR"].includes(r.toUpperCase()));return e.length===0?'""':e.map(r=>`"${r}"`).join(" OR ")}var _o=class{#e;constructor(e){let r=dT(),n=e??lT(uT(),`context-mode-${process.pid}.db`);this.#e=new r(n,{timeout:5e3}),this.#e.pragma("journal_mode = WAL"),this.#e.pragma("synchronous = NORMAL"),this.#r()}#r(){this.#e.exec(`
      CREATE TABLE IF NOT EXISTS sources (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        label TEXT NOT NULL,
        chunk_count INTEGER NOT NULL DEFAULT 0,
        code_chunk_count INTEGER NOT NULL DEFAULT 0,
        indexed_at TEXT NOT NULL DEFAULT (datetime('now'))
      );

      CREATE VIRTUAL TABLE IF NOT EXISTS chunks USING fts5(
        title,
        content,
        source_id UNINDEXED,
        content_type UNINDEXED,
        tokenize='porter unicode61'
      );
    `)}index(e){let{content:r,path:n,source:o}=e;if(!r&&!n)throw new Error("Either content or path must be provided");let s=r??cT(n,"utf-8"),i=o??n??"untitled",a=this.#t(s);if(a.length===0){let p=this.#e.prepare("INSERT INTO sources (label, chunk_count, code_chunk_count) VALUES (?, 0, 0)").run(i);return{sourceId:Number(p.lastInsertRowid),label:i,totalChunks:0,codeChunks:0}}let c=a.filter(f=>f.hasCode).length,u=this.#e.prepare("INSERT INTO sources (label, chunk_count, code_chunk_count) VALUES (?, ?, ?)"),l=this.#e.prepare("INSERT INTO chunks (title, content, source_id, content_type) VALUES (?, ?, ?, ?)");return{sourceId:this.#e.transaction(()=>{let f=u.run(i,a.length,c),p=Number(f.lastInsertRowid);for(let h of a)l.run(h.title,h.content,p,h.hasCode?"code":"prose");return p})(),label:i,totalChunks:a.length,codeChunks:c}}indexPlainText(e,r,n=20){if(!e||e.trim().length===0){let l=this.#e.prepare("INSERT INTO sources (label, chunk_count, code_chunk_count) VALUES (?, 0, 0)").run(r);return{sourceId:Number(l.lastInsertRowid),label:r,totalChunks:0,codeChunks:0}}let o=this.#n(e,n),s=this.#e.prepare("INSERT INTO sources (label, chunk_count, code_chunk_count) VALUES (?, ?, ?)"),i=this.#e.prepare("INSERT INTO chunks (title, content, source_id, content_type) VALUES (?, ?, ?, ?)");return{sourceId:this.#e.transaction(()=>{let u=s.run(r,o.length,0),l=Number(u.lastInsertRowid);for(let d of o)i.run(d.title,d.content,l,"prose");return l})(),label:r,totalChunks:o.length,codeChunks:0}}search(e,r=3,n){let o=fT(e),s=n?"AND sources.label LIKE ?":"",i=this.#e.prepare(`
      SELECT
        chunks.title,
        chunks.content,
        chunks.content_type,
        sources.label,
        bm25(chunks, 2.0, 1.0) AS rank
      FROM chunks
      JOIN sources ON sources.id = chunks.source_id
      WHERE chunks MATCH ? ${s}
      ORDER BY rank
      LIMIT ?
    `),a=n?[o,`%${n}%`,r]:[o,r];return i.all(...a).map(u=>({title:u.title,content:u.content,source:u.label,rank:u.rank,contentType:u.content_type}))}listSources(){return this.#e.prepare("SELECT label, chunk_count as chunkCount FROM sources ORDER BY id DESC").all()}getDistinctiveTerms(e,r=40){let n=this.#e.prepare("SELECT chunk_count FROM sources WHERE id = ?").get(e);if(!n||n.chunk_count<3)return[];let o=n.chunk_count,s=2,i=Math.max(3,Math.ceil(o*.4)),a=this.#e.prepare("SELECT content FROM chunks WHERE source_id = ?").all(e),c=new Map;for(let d of a){let m=new Set(d.content.toLowerCase().split(/[^\p{L}\p{N}_-]+/u).filter(f=>f.length>=3&&!pT.has(f)));for(let f of m)c.set(f,(c.get(f)??0)+1)}return Array.from(c.entries()).filter(([,d])=>d>=s&&d<=i).map(([d,m])=>{let f=Math.log(o/m),p=Math.min(d.length/20,.5),h=/[_]/.test(d),g=d.length>=12,v=h?1.5:g?.8:0;return{word:d,score:f+p+v}}).sort((d,m)=>m.score-d.score).slice(0,r).map(d=>d.word)}getStats(){let e=this.#e.prepare("SELECT COUNT(*) as c FROM sources").get()?.c??0,r=this.#e.prepare("SELECT COUNT(*) as c FROM chunks").get()?.c??0,n=this.#e.prepare("SELECT COUNT(*) as c FROM chunks WHERE content_type = 'code'").get()?.c??0;return{sources:e,chunks:r,codeChunks:n}}close(){this.#e.close()}#t(e){let r=[],n=e.split(`
`),o=[],s=[],i="",a=()=>{let u=s.join(`
`).trim();u.length!==0&&(r.push({title:this.#o(o,i),content:u,hasCode:s.some(l=>/^`{3,}/.test(l))}),s=[])},c=0;for(;c<n.length;){let u=n[c];if(/^[-_*]{3,}\s*$/.test(u)){a(),c++;continue}let l=u.match(/^(#{1,4})\s+(.+)$/);if(l){a();let m=l[1].length,f=l[2].trim();for(;o.length>0&&o[o.length-1].level>=m;)o.pop();o.push({level:m,text:f}),i=f,s.push(u),c++;continue}let d=u.match(/^(`{3,})(.*)?$/);if(d){let m=d[1],f=[u];for(c++;c<n.length;){if(f.push(n[c]),n[c].startsWith(m)&&n[c].trim()===m){c++;break}c++}s.push(...f);continue}s.push(u),c++}return a(),r}#n(e,r){let n=e.split(/\n\s*\n/);if(n.length>=3&&n.length<=200&&n.every(c=>Buffer.byteLength(c)<5e3))return n.map((c,u)=>{let l=c.trim();return{title:l.split(`
`)[0].slice(0,80)||`Section ${u+1}`,content:l}}).filter(c=>c.content.length>0);let o=e.split(`
`);if(o.length<=r)return[{title:"Output",content:e}];let s=[],a=Math.max(r-2,1);for(let c=0;c<o.length;c+=a){let u=o.slice(c,c+r);if(u.length===0)break;let l=c+1,d=Math.min(c+u.length,o.length),m=u[0]?.trim().slice(0,80);s.push({title:m||`Lines ${l}-${d}`,content:u.join(`
`)})}return s}#o(e,r){return e.length===0?r||"Untitled":e.map(n=>n.text).join(" > ")}};var Qg="0.5.23",Wl=ai(),mT=Jg(Wl),dn=new oi({name:"context-mode",version:Qg}),Xl=new ci({runtimes:Wl}),Jl=null;function di(){return Jl||(Jl=new _o),Jl}var hT=mT.join(", "),gT=Kl()?" (Bun detected \u2014 JS/TS runs 3-5x faster)":"";dn.registerTool("execute",{title:"Execute Code",description:`Execute code in a sandboxed subprocess. Only stdout enters context \u2014 raw data stays in the subprocess. Use instead of bash/cat when output would exceed 20 lines.${gT} Available: ${hT}.`,inputSchema:ie.object({language:ie.enum(["javascript","typescript","python","shell","ruby","go","rust","php","perl","r"]).describe("Runtime language"),code:ie.string().describe("Source code to execute. Use console.log (JS/TS), print (Python/Ruby/Perl/R), echo (Shell), echo (PHP), or fmt.Println (Go) to output a summary to context."),timeout:ie.number().optional().default(3e4).describe("Max execution time in ms"),intent:ie.string().optional().describe(`What you're looking for in the output. When provided and output is large (>5KB), indexes output into knowledge base and returns section titles + previews \u2014 not full content. Use search() to retrieve specific sections. Example: 'failing tests', 'HTTP 500 errors'.

TIP: Use specific technical terms, not just concepts. Check 'Searchable terms' in the response for available vocabulary.`)})},async({language:t,code:e,timeout:r,intent:n})=>{try{let o=await Xl.execute({language:t,code:e,timeout:r});if(o.timedOut)return{content:[{type:"text",text:`Execution timed out after ${r}ms

Partial stdout:
${o.stdout}

stderr:
${o.stderr}`}],isError:!0};if(o.exitCode!==0){let i=`Exit code: ${o.exitCode}

stdout:
${o.stdout}

stderr:
${o.stderr}`;return n&&n.trim().length>0&&Buffer.byteLength(i)>ui?{content:[{type:"text",text:li(i,n,`execute:${t}:error`)}],isError:!0}:{content:[{type:"text",text:i}],isError:!0}}let s=o.stdout||"(no output)";return n&&n.trim().length>0&&Buffer.byteLength(s)>ui?{content:[{type:"text",text:li(s,n,`execute:${t}`)}]}:{content:[{type:"text",text:s}]}}catch(o){return{content:[{type:"text",text:`Runtime error: ${o instanceof Error?o.message:String(o)}`}],isError:!0}}});function _T(t,e){let n=di().index({content:t,source:e});return{content:[{type:"text",text:`Indexed ${n.totalChunks} sections (${n.codeChunks} with code) from: ${n.label}
Use search() to query this content. Use source: "${n.label}" to scope results.`}]}}var ui=5e3;function li(t,e,r,n=5){let o=t.split(`
`).length,s=Buffer.byteLength(t),i=di(),a=i.indexPlainText(t,r),c=new _o(":memory:");try{c.indexPlainText(t,r);let u=c.search(e,n);if(u.length===0){let m=e.trim().split(/\s+/).filter(f=>f.length>2).slice(0,20);if(m.length>0){let f=new Map;for(let p of m){let h=c.search(p,10);for(let g of h){let v=f.get(g.title);v?(v.score+=1,g.rank<v.bestRank&&(v.bestRank=g.rank,v.result=g)):f.set(g.title,{result:g,score:1,bestRank:g.rank})}}u=Array.from(f.values()).sort((p,h)=>h.score-p.score||p.bestRank-h.bestRank).slice(0,n).map(p=>p.result)}}let l=i.getDistinctiveTerms(a.sourceId);if(u.length===0){let m=[`Indexed ${a.totalChunks} sections from "${r}" into knowledge base.`,`No sections matched intent "${e}" in ${o}-line output (${(s/1024).toFixed(1)}KB).`];return l.length>0&&(m.push(""),m.push(`Searchable terms: ${l.join(", ")}`)),m.push(""),m.push("Use search() to explore the indexed content."),m.join(`
`)}let d=[`Indexed ${a.totalChunks} sections from "${r}" into knowledge base.`,`${u.length} sections matched "${e}" (${o} lines, ${(s/1024).toFixed(1)}KB):`,""];for(let m of u){let f=m.content.split(`
`)[0].slice(0,120);d.push(`  - ${m.title}: ${f}`)}return l.length>0&&(d.push(""),d.push(`Searchable terms: ${l.join(", ")}`)),d.push(""),d.push("Use search() to retrieve full content of any section."),d.join(`
`)}finally{c.close()}}dn.registerTool("execute_file",{title:"Execute File Processing",description:"Read a file and process it without loading contents into context. The file is read into a FILE_CONTENT variable inside the sandbox. Only your printed summary enters context.",inputSchema:ie.object({path:ie.string().describe("Absolute file path or relative to project root"),language:ie.enum(["javascript","typescript","python","shell","ruby","go","rust","php","perl","r"]).describe("Runtime language"),code:ie.string().describe("Code to process FILE_CONTENT. Print summary via console.log/print/echo."),timeout:ie.number().optional().default(3e4).describe("Max execution time in ms"),intent:ie.string().optional().describe("What you're looking for in the output. When provided and output is large (>5KB), returns only matching sections via BM25 search instead of truncated output.")})},async({path:t,language:e,code:r,timeout:n,intent:o})=>{try{let s=await Xl.executeFile({path:t,language:e,code:r,timeout:n});if(s.timedOut)return{content:[{type:"text",text:`Timed out processing ${t} after ${n}ms`}],isError:!0};if(s.exitCode!==0){let a=`Error processing ${t} (exit ${s.exitCode}):
${s.stderr||s.stdout}`;return o&&o.trim().length>0&&Buffer.byteLength(a)>ui?{content:[{type:"text",text:li(a,o,`file:${t}:error`)}],isError:!0}:{content:[{type:"text",text:a}],isError:!0}}let i=s.stdout||"(no output)";return o&&o.trim().length>0&&Buffer.byteLength(i)>ui?{content:[{type:"text",text:li(i,o,`file:${t}`)}]}:{content:[{type:"text",text:i}]}}catch(s){return{content:[{type:"text",text:`Runtime error: ${s instanceof Error?s.message:String(s)}`}],isError:!0}}});dn.registerTool("index",{title:"Index Content",description:`Index documentation or knowledge content into a searchable BM25 knowledge base. Chunks markdown by headings (keeping code blocks intact) and stores in ephemeral FTS5 database. The full content does NOT stay in context \u2014 only a brief summary is returned.

WHEN TO USE:
- Documentation from Context7, Skills, or MCP tools (API docs, framework guides, code examples)
- API references (endpoint details, parameter specs, response schemas)
- MCP tools/list output (exact tool signatures and descriptions)
- Skill prompts and instructions that are too large for context
- README files, migration guides, changelog entries
- Any content with code examples you may need to reference precisely

After indexing, use 'search' to retrieve specific sections on-demand.
Do NOT use for: log files, test output, CSV, build output \u2014 use 'execute_file' for those.`,inputSchema:ie.object({content:ie.string().optional().describe("Raw text/markdown to index. Provide this OR path, not both."),path:ie.string().optional().describe("File path to read and index (content never enters context). Provide this OR content."),source:ie.string().optional().describe("Label for the indexed content (e.g., 'Context7: React useEffect', 'Skill: frontend-design')")})},async({content:t,path:e,source:r})=>{if(!t&&!e)return{content:[{type:"text",text:"Error: Either content or path must be provided"}],isError:!0};try{let o=di().index({content:t,path:e,source:r});return{content:[{type:"text",text:`Indexed ${o.totalChunks} sections (${o.codeChunks} with code) from: ${o.label}
Use search() to query this content. Use source: "${o.label}" to scope results.`}]}}catch(n){return{content:[{type:"text",text:`Index error: ${n instanceof Error?n.message:String(n)}`}],isError:!0}}});dn.registerTool("search",{title:"Search Indexed Content",description:`Search previously indexed content using BM25 full-text search. Returns the top matching chunks with heading context and full content. Use after 'index' to retrieve specific documentation sections, code examples, or API details on demand.

WHEN TO USE:
- Find specific code examples ('useEffect cleanup pattern')
- Look up API signatures ('Supabase RLS policy syntax')
- Get configuration details ('Tailwind responsive breakpoints')
- Find migration steps ('App Router data fetching')

SEARCH TIPS:
- Queries use OR semantics \u2014 results matching more terms rank higher via BM25
- Use 2-4 specific technical terms per query for best results
- Use 'source' parameter to scope search to a specific indexed source (partial match)
- Check 'Searchable terms' from execute/execute_file results for available vocabulary
- For broad topics, send multiple focused searches in parallel

Returns exact content \u2014 not summaries. Each result includes heading hierarchy and full section text.`,inputSchema:ie.object({query:ie.string().describe("Natural language search query"),limit:ie.number().optional().default(3).describe("Maximum results to return (default: 3)"),source:ie.string().optional().describe("Filter results to a specific indexed source (partial match). Use the source label from index/fetch_and_index response.")})},async({query:t,limit:e,source:r})=>{try{let n=di(),o=n.search(t,e,r);if(o.length===0){let i=n.listSources(),a=i.length>0?`
Indexed sources: ${i.map(c=>`"${c.label}" (${c.chunkCount} sections)`).join(", ")}`:"";return{content:[{type:"text",text:`No results found for: "${t}"${r?` in source "${r}"`:""}.${a}`}]}}return{content:[{type:"text",text:o.map((i,a)=>{let c=`--- Result ${a+1} [${i.source}] (${i.contentType}) ---`,u=`## ${i.title}`;return`${c}
${u}

${i.content}`}).join(`

`)}]}}catch(n){return{content:[{type:"text",text:`Search error: ${n instanceof Error?n.message:String(n)}`}],isError:!0}}});var yT=`
const url = process.argv[1];
if (!url) { console.error("No URL provided"); process.exit(1); }

async function main() {
  const resp = await fetch(url);
  if (!resp.ok) { console.error("HTTP " + resp.status); process.exit(1); }

  let html = await resp.text();

  // Strip script, style, nav, header, footer tags with content
  html = html.replace(/<script[^>]*>[\\s\\S]*?<\\/script>/gi, "");
  html = html.replace(/<style[^>]*>[\\s\\S]*?<\\/style>/gi, "");
  html = html.replace(/<nav[^>]*>[\\s\\S]*?<\\/nav>/gi, "");
  html = html.replace(/<header[^>]*>[\\s\\S]*?<\\/header>/gi, "");
  html = html.replace(/<footer[^>]*>[\\s\\S]*?<\\/footer>/gi, "");

  // Convert headings to markdown
  html = html.replace(/<h1[^>]*>(.*?)<\\/h1>/gi, "\\n# $1\\n");
  html = html.replace(/<h2[^>]*>(.*?)<\\/h2>/gi, "\\n## $1\\n");
  html = html.replace(/<h3[^>]*>(.*?)<\\/h3>/gi, "\\n### $1\\n");
  html = html.replace(/<h4[^>]*>(.*?)<\\/h4>/gi, "\\n#### $1\\n");

  // Convert code blocks
  html = html.replace(/<pre[^>]*><code[^>]*class="[^"]*language-(\\w+)"[^>]*>([\\s\\S]*?)<\\/code><\\/pre>/gi,
    (_, lang, code) => "\\n\\\`\\\`\\\`" + lang + "\\n" + decodeEntities(code) + "\\n\\\`\\\`\\\`\\n");
  html = html.replace(/<pre[^>]*><code[^>]*>([\\s\\S]*?)<\\/code><\\/pre>/gi,
    (_, code) => "\\n\\\`\\\`\\\`\\n" + decodeEntities(code) + "\\n\\\`\\\`\\\`\\n");
  html = html.replace(/<code[^>]*>([^<]*)<\\/code>/gi, "\\\`$1\\\`");

  // Convert links
  html = html.replace(/<a[^>]*href="([^"]*)"[^>]*>(.*?)<\\/a>/gi, "[$2]($1)");

  // Convert lists
  html = html.replace(/<li[^>]*>(.*?)<\\/li>/gi, "- $1\\n");

  // Convert paragraphs and line breaks
  html = html.replace(/<p[^>]*>(.*?)<\\/p>/gi, "\\n$1\\n");
  html = html.replace(/<br\\s*\\/?>/gi, "\\n");
  html = html.replace(/<hr\\s*\\/?>/gi, "\\n---\\n");

  // Strip remaining HTML tags
  html = html.replace(/<[^>]+>/g, "");

  // Decode HTML entities
  html = decodeEntities(html);

  // Clean up whitespace
  html = html.replace(/\\n{3,}/g, "\\n\\n").trim();

  console.log(html);
}

function decodeEntities(s) {
  return s
    .replace(/&amp;/g, "&")
    .replace(/&lt;/g, "<")
    .replace(/&gt;/g, ">")
    .replace(/&quot;/g, '"')
    .replace(/&#39;/g, "'")
    .replace(/&#x27;/g, "'")
    .replace(/&#x2F;/g, "/")
    .replace(/&nbsp;/g, " ");
}

main();
`;dn.registerTool("fetch_and_index",{title:"Fetch & Index URL",description:`Fetches URL content, converts HTML to markdown, and indexes into the searchable knowledge base. Raw content never enters context \u2014 only a brief confirmation is returned.

Use INSTEAD of WebFetch/Context7 when you need to reference web documentation later via search.

After fetching, use 'search' to retrieve specific sections on-demand.`,inputSchema:ie.object({url:ie.string().describe("The URL to fetch and index"),source:ie.string().optional().describe("Label for the indexed content (e.g., 'React useEffect docs', 'Supabase Auth API')")})},async({url:t,source:e})=>{try{let r=`process.argv[1] = ${JSON.stringify(t)};
${yT}`,n=await Xl.execute({language:"javascript",code:r,timeout:3e4});return n.exitCode!==0?{content:[{type:"text",text:`Failed to fetch ${t}: ${n.stderr||n.stdout}`}],isError:!0}:!n.stdout||n.stdout.trim().length===0?{content:[{type:"text",text:`Fetched ${t} but got empty content after HTML conversion`}],isError:!0}:_T(n.stdout,e??t)}catch(r){return{content:[{type:"text",text:`Fetch error: ${r instanceof Error?r.message:String(r)}`}],isError:!0}}});async function vT(){let t=new ii;await dn.connect(t),console.error(`Context Mode MCP server v${Qg} running on stdio`),console.error(`Detected runtimes:
${Gg(Wl)}`),Kl()||(console.error(`
Performance tip: Install Bun for 3-5x faster JS/TS execution`),console.error("  curl -fsSL https://bun.sh/install | bash"))}vT().catch(t=>{console.error("Fatal:",t),process.exit(1)});
