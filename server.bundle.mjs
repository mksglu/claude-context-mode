#!/usr/bin/env node
var db=Object.create;var Va=Object.defineProperty;var pb=Object.getOwnPropertyDescriptor;var fb=Object.getOwnPropertyNames;var mb=Object.getPrototypeOf,hb=Object.prototype.hasOwnProperty;var x=(e,t)=>()=>(e&&(t=e(e=0)),t);var P=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),ms=(e,t)=>{for(var r in t)Va(e,r,{get:t[r],enumerable:!0})},gb=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of fb(t))!hb.call(e,o)&&o!==r&&Va(e,o,{get:()=>t[o],enumerable:!(n=pb(t,o))||n.enumerable});return e};var pn=(e,t,r)=>(r=e!=null?db(mb(e)):{},gb(t||!e||!e.__esModule?Va(r,"default",{value:e,enumerable:!0}):r,e));var Ha=P((HR,Ba)=>{var gs=process||{},Bf=gs.argv||[],hs=gs.env||{},yb=!(hs.NO_COLOR||Bf.includes("--no-color"))&&(!!hs.FORCE_COLOR||Bf.includes("--color")||gs.platform==="win32"||(gs.stdout||{}).isTTY&&hs.TERM!=="dumb"||!!hs.CI),_b=(e,t,r=e)=>n=>{let o=""+n,s=o.indexOf(t,e.length);return~s?e+vb(o,t,r,s)+t:e+o+t},vb=(e,t,r,n)=>{let o="",s=0;do o+=e.substring(s,n)+r,s=n+t.length,n=e.indexOf(t,s);while(~n);return o+e.substring(s)},Hf=(e=yb)=>{let t=e?_b:()=>String;return{isColorSupported:e,reset:t("\x1B[0m","\x1B[0m"),bold:t("\x1B[1m","\x1B[22m","\x1B[22m\x1B[1m"),dim:t("\x1B[2m","\x1B[22m","\x1B[22m\x1B[2m"),italic:t("\x1B[3m","\x1B[23m"),underline:t("\x1B[4m","\x1B[24m"),inverse:t("\x1B[7m","\x1B[27m"),hidden:t("\x1B[8m","\x1B[28m"),strikethrough:t("\x1B[9m","\x1B[29m"),black:t("\x1B[30m","\x1B[39m"),red:t("\x1B[31m","\x1B[39m"),green:t("\x1B[32m","\x1B[39m"),yellow:t("\x1B[33m","\x1B[39m"),blue:t("\x1B[34m","\x1B[39m"),magenta:t("\x1B[35m","\x1B[39m"),cyan:t("\x1B[36m","\x1B[39m"),white:t("\x1B[37m","\x1B[39m"),gray:t("\x1B[90m","\x1B[39m"),bgBlack:t("\x1B[40m","\x1B[49m"),bgRed:t("\x1B[41m","\x1B[49m"),bgGreen:t("\x1B[42m","\x1B[49m"),bgYellow:t("\x1B[43m","\x1B[49m"),bgBlue:t("\x1B[44m","\x1B[49m"),bgMagenta:t("\x1B[45m","\x1B[49m"),bgCyan:t("\x1B[46m","\x1B[49m"),bgWhite:t("\x1B[47m","\x1B[49m"),blackBright:t("\x1B[90m","\x1B[39m"),redBright:t("\x1B[91m","\x1B[39m"),greenBright:t("\x1B[92m","\x1B[39m"),yellowBright:t("\x1B[93m","\x1B[39m"),blueBright:t("\x1B[94m","\x1B[39m"),magentaBright:t("\x1B[95m","\x1B[39m"),cyanBright:t("\x1B[96m","\x1B[39m"),whiteBright:t("\x1B[97m","\x1B[39m"),bgBlackBright:t("\x1B[100m","\x1B[49m"),bgRedBright:t("\x1B[101m","\x1B[49m"),bgGreenBright:t("\x1B[102m","\x1B[49m"),bgYellowBright:t("\x1B[103m","\x1B[49m"),bgBlueBright:t("\x1B[104m","\x1B[49m"),bgMagentaBright:t("\x1B[105m","\x1B[49m"),bgCyanBright:t("\x1B[106m","\x1B[49m"),bgWhiteBright:t("\x1B[107m","\x1B[49m")}};Ba.exports=Hf();Ba.exports.createColors=Hf});var Ga=P((WR,Wf)=>{"use strict";var Wa={to(e,t){return t?`\x1B[${t+1};${e+1}H`:`\x1B[${e+1}G`},move(e,t){let r="";return e<0?r+=`\x1B[${-e}D`:e>0&&(r+=`\x1B[${e}C`),t<0?r+=`\x1B[${-t}A`:t>0&&(r+=`\x1B[${t}B`),r},up:(e=1)=>`\x1B[${e}A`,down:(e=1)=>`\x1B[${e}B`,forward:(e=1)=>`\x1B[${e}C`,backward:(e=1)=>`\x1B[${e}D`,nextLine:(e=1)=>"\x1B[E".repeat(e),prevLine:(e=1)=>"\x1B[F".repeat(e),left:"\x1B[G",hide:"\x1B[?25l",show:"\x1B[?25h",save:"\x1B7",restore:"\x1B8"},bb={up:(e=1)=>"\x1B[S".repeat(e),down:(e=1)=>"\x1B[T".repeat(e)},$b={screen:"\x1B[2J",up:(e=1)=>"\x1B[1J".repeat(e),down:(e=1)=>"\x1B[J".repeat(e),line:"\x1B[2K",lineEnd:"\x1B[K",lineStart:"\x1B[1K",lines(e){let t="";for(let r=0;r<e;r++)t+=this.line+(r<e-1?Wa.up():"");return e&&(t+=Wa.left),t}};Wf.exports={cursor:Wa,scroll:bb,erase:$b,beep:"\x07"}});import{execSync as ym}from"node:child_process";function Ye(e){try{return ym(`command -v ${e} 2>/dev/null`,{stdio:"pipe"}),!0}catch{return!1}}function Nt(e){try{return ym(`${e} --version 2>/dev/null`,{encoding:"utf-8",timeout:5e3}).trim().split(`
`)[0]}catch{return"unknown"}}function ir(){let e=Ye("bun");return{javascript:e?"bun":"node",typescript:e?"bun":Ye("tsx")?"tsx":Ye("ts-node")?"ts-node":null,python:Ye("python3")?"python3":Ye("python")?"python":null,shell:Ye("bash")?"bash":"sh",ruby:Ye("ruby")?"ruby":null,go:Ye("go")?"go":null,rust:Ye("rustc")?"rustc":null,php:Ye("php")?"php":null,perl:Ye("perl")?"perl":null,r:Ye("Rscript")?"Rscript":Ye("r")?"r":null}}function Pr(){return Ye("bun")}function mn(e){let t=[],r=e.javascript==="bun";return t.push(`  JavaScript: ${e.javascript} (${Nt(e.javascript)})${r?" \u26A1":""}`),e.typescript?t.push(`  TypeScript: ${e.typescript} (${Nt(e.typescript)})`):t.push("  TypeScript: not available (install bun, tsx, or ts-node)"),e.python?t.push(`  Python:     ${e.python} (${Nt(e.python)})`):t.push("  Python:     not available"),t.push(`  Shell:      ${e.shell} (${Nt(e.shell)})`),e.ruby&&t.push(`  Ruby:       ${e.ruby} (${Nt(e.ruby)})`),e.go&&t.push(`  Go:         ${e.go} (${Nt(e.go)})`),e.rust&&t.push(`  Rust:       ${e.rust} (${Nt(e.rust)})`),e.php&&t.push(`  PHP:        ${e.php} (${Nt(e.php)})`),e.perl&&t.push(`  Perl:       ${e.perl} (${Nt(e.perl)})`),e.r&&t.push(`  R:          ${e.r} (${Nt(e.r)})`),r||(t.push(""),t.push("  Tip: Install Bun for 3-5x faster JS/TS execution \u2192 https://bun.sh")),t.join(`
`)}function eo(e){let t=["javascript","shell"];return e.typescript&&t.push("typescript"),e.python&&t.push("python"),e.ruby&&t.push("ruby"),e.go&&t.push("go"),e.rust&&t.push("rust"),e.php&&t.push("php"),e.perl&&t.push("perl"),e.r&&t.push("r"),t}function _m(e,t,r){switch(t){case"javascript":return e.javascript==="bun"?["bun","run",r]:["node",r];case"typescript":if(!e.typescript)throw new Error("No TypeScript runtime available. Install one of: bun (recommended), tsx (npm i -g tsx), or ts-node.");return e.typescript==="bun"?["bun","run",r]:e.typescript==="tsx"?["tsx",r]:["ts-node",r];case"python":if(!e.python)throw new Error("No Python runtime available. Install python3 or python.");return[e.python,r];case"shell":return[e.shell,r];case"ruby":if(!e.ruby)throw new Error("Ruby not available. Install ruby.");return[e.ruby,r];case"go":if(!e.go)throw new Error("Go not available. Install go.");return["go","run",r];case"rust":{if(!e.rust)throw new Error("Rust not available. Install rustc via https://rustup.rs");return["__rust_compile_run__",r]}case"php":if(!e.php)throw new Error("PHP not available. Install php.");return["php",r];case"perl":if(!e.perl)throw new Error("Perl not available. Install perl.");return["perl",r];case"r":if(!e.r)throw new Error("R not available. Install R / Rscript.");return[e.r,r]}}var Zs=x(()=>{"use strict"});var X,fc,R,At,to=x(()=>{(function(e){e.assertEqual=o=>{};function t(o){}e.assertIs=t;function r(o){throw new Error}e.assertNever=r,e.arrayToEnum=o=>{let s={};for(let i of o)s[i]=i;return s},e.getValidEnumValues=o=>{let s=e.objectKeys(o).filter(a=>typeof o[o[a]]!="number"),i={};for(let a of s)i[a]=o[a];return e.objectValues(i)},e.objectValues=o=>e.objectKeys(o).map(function(s){return o[s]}),e.objectKeys=typeof Object.keys=="function"?o=>Object.keys(o):o=>{let s=[];for(let i in o)Object.prototype.hasOwnProperty.call(o,i)&&s.push(i);return s},e.find=(o,s)=>{for(let i of o)if(s(i))return i},e.isInteger=typeof Number.isInteger=="function"?o=>Number.isInteger(o):o=>typeof o=="number"&&Number.isFinite(o)&&Math.floor(o)===o;function n(o,s=" | "){return o.map(i=>typeof i=="string"?`'${i}'`:i).join(s)}e.joinValues=n,e.jsonStringifyReplacer=(o,s)=>typeof s=="bigint"?s.toString():s})(X||(X={}));(function(e){e.mergeShapes=(t,r)=>({...t,...r})})(fc||(fc={}));R=X.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),At=e=>{switch(typeof e){case"undefined":return R.undefined;case"string":return R.string;case"number":return Number.isNaN(e)?R.nan:R.number;case"boolean":return R.boolean;case"function":return R.function;case"bigint":return R.bigint;case"symbol":return R.symbol;case"object":return Array.isArray(e)?R.array:e===null?R.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?R.promise:typeof Map<"u"&&e instanceof Map?R.map:typeof Set<"u"&&e instanceof Set?R.set:typeof Date<"u"&&e instanceof Date?R.date:R.object;default:return R.unknown}}});var k,h$,Xe,Ls=x(()=>{to();k=X.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),h$=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),Xe=class e extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){let r=t||function(s){return s.message},n={_errors:[]},o=s=>{for(let i of s.issues)if(i.code==="invalid_union")i.unionErrors.map(o);else if(i.code==="invalid_return_type")o(i.returnTypeError);else if(i.code==="invalid_arguments")o(i.argumentsError);else if(i.path.length===0)n._errors.push(r(i));else{let a=n,c=0;for(;c<i.path.length;){let u=i.path[c];c===i.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(r(i))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return o(this),n}static assert(t){if(!(t instanceof e))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,X.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){let r={},n=[];for(let o of this.issues)if(o.path.length>0){let s=o.path[0];r[s]=r[s]||[],r[s].push(t(o))}else n.push(t(o));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};Xe.create=e=>new Xe(e)});var g$,Gt,mc=x(()=>{Ls();to();g$=(e,t)=>{let r;switch(e.code){case k.invalid_type:e.received===R.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case k.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,X.jsonStringifyReplacer)}`;break;case k.unrecognized_keys:r=`Unrecognized key(s) in object: ${X.joinValues(e.keys,", ")}`;break;case k.invalid_union:r="Invalid input";break;case k.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${X.joinValues(e.options)}`;break;case k.invalid_enum_value:r=`Invalid enum value. Expected ${X.joinValues(e.options)}, received '${e.received}'`;break;case k.invalid_arguments:r="Invalid function arguments";break;case k.invalid_return_type:r="Invalid function return type";break;case k.invalid_date:r="Invalid date";break;case k.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:X.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case k.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case k.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case k.custom:r="Invalid input";break;case k.invalid_intersection_types:r="Intersection results could not be merged";break;case k.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case k.not_finite:r="Number must be finite";break;default:r=t.defaultError,X.assertNever(e)}return{message:r}},Gt=g$});function y$(e){vm=e}function hn(){return vm}var vm,Ds=x(()=>{mc();vm=Gt});function z(e,t){let r=hn(),n=ro({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===Gt?void 0:Gt].filter(o=>!!o)});e.common.issues.push(n)}var ro,_$,Oe,q,Ir,qe,qs,Fs,ar,gn,hc=x(()=>{Ds();mc();ro=e=>{let{data:t,path:r,errorMaps:n,issueData:o}=e,s=[...r,...o.path||[]],i={...o,path:s};if(o.message!==void 0)return{...o,path:s,message:o.message};let a="",c=n.filter(u=>!!u).slice().reverse();for(let u of c)a=u(i,{data:t,defaultError:a}).message;return{...o,path:s,message:a}},_$=[];Oe=class e{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){let n=[];for(let o of r){if(o.status==="aborted")return q;o.status==="dirty"&&t.dirty(),n.push(o.value)}return{status:t.value,value:n}}static async mergeObjectAsync(t,r){let n=[];for(let o of r){let s=await o.key,i=await o.value;n.push({key:s,value:i})}return e.mergeObjectSync(t,n)}static mergeObjectSync(t,r){let n={};for(let o of r){let{key:s,value:i}=o;if(s.status==="aborted"||i.status==="aborted")return q;s.status==="dirty"&&t.dirty(),i.status==="dirty"&&t.dirty(),s.value!=="__proto__"&&(typeof i.value<"u"||o.alwaysSet)&&(n[s.value]=i.value)}return{status:t.value,value:n}}},q=Object.freeze({status:"aborted"}),Ir=e=>({status:"dirty",value:e}),qe=e=>({status:"valid",value:e}),qs=e=>e.status==="aborted",Fs=e=>e.status==="dirty",ar=e=>e.status==="valid",gn=e=>typeof Promise<"u"&&e instanceof Promise});var bm=x(()=>{});var A,$m=x(()=>{(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t?.message})(A||(A={}))});function H(e){if(!e)return{};let{errorMap:t,invalid_type_error:r,required_error:n,description:o}=e;if(t&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:o}:{errorMap:(i,a)=>{let{message:c}=e;return i.code==="invalid_enum_value"?{message:c??a.defaultError}:typeof a.data>"u"?{message:c??n??a.defaultError}:i.code!=="invalid_type"?{message:a.defaultError}:{message:c??r??a.defaultError}},description:o}}function Sm(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);let r=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}function A$(e){return new RegExp(`^${Sm(e)}$`)}function Tm(e){let t=`${km}T${Sm(e)}`,r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function j$(e,t){return!!((t==="v4"||!t)&&z$.test(e)||(t==="v6"||!t)&&I$.test(e))}function M$(e,t){if(!k$.test(e))return!1;try{let[r]=e.split(".");if(!r)return!1;let n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),o=JSON.parse(atob(n));return!(typeof o!="object"||o===null||"typ"in o&&o?.typ!=="JWT"||!o.alg||t&&o.alg!==t)}catch{return!1}}function Z$(e,t){return!!((t==="v4"||!t)&&P$.test(e)||(t==="v6"||!t)&&R$.test(e))}function L$(e,t){let r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,o=r>n?r:n,s=Number.parseInt(e.toFixed(o).replace(".","")),i=Number.parseInt(t.toFixed(o).replace(".",""));return s%i/10**o}function yn(e){if(e instanceof et){let t={};for(let r in e.shape){let n=e.shape[r];t[r]=Qe.create(yn(n))}return new et({...e._def,shape:()=>t})}else return e instanceof Yt?new Yt({...e._def,type:yn(e.element)}):e instanceof Qe?Qe.create(yn(e.unwrap())):e instanceof Mt?Mt.create(yn(e.unwrap())):e instanceof jt?jt.create(e.items.map(t=>yn(t))):e}function yc(e,t){let r=At(e),n=At(t);if(e===t)return{valid:!0,data:e};if(r===R.object&&n===R.object){let o=X.objectKeys(t),s=X.objectKeys(e).filter(a=>o.indexOf(a)!==-1),i={...e,...t};for(let a of s){let c=yc(e[a],t[a]);if(!c.valid)return{valid:!1};i[a]=c.data}return{valid:!0,data:i}}else if(r===R.array&&n===R.array){if(e.length!==t.length)return{valid:!1};let o=[];for(let s=0;s<e.length;s++){let i=e[s],a=t[s],c=yc(i,a);if(!c.valid)return{valid:!1};o.push(c.data)}return{valid:!0,data:o}}else return r===R.date&&n===R.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}function Em(e,t){return new qr({values:e,typeName:S.ZodEnum,...H(t)})}function wm(e,t){let r=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof r=="string"?{message:r}:r}function zm(e,t={},r){return e?ur.create().superRefine((n,o)=>{let s=e(n);if(s instanceof Promise)return s.then(i=>{if(!i){let a=wm(t,n),c=a.fatal??r??!0;o.addIssue({code:"custom",...a,fatal:c})}});if(!s){let i=wm(t,n),a=i.fatal??r??!0;o.addIssue({code:"custom",...i,fatal:a})}}):ur.create()}var ft,xm,G,v$,b$,$$,x$,w$,k$,S$,T$,E$,gc,z$,P$,I$,R$,C$,O$,km,N$,cr,Rr,Cr,Or,Nr,_n,Ar,jr,ur,Jt,wt,vn,Yt,et,Mr,Kt,Us,Zr,jt,Vs,bn,$n,Bs,Lr,Dr,qr,Fr,lr,mt,Qe,Mt,Ur,Vr,xn,D$,no,oo,Br,q$,S,F$,Pm,Im,U$,V$,Rm,B$,H$,W$,G$,K$,J$,Y$,X$,Q$,_c,ex,tx,rx,nx,ox,sx,ix,ax,cx,ux,lx,dx,px,fx,mx,hx,gx,yx,_x,vx,bx,$x,xx,wx,Cm=x(()=>{Ls();Ds();$m();hc();to();ft=class{constructor(t,r,n,o){this._cachedPath=[],this.parent=t,this.data=r,this._path=n,this._key=o}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},xm=(e,t)=>{if(ar(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new Xe(e.common.issues);return this._error=r,this._error}}};G=class{get description(){return this._def.description}_getType(t){return At(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:At(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Oe,ctx:{common:t.parent.common,data:t.data,parsedType:At(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){let r=this._parse(t);if(gn(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){let r=this._parse(t);return Promise.resolve(r)}parse(t,r){let n=this.safeParse(t,r);if(n.success)return n.data;throw n.error}safeParse(t,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:At(t)},o=this._parseSync({data:t,path:n.path,parent:n});return xm(n,o)}"~validate"(t){let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:At(t)};if(!this["~standard"].async)try{let n=this._parseSync({data:t,path:[],parent:r});return ar(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:r}).then(n=>ar(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(t,r){let n=await this.safeParseAsync(t,r);if(n.success)return n.data;throw n.error}async safeParseAsync(t,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:At(t)},o=this._parse({data:t,path:n.path,parent:n}),s=await(gn(o)?o:Promise.resolve(o));return xm(n,s)}refine(t,r){let n=o=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(o):r;return this._refinement((o,s)=>{let i=t(o),a=()=>s.addIssue({code:k.custom,...n(o)});return typeof Promise<"u"&&i instanceof Promise?i.then(c=>c?!0:(a(),!1)):i?!0:(a(),!1)})}refinement(t,r){return this._refinement((n,o)=>t(n)?!0:(o.addIssue(typeof r=="function"?r(n,o):r),!1))}_refinement(t){return new mt({schema:this,typeName:S.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Qe.create(this,this._def)}nullable(){return Mt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Yt.create(this)}promise(){return lr.create(this,this._def)}or(t){return Mr.create([this,t],this._def)}and(t){return Zr.create(this,t,this._def)}transform(t){return new mt({...H(this._def),schema:this,typeName:S.ZodEffects,effect:{type:"transform",transform:t}})}default(t){let r=typeof t=="function"?t:()=>t;return new Ur({...H(this._def),innerType:this,defaultValue:r,typeName:S.ZodDefault})}brand(){return new no({typeName:S.ZodBranded,type:this,...H(this._def)})}catch(t){let r=typeof t=="function"?t:()=>t;return new Vr({...H(this._def),innerType:this,catchValue:r,typeName:S.ZodCatch})}describe(t){let r=this.constructor;return new r({...this._def,description:t})}pipe(t){return oo.create(this,t)}readonly(){return Br.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},v$=/^c[^\s-]{8,}$/i,b$=/^[0-9a-z]+$/,$$=/^[0-9A-HJKMNP-TV-Z]{26}$/i,x$=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,w$=/^[a-z0-9_-]{21}$/i,k$=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,S$=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,T$=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,E$="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",z$=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,P$=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,I$=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,R$=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,C$=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,O$=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,km="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",N$=new RegExp(`^${km}$`);cr=class e extends G{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==R.string){let s=this._getOrReturnCtx(t);return z(s,{code:k.invalid_type,expected:R.string,received:s.parsedType}),q}let n=new Oe,o;for(let s of this._def.checks)if(s.kind==="min")t.data.length<s.value&&(o=this._getOrReturnCtx(t,o),z(o,{code:k.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="max")t.data.length>s.value&&(o=this._getOrReturnCtx(t,o),z(o,{code:k.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="length"){let i=t.data.length>s.value,a=t.data.length<s.value;(i||a)&&(o=this._getOrReturnCtx(t,o),i?z(o,{code:k.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):a&&z(o,{code:k.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),n.dirty())}else if(s.kind==="email")T$.test(t.data)||(o=this._getOrReturnCtx(t,o),z(o,{validation:"email",code:k.invalid_string,message:s.message}),n.dirty());else if(s.kind==="emoji")gc||(gc=new RegExp(E$,"u")),gc.test(t.data)||(o=this._getOrReturnCtx(t,o),z(o,{validation:"emoji",code:k.invalid_string,message:s.message}),n.dirty());else if(s.kind==="uuid")x$.test(t.data)||(o=this._getOrReturnCtx(t,o),z(o,{validation:"uuid",code:k.invalid_string,message:s.message}),n.dirty());else if(s.kind==="nanoid")w$.test(t.data)||(o=this._getOrReturnCtx(t,o),z(o,{validation:"nanoid",code:k.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid")v$.test(t.data)||(o=this._getOrReturnCtx(t,o),z(o,{validation:"cuid",code:k.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid2")b$.test(t.data)||(o=this._getOrReturnCtx(t,o),z(o,{validation:"cuid2",code:k.invalid_string,message:s.message}),n.dirty());else if(s.kind==="ulid")$$.test(t.data)||(o=this._getOrReturnCtx(t,o),z(o,{validation:"ulid",code:k.invalid_string,message:s.message}),n.dirty());else if(s.kind==="url")try{new URL(t.data)}catch{o=this._getOrReturnCtx(t,o),z(o,{validation:"url",code:k.invalid_string,message:s.message}),n.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(t.data)||(o=this._getOrReturnCtx(t,o),z(o,{validation:"regex",code:k.invalid_string,message:s.message}),n.dirty())):s.kind==="trim"?t.data=t.data.trim():s.kind==="includes"?t.data.includes(s.value,s.position)||(o=this._getOrReturnCtx(t,o),z(o,{code:k.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),n.dirty()):s.kind==="toLowerCase"?t.data=t.data.toLowerCase():s.kind==="toUpperCase"?t.data=t.data.toUpperCase():s.kind==="startsWith"?t.data.startsWith(s.value)||(o=this._getOrReturnCtx(t,o),z(o,{code:k.invalid_string,validation:{startsWith:s.value},message:s.message}),n.dirty()):s.kind==="endsWith"?t.data.endsWith(s.value)||(o=this._getOrReturnCtx(t,o),z(o,{code:k.invalid_string,validation:{endsWith:s.value},message:s.message}),n.dirty()):s.kind==="datetime"?Tm(s).test(t.data)||(o=this._getOrReturnCtx(t,o),z(o,{code:k.invalid_string,validation:"datetime",message:s.message}),n.dirty()):s.kind==="date"?N$.test(t.data)||(o=this._getOrReturnCtx(t,o),z(o,{code:k.invalid_string,validation:"date",message:s.message}),n.dirty()):s.kind==="time"?A$(s).test(t.data)||(o=this._getOrReturnCtx(t,o),z(o,{code:k.invalid_string,validation:"time",message:s.message}),n.dirty()):s.kind==="duration"?S$.test(t.data)||(o=this._getOrReturnCtx(t,o),z(o,{validation:"duration",code:k.invalid_string,message:s.message}),n.dirty()):s.kind==="ip"?j$(t.data,s.version)||(o=this._getOrReturnCtx(t,o),z(o,{validation:"ip",code:k.invalid_string,message:s.message}),n.dirty()):s.kind==="jwt"?M$(t.data,s.alg)||(o=this._getOrReturnCtx(t,o),z(o,{validation:"jwt",code:k.invalid_string,message:s.message}),n.dirty()):s.kind==="cidr"?Z$(t.data,s.version)||(o=this._getOrReturnCtx(t,o),z(o,{validation:"cidr",code:k.invalid_string,message:s.message}),n.dirty()):s.kind==="base64"?C$.test(t.data)||(o=this._getOrReturnCtx(t,o),z(o,{validation:"base64",code:k.invalid_string,message:s.message}),n.dirty()):s.kind==="base64url"?O$.test(t.data)||(o=this._getOrReturnCtx(t,o),z(o,{validation:"base64url",code:k.invalid_string,message:s.message}),n.dirty()):X.assertNever(s);return{status:n.value,value:t.data}}_regex(t,r,n){return this.refinement(o=>t.test(o),{validation:r,code:k.invalid_string,...A.errToObj(n)})}_addCheck(t){return new e({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...A.errToObj(t)})}url(t){return this._addCheck({kind:"url",...A.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...A.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...A.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...A.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...A.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...A.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...A.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...A.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...A.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...A.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...A.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...A.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof t?.precision>"u"?null:t?.precision,offset:t?.offset??!1,local:t?.local??!1,...A.errToObj(t?.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof t?.precision>"u"?null:t?.precision,...A.errToObj(t?.message)})}duration(t){return this._addCheck({kind:"duration",...A.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...A.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r?.position,...A.errToObj(r?.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...A.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...A.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...A.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...A.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...A.errToObj(r)})}nonempty(t){return this.min(1,A.errToObj(t))}trim(){return new e({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new e({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new e({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(let r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(let r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}};cr.create=e=>new cr({checks:[],typeName:S.ZodString,coerce:e?.coerce??!1,...H(e)});Rr=class e extends G{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==R.number){let s=this._getOrReturnCtx(t);return z(s,{code:k.invalid_type,expected:R.number,received:s.parsedType}),q}let n,o=new Oe;for(let s of this._def.checks)s.kind==="int"?X.isInteger(t.data)||(n=this._getOrReturnCtx(t,n),z(n,{code:k.invalid_type,expected:"integer",received:"float",message:s.message}),o.dirty()):s.kind==="min"?(s.inclusive?t.data<s.value:t.data<=s.value)&&(n=this._getOrReturnCtx(t,n),z(n,{code:k.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),o.dirty()):s.kind==="max"?(s.inclusive?t.data>s.value:t.data>=s.value)&&(n=this._getOrReturnCtx(t,n),z(n,{code:k.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),o.dirty()):s.kind==="multipleOf"?L$(t.data,s.value)!==0&&(n=this._getOrReturnCtx(t,n),z(n,{code:k.not_multiple_of,multipleOf:s.value,message:s.message}),o.dirty()):s.kind==="finite"?Number.isFinite(t.data)||(n=this._getOrReturnCtx(t,n),z(n,{code:k.not_finite,message:s.message}),o.dirty()):X.assertNever(s);return{status:o.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,A.toString(r))}gt(t,r){return this.setLimit("min",t,!1,A.toString(r))}lte(t,r){return this.setLimit("max",t,!0,A.toString(r))}lt(t,r){return this.setLimit("max",t,!1,A.toString(r))}setLimit(t,r,n,o){return new e({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:A.toString(o)}]})}_addCheck(t){return new e({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:A.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:A.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:A.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:A.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:A.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:A.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:A.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:A.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:A.toString(t)})}get minValue(){let t=null;for(let r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(let r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&X.isInteger(t.value))}get isFinite(){let t=null,r=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(t===null||n.value<t)&&(t=n.value)}return Number.isFinite(r)&&Number.isFinite(t)}};Rr.create=e=>new Rr({checks:[],typeName:S.ZodNumber,coerce:e?.coerce||!1,...H(e)});Cr=class e extends G{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==R.bigint)return this._getInvalidInput(t);let n,o=new Oe;for(let s of this._def.checks)s.kind==="min"?(s.inclusive?t.data<s.value:t.data<=s.value)&&(n=this._getOrReturnCtx(t,n),z(n,{code:k.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),o.dirty()):s.kind==="max"?(s.inclusive?t.data>s.value:t.data>=s.value)&&(n=this._getOrReturnCtx(t,n),z(n,{code:k.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),o.dirty()):s.kind==="multipleOf"?t.data%s.value!==BigInt(0)&&(n=this._getOrReturnCtx(t,n),z(n,{code:k.not_multiple_of,multipleOf:s.value,message:s.message}),o.dirty()):X.assertNever(s);return{status:o.value,value:t.data}}_getInvalidInput(t){let r=this._getOrReturnCtx(t);return z(r,{code:k.invalid_type,expected:R.bigint,received:r.parsedType}),q}gte(t,r){return this.setLimit("min",t,!0,A.toString(r))}gt(t,r){return this.setLimit("min",t,!1,A.toString(r))}lte(t,r){return this.setLimit("max",t,!0,A.toString(r))}lt(t,r){return this.setLimit("max",t,!1,A.toString(r))}setLimit(t,r,n,o){return new e({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:A.toString(o)}]})}_addCheck(t){return new e({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:A.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:A.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:A.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:A.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:A.toString(r)})}get minValue(){let t=null;for(let r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(let r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}};Cr.create=e=>new Cr({checks:[],typeName:S.ZodBigInt,coerce:e?.coerce??!1,...H(e)});Or=class extends G{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==R.boolean){let n=this._getOrReturnCtx(t);return z(n,{code:k.invalid_type,expected:R.boolean,received:n.parsedType}),q}return qe(t.data)}};Or.create=e=>new Or({typeName:S.ZodBoolean,coerce:e?.coerce||!1,...H(e)});Nr=class e extends G{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==R.date){let s=this._getOrReturnCtx(t);return z(s,{code:k.invalid_type,expected:R.date,received:s.parsedType}),q}if(Number.isNaN(t.data.getTime())){let s=this._getOrReturnCtx(t);return z(s,{code:k.invalid_date}),q}let n=new Oe,o;for(let s of this._def.checks)s.kind==="min"?t.data.getTime()<s.value&&(o=this._getOrReturnCtx(t,o),z(o,{code:k.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),n.dirty()):s.kind==="max"?t.data.getTime()>s.value&&(o=this._getOrReturnCtx(t,o),z(o,{code:k.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),n.dirty()):X.assertNever(s);return{status:n.value,value:new Date(t.data.getTime())}}_addCheck(t){return new e({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:A.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:A.toString(r)})}get minDate(){let t=null;for(let r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(let r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}};Nr.create=e=>new Nr({checks:[],coerce:e?.coerce||!1,typeName:S.ZodDate,...H(e)});_n=class extends G{_parse(t){if(this._getType(t)!==R.symbol){let n=this._getOrReturnCtx(t);return z(n,{code:k.invalid_type,expected:R.symbol,received:n.parsedType}),q}return qe(t.data)}};_n.create=e=>new _n({typeName:S.ZodSymbol,...H(e)});Ar=class extends G{_parse(t){if(this._getType(t)!==R.undefined){let n=this._getOrReturnCtx(t);return z(n,{code:k.invalid_type,expected:R.undefined,received:n.parsedType}),q}return qe(t.data)}};Ar.create=e=>new Ar({typeName:S.ZodUndefined,...H(e)});jr=class extends G{_parse(t){if(this._getType(t)!==R.null){let n=this._getOrReturnCtx(t);return z(n,{code:k.invalid_type,expected:R.null,received:n.parsedType}),q}return qe(t.data)}};jr.create=e=>new jr({typeName:S.ZodNull,...H(e)});ur=class extends G{constructor(){super(...arguments),this._any=!0}_parse(t){return qe(t.data)}};ur.create=e=>new ur({typeName:S.ZodAny,...H(e)});Jt=class extends G{constructor(){super(...arguments),this._unknown=!0}_parse(t){return qe(t.data)}};Jt.create=e=>new Jt({typeName:S.ZodUnknown,...H(e)});wt=class extends G{_parse(t){let r=this._getOrReturnCtx(t);return z(r,{code:k.invalid_type,expected:R.never,received:r.parsedType}),q}};wt.create=e=>new wt({typeName:S.ZodNever,...H(e)});vn=class extends G{_parse(t){if(this._getType(t)!==R.undefined){let n=this._getOrReturnCtx(t);return z(n,{code:k.invalid_type,expected:R.void,received:n.parsedType}),q}return qe(t.data)}};vn.create=e=>new vn({typeName:S.ZodVoid,...H(e)});Yt=class e extends G{_parse(t){let{ctx:r,status:n}=this._processInputParams(t),o=this._def;if(r.parsedType!==R.array)return z(r,{code:k.invalid_type,expected:R.array,received:r.parsedType}),q;if(o.exactLength!==null){let i=r.data.length>o.exactLength.value,a=r.data.length<o.exactLength.value;(i||a)&&(z(r,{code:i?k.too_big:k.too_small,minimum:a?o.exactLength.value:void 0,maximum:i?o.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:o.exactLength.message}),n.dirty())}if(o.minLength!==null&&r.data.length<o.minLength.value&&(z(r,{code:k.too_small,minimum:o.minLength.value,type:"array",inclusive:!0,exact:!1,message:o.minLength.message}),n.dirty()),o.maxLength!==null&&r.data.length>o.maxLength.value&&(z(r,{code:k.too_big,maximum:o.maxLength.value,type:"array",inclusive:!0,exact:!1,message:o.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((i,a)=>o.type._parseAsync(new ft(r,i,r.path,a)))).then(i=>Oe.mergeArray(n,i));let s=[...r.data].map((i,a)=>o.type._parseSync(new ft(r,i,r.path,a)));return Oe.mergeArray(n,s)}get element(){return this._def.type}min(t,r){return new e({...this._def,minLength:{value:t,message:A.toString(r)}})}max(t,r){return new e({...this._def,maxLength:{value:t,message:A.toString(r)}})}length(t,r){return new e({...this._def,exactLength:{value:t,message:A.toString(r)}})}nonempty(t){return this.min(1,t)}};Yt.create=(e,t)=>new Yt({type:e,minLength:null,maxLength:null,exactLength:null,typeName:S.ZodArray,...H(t)});et=class e extends G{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let t=this._def.shape(),r=X.objectKeys(t);return this._cached={shape:t,keys:r},this._cached}_parse(t){if(this._getType(t)!==R.object){let u=this._getOrReturnCtx(t);return z(u,{code:k.invalid_type,expected:R.object,received:u.parsedType}),q}let{status:n,ctx:o}=this._processInputParams(t),{shape:s,keys:i}=this._getCached(),a=[];if(!(this._def.catchall instanceof wt&&this._def.unknownKeys==="strip"))for(let u in o.data)i.includes(u)||a.push(u);let c=[];for(let u of i){let d=s[u],l=o.data[u];c.push({key:{status:"valid",value:u},value:d._parse(new ft(o,l,o.path,u)),alwaysSet:u in o.data})}if(this._def.catchall instanceof wt){let u=this._def.unknownKeys;if(u==="passthrough")for(let d of a)c.push({key:{status:"valid",value:d},value:{status:"valid",value:o.data[d]}});else if(u==="strict")a.length>0&&(z(o,{code:k.unrecognized_keys,keys:a}),n.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let d of a){let l=o.data[d];c.push({key:{status:"valid",value:d},value:u._parse(new ft(o,l,o.path,d)),alwaysSet:d in o.data})}}return o.common.async?Promise.resolve().then(async()=>{let u=[];for(let d of c){let l=await d.key,m=await d.value;u.push({key:l,value:m,alwaysSet:d.alwaysSet})}return u}).then(u=>Oe.mergeObjectSync(n,u)):Oe.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(t){return A.errToObj,new e({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,n)=>{let o=this._def.errorMap?.(r,n).message??n.defaultError;return r.code==="unrecognized_keys"?{message:A.errToObj(t).message??o}:{message:o}}}:{}})}strip(){return new e({...this._def,unknownKeys:"strip"})}passthrough(){return new e({...this._def,unknownKeys:"passthrough"})}extend(t){return new e({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new e({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:S.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new e({...this._def,catchall:t})}pick(t){let r={};for(let n of X.objectKeys(t))t[n]&&this.shape[n]&&(r[n]=this.shape[n]);return new e({...this._def,shape:()=>r})}omit(t){let r={};for(let n of X.objectKeys(this.shape))t[n]||(r[n]=this.shape[n]);return new e({...this._def,shape:()=>r})}deepPartial(){return yn(this)}partial(t){let r={};for(let n of X.objectKeys(this.shape)){let o=this.shape[n];t&&!t[n]?r[n]=o:r[n]=o.optional()}return new e({...this._def,shape:()=>r})}required(t){let r={};for(let n of X.objectKeys(this.shape))if(t&&!t[n])r[n]=this.shape[n];else{let s=this.shape[n];for(;s instanceof Qe;)s=s._def.innerType;r[n]=s}return new e({...this._def,shape:()=>r})}keyof(){return Em(X.objectKeys(this.shape))}};et.create=(e,t)=>new et({shape:()=>e,unknownKeys:"strip",catchall:wt.create(),typeName:S.ZodObject,...H(t)});et.strictCreate=(e,t)=>new et({shape:()=>e,unknownKeys:"strict",catchall:wt.create(),typeName:S.ZodObject,...H(t)});et.lazycreate=(e,t)=>new et({shape:e,unknownKeys:"strip",catchall:wt.create(),typeName:S.ZodObject,...H(t)});Mr=class extends G{_parse(t){let{ctx:r}=this._processInputParams(t),n=this._def.options;function o(s){for(let a of s)if(a.result.status==="valid")return a.result;for(let a of s)if(a.result.status==="dirty")return r.common.issues.push(...a.ctx.common.issues),a.result;let i=s.map(a=>new Xe(a.ctx.common.issues));return z(r,{code:k.invalid_union,unionErrors:i}),q}if(r.common.async)return Promise.all(n.map(async s=>{let i={...r,common:{...r.common,issues:[]},parent:null};return{result:await s._parseAsync({data:r.data,path:r.path,parent:i}),ctx:i}})).then(o);{let s,i=[];for(let c of n){let u={...r,common:{...r.common,issues:[]},parent:null},d=c._parseSync({data:r.data,path:r.path,parent:u});if(d.status==="valid")return d;d.status==="dirty"&&!s&&(s={result:d,ctx:u}),u.common.issues.length&&i.push(u.common.issues)}if(s)return r.common.issues.push(...s.ctx.common.issues),s.result;let a=i.map(c=>new Xe(c));return z(r,{code:k.invalid_union,unionErrors:a}),q}}get options(){return this._def.options}};Mr.create=(e,t)=>new Mr({options:e,typeName:S.ZodUnion,...H(t)});Kt=e=>e instanceof Lr?Kt(e.schema):e instanceof mt?Kt(e.innerType()):e instanceof Dr?[e.value]:e instanceof qr?e.options:e instanceof Fr?X.objectValues(e.enum):e instanceof Ur?Kt(e._def.innerType):e instanceof Ar?[void 0]:e instanceof jr?[null]:e instanceof Qe?[void 0,...Kt(e.unwrap())]:e instanceof Mt?[null,...Kt(e.unwrap())]:e instanceof no||e instanceof Br?Kt(e.unwrap()):e instanceof Vr?Kt(e._def.innerType):[],Us=class e extends G{_parse(t){let{ctx:r}=this._processInputParams(t);if(r.parsedType!==R.object)return z(r,{code:k.invalid_type,expected:R.object,received:r.parsedType}),q;let n=this.discriminator,o=r.data[n],s=this.optionsMap.get(o);return s?r.common.async?s._parseAsync({data:r.data,path:r.path,parent:r}):s._parseSync({data:r.data,path:r.path,parent:r}):(z(r,{code:k.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),q)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,r,n){let o=new Map;for(let s of r){let i=Kt(s.shape[t]);if(!i.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(let a of i){if(o.has(a))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(a)}`);o.set(a,s)}}return new e({typeName:S.ZodDiscriminatedUnion,discriminator:t,options:r,optionsMap:o,...H(n)})}};Zr=class extends G{_parse(t){let{status:r,ctx:n}=this._processInputParams(t),o=(s,i)=>{if(qs(s)||qs(i))return q;let a=yc(s.value,i.value);return a.valid?((Fs(s)||Fs(i))&&r.dirty(),{status:r.value,value:a.data}):(z(n,{code:k.invalid_intersection_types}),q)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([s,i])=>o(s,i)):o(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};Zr.create=(e,t,r)=>new Zr({left:e,right:t,typeName:S.ZodIntersection,...H(r)});jt=class e extends G{_parse(t){let{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==R.array)return z(n,{code:k.invalid_type,expected:R.array,received:n.parsedType}),q;if(n.data.length<this._def.items.length)return z(n,{code:k.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),q;!this._def.rest&&n.data.length>this._def.items.length&&(z(n,{code:k.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());let s=[...n.data].map((i,a)=>{let c=this._def.items[a]||this._def.rest;return c?c._parse(new ft(n,i,n.path,a)):null}).filter(i=>!!i);return n.common.async?Promise.all(s).then(i=>Oe.mergeArray(r,i)):Oe.mergeArray(r,s)}get items(){return this._def.items}rest(t){return new e({...this._def,rest:t})}};jt.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new jt({items:e,typeName:S.ZodTuple,rest:null,...H(t)})};Vs=class e extends G{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){let{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==R.object)return z(n,{code:k.invalid_type,expected:R.object,received:n.parsedType}),q;let o=[],s=this._def.keyType,i=this._def.valueType;for(let a in n.data)o.push({key:s._parse(new ft(n,a,n.path,a)),value:i._parse(new ft(n,n.data[a],n.path,a)),alwaysSet:a in n.data});return n.common.async?Oe.mergeObjectAsync(r,o):Oe.mergeObjectSync(r,o)}get element(){return this._def.valueType}static create(t,r,n){return r instanceof G?new e({keyType:t,valueType:r,typeName:S.ZodRecord,...H(n)}):new e({keyType:cr.create(),valueType:t,typeName:S.ZodRecord,...H(r)})}},bn=class extends G{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){let{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==R.map)return z(n,{code:k.invalid_type,expected:R.map,received:n.parsedType}),q;let o=this._def.keyType,s=this._def.valueType,i=[...n.data.entries()].map(([a,c],u)=>({key:o._parse(new ft(n,a,n.path,[u,"key"])),value:s._parse(new ft(n,c,n.path,[u,"value"]))}));if(n.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of i){let u=await c.key,d=await c.value;if(u.status==="aborted"||d.status==="aborted")return q;(u.status==="dirty"||d.status==="dirty")&&r.dirty(),a.set(u.value,d.value)}return{status:r.value,value:a}})}else{let a=new Map;for(let c of i){let u=c.key,d=c.value;if(u.status==="aborted"||d.status==="aborted")return q;(u.status==="dirty"||d.status==="dirty")&&r.dirty(),a.set(u.value,d.value)}return{status:r.value,value:a}}}};bn.create=(e,t,r)=>new bn({valueType:t,keyType:e,typeName:S.ZodMap,...H(r)});$n=class e extends G{_parse(t){let{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==R.set)return z(n,{code:k.invalid_type,expected:R.set,received:n.parsedType}),q;let o=this._def;o.minSize!==null&&n.data.size<o.minSize.value&&(z(n,{code:k.too_small,minimum:o.minSize.value,type:"set",inclusive:!0,exact:!1,message:o.minSize.message}),r.dirty()),o.maxSize!==null&&n.data.size>o.maxSize.value&&(z(n,{code:k.too_big,maximum:o.maxSize.value,type:"set",inclusive:!0,exact:!1,message:o.maxSize.message}),r.dirty());let s=this._def.valueType;function i(c){let u=new Set;for(let d of c){if(d.status==="aborted")return q;d.status==="dirty"&&r.dirty(),u.add(d.value)}return{status:r.value,value:u}}let a=[...n.data.values()].map((c,u)=>s._parse(new ft(n,c,n.path,u)));return n.common.async?Promise.all(a).then(c=>i(c)):i(a)}min(t,r){return new e({...this._def,minSize:{value:t,message:A.toString(r)}})}max(t,r){return new e({...this._def,maxSize:{value:t,message:A.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}};$n.create=(e,t)=>new $n({valueType:e,minSize:null,maxSize:null,typeName:S.ZodSet,...H(t)});Bs=class e extends G{constructor(){super(...arguments),this.validate=this.implement}_parse(t){let{ctx:r}=this._processInputParams(t);if(r.parsedType!==R.function)return z(r,{code:k.invalid_type,expected:R.function,received:r.parsedType}),q;function n(a,c){return ro({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,hn(),Gt].filter(u=>!!u),issueData:{code:k.invalid_arguments,argumentsError:c}})}function o(a,c){return ro({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,hn(),Gt].filter(u=>!!u),issueData:{code:k.invalid_return_type,returnTypeError:c}})}let s={errorMap:r.common.contextualErrorMap},i=r.data;if(this._def.returns instanceof lr){let a=this;return qe(async function(...c){let u=new Xe([]),d=await a._def.args.parseAsync(c,s).catch(h=>{throw u.addIssue(n(c,h)),u}),l=await Reflect.apply(i,this,d);return await a._def.returns._def.type.parseAsync(l,s).catch(h=>{throw u.addIssue(o(l,h)),u})})}else{let a=this;return qe(function(...c){let u=a._def.args.safeParse(c,s);if(!u.success)throw new Xe([n(c,u.error)]);let d=Reflect.apply(i,this,u.data),l=a._def.returns.safeParse(d,s);if(!l.success)throw new Xe([o(d,l.error)]);return l.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new e({...this._def,args:jt.create(t).rest(Jt.create())})}returns(t){return new e({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,r,n){return new e({args:t||jt.create([]).rest(Jt.create()),returns:r||Jt.create(),typeName:S.ZodFunction,...H(n)})}},Lr=class extends G{get schema(){return this._def.getter()}_parse(t){let{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}};Lr.create=(e,t)=>new Lr({getter:e,typeName:S.ZodLazy,...H(t)});Dr=class extends G{_parse(t){if(t.data!==this._def.value){let r=this._getOrReturnCtx(t);return z(r,{received:r.data,code:k.invalid_literal,expected:this._def.value}),q}return{status:"valid",value:t.data}}get value(){return this._def.value}};Dr.create=(e,t)=>new Dr({value:e,typeName:S.ZodLiteral,...H(t)});qr=class e extends G{_parse(t){if(typeof t.data!="string"){let r=this._getOrReturnCtx(t),n=this._def.values;return z(r,{expected:X.joinValues(n),received:r.parsedType,code:k.invalid_type}),q}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){let r=this._getOrReturnCtx(t),n=this._def.values;return z(r,{received:r.data,code:k.invalid_enum_value,options:n}),q}return qe(t.data)}get options(){return this._def.values}get enum(){let t={};for(let r of this._def.values)t[r]=r;return t}get Values(){let t={};for(let r of this._def.values)t[r]=r;return t}get Enum(){let t={};for(let r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return e.create(t,{...this._def,...r})}exclude(t,r=this._def){return e.create(this.options.filter(n=>!t.includes(n)),{...this._def,...r})}};qr.create=Em;Fr=class extends G{_parse(t){let r=X.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(t);if(n.parsedType!==R.string&&n.parsedType!==R.number){let o=X.objectValues(r);return z(n,{expected:X.joinValues(o),received:n.parsedType,code:k.invalid_type}),q}if(this._cache||(this._cache=new Set(X.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){let o=X.objectValues(r);return z(n,{received:n.data,code:k.invalid_enum_value,options:o}),q}return qe(t.data)}get enum(){return this._def.values}};Fr.create=(e,t)=>new Fr({values:e,typeName:S.ZodNativeEnum,...H(t)});lr=class extends G{unwrap(){return this._def.type}_parse(t){let{ctx:r}=this._processInputParams(t);if(r.parsedType!==R.promise&&r.common.async===!1)return z(r,{code:k.invalid_type,expected:R.promise,received:r.parsedType}),q;let n=r.parsedType===R.promise?r.data:Promise.resolve(r.data);return qe(n.then(o=>this._def.type.parseAsync(o,{path:r.path,errorMap:r.common.contextualErrorMap})))}};lr.create=(e,t)=>new lr({type:e,typeName:S.ZodPromise,...H(t)});mt=class extends G{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===S.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){let{status:r,ctx:n}=this._processInputParams(t),o=this._def.effect||null,s={addIssue:i=>{z(n,i),i.fatal?r.abort():r.dirty()},get path(){return n.path}};if(s.addIssue=s.addIssue.bind(s),o.type==="preprocess"){let i=o.transform(n.data,s);if(n.common.async)return Promise.resolve(i).then(async a=>{if(r.value==="aborted")return q;let c=await this._def.schema._parseAsync({data:a,path:n.path,parent:n});return c.status==="aborted"?q:c.status==="dirty"?Ir(c.value):r.value==="dirty"?Ir(c.value):c});{if(r.value==="aborted")return q;let a=this._def.schema._parseSync({data:i,path:n.path,parent:n});return a.status==="aborted"?q:a.status==="dirty"?Ir(a.value):r.value==="dirty"?Ir(a.value):a}}if(o.type==="refinement"){let i=a=>{let c=o.refinement(a,s);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(n.common.async===!1){let a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?q:(a.status==="dirty"&&r.dirty(),i(a.value),{status:r.value,value:a.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>a.status==="aborted"?q:(a.status==="dirty"&&r.dirty(),i(a.value).then(()=>({status:r.value,value:a.value}))))}if(o.type==="transform")if(n.common.async===!1){let i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!ar(i))return q;let a=o.transform(i.value,s);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:a}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>ar(i)?Promise.resolve(o.transform(i.value,s)).then(a=>({status:r.value,value:a})):q);X.assertNever(o)}};mt.create=(e,t,r)=>new mt({schema:e,typeName:S.ZodEffects,effect:t,...H(r)});mt.createWithPreprocess=(e,t,r)=>new mt({schema:t,effect:{type:"preprocess",transform:e},typeName:S.ZodEffects,...H(r)});Qe=class extends G{_parse(t){return this._getType(t)===R.undefined?qe(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}};Qe.create=(e,t)=>new Qe({innerType:e,typeName:S.ZodOptional,...H(t)});Mt=class extends G{_parse(t){return this._getType(t)===R.null?qe(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}};Mt.create=(e,t)=>new Mt({innerType:e,typeName:S.ZodNullable,...H(t)});Ur=class extends G{_parse(t){let{ctx:r}=this._processInputParams(t),n=r.data;return r.parsedType===R.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}};Ur.create=(e,t)=>new Ur({innerType:e,typeName:S.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...H(t)});Vr=class extends G{_parse(t){let{ctx:r}=this._processInputParams(t),n={...r,common:{...r.common,issues:[]}},o=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return gn(o)?o.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Xe(n.common.issues)},input:n.data})})):{status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new Xe(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};Vr.create=(e,t)=>new Vr({innerType:e,typeName:S.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...H(t)});xn=class extends G{_parse(t){if(this._getType(t)!==R.nan){let n=this._getOrReturnCtx(t);return z(n,{code:k.invalid_type,expected:R.nan,received:n.parsedType}),q}return{status:"valid",value:t.data}}};xn.create=e=>new xn({typeName:S.ZodNaN,...H(e)});D$=Symbol("zod_brand"),no=class extends G{_parse(t){let{ctx:r}=this._processInputParams(t),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}},oo=class e extends G{_parse(t){let{status:r,ctx:n}=this._processInputParams(t);if(n.common.async)return(async()=>{let s=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?q:s.status==="dirty"?(r.dirty(),Ir(s.value)):this._def.out._parseAsync({data:s.value,path:n.path,parent:n})})();{let o=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?q:o.status==="dirty"?(r.dirty(),{status:"dirty",value:o.value}):this._def.out._parseSync({data:o.value,path:n.path,parent:n})}}static create(t,r){return new e({in:t,out:r,typeName:S.ZodPipeline})}},Br=class extends G{_parse(t){let r=this._def.innerType._parse(t),n=o=>(ar(o)&&(o.value=Object.freeze(o.value)),o);return gn(r)?r.then(o=>n(o)):n(r)}unwrap(){return this._def.innerType}};Br.create=(e,t)=>new Br({innerType:e,typeName:S.ZodReadonly,...H(t)});q$={object:et.lazycreate};(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(S||(S={}));F$=(e,t={message:`Input not instance of ${e.name}`})=>zm(r=>r instanceof e,t),Pm=cr.create,Im=Rr.create,U$=xn.create,V$=Cr.create,Rm=Or.create,B$=Nr.create,H$=_n.create,W$=Ar.create,G$=jr.create,K$=ur.create,J$=Jt.create,Y$=wt.create,X$=vn.create,Q$=Yt.create,_c=et.create,ex=et.strictCreate,tx=Mr.create,rx=Us.create,nx=Zr.create,ox=jt.create,sx=Vs.create,ix=bn.create,ax=$n.create,cx=Bs.create,ux=Lr.create,lx=Dr.create,dx=qr.create,px=Fr.create,fx=lr.create,mx=mt.create,hx=Qe.create,gx=Mt.create,yx=mt.createWithPreprocess,_x=oo.create,vx=()=>Pm().optional(),bx=()=>Im().optional(),$x=()=>Rm().optional(),xx={string:(e=>cr.create({...e,coerce:!0})),number:(e=>Rr.create({...e,coerce:!0})),boolean:(e=>Or.create({...e,coerce:!0})),bigint:(e=>Cr.create({...e,coerce:!0})),date:(e=>Nr.create({...e,coerce:!0}))},wx=q});var ee={};ms(ee,{BRAND:()=>D$,DIRTY:()=>Ir,EMPTY_PATH:()=>_$,INVALID:()=>q,NEVER:()=>wx,OK:()=>qe,ParseStatus:()=>Oe,Schema:()=>G,ZodAny:()=>ur,ZodArray:()=>Yt,ZodBigInt:()=>Cr,ZodBoolean:()=>Or,ZodBranded:()=>no,ZodCatch:()=>Vr,ZodDate:()=>Nr,ZodDefault:()=>Ur,ZodDiscriminatedUnion:()=>Us,ZodEffects:()=>mt,ZodEnum:()=>qr,ZodError:()=>Xe,ZodFirstPartyTypeKind:()=>S,ZodFunction:()=>Bs,ZodIntersection:()=>Zr,ZodIssueCode:()=>k,ZodLazy:()=>Lr,ZodLiteral:()=>Dr,ZodMap:()=>bn,ZodNaN:()=>xn,ZodNativeEnum:()=>Fr,ZodNever:()=>wt,ZodNull:()=>jr,ZodNullable:()=>Mt,ZodNumber:()=>Rr,ZodObject:()=>et,ZodOptional:()=>Qe,ZodParsedType:()=>R,ZodPipeline:()=>oo,ZodPromise:()=>lr,ZodReadonly:()=>Br,ZodRecord:()=>Vs,ZodSchema:()=>G,ZodSet:()=>$n,ZodString:()=>cr,ZodSymbol:()=>_n,ZodTransformer:()=>mt,ZodTuple:()=>jt,ZodType:()=>G,ZodUndefined:()=>Ar,ZodUnion:()=>Mr,ZodUnknown:()=>Jt,ZodVoid:()=>vn,addIssueToContext:()=>z,any:()=>K$,array:()=>Q$,bigint:()=>V$,boolean:()=>Rm,coerce:()=>xx,custom:()=>zm,date:()=>B$,datetimeRegex:()=>Tm,defaultErrorMap:()=>Gt,discriminatedUnion:()=>rx,effect:()=>mx,enum:()=>dx,function:()=>cx,getErrorMap:()=>hn,getParsedType:()=>At,instanceof:()=>F$,intersection:()=>nx,isAborted:()=>qs,isAsync:()=>gn,isDirty:()=>Fs,isValid:()=>ar,late:()=>q$,lazy:()=>ux,literal:()=>lx,makeIssue:()=>ro,map:()=>ix,nan:()=>U$,nativeEnum:()=>px,never:()=>Y$,null:()=>G$,nullable:()=>gx,number:()=>Im,object:()=>_c,objectUtil:()=>fc,oboolean:()=>$x,onumber:()=>bx,optional:()=>hx,ostring:()=>vx,pipeline:()=>_x,preprocess:()=>yx,promise:()=>fx,quotelessJson:()=>h$,record:()=>sx,set:()=>ax,setErrorMap:()=>y$,strictObject:()=>ex,string:()=>Pm,symbol:()=>H$,transformer:()=>mx,tuple:()=>ox,undefined:()=>W$,union:()=>tx,unknown:()=>J$,util:()=>X,void:()=>X$});var Hs=x(()=>{Ds();hc();bm();to();Cm();Ls()});var so=x(()=>{Hs()});function $(e,t,r){function n(a,c){var u;Object.defineProperty(a,"_zod",{value:a._zod??{},enumerable:!1}),(u=a._zod).traits??(u.traits=new Set),a._zod.traits.add(e),t(a,c);for(let d in i.prototype)d in a||Object.defineProperty(a,d,{value:i.prototype[d].bind(a)});a._zod.constr=i,a._zod.def=c}let o=r?.Parent??Object;class s extends o{}Object.defineProperty(s,"name",{value:e});function i(a){var c;let u=r?.Parent?new s:this;n(u,a),(c=u._zod).deferred??(c.deferred=[]);for(let d of u._zod.deferred)d();return u}return Object.defineProperty(i,"init",{value:n}),Object.defineProperty(i,Symbol.hasInstance,{value:a=>r?.Parent&&a instanceof r.Parent?!0:a?._zod?.traits?.has(e)}),Object.defineProperty(i,"name",{value:e}),i}function at(e){return e&&Object.assign(Ws,e),Ws}var Sx,Xt,Ws,wn=x(()=>{Sx=Object.freeze({status:"aborted"});Xt=class extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}},Ws={}});var Q={};ms(Q,{BIGINT_FORMAT_RANGES:()=>Nm,Class:()=>bc,NUMBER_FORMAT_RANGES:()=>Ec,aborted:()=>Wr,allowsEval:()=>kc,assert:()=>Ix,assertEqual:()=>Tx,assertIs:()=>zx,assertNever:()=>Px,assertNotEqual:()=>Ex,assignProp:()=>wc,cached:()=>co,captureStackTrace:()=>Ks,cleanEnum:()=>Ux,cleanRegex:()=>lo,clone:()=>ct,createTransparentProxy:()=>jx,defineLazy:()=>fe,esc:()=>Hr,escapeRegex:()=>dr,extend:()=>Lx,finalizeIssue:()=>kt,floatSafeRemainder:()=>xc,getElementAtPath:()=>Rx,getEnumValues:()=>ao,getLengthableOrigin:()=>po,getParsedType:()=>Ax,getSizableOrigin:()=>Am,isObject:()=>kn,isPlainObject:()=>Sn,issue:()=>zc,joinValues:()=>Gs,jsonStringifyReplacer:()=>$c,merge:()=>Dx,normalizeParams:()=>F,nullish:()=>uo,numKeys:()=>Nx,omit:()=>Zx,optionalKeys:()=>Tc,partial:()=>qx,pick:()=>Mx,prefixIssues:()=>Zt,primitiveTypes:()=>Om,promiseAllObject:()=>Cx,propertyKeyTypes:()=>Sc,randomString:()=>Ox,required:()=>Fx,stringifyPrimitive:()=>Js,unwrapMessage:()=>io});function Tx(e){return e}function Ex(e){return e}function zx(e){}function Px(e){throw new Error}function Ix(e){}function ao(e){let t=Object.values(e).filter(n=>typeof n=="number");return Object.entries(e).filter(([n,o])=>t.indexOf(+n)===-1).map(([n,o])=>o)}function Gs(e,t="|"){return e.map(r=>Js(r)).join(t)}function $c(e,t){return typeof t=="bigint"?t.toString():t}function co(e){return{get value(){{let r=e();return Object.defineProperty(this,"value",{value:r}),r}throw new Error("cached value already set")}}}function uo(e){return e==null}function lo(e){let t=e.startsWith("^")?1:0,r=e.endsWith("$")?e.length-1:e.length;return e.slice(t,r)}function xc(e,t){let r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,o=r>n?r:n,s=Number.parseInt(e.toFixed(o).replace(".","")),i=Number.parseInt(t.toFixed(o).replace(".",""));return s%i/10**o}function fe(e,t,r){Object.defineProperty(e,t,{get(){{let o=r();return e[t]=o,o}throw new Error("cached value already set")},set(o){Object.defineProperty(e,t,{value:o})},configurable:!0})}function wc(e,t,r){Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0})}function Rx(e,t){return t?t.reduce((r,n)=>r?.[n],e):e}function Cx(e){let t=Object.keys(e),r=t.map(n=>e[n]);return Promise.all(r).then(n=>{let o={};for(let s=0;s<t.length;s++)o[t[s]]=n[s];return o})}function Ox(e=10){let t="abcdefghijklmnopqrstuvwxyz",r="";for(let n=0;n<e;n++)r+=t[Math.floor(Math.random()*t.length)];return r}function Hr(e){return JSON.stringify(e)}function kn(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function Sn(e){if(kn(e)===!1)return!1;let t=e.constructor;if(t===void 0)return!0;let r=t.prototype;return!(kn(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function Nx(e){let t=0;for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function dr(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ct(e,t,r){let n=new e._zod.constr(t??e._zod.def);return(!t||r?.parent)&&(n._zod.parent=e),n}function F(e){let t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if(t?.message!==void 0){if(t?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function jx(e){let t;return new Proxy({},{get(r,n,o){return t??(t=e()),Reflect.get(t,n,o)},set(r,n,o,s){return t??(t=e()),Reflect.set(t,n,o,s)},has(r,n){return t??(t=e()),Reflect.has(t,n)},deleteProperty(r,n){return t??(t=e()),Reflect.deleteProperty(t,n)},ownKeys(r){return t??(t=e()),Reflect.ownKeys(t)},getOwnPropertyDescriptor(r,n){return t??(t=e()),Reflect.getOwnPropertyDescriptor(t,n)},defineProperty(r,n,o){return t??(t=e()),Reflect.defineProperty(t,n,o)}})}function Js(e){return typeof e=="bigint"?e.toString()+"n":typeof e=="string"?`"${e}"`:`${e}`}function Tc(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}function Mx(e,t){let r={},n=e._zod.def;for(let o in t){if(!(o in n.shape))throw new Error(`Unrecognized key: "${o}"`);t[o]&&(r[o]=n.shape[o])}return ct(e,{...e._zod.def,shape:r,checks:[]})}function Zx(e,t){let r={...e._zod.def.shape},n=e._zod.def;for(let o in t){if(!(o in n.shape))throw new Error(`Unrecognized key: "${o}"`);t[o]&&delete r[o]}return ct(e,{...e._zod.def,shape:r,checks:[]})}function Lx(e,t){if(!Sn(t))throw new Error("Invalid input to extend: expected a plain object");let r={...e._zod.def,get shape(){let n={...e._zod.def.shape,...t};return wc(this,"shape",n),n},checks:[]};return ct(e,r)}function Dx(e,t){return ct(e,{...e._zod.def,get shape(){let r={...e._zod.def.shape,...t._zod.def.shape};return wc(this,"shape",r),r},catchall:t._zod.def.catchall,checks:[]})}function qx(e,t,r){let n=t._zod.def.shape,o={...n};if(r)for(let s in r){if(!(s in n))throw new Error(`Unrecognized key: "${s}"`);r[s]&&(o[s]=e?new e({type:"optional",innerType:n[s]}):n[s])}else for(let s in n)o[s]=e?new e({type:"optional",innerType:n[s]}):n[s];return ct(t,{...t._zod.def,shape:o,checks:[]})}function Fx(e,t,r){let n=t._zod.def.shape,o={...n};if(r)for(let s in r){if(!(s in o))throw new Error(`Unrecognized key: "${s}"`);r[s]&&(o[s]=new e({type:"nonoptional",innerType:n[s]}))}else for(let s in n)o[s]=new e({type:"nonoptional",innerType:n[s]});return ct(t,{...t._zod.def,shape:o,checks:[]})}function Wr(e,t=0){for(let r=t;r<e.issues.length;r++)if(e.issues[r]?.continue!==!0)return!0;return!1}function Zt(e,t){return t.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(e),r})}function io(e){return typeof e=="string"?e:e?.message}function kt(e,t,r){let n={...e,path:e.path??[]};if(!e.message){let o=io(e.inst?._zod.def?.error?.(e))??io(t?.error?.(e))??io(r.customError?.(e))??io(r.localeError?.(e))??"Invalid input";n.message=o}return delete n.inst,delete n.continue,t?.reportInput||delete n.input,n}function Am(e){return e instanceof Set?"set":e instanceof Map?"map":e instanceof File?"file":"unknown"}function po(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function zc(...e){let[t,r,n]=e;return typeof t=="string"?{message:t,code:"custom",input:r,inst:n}:{...t}}function Ux(e){return Object.entries(e).filter(([t,r])=>Number.isNaN(Number.parseInt(t,10))).map(t=>t[1])}var Ks,kc,Ax,Sc,Om,Ec,Nm,bc,Lt=x(()=>{Ks=Error.captureStackTrace?Error.captureStackTrace:(...e)=>{};kc=co(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{let e=Function;return new e(""),!0}catch{return!1}});Ax=e=>{let t=typeof e;switch(t){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(e)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":return Array.isArray(e)?"array":e===null?"null":e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?"promise":typeof Map<"u"&&e instanceof Map?"map":typeof Set<"u"&&e instanceof Set?"set":typeof Date<"u"&&e instanceof Date?"date":typeof File<"u"&&e instanceof File?"file":"object";default:throw new Error(`Unknown data type: ${t}`)}},Sc=new Set(["string","number","symbol"]),Om=new Set(["string","number","bigint","boolean","symbol","undefined"]);Ec={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},Nm={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};bc=class{constructor(...t){}}});function Pc(e,t=r=>r.message){let r={},n=[];for(let o of e.issues)o.path.length>0?(r[o.path[0]]=r[o.path[0]]||[],r[o.path[0]].push(t(o))):n.push(t(o));return{formErrors:n,fieldErrors:r}}function Ic(e,t){let r=t||function(s){return s.message},n={_errors:[]},o=s=>{for(let i of s.issues)if(i.code==="invalid_union"&&i.errors.length)i.errors.map(a=>o({issues:a}));else if(i.code==="invalid_key")o({issues:i.issues});else if(i.code==="invalid_element")o({issues:i.issues});else if(i.path.length===0)n._errors.push(r(i));else{let a=n,c=0;for(;c<i.path.length;){let u=i.path[c];c===i.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(r(i))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return o(e),n}var jm,Ys,fo,Rc=x(()=>{wn();Lt();jm=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),Object.defineProperty(e,"message",{get(){return JSON.stringify(t,$c,2)},enumerable:!0}),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},Ys=$("$ZodError",jm),fo=$("$ZodError",jm,{Parent:Error})});var Cc,Oc,Nc,Ac,jc,Gr,Mc,Kr,Zc=x(()=>{wn();Rc();Lt();Cc=e=>(t,r,n,o)=>{let s=n?Object.assign(n,{async:!1}):{async:!1},i=t._zod.run({value:r,issues:[]},s);if(i instanceof Promise)throw new Xt;if(i.issues.length){let a=new(o?.Err??e)(i.issues.map(c=>kt(c,s,at())));throw Ks(a,o?.callee),a}return i.value},Oc=Cc(fo),Nc=e=>async(t,r,n,o)=>{let s=n?Object.assign(n,{async:!0}):{async:!0},i=t._zod.run({value:r,issues:[]},s);if(i instanceof Promise&&(i=await i),i.issues.length){let a=new(o?.Err??e)(i.issues.map(c=>kt(c,s,at())));throw Ks(a,o?.callee),a}return i.value},Ac=Nc(fo),jc=e=>(t,r,n)=>{let o=n?{...n,async:!1}:{async:!1},s=t._zod.run({value:r,issues:[]},o);if(s instanceof Promise)throw new Xt;return s.issues.length?{success:!1,error:new(e??Ys)(s.issues.map(i=>kt(i,o,at())))}:{success:!0,data:s.value}},Gr=jc(fo),Mc=e=>async(t,r,n)=>{let o=n?Object.assign(n,{async:!0}):{async:!0},s=t._zod.run({value:r,issues:[]},o);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new e(s.issues.map(i=>kt(i,o,at())))}:{success:!0,data:s.value}},Kr=Mc(fo)});function Hm(){return new RegExp(Bx,"u")}function rh(e){let t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function nh(e){return new RegExp(`^${rh(e)}$`)}function oh(e){let t=rh({precision:e.precision}),r=["Z"];e.local&&r.push(""),e.offset&&r.push("([+-]\\d{2}:\\d{2})");let n=`${t}(?:${r.join("|")})`;return new RegExp(`^${eh}T(?:${n})$`)}var Mm,Zm,Lm,Dm,qm,Fm,Um,Vm,Lc,Bm,Bx,Wm,Gm,Km,Jm,Ym,Dc,Xm,Qm,eh,th,sh,ih,ah,ch,uh,lh,dh,Qs=x(()=>{Mm=/^[cC][^\s-]{8,}$/,Zm=/^[0-9a-z]+$/,Lm=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,Dm=/^[0-9a-vA-V]{20}$/,qm=/^[A-Za-z0-9]{27}$/,Fm=/^[a-zA-Z0-9_-]{21}$/,Um=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,Vm=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Lc=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/,Bm=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,Bx="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";Wm=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Gm=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,Km=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Jm=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Ym=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Dc=/^[A-Za-z0-9_-]*$/,Xm=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/,Qm=/^\+(?:[0-9]){6,14}[0-9]$/,eh="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",th=new RegExp(`^${eh}$`);sh=e=>{let t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},ih=/^\d+$/,ah=/^-?\d+(?:\.\d+)?/i,ch=/true|false/i,uh=/null/i,lh=/^[^A-Z]*$/,dh=/^[^a-z]*$/});var Ne,ph,qc,Fc,fh,mh,hh,gh,yh,mo,_h,vh,bh,$h,xh,wh,kh,ei=x(()=>{wn();Qs();Lt();Ne=$("$ZodCheck",(e,t)=>{var r;e._zod??(e._zod={}),e._zod.def=t,(r=e._zod).onattach??(r.onattach=[])}),ph={number:"number",bigint:"bigint",object:"date"},qc=$("$ZodCheckLessThan",(e,t)=>{Ne.init(e,t);let r=ph[typeof t.value];e._zod.onattach.push(n=>{let o=n._zod.bag,s=(t.inclusive?o.maximum:o.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<s&&(t.inclusive?o.maximum=t.value:o.exclusiveMaximum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value<=t.value:n.value<t.value)||n.issues.push({origin:r,code:"too_big",maximum:t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),Fc=$("$ZodCheckGreaterThan",(e,t)=>{Ne.init(e,t);let r=ph[typeof t.value];e._zod.onattach.push(n=>{let o=n._zod.bag,s=(t.inclusive?o.minimum:o.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>s&&(t.inclusive?o.minimum=t.value:o.exclusiveMinimum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value>=t.value:n.value>t.value)||n.issues.push({origin:r,code:"too_small",minimum:t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),fh=$("$ZodCheckMultipleOf",(e,t)=>{Ne.init(e,t),e._zod.onattach.push(r=>{var n;(n=r._zod.bag).multipleOf??(n.multipleOf=t.value)}),e._zod.check=r=>{if(typeof r.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%t.value===BigInt(0):xc(r.value,t.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:t.value,input:r.value,inst:e,continue:!t.abort})}}),mh=$("$ZodCheckNumberFormat",(e,t)=>{Ne.init(e,t),t.format=t.format||"float64";let r=t.format?.includes("int"),n=r?"int":"number",[o,s]=Ec[t.format];e._zod.onattach.push(i=>{let a=i._zod.bag;a.format=t.format,a.minimum=o,a.maximum=s,r&&(a.pattern=ih)}),e._zod.check=i=>{let a=i.value;if(r){if(!Number.isInteger(a)){i.issues.push({expected:n,format:t.format,code:"invalid_type",input:a,inst:e});return}if(!Number.isSafeInteger(a)){a>0?i.issues.push({input:a,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,continue:!t.abort}):i.issues.push({input:a,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,continue:!t.abort});return}}a<o&&i.issues.push({origin:"number",input:a,code:"too_small",minimum:o,inclusive:!0,inst:e,continue:!t.abort}),a>s&&i.issues.push({origin:"number",input:a,code:"too_big",maximum:s,inst:e})}}),hh=$("$ZodCheckMaxLength",(e,t)=>{var r;Ne.init(e,t),(r=e._zod.def).when??(r.when=n=>{let o=n.value;return!uo(o)&&o.length!==void 0}),e._zod.onattach.push(n=>{let o=n._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<o&&(n._zod.bag.maximum=t.maximum)}),e._zod.check=n=>{let o=n.value;if(o.length<=t.maximum)return;let i=po(o);n.issues.push({origin:i,code:"too_big",maximum:t.maximum,inclusive:!0,input:o,inst:e,continue:!t.abort})}}),gh=$("$ZodCheckMinLength",(e,t)=>{var r;Ne.init(e,t),(r=e._zod.def).when??(r.when=n=>{let o=n.value;return!uo(o)&&o.length!==void 0}),e._zod.onattach.push(n=>{let o=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>o&&(n._zod.bag.minimum=t.minimum)}),e._zod.check=n=>{let o=n.value;if(o.length>=t.minimum)return;let i=po(o);n.issues.push({origin:i,code:"too_small",minimum:t.minimum,inclusive:!0,input:o,inst:e,continue:!t.abort})}}),yh=$("$ZodCheckLengthEquals",(e,t)=>{var r;Ne.init(e,t),(r=e._zod.def).when??(r.when=n=>{let o=n.value;return!uo(o)&&o.length!==void 0}),e._zod.onattach.push(n=>{let o=n._zod.bag;o.minimum=t.length,o.maximum=t.length,o.length=t.length}),e._zod.check=n=>{let o=n.value,s=o.length;if(s===t.length)return;let i=po(o),a=s>t.length;n.issues.push({origin:i,...a?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:n.value,inst:e,continue:!t.abort})}}),mo=$("$ZodCheckStringFormat",(e,t)=>{var r,n;Ne.init(e,t),e._zod.onattach.push(o=>{let s=o._zod.bag;s.format=t.format,t.pattern&&(s.patterns??(s.patterns=new Set),s.patterns.add(t.pattern))}),t.pattern?(r=e._zod).check??(r.check=o=>{t.pattern.lastIndex=0,!t.pattern.test(o.value)&&o.issues.push({origin:"string",code:"invalid_format",format:t.format,input:o.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(n=e._zod).check??(n.check=()=>{})}),_h=$("$ZodCheckRegex",(e,t)=>{mo.init(e,t),e._zod.check=r=>{t.pattern.lastIndex=0,!t.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),vh=$("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=lh),mo.init(e,t)}),bh=$("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=dh),mo.init(e,t)}),$h=$("$ZodCheckIncludes",(e,t)=>{Ne.init(e,t);let r=dr(t.includes),n=new RegExp(typeof t.position=="number"?`^.{${t.position}}${r}`:r);t.pattern=n,e._zod.onattach.push(o=>{let s=o._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(n)}),e._zod.check=o=>{o.value.includes(t.includes,t.position)||o.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:o.value,inst:e,continue:!t.abort})}}),xh=$("$ZodCheckStartsWith",(e,t)=>{Ne.init(e,t);let r=new RegExp(`^${dr(t.prefix)}.*`);t.pattern??(t.pattern=r),e._zod.onattach.push(n=>{let o=n._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(r)}),e._zod.check=n=>{n.value.startsWith(t.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:n.value,inst:e,continue:!t.abort})}}),wh=$("$ZodCheckEndsWith",(e,t)=>{Ne.init(e,t);let r=new RegExp(`.*${dr(t.suffix)}$`);t.pattern??(t.pattern=r),e._zod.onattach.push(n=>{let o=n._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(r)}),e._zod.check=n=>{n.value.endsWith(t.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:n.value,inst:e,continue:!t.abort})}}),kh=$("$ZodCheckOverwrite",(e,t)=>{Ne.init(e,t),e._zod.check=r=>{r.value=t.tx(r.value)}})});var ti,Uc=x(()=>{ti=class{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}let n=t.split(`
`).filter(i=>i),o=Math.min(...n.map(i=>i.length-i.trimStart().length)),s=n.map(i=>i.slice(o)).map(i=>" ".repeat(this.indent*2)+i);for(let i of s)this.content.push(i)}compile(){let t=Function,r=this?.args,o=[...(this?.content??[""]).map(s=>`  ${s}`)];return new t(...r,o.join(`
`))}}});var Th,Vc=x(()=>{Th={major:4,minor:0,patch:0}});function Dh(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}function Hx(e){if(!Dc.test(e))return!1;let t=e.replace(/[-_]/g,n=>n==="-"?"+":"/"),r=t.padEnd(Math.ceil(t.length/4)*4,"=");return Dh(r)}function Wx(e,t=null){try{let r=e.split(".");if(r.length!==3)return!1;let[n]=r;if(!n)return!1;let o=JSON.parse(atob(n));return!("typ"in o&&o?.typ!=="JWT"||!o.alg||t&&(!("alg"in o)||o.alg!==t))}catch{return!1}}function Eh(e,t,r){e.issues.length&&t.issues.push(...Zt(r,e.issues)),t.value[r]=e.value}function ri(e,t,r){e.issues.length&&t.issues.push(...Zt(r,e.issues)),t.value[r]=e.value}function zh(e,t,r,n){e.issues.length?n[r]===void 0?r in n?t.value[r]=void 0:t.value[r]=e.value:t.issues.push(...Zt(r,e.issues)):e.value===void 0?r in n&&(t.value[r]=void 0):t.value[r]=e.value}function Ph(e,t,r,n){for(let o of e)if(o.issues.length===0)return t.value=o.value,t;return t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(o=>o.issues.map(s=>kt(s,n,at())))}),t}function Bc(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(Sn(e)&&Sn(t)){let r=Object.keys(t),n=Object.keys(e).filter(s=>r.indexOf(s)!==-1),o={...e,...t};for(let s of n){let i=Bc(e[s],t[s]);if(!i.valid)return{valid:!1,mergeErrorPath:[s,...i.mergeErrorPath]};o[s]=i.data}return{valid:!0,data:o}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};let r=[];for(let n=0;n<e.length;n++){let o=e[n],s=t[n],i=Bc(o,s);if(!i.valid)return{valid:!1,mergeErrorPath:[n,...i.mergeErrorPath]};r.push(i.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function Ih(e,t,r){if(t.issues.length&&e.issues.push(...t.issues),r.issues.length&&e.issues.push(...r.issues),Wr(e))return e;let n=Bc(t.value,r.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return e.value=n.data,e}function Rh(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}function Ch(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}function Oh(e,t,r){return Wr(e)?e:t.out._zod.run({value:e.value,issues:e.issues},r)}function Nh(e){return e.value=Object.freeze(e.value),e}function Ah(e,t,r,n){if(!e){let o={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(o.params=n._zod.def.params),t.issues.push(zc(o))}}var ue,ho,me,Hc,Wc,Gc,Kc,Jc,Yc,Xc,Qc,eu,tu,ru,jh,Mh,Zh,Lh,nu,ou,su,iu,au,cu,uu,lu,ni,du,pu,fu,mu,hu,gu,oi,si,yu,_u,vu,bu,$u,xu,wu,ku,Su,Tu,Eu,zu,Pu,Iu,Ru,qh=x(()=>{ei();wn();Uc();Zc();Qs();Lt();Vc();Lt();ue=$("$ZodType",(e,t)=>{var r;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=Th;let n=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&n.unshift(e);for(let o of n)for(let s of o._zod.onattach)s(e);if(n.length===0)(r=e._zod).deferred??(r.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{let o=(s,i,a)=>{let c=Wr(s),u;for(let d of i){if(d._zod.def.when){if(!d._zod.def.when(s))continue}else if(c)continue;let l=s.issues.length,m=d._zod.check(s);if(m instanceof Promise&&a?.async===!1)throw new Xt;if(u||m instanceof Promise)u=(u??Promise.resolve()).then(async()=>{await m,s.issues.length!==l&&(c||(c=Wr(s,l)))});else{if(s.issues.length===l)continue;c||(c=Wr(s,l))}}return u?u.then(()=>s):s};e._zod.run=(s,i)=>{let a=e._zod.parse(s,i);if(a instanceof Promise){if(i.async===!1)throw new Xt;return a.then(c=>o(c,n,i))}return o(a,n,i)}}e["~standard"]={validate:o=>{try{let s=Gr(e,o);return s.success?{value:s.data}:{issues:s.error?.issues}}catch{return Kr(e,o).then(i=>i.success?{value:i.data}:{issues:i.error?.issues})}},vendor:"zod",version:1}}),ho=$("$ZodString",(e,t)=>{ue.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??sh(e._zod.bag),e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:e}),r}}),me=$("$ZodStringFormat",(e,t)=>{mo.init(e,t),ho.init(e,t)}),Hc=$("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=Vm),me.init(e,t)}),Wc=$("$ZodUUID",(e,t)=>{if(t.version){let n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(n===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=Lc(n))}else t.pattern??(t.pattern=Lc());me.init(e,t)}),Gc=$("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=Bm),me.init(e,t)}),Kc=$("$ZodURL",(e,t)=>{me.init(e,t),e._zod.check=r=>{try{let n=r.value,o=new URL(n),s=o.href;t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(o.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:Xm.source,input:r.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(o.protocol.endsWith(":")?o.protocol.slice(0,-1):o.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:r.value,inst:e,continue:!t.abort})),!n.endsWith("/")&&s.endsWith("/")?r.value=s.slice(0,-1):r.value=s;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:e,continue:!t.abort})}}}),Jc=$("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=Hm()),me.init(e,t)}),Yc=$("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=Fm),me.init(e,t)}),Xc=$("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=Mm),me.init(e,t)}),Qc=$("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=Zm),me.init(e,t)}),eu=$("$ZodULID",(e,t)=>{t.pattern??(t.pattern=Lm),me.init(e,t)}),tu=$("$ZodXID",(e,t)=>{t.pattern??(t.pattern=Dm),me.init(e,t)}),ru=$("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=qm),me.init(e,t)}),jh=$("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=oh(t)),me.init(e,t)}),Mh=$("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=th),me.init(e,t)}),Zh=$("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=nh(t)),me.init(e,t)}),Lh=$("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=Um),me.init(e,t)}),nu=$("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=Wm),me.init(e,t),e._zod.onattach.push(r=>{let n=r._zod.bag;n.format="ipv4"})}),ou=$("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=Gm),me.init(e,t),e._zod.onattach.push(r=>{let n=r._zod.bag;n.format="ipv6"}),e._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:e,continue:!t.abort})}}}),su=$("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=Km),me.init(e,t)}),iu=$("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=Jm),me.init(e,t),e._zod.check=r=>{let[n,o]=r.value.split("/");try{if(!o)throw new Error;let s=Number(o);if(`${s}`!==o)throw new Error;if(s<0||s>128)throw new Error;new URL(`http://[${n}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:e,continue:!t.abort})}}});au=$("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=Ym),me.init(e,t),e._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64"}),e._zod.check=r=>{Dh(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:e,continue:!t.abort})}});cu=$("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=Dc),me.init(e,t),e._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64url"}),e._zod.check=r=>{Hx(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:e,continue:!t.abort})}}),uu=$("$ZodE164",(e,t)=>{t.pattern??(t.pattern=Qm),me.init(e,t)});lu=$("$ZodJWT",(e,t)=>{me.init(e,t),e._zod.check=r=>{Wx(r.value,t.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:e,continue:!t.abort})}}),ni=$("$ZodNumber",(e,t)=>{ue.init(e,t),e._zod.pattern=e._zod.bag.pattern??ah,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=Number(r.value)}catch{}let o=r.value;if(typeof o=="number"&&!Number.isNaN(o)&&Number.isFinite(o))return r;let s=typeof o=="number"?Number.isNaN(o)?"NaN":Number.isFinite(o)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:o,inst:e,...s?{received:s}:{}}),r}}),du=$("$ZodNumber",(e,t)=>{mh.init(e,t),ni.init(e,t)}),pu=$("$ZodBoolean",(e,t)=>{ue.init(e,t),e._zod.pattern=ch,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=!!r.value}catch{}let o=r.value;return typeof o=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:o,inst:e}),r}}),fu=$("$ZodNull",(e,t)=>{ue.init(e,t),e._zod.pattern=uh,e._zod.values=new Set([null]),e._zod.parse=(r,n)=>{let o=r.value;return o===null||r.issues.push({expected:"null",code:"invalid_type",input:o,inst:e}),r}}),mu=$("$ZodUnknown",(e,t)=>{ue.init(e,t),e._zod.parse=r=>r}),hu=$("$ZodNever",(e,t)=>{ue.init(e,t),e._zod.parse=(r,n)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:e}),r)});gu=$("$ZodArray",(e,t)=>{ue.init(e,t),e._zod.parse=(r,n)=>{let o=r.value;if(!Array.isArray(o))return r.issues.push({expected:"array",code:"invalid_type",input:o,inst:e}),r;r.value=Array(o.length);let s=[];for(let i=0;i<o.length;i++){let a=o[i],c=t.element._zod.run({value:a,issues:[]},n);c instanceof Promise?s.push(c.then(u=>Eh(u,r,i))):Eh(c,r,i)}return s.length?Promise.all(s).then(()=>r):r}});oi=$("$ZodObject",(e,t)=>{ue.init(e,t);let r=co(()=>{let l=Object.keys(t.shape);for(let h of l)if(!(t.shape[h]instanceof ue))throw new Error(`Invalid element at key "${h}": expected a Zod schema`);let m=Tc(t.shape);return{shape:t.shape,keys:l,keySet:new Set(l),numKeys:l.length,optionalKeys:new Set(m)}});fe(e._zod,"propValues",()=>{let l=t.shape,m={};for(let h in l){let p=l[h]._zod;if(p.values){m[h]??(m[h]=new Set);for(let f of p.values)m[h].add(f)}}return m});let n=l=>{let m=new ti(["shape","payload","ctx"]),h=r.value,p=v=>{let _=Hr(v);return`shape[${_}]._zod.run({ value: input[${_}], issues: [] }, ctx)`};m.write("const input = payload.value;");let f=Object.create(null),g=0;for(let v of h.keys)f[v]=`key_${g++}`;m.write("const newResult = {}");for(let v of h.keys)if(h.optionalKeys.has(v)){let _=f[v];m.write(`const ${_} = ${p(v)};`);let w=Hr(v);m.write(`
        if (${_}.issues.length) {
          if (input[${w}] === undefined) {
            if (${w} in input) {
              newResult[${w}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${_}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${w}, ...iss.path] : [${w}],
              }))
            );
          }
        } else if (${_}.value === undefined) {
          if (${w} in input) newResult[${w}] = undefined;
        } else {
          newResult[${w}] = ${_}.value;
        }
        `)}else{let _=f[v];m.write(`const ${_} = ${p(v)};`),m.write(`
          if (${_}.issues.length) payload.issues = payload.issues.concat(${_}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${Hr(v)}, ...iss.path] : [${Hr(v)}]
          })));`),m.write(`newResult[${Hr(v)}] = ${_}.value`)}m.write("payload.value = newResult;"),m.write("return payload;");let y=m.compile();return(v,_)=>y(l,v,_)},o,s=kn,i=!Ws.jitless,c=i&&kc.value,u=t.catchall,d;e._zod.parse=(l,m)=>{d??(d=r.value);let h=l.value;if(!s(h))return l.issues.push({expected:"object",code:"invalid_type",input:h,inst:e}),l;let p=[];if(i&&c&&m?.async===!1&&m.jitless!==!0)o||(o=n(t.shape)),l=o(l,m);else{l.value={};let _=d.shape;for(let w of d.keys){let E=_[w],B=E._zod.run({value:h[w],issues:[]},m),I=E._zod.optin==="optional"&&E._zod.optout==="optional";B instanceof Promise?p.push(B.then(j=>I?zh(j,l,w,h):ri(j,l,w))):I?zh(B,l,w,h):ri(B,l,w)}}if(!u)return p.length?Promise.all(p).then(()=>l):l;let f=[],g=d.keySet,y=u._zod,v=y.def.type;for(let _ of Object.keys(h)){if(g.has(_))continue;if(v==="never"){f.push(_);continue}let w=y.run({value:h[_],issues:[]},m);w instanceof Promise?p.push(w.then(E=>ri(E,l,_))):ri(w,l,_)}return f.length&&l.issues.push({code:"unrecognized_keys",keys:f,input:h,inst:e}),p.length?Promise.all(p).then(()=>l):l}});si=$("$ZodUnion",(e,t)=>{ue.init(e,t),fe(e._zod,"optin",()=>t.options.some(r=>r._zod.optin==="optional")?"optional":void 0),fe(e._zod,"optout",()=>t.options.some(r=>r._zod.optout==="optional")?"optional":void 0),fe(e._zod,"values",()=>{if(t.options.every(r=>r._zod.values))return new Set(t.options.flatMap(r=>Array.from(r._zod.values)))}),fe(e._zod,"pattern",()=>{if(t.options.every(r=>r._zod.pattern)){let r=t.options.map(n=>n._zod.pattern);return new RegExp(`^(${r.map(n=>lo(n.source)).join("|")})$`)}}),e._zod.parse=(r,n)=>{let o=!1,s=[];for(let i of t.options){let a=i._zod.run({value:r.value,issues:[]},n);if(a instanceof Promise)s.push(a),o=!0;else{if(a.issues.length===0)return a;s.push(a)}}return o?Promise.all(s).then(i=>Ph(i,r,e,n)):Ph(s,r,e,n)}}),yu=$("$ZodDiscriminatedUnion",(e,t)=>{si.init(e,t);let r=e._zod.parse;fe(e._zod,"propValues",()=>{let o={};for(let s of t.options){let i=s._zod.propValues;if(!i||Object.keys(i).length===0)throw new Error(`Invalid discriminated union option at index "${t.options.indexOf(s)}"`);for(let[a,c]of Object.entries(i)){o[a]||(o[a]=new Set);for(let u of c)o[a].add(u)}}return o});let n=co(()=>{let o=t.options,s=new Map;for(let i of o){let a=i._zod.propValues[t.discriminator];if(!a||a.size===0)throw new Error(`Invalid discriminated union option at index "${t.options.indexOf(i)}"`);for(let c of a){if(s.has(c))throw new Error(`Duplicate discriminator value "${String(c)}"`);s.set(c,i)}}return s});e._zod.parse=(o,s)=>{let i=o.value;if(!kn(i))return o.issues.push({code:"invalid_type",expected:"object",input:i,inst:e}),o;let a=n.value.get(i?.[t.discriminator]);return a?a._zod.run(o,s):t.unionFallback?r(o,s):(o.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:i,path:[t.discriminator],inst:e}),o)}}),_u=$("$ZodIntersection",(e,t)=>{ue.init(e,t),e._zod.parse=(r,n)=>{let o=r.value,s=t.left._zod.run({value:o,issues:[]},n),i=t.right._zod.run({value:o,issues:[]},n);return s instanceof Promise||i instanceof Promise?Promise.all([s,i]).then(([c,u])=>Ih(r,c,u)):Ih(r,s,i)}});vu=$("$ZodRecord",(e,t)=>{ue.init(e,t),e._zod.parse=(r,n)=>{let o=r.value;if(!Sn(o))return r.issues.push({expected:"record",code:"invalid_type",input:o,inst:e}),r;let s=[];if(t.keyType._zod.values){let i=t.keyType._zod.values;r.value={};for(let c of i)if(typeof c=="string"||typeof c=="number"||typeof c=="symbol"){let u=t.valueType._zod.run({value:o[c],issues:[]},n);u instanceof Promise?s.push(u.then(d=>{d.issues.length&&r.issues.push(...Zt(c,d.issues)),r.value[c]=d.value})):(u.issues.length&&r.issues.push(...Zt(c,u.issues)),r.value[c]=u.value)}let a;for(let c in o)i.has(c)||(a=a??[],a.push(c));a&&a.length>0&&r.issues.push({code:"unrecognized_keys",input:o,inst:e,keys:a})}else{r.value={};for(let i of Reflect.ownKeys(o)){if(i==="__proto__")continue;let a=t.keyType._zod.run({value:i,issues:[]},n);if(a instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(a.issues.length){r.issues.push({origin:"record",code:"invalid_key",issues:a.issues.map(u=>kt(u,n,at())),input:i,path:[i],inst:e}),r.value[a.value]=a.value;continue}let c=t.valueType._zod.run({value:o[i],issues:[]},n);c instanceof Promise?s.push(c.then(u=>{u.issues.length&&r.issues.push(...Zt(i,u.issues)),r.value[a.value]=u.value})):(c.issues.length&&r.issues.push(...Zt(i,c.issues)),r.value[a.value]=c.value)}}return s.length?Promise.all(s).then(()=>r):r}}),bu=$("$ZodEnum",(e,t)=>{ue.init(e,t);let r=ao(t.entries);e._zod.values=new Set(r),e._zod.pattern=new RegExp(`^(${r.filter(n=>Sc.has(typeof n)).map(n=>typeof n=="string"?dr(n):n.toString()).join("|")})$`),e._zod.parse=(n,o)=>{let s=n.value;return e._zod.values.has(s)||n.issues.push({code:"invalid_value",values:r,input:s,inst:e}),n}}),$u=$("$ZodLiteral",(e,t)=>{ue.init(e,t),e._zod.values=new Set(t.values),e._zod.pattern=new RegExp(`^(${t.values.map(r=>typeof r=="string"?dr(r):r?r.toString():String(r)).join("|")})$`),e._zod.parse=(r,n)=>{let o=r.value;return e._zod.values.has(o)||r.issues.push({code:"invalid_value",values:t.values,input:o,inst:e}),r}}),xu=$("$ZodTransform",(e,t)=>{ue.init(e,t),e._zod.parse=(r,n)=>{let o=t.transform(r.value,r);if(n.async)return(o instanceof Promise?o:Promise.resolve(o)).then(i=>(r.value=i,r));if(o instanceof Promise)throw new Xt;return r.value=o,r}}),wu=$("$ZodOptional",(e,t)=>{ue.init(e,t),e._zod.optin="optional",e._zod.optout="optional",fe(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),fe(e._zod,"pattern",()=>{let r=t.innerType._zod.pattern;return r?new RegExp(`^(${lo(r.source)})?$`):void 0}),e._zod.parse=(r,n)=>t.innerType._zod.optin==="optional"?t.innerType._zod.run(r,n):r.value===void 0?r:t.innerType._zod.run(r,n)}),ku=$("$ZodNullable",(e,t)=>{ue.init(e,t),fe(e._zod,"optin",()=>t.innerType._zod.optin),fe(e._zod,"optout",()=>t.innerType._zod.optout),fe(e._zod,"pattern",()=>{let r=t.innerType._zod.pattern;return r?new RegExp(`^(${lo(r.source)}|null)$`):void 0}),fe(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(r,n)=>r.value===null?r:t.innerType._zod.run(r,n)}),Su=$("$ZodDefault",(e,t)=>{ue.init(e,t),e._zod.optin="optional",fe(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>{if(r.value===void 0)return r.value=t.defaultValue,r;let o=t.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>Rh(s,t)):Rh(o,t)}});Tu=$("$ZodPrefault",(e,t)=>{ue.init(e,t),e._zod.optin="optional",fe(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>(r.value===void 0&&(r.value=t.defaultValue),t.innerType._zod.run(r,n))}),Eu=$("$ZodNonOptional",(e,t)=>{ue.init(e,t),fe(e._zod,"values",()=>{let r=t.innerType._zod.values;return r?new Set([...r].filter(n=>n!==void 0)):void 0}),e._zod.parse=(r,n)=>{let o=t.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>Ch(s,e)):Ch(o,e)}});zu=$("$ZodCatch",(e,t)=>{ue.init(e,t),e._zod.optin="optional",fe(e._zod,"optout",()=>t.innerType._zod.optout),fe(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>{let o=t.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>(r.value=s.value,s.issues.length&&(r.value=t.catchValue({...r,error:{issues:s.issues.map(i=>kt(i,n,at()))},input:r.value}),r.issues=[]),r)):(r.value=o.value,o.issues.length&&(r.value=t.catchValue({...r,error:{issues:o.issues.map(s=>kt(s,n,at()))},input:r.value}),r.issues=[]),r)}}),Pu=$("$ZodPipe",(e,t)=>{ue.init(e,t),fe(e._zod,"values",()=>t.in._zod.values),fe(e._zod,"optin",()=>t.in._zod.optin),fe(e._zod,"optout",()=>t.out._zod.optout),e._zod.parse=(r,n)=>{let o=t.in._zod.run(r,n);return o instanceof Promise?o.then(s=>Oh(s,t,n)):Oh(o,t,n)}});Iu=$("$ZodReadonly",(e,t)=>{ue.init(e,t),fe(e._zod,"propValues",()=>t.innerType._zod.propValues),fe(e._zod,"values",()=>t.innerType._zod.values),fe(e._zod,"optin",()=>t.innerType._zod.optin),fe(e._zod,"optout",()=>t.innerType._zod.optout),e._zod.parse=(r,n)=>{let o=t.innerType._zod.run(r,n);return o instanceof Promise?o.then(Nh):Nh(o)}});Ru=$("$ZodCustom",(e,t)=>{Ne.init(e,t),ue.init(e,t),e._zod.parse=(r,n)=>r,e._zod.check=r=>{let n=r.value,o=t.fn(n);if(o instanceof Promise)return o.then(s=>Ah(s,r,n,e));Ah(o,r,n,e)}})});function Fh(){return{localeError:Kx()}}var Gx,Kx,Uh=x(()=>{Lt();Gx=e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"number";case"object":{if(Array.isArray(e))return"array";if(e===null)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}}return t},Kx=()=>{let e={string:{unit:"characters",verb:"to have"},file:{unit:"bytes",verb:"to have"},array:{unit:"items",verb:"to have"},set:{unit:"items",verb:"to have"}};function t(n){return e[n]??null}let r={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"};return n=>{switch(n.code){case"invalid_type":return`Invalid input: expected ${n.expected}, received ${Gx(n.input)}`;case"invalid_value":return n.values.length===1?`Invalid input: expected ${Js(n.values[0])}`:`Invalid option: expected one of ${Gs(n.values,"|")}`;case"too_big":{let o=n.inclusive?"<=":"<",s=t(n.origin);return s?`Too big: expected ${n.origin??"value"} to have ${o}${n.maximum.toString()} ${s.unit??"elements"}`:`Too big: expected ${n.origin??"value"} to be ${o}${n.maximum.toString()}`}case"too_small":{let o=n.inclusive?">=":">",s=t(n.origin);return s?`Too small: expected ${n.origin} to have ${o}${n.minimum.toString()} ${s.unit}`:`Too small: expected ${n.origin} to be ${o}${n.minimum.toString()}`}case"invalid_format":{let o=n;return o.format==="starts_with"?`Invalid string: must start with "${o.prefix}"`:o.format==="ends_with"?`Invalid string: must end with "${o.suffix}"`:o.format==="includes"?`Invalid string: must include "${o.includes}"`:o.format==="regex"?`Invalid string: must match pattern ${o.pattern}`:`Invalid ${r[o.format]??n.format}`}case"not_multiple_of":return`Invalid number: must be a multiple of ${n.divisor}`;case"unrecognized_keys":return`Unrecognized key${n.keys.length>1?"s":""}: ${Gs(n.keys,", ")}`;case"invalid_key":return`Invalid key in ${n.origin}`;case"invalid_union":return"Invalid input";case"invalid_element":return`Invalid value in ${n.origin}`;default:return"Invalid input"}}}});var ii=x(()=>{});function Vh(){return new go}var go,pr,Ou=x(()=>{go=class{constructor(){this._map=new Map,this._idmap=new Map}add(t,...r){let n=r[0];if(this._map.set(t,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,t)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(t){let r=this._map.get(t);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(t),this}get(t){let r=t._zod.parent;if(r){let n={...this.get(r)??{}};return delete n.id,{...n,...this._map.get(t)}}return this._map.get(t)}has(t){return this._map.has(t)}};pr=Vh()});function Nu(e,t){return new e({type:"string",...F(t)})}function Au(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...F(t)})}function ai(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...F(t)})}function ju(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...F(t)})}function Mu(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...F(t)})}function Zu(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...F(t)})}function Lu(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...F(t)})}function Du(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...F(t)})}function qu(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...F(t)})}function Fu(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...F(t)})}function Uu(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...F(t)})}function Vu(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...F(t)})}function Bu(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...F(t)})}function Hu(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...F(t)})}function Wu(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...F(t)})}function Gu(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...F(t)})}function Ku(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...F(t)})}function Ju(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...F(t)})}function Yu(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...F(t)})}function Xu(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...F(t)})}function Qu(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...F(t)})}function el(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...F(t)})}function tl(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...F(t)})}function Bh(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...F(t)})}function Hh(e,t){return new e({type:"string",format:"date",check:"string_format",...F(t)})}function Wh(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...F(t)})}function Gh(e,t){return new e({type:"string",format:"duration",check:"string_format",...F(t)})}function rl(e,t){return new e({type:"number",checks:[],...F(t)})}function nl(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...F(t)})}function ol(e,t){return new e({type:"boolean",...F(t)})}function sl(e,t){return new e({type:"null",...F(t)})}function il(e){return new e({type:"unknown"})}function al(e,t){return new e({type:"never",...F(t)})}function ci(e,t){return new qc({check:"less_than",...F(t),value:e,inclusive:!1})}function yo(e,t){return new qc({check:"less_than",...F(t),value:e,inclusive:!0})}function ui(e,t){return new Fc({check:"greater_than",...F(t),value:e,inclusive:!1})}function _o(e,t){return new Fc({check:"greater_than",...F(t),value:e,inclusive:!0})}function li(e,t){return new fh({check:"multiple_of",...F(t),value:e})}function di(e,t){return new hh({check:"max_length",...F(t),maximum:e})}function Tn(e,t){return new gh({check:"min_length",...F(t),minimum:e})}function pi(e,t){return new yh({check:"length_equals",...F(t),length:e})}function cl(e,t){return new _h({check:"string_format",format:"regex",...F(t),pattern:e})}function ul(e){return new vh({check:"string_format",format:"lowercase",...F(e)})}function ll(e){return new bh({check:"string_format",format:"uppercase",...F(e)})}function dl(e,t){return new $h({check:"string_format",format:"includes",...F(t),includes:e})}function pl(e,t){return new xh({check:"string_format",format:"starts_with",...F(t),prefix:e})}function fl(e,t){return new wh({check:"string_format",format:"ends_with",...F(t),suffix:e})}function Jr(e){return new kh({check:"overwrite",tx:e})}function ml(e){return Jr(t=>t.normalize(e))}function hl(){return Jr(e=>e.trim())}function gl(){return Jr(e=>e.toLowerCase())}function yl(){return Jr(e=>e.toUpperCase())}function Kh(e,t,r){return new e({type:"array",element:t,...F(r)})}function _l(e,t,r){let n=F(r);return n.abort??(n.abort=!0),new e({type:"custom",check:"custom",fn:t,...n})}function vl(e,t,r){return new e({type:"custom",check:"custom",fn:t,...F(r)})}var Jh=x(()=>{ei();Lt()});var Yh=x(()=>{});function bl(e,t){if(e instanceof go){let n=new fi(t),o={};for(let a of e._idmap.entries()){let[c,u]=a;n.process(u)}let s={},i={registry:e,uri:t?.uri,defs:o};for(let a of e._idmap.entries()){let[c,u]=a;s[c]=n.emit(u,{...t,external:i})}if(Object.keys(o).length>0){let a=n.target==="draft-2020-12"?"$defs":"definitions";s.__shared={[a]:o}}return{schemas:s}}let r=new fi(t);return r.process(e),r.emit(e,t)}function Pe(e,t){let r=t??{seen:new Set};if(r.seen.has(e))return!1;r.seen.add(e);let o=e._zod.def;switch(o.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":return!1;case"array":return Pe(o.element,r);case"object":{for(let s in o.shape)if(Pe(o.shape[s],r))return!0;return!1}case"union":{for(let s of o.options)if(Pe(s,r))return!0;return!1}case"intersection":return Pe(o.left,r)||Pe(o.right,r);case"tuple":{for(let s of o.items)if(Pe(s,r))return!0;return!!(o.rest&&Pe(o.rest,r))}case"record":return Pe(o.keyType,r)||Pe(o.valueType,r);case"map":return Pe(o.keyType,r)||Pe(o.valueType,r);case"set":return Pe(o.valueType,r);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":return Pe(o.innerType,r);case"lazy":return Pe(o.getter(),r);case"default":return Pe(o.innerType,r);case"prefault":return Pe(o.innerType,r);case"custom":return!1;case"transform":return!0;case"pipe":return Pe(o.in,r)||Pe(o.out,r);case"success":return!1;case"catch":return!1;default:}throw new Error(`Unknown schema type: ${o.type}`)}var fi,Xh=x(()=>{Ou();Lt();fi=class{constructor(t){this.counter=0,this.metadataRegistry=t?.metadata??pr,this.target=t?.target??"draft-2020-12",this.unrepresentable=t?.unrepresentable??"throw",this.override=t?.override??(()=>{}),this.io=t?.io??"output",this.seen=new Map}process(t,r={path:[],schemaPath:[]}){var n;let o=t._zod.def,s={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},i=this.seen.get(t);if(i)return i.count++,r.schemaPath.includes(t)&&(i.cycle=r.path),i.schema;let a={schema:{},count:1,cycle:void 0,path:r.path};this.seen.set(t,a);let c=t._zod.toJSONSchema?.();if(c)a.schema=c;else{let l={...r,schemaPath:[...r.schemaPath,t],path:r.path},m=t._zod.parent;if(m)a.ref=m,this.process(m,l),this.seen.get(m).isParent=!0;else{let h=a.schema;switch(o.type){case"string":{let p=h;p.type="string";let{minimum:f,maximum:g,format:y,patterns:v,contentEncoding:_}=t._zod.bag;if(typeof f=="number"&&(p.minLength=f),typeof g=="number"&&(p.maxLength=g),y&&(p.format=s[y]??y,p.format===""&&delete p.format),_&&(p.contentEncoding=_),v&&v.size>0){let w=[...v];w.length===1?p.pattern=w[0].source:w.length>1&&(a.schema.allOf=[...w.map(E=>({...this.target==="draft-7"?{type:"string"}:{},pattern:E.source}))])}break}case"number":{let p=h,{minimum:f,maximum:g,format:y,multipleOf:v,exclusiveMaximum:_,exclusiveMinimum:w}=t._zod.bag;typeof y=="string"&&y.includes("int")?p.type="integer":p.type="number",typeof w=="number"&&(p.exclusiveMinimum=w),typeof f=="number"&&(p.minimum=f,typeof w=="number"&&(w>=f?delete p.minimum:delete p.exclusiveMinimum)),typeof _=="number"&&(p.exclusiveMaximum=_),typeof g=="number"&&(p.maximum=g,typeof _=="number"&&(_<=g?delete p.maximum:delete p.exclusiveMaximum)),typeof v=="number"&&(p.multipleOf=v);break}case"boolean":{let p=h;p.type="boolean";break}case"bigint":{if(this.unrepresentable==="throw")throw new Error("BigInt cannot be represented in JSON Schema");break}case"symbol":{if(this.unrepresentable==="throw")throw new Error("Symbols cannot be represented in JSON Schema");break}case"null":{h.type="null";break}case"any":break;case"unknown":break;case"undefined":{if(this.unrepresentable==="throw")throw new Error("Undefined cannot be represented in JSON Schema");break}case"void":{if(this.unrepresentable==="throw")throw new Error("Void cannot be represented in JSON Schema");break}case"never":{h.not={};break}case"date":{if(this.unrepresentable==="throw")throw new Error("Date cannot be represented in JSON Schema");break}case"array":{let p=h,{minimum:f,maximum:g}=t._zod.bag;typeof f=="number"&&(p.minItems=f),typeof g=="number"&&(p.maxItems=g),p.type="array",p.items=this.process(o.element,{...l,path:[...l.path,"items"]});break}case"object":{let p=h;p.type="object",p.properties={};let f=o.shape;for(let v in f)p.properties[v]=this.process(f[v],{...l,path:[...l.path,"properties",v]});let g=new Set(Object.keys(f)),y=new Set([...g].filter(v=>{let _=o.shape[v]._zod;return this.io==="input"?_.optin===void 0:_.optout===void 0}));y.size>0&&(p.required=Array.from(y)),o.catchall?._zod.def.type==="never"?p.additionalProperties=!1:o.catchall?o.catchall&&(p.additionalProperties=this.process(o.catchall,{...l,path:[...l.path,"additionalProperties"]})):this.io==="output"&&(p.additionalProperties=!1);break}case"union":{let p=h;p.anyOf=o.options.map((f,g)=>this.process(f,{...l,path:[...l.path,"anyOf",g]}));break}case"intersection":{let p=h,f=this.process(o.left,{...l,path:[...l.path,"allOf",0]}),g=this.process(o.right,{...l,path:[...l.path,"allOf",1]}),y=_=>"allOf"in _&&Object.keys(_).length===1,v=[...y(f)?f.allOf:[f],...y(g)?g.allOf:[g]];p.allOf=v;break}case"tuple":{let p=h;p.type="array";let f=o.items.map((v,_)=>this.process(v,{...l,path:[...l.path,"prefixItems",_]}));if(this.target==="draft-2020-12"?p.prefixItems=f:p.items=f,o.rest){let v=this.process(o.rest,{...l,path:[...l.path,"items"]});this.target==="draft-2020-12"?p.items=v:p.additionalItems=v}o.rest&&(p.items=this.process(o.rest,{...l,path:[...l.path,"items"]}));let{minimum:g,maximum:y}=t._zod.bag;typeof g=="number"&&(p.minItems=g),typeof y=="number"&&(p.maxItems=y);break}case"record":{let p=h;p.type="object",p.propertyNames=this.process(o.keyType,{...l,path:[...l.path,"propertyNames"]}),p.additionalProperties=this.process(o.valueType,{...l,path:[...l.path,"additionalProperties"]});break}case"map":{if(this.unrepresentable==="throw")throw new Error("Map cannot be represented in JSON Schema");break}case"set":{if(this.unrepresentable==="throw")throw new Error("Set cannot be represented in JSON Schema");break}case"enum":{let p=h,f=ao(o.entries);f.every(g=>typeof g=="number")&&(p.type="number"),f.every(g=>typeof g=="string")&&(p.type="string"),p.enum=f;break}case"literal":{let p=h,f=[];for(let g of o.values)if(g===void 0){if(this.unrepresentable==="throw")throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof g=="bigint"){if(this.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");f.push(Number(g))}else f.push(g);if(f.length!==0)if(f.length===1){let g=f[0];p.type=g===null?"null":typeof g,p.const=g}else f.every(g=>typeof g=="number")&&(p.type="number"),f.every(g=>typeof g=="string")&&(p.type="string"),f.every(g=>typeof g=="boolean")&&(p.type="string"),f.every(g=>g===null)&&(p.type="null"),p.enum=f;break}case"file":{let p=h,f={type:"string",format:"binary",contentEncoding:"binary"},{minimum:g,maximum:y,mime:v}=t._zod.bag;g!==void 0&&(f.minLength=g),y!==void 0&&(f.maxLength=y),v?v.length===1?(f.contentMediaType=v[0],Object.assign(p,f)):p.anyOf=v.map(_=>({...f,contentMediaType:_})):Object.assign(p,f);break}case"transform":{if(this.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema");break}case"nullable":{let p=this.process(o.innerType,l);h.anyOf=[p,{type:"null"}];break}case"nonoptional":{this.process(o.innerType,l),a.ref=o.innerType;break}case"success":{let p=h;p.type="boolean";break}case"default":{this.process(o.innerType,l),a.ref=o.innerType,h.default=JSON.parse(JSON.stringify(o.defaultValue));break}case"prefault":{this.process(o.innerType,l),a.ref=o.innerType,this.io==="input"&&(h._prefault=JSON.parse(JSON.stringify(o.defaultValue)));break}case"catch":{this.process(o.innerType,l),a.ref=o.innerType;let p;try{p=o.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}h.default=p;break}case"nan":{if(this.unrepresentable==="throw")throw new Error("NaN cannot be represented in JSON Schema");break}case"template_literal":{let p=h,f=t._zod.pattern;if(!f)throw new Error("Pattern not found in template literal");p.type="string",p.pattern=f.source;break}case"pipe":{let p=this.io==="input"?o.in._zod.def.type==="transform"?o.out:o.in:o.out;this.process(p,l),a.ref=p;break}case"readonly":{this.process(o.innerType,l),a.ref=o.innerType,h.readOnly=!0;break}case"promise":{this.process(o.innerType,l),a.ref=o.innerType;break}case"optional":{this.process(o.innerType,l),a.ref=o.innerType;break}case"lazy":{let p=t._zod.innerType;this.process(p,l),a.ref=p;break}case"custom":{if(this.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema");break}default:}}}let u=this.metadataRegistry.get(t);return u&&Object.assign(a.schema,u),this.io==="input"&&Pe(t)&&(delete a.schema.examples,delete a.schema.default),this.io==="input"&&a.schema._prefault&&((n=a.schema).default??(n.default=a.schema._prefault)),delete a.schema._prefault,this.seen.get(t).schema}emit(t,r){let n={cycles:r?.cycles??"ref",reused:r?.reused??"inline",external:r?.external??void 0},o=this.seen.get(t);if(!o)throw new Error("Unprocessed schema. This is a bug in Zod.");let s=d=>{let l=this.target==="draft-2020-12"?"$defs":"definitions";if(n.external){let f=n.external.registry.get(d[0])?.id,g=n.external.uri??(v=>v);if(f)return{ref:g(f)};let y=d[1].defId??d[1].schema.id??`schema${this.counter++}`;return d[1].defId=y,{defId:y,ref:`${g("__shared")}#/${l}/${y}`}}if(d[1]===o)return{ref:"#"};let h=`#/${l}/`,p=d[1].schema.id??`__schema${this.counter++}`;return{defId:p,ref:h+p}},i=d=>{if(d[1].schema.$ref)return;let l=d[1],{ref:m,defId:h}=s(d);l.def={...l.schema},h&&(l.defId=h);let p=l.schema;for(let f in p)delete p[f];p.$ref=m};if(n.cycles==="throw")for(let d of this.seen.entries()){let l=d[1];if(l.cycle)throw new Error(`Cycle detected: #/${l.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(let d of this.seen.entries()){let l=d[1];if(t===d[0]){i(d);continue}if(n.external){let h=n.external.registry.get(d[0])?.id;if(t!==d[0]&&h){i(d);continue}}if(this.metadataRegistry.get(d[0])?.id){i(d);continue}if(l.cycle){i(d);continue}if(l.count>1&&n.reused==="ref"){i(d);continue}}let a=(d,l)=>{let m=this.seen.get(d),h=m.def??m.schema,p={...h};if(m.ref===null)return;let f=m.ref;if(m.ref=null,f){a(f,l);let g=this.seen.get(f).schema;g.$ref&&l.target==="draft-7"?(h.allOf=h.allOf??[],h.allOf.push(g)):(Object.assign(h,g),Object.assign(h,p))}m.isParent||this.override({zodSchema:d,jsonSchema:h,path:m.path??[]})};for(let d of[...this.seen.entries()].reverse())a(d[0],{target:this.target});let c={};if(this.target==="draft-2020-12"?c.$schema="https://json-schema.org/draft/2020-12/schema":this.target==="draft-7"?c.$schema="http://json-schema.org/draft-07/schema#":console.warn(`Invalid target: ${this.target}`),n.external?.uri){let d=n.external.registry.get(t)?.id;if(!d)throw new Error("Schema is missing an `id` property");c.$id=n.external.uri(d)}Object.assign(c,o.def);let u=n.external?.defs??{};for(let d of this.seen.entries()){let l=d[1];l.def&&l.defId&&(u[l.defId]=l.def)}n.external||Object.keys(u).length>0&&(this.target==="draft-2020-12"?c.$defs=u:c.definitions=u);try{return JSON.parse(JSON.stringify(c))}catch{throw new Error("Error converting schema to JSON.")}}}});var Qh=x(()=>{});var Be=x(()=>{wn();Zc();Rc();qh();ei();Vc();Lt();Qs();ii();Ou();Uc();Yh();Jh();Xh();Qh()});var $l=x(()=>{Be()});function xl(e,t){let r={type:"object",get shape(){return Q.assignProp(this,"shape",{...e}),this.shape},...Q.normalizeParams(t)};return new Rw(r)}var Iw,Rw,eg=x(()=>{Be();Be();$l();Iw=$("ZodMiniType",(e,t)=>{if(!e._zod)throw new Error("Uninitialized schema in ZodMiniType.");ue.init(e,t),e.def=t,e.parse=(r,n)=>Oc(e,r,n,{callee:e.parse}),e.safeParse=(r,n)=>Gr(e,r,n),e.parseAsync=async(r,n)=>Ac(e,r,n,{callee:e.parseAsync}),e.safeParseAsync=async(r,n)=>Kr(e,r,n),e.check=(...r)=>e.clone({...t,checks:[...t.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]}),e.clone=(r,n)=>ct(e,r,n),e.brand=()=>e,e.register=((r,n)=>(r.add(e,n),e))}),Rw=$("ZodMiniObject",(e,t)=>{oi.init(e,t),Iw.init(e,t),Q.defineLazy(e,"shape",()=>t.shape)})});var tg=x(()=>{});var rg=x(()=>{});var ng=x(()=>{});var og=x(()=>{Be();$l();eg();tg();Be();ii();rg();ng()});var sg=x(()=>{og()});var wl=x(()=>{sg()});function ht(e){return!!e._zod}function Xr(e){let t=Object.values(e);if(t.length===0)return xl({});let r=t.every(ht),n=t.every(o=>!ht(o));if(r)return xl(e);if(n)return _c(e);throw new Error("Mixed Zod versions detected in object shape.")}function fr(e,t){return ht(e)?Gr(e,t):e.safeParse(t)}async function mi(e,t){return ht(e)?await Kr(e,t):await e.safeParseAsync(t)}function mr(e){if(!e)return;let t;if(ht(e)?t=e._zod?.def?.shape:t=e.shape,!!t){if(typeof t=="function")try{return t()}catch{return}return t}}function En(e){if(e){if(typeof e=="object"){let t=e,r=e;if(!t._def&&!r._zod){let n=Object.values(e);if(n.length>0&&n.every(o=>typeof o=="object"&&o!==null&&(o._def!==void 0||o._zod!==void 0||typeof o.parse=="function")))return Xr(e)}}if(ht(e)){let r=e._zod?.def;if(r&&(r.type==="object"||r.shape!==void 0))return e}else if(e.shape!==void 0)return e}}function hi(e){if(e&&typeof e=="object"){if("message"in e&&typeof e.message=="string")return e.message;if("issues"in e&&Array.isArray(e.issues)&&e.issues.length>0){let t=e.issues[0];if(t&&typeof t=="object"&&"message"in t)return String(t.message)}try{return JSON.stringify(e)}catch{return String(e)}}return String(e)}function ag(e){return e.description}function cg(e){if(ht(e))return e._zod?.def?.type==="optional";let t=e;return typeof e.isOptional=="function"?e.isOptional():t._def?.typeName==="ZodOptional"}function gi(e){if(ht(e)){let s=e._zod?.def;if(s){if(s.value!==void 0)return s.value;if(Array.isArray(s.values)&&s.values.length>0)return s.values[0]}}let r=e._def;if(r){if(r.value!==void 0)return r.value;if(Array.isArray(r.values)&&r.values.length>0)return r.values[0]}let n=e.value;if(n!==void 0)return n}var vo=x(()=>{so();wl()});var kl=x(()=>{Be()});var bo={};ms(bo,{ZodISODate:()=>lg,ZodISODateTime:()=>ug,ZodISODuration:()=>pg,ZodISOTime:()=>dg,date:()=>Tl,datetime:()=>Sl,duration:()=>zl,time:()=>El});function Sl(e){return Bh(ug,e)}function Tl(e){return Hh(lg,e)}function El(e){return Wh(dg,e)}function zl(e){return Gh(pg,e)}var ug,lg,dg,pg,Pl=x(()=>{Be();Il();ug=$("ZodISODateTime",(e,t)=>{jh.init(e,t),ve.init(e,t)});lg=$("ZodISODate",(e,t)=>{Mh.init(e,t),ve.init(e,t)});dg=$("ZodISOTime",(e,t)=>{Zh.init(e,t),ve.init(e,t)});pg=$("ZodISODuration",(e,t)=>{Lh.init(e,t),ve.init(e,t)})});var fg,Q9,$o,Rl=x(()=>{Be();Be();fg=(e,t)=>{Ys.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:r=>Ic(e,r)},flatten:{value:r=>Pc(e,r)},addIssue:{value:r=>e.issues.push(r)},addIssues:{value:r=>e.issues.push(...r)},isEmpty:{get(){return e.issues.length===0}}})},Q9=$("ZodError",fg),$o=$("ZodError",fg,{Parent:Error})});var mg,hg,gg,yg,Cl=x(()=>{Be();Rl();mg=Cc($o),hg=Nc($o),gg=jc($o),yg=Mc($o)});function b(e){return Nu(qw,e)}function ae(e){return rl(xg,e)}function vg(e){return nl(sk,e)}function Ce(e){return ol(ik,e)}function Al(e){return sl(ak,e)}function be(){return il(ck)}function lk(e){return al(uk,e)}function te(e,t){return Kh(dk,e,t)}function N(e,t){let r={type:"object",get shape(){return Q.assignProp(this,"shape",{...e}),this.shape},...Q.normalizeParams(t)};return new wg(r)}function He(e,t){return new wg({type:"object",get shape(){return Q.assignProp(this,"shape",{...e}),this.shape},catchall:be(),...Q.normalizeParams(t)})}function he(e,t){return new kg({type:"union",options:e,...Q.normalizeParams(t)})}function jl(e,t,r){return new pk({type:"union",options:t,discriminator:e,...Q.normalizeParams(r)})}function _i(e,t){return new fk({type:"intersection",left:e,right:t})}function $e(e,t,r){return new mk({type:"record",keyType:e,valueType:t,...Q.normalizeParams(r)})}function tt(e,t){let r=Array.isArray(e)?Object.fromEntries(e.map(n=>[n,n])):e;return new Ol({type:"enum",entries:r,...Q.normalizeParams(t)})}function Z(e,t){return new hk({type:"literal",values:Array.isArray(e)?e:[e],...Q.normalizeParams(t)})}function Sg(e){return new gk({type:"transform",transform:e})}function ke(e){return new Tg({type:"optional",innerType:e})}function bg(e){return new yk({type:"nullable",innerType:e})}function vk(e,t){return new _k({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():t}})}function $k(e,t){return new bk({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():t}})}function xk(e,t){return new Eg({type:"nonoptional",innerType:e,...Q.normalizeParams(t)})}function kk(e,t){return new wk({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}function Nl(e,t){return new Sk({type:"pipe",in:e,out:t})}function Ek(e){return new Tk({type:"readonly",innerType:e})}function zk(e){let t=new Ne({check:"custom"});return t._zod.check=e,t}function Pg(e,t){return _l(zg,e??(()=>!0),t)}function Pk(e,t={}){return vl(zg,e,t)}function Ik(e){let t=zk(r=>(r.addIssue=n=>{if(typeof n=="string")r.issues.push(Q.issue(n,r.value,t._zod.def));else{let o=n;o.fatal&&(o.continue=!1),o.code??(o.code="custom"),o.input??(o.input=r.value),o.inst??(o.inst=t),o.continue??(o.continue=!t._zod.def.abort),r.issues.push(Q.issue(o))}},e(r.value,r)));return t}function Ml(e,t){return Nl(Sg(e),t)}var Se,$g,qw,ve,Fw,_g,yi,Uw,Vw,Bw,Hw,Ww,Gw,Kw,Jw,Yw,Xw,Qw,ek,tk,rk,nk,ok,xg,sk,ik,ak,ck,uk,dk,wg,kg,pk,fk,mk,Ol,hk,gk,Tg,yk,_k,bk,Eg,wk,Sk,Tk,zg,Il=x(()=>{Be();Be();kl();Pl();Cl();Se=$("ZodType",(e,t)=>(ue.init(e,t),e.def=t,Object.defineProperty(e,"_def",{value:t}),e.check=(...r)=>e.clone({...t,checks:[...t.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]}),e.clone=(r,n)=>ct(e,r,n),e.brand=()=>e,e.register=((r,n)=>(r.add(e,n),e)),e.parse=(r,n)=>mg(e,r,n,{callee:e.parse}),e.safeParse=(r,n)=>gg(e,r,n),e.parseAsync=async(r,n)=>hg(e,r,n,{callee:e.parseAsync}),e.safeParseAsync=async(r,n)=>yg(e,r,n),e.spa=e.safeParseAsync,e.refine=(r,n)=>e.check(Pk(r,n)),e.superRefine=r=>e.check(Ik(r)),e.overwrite=r=>e.check(Jr(r)),e.optional=()=>ke(e),e.nullable=()=>bg(e),e.nullish=()=>ke(bg(e)),e.nonoptional=r=>xk(e,r),e.array=()=>te(e),e.or=r=>he([e,r]),e.and=r=>_i(e,r),e.transform=r=>Nl(e,Sg(r)),e.default=r=>vk(e,r),e.prefault=r=>$k(e,r),e.catch=r=>kk(e,r),e.pipe=r=>Nl(e,r),e.readonly=()=>Ek(e),e.describe=r=>{let n=e.clone();return pr.add(n,{description:r}),n},Object.defineProperty(e,"description",{get(){return pr.get(e)?.description},configurable:!0}),e.meta=(...r)=>{if(r.length===0)return pr.get(e);let n=e.clone();return pr.add(n,r[0]),n},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),$g=$("_ZodString",(e,t)=>{ho.init(e,t),Se.init(e,t);let r=e._zod.bag;e.format=r.format??null,e.minLength=r.minimum??null,e.maxLength=r.maximum??null,e.regex=(...n)=>e.check(cl(...n)),e.includes=(...n)=>e.check(dl(...n)),e.startsWith=(...n)=>e.check(pl(...n)),e.endsWith=(...n)=>e.check(fl(...n)),e.min=(...n)=>e.check(Tn(...n)),e.max=(...n)=>e.check(di(...n)),e.length=(...n)=>e.check(pi(...n)),e.nonempty=(...n)=>e.check(Tn(1,...n)),e.lowercase=n=>e.check(ul(n)),e.uppercase=n=>e.check(ll(n)),e.trim=()=>e.check(hl()),e.normalize=(...n)=>e.check(ml(...n)),e.toLowerCase=()=>e.check(gl()),e.toUpperCase=()=>e.check(yl())}),qw=$("ZodString",(e,t)=>{ho.init(e,t),$g.init(e,t),e.email=r=>e.check(Au(Fw,r)),e.url=r=>e.check(Du(Uw,r)),e.jwt=r=>e.check(tl(ok,r)),e.emoji=r=>e.check(qu(Vw,r)),e.guid=r=>e.check(ai(_g,r)),e.uuid=r=>e.check(ju(yi,r)),e.uuidv4=r=>e.check(Mu(yi,r)),e.uuidv6=r=>e.check(Zu(yi,r)),e.uuidv7=r=>e.check(Lu(yi,r)),e.nanoid=r=>e.check(Fu(Bw,r)),e.guid=r=>e.check(ai(_g,r)),e.cuid=r=>e.check(Uu(Hw,r)),e.cuid2=r=>e.check(Vu(Ww,r)),e.ulid=r=>e.check(Bu(Gw,r)),e.base64=r=>e.check(Xu(tk,r)),e.base64url=r=>e.check(Qu(rk,r)),e.xid=r=>e.check(Hu(Kw,r)),e.ksuid=r=>e.check(Wu(Jw,r)),e.ipv4=r=>e.check(Gu(Yw,r)),e.ipv6=r=>e.check(Ku(Xw,r)),e.cidrv4=r=>e.check(Ju(Qw,r)),e.cidrv6=r=>e.check(Yu(ek,r)),e.e164=r=>e.check(el(nk,r)),e.datetime=r=>e.check(Sl(r)),e.date=r=>e.check(Tl(r)),e.time=r=>e.check(El(r)),e.duration=r=>e.check(zl(r))});ve=$("ZodStringFormat",(e,t)=>{me.init(e,t),$g.init(e,t)}),Fw=$("ZodEmail",(e,t)=>{Gc.init(e,t),ve.init(e,t)}),_g=$("ZodGUID",(e,t)=>{Hc.init(e,t),ve.init(e,t)}),yi=$("ZodUUID",(e,t)=>{Wc.init(e,t),ve.init(e,t)}),Uw=$("ZodURL",(e,t)=>{Kc.init(e,t),ve.init(e,t)}),Vw=$("ZodEmoji",(e,t)=>{Jc.init(e,t),ve.init(e,t)}),Bw=$("ZodNanoID",(e,t)=>{Yc.init(e,t),ve.init(e,t)}),Hw=$("ZodCUID",(e,t)=>{Xc.init(e,t),ve.init(e,t)}),Ww=$("ZodCUID2",(e,t)=>{Qc.init(e,t),ve.init(e,t)}),Gw=$("ZodULID",(e,t)=>{eu.init(e,t),ve.init(e,t)}),Kw=$("ZodXID",(e,t)=>{tu.init(e,t),ve.init(e,t)}),Jw=$("ZodKSUID",(e,t)=>{ru.init(e,t),ve.init(e,t)}),Yw=$("ZodIPv4",(e,t)=>{nu.init(e,t),ve.init(e,t)}),Xw=$("ZodIPv6",(e,t)=>{ou.init(e,t),ve.init(e,t)}),Qw=$("ZodCIDRv4",(e,t)=>{su.init(e,t),ve.init(e,t)}),ek=$("ZodCIDRv6",(e,t)=>{iu.init(e,t),ve.init(e,t)}),tk=$("ZodBase64",(e,t)=>{au.init(e,t),ve.init(e,t)}),rk=$("ZodBase64URL",(e,t)=>{cu.init(e,t),ve.init(e,t)}),nk=$("ZodE164",(e,t)=>{uu.init(e,t),ve.init(e,t)}),ok=$("ZodJWT",(e,t)=>{lu.init(e,t),ve.init(e,t)}),xg=$("ZodNumber",(e,t)=>{ni.init(e,t),Se.init(e,t),e.gt=(n,o)=>e.check(ui(n,o)),e.gte=(n,o)=>e.check(_o(n,o)),e.min=(n,o)=>e.check(_o(n,o)),e.lt=(n,o)=>e.check(ci(n,o)),e.lte=(n,o)=>e.check(yo(n,o)),e.max=(n,o)=>e.check(yo(n,o)),e.int=n=>e.check(vg(n)),e.safe=n=>e.check(vg(n)),e.positive=n=>e.check(ui(0,n)),e.nonnegative=n=>e.check(_o(0,n)),e.negative=n=>e.check(ci(0,n)),e.nonpositive=n=>e.check(yo(0,n)),e.multipleOf=(n,o)=>e.check(li(n,o)),e.step=(n,o)=>e.check(li(n,o)),e.finite=()=>e;let r=e._zod.bag;e.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),e.isFinite=!0,e.format=r.format??null});sk=$("ZodNumberFormat",(e,t)=>{du.init(e,t),xg.init(e,t)});ik=$("ZodBoolean",(e,t)=>{pu.init(e,t),Se.init(e,t)});ak=$("ZodNull",(e,t)=>{fu.init(e,t),Se.init(e,t)});ck=$("ZodUnknown",(e,t)=>{mu.init(e,t),Se.init(e,t)});uk=$("ZodNever",(e,t)=>{hu.init(e,t),Se.init(e,t)});dk=$("ZodArray",(e,t)=>{gu.init(e,t),Se.init(e,t),e.element=t.element,e.min=(r,n)=>e.check(Tn(r,n)),e.nonempty=r=>e.check(Tn(1,r)),e.max=(r,n)=>e.check(di(r,n)),e.length=(r,n)=>e.check(pi(r,n)),e.unwrap=()=>e.element});wg=$("ZodObject",(e,t)=>{oi.init(e,t),Se.init(e,t),Q.defineLazy(e,"shape",()=>t.shape),e.keyof=()=>tt(Object.keys(e._zod.def.shape)),e.catchall=r=>e.clone({...e._zod.def,catchall:r}),e.passthrough=()=>e.clone({...e._zod.def,catchall:be()}),e.loose=()=>e.clone({...e._zod.def,catchall:be()}),e.strict=()=>e.clone({...e._zod.def,catchall:lk()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=r=>Q.extend(e,r),e.merge=r=>Q.merge(e,r),e.pick=r=>Q.pick(e,r),e.omit=r=>Q.omit(e,r),e.partial=(...r)=>Q.partial(Tg,e,r[0]),e.required=(...r)=>Q.required(Eg,e,r[0])});kg=$("ZodUnion",(e,t)=>{si.init(e,t),Se.init(e,t),e.options=t.options});pk=$("ZodDiscriminatedUnion",(e,t)=>{kg.init(e,t),yu.init(e,t)});fk=$("ZodIntersection",(e,t)=>{_u.init(e,t),Se.init(e,t)});mk=$("ZodRecord",(e,t)=>{vu.init(e,t),Se.init(e,t),e.keyType=t.keyType,e.valueType=t.valueType});Ol=$("ZodEnum",(e,t)=>{bu.init(e,t),Se.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);let r=new Set(Object.keys(t.entries));e.extract=(n,o)=>{let s={};for(let i of n)if(r.has(i))s[i]=t.entries[i];else throw new Error(`Key ${i} not found in enum`);return new Ol({...t,checks:[],...Q.normalizeParams(o),entries:s})},e.exclude=(n,o)=>{let s={...t.entries};for(let i of n)if(r.has(i))delete s[i];else throw new Error(`Key ${i} not found in enum`);return new Ol({...t,checks:[],...Q.normalizeParams(o),entries:s})}});hk=$("ZodLiteral",(e,t)=>{$u.init(e,t),Se.init(e,t),e.values=new Set(t.values),Object.defineProperty(e,"value",{get(){if(t.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return t.values[0]}})});gk=$("ZodTransform",(e,t)=>{xu.init(e,t),Se.init(e,t),e._zod.parse=(r,n)=>{r.addIssue=s=>{if(typeof s=="string")r.issues.push(Q.issue(s,r.value,t));else{let i=s;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=r.value),i.inst??(i.inst=e),i.continue??(i.continue=!0),r.issues.push(Q.issue(i))}};let o=t.transform(r.value,r);return o instanceof Promise?o.then(s=>(r.value=s,r)):(r.value=o,r)}});Tg=$("ZodOptional",(e,t)=>{wu.init(e,t),Se.init(e,t),e.unwrap=()=>e._zod.def.innerType});yk=$("ZodNullable",(e,t)=>{ku.init(e,t),Se.init(e,t),e.unwrap=()=>e._zod.def.innerType});_k=$("ZodDefault",(e,t)=>{Su.init(e,t),Se.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});bk=$("ZodPrefault",(e,t)=>{Tu.init(e,t),Se.init(e,t),e.unwrap=()=>e._zod.def.innerType});Eg=$("ZodNonOptional",(e,t)=>{Eu.init(e,t),Se.init(e,t),e.unwrap=()=>e._zod.def.innerType});wk=$("ZodCatch",(e,t)=>{zu.init(e,t),Se.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});Sk=$("ZodPipe",(e,t)=>{Pu.init(e,t),Se.init(e,t),e.in=t.in,e.out=t.out});Tk=$("ZodReadonly",(e,t)=>{Iu.init(e,t),Se.init(e,t)});zg=$("ZodCustom",(e,t)=>{Ru.init(e,t),Se.init(e,t)})});var Ig=x(()=>{});var Rg=x(()=>{});var Cg=x(()=>{Be();Il();kl();Rl();Cl();Ig();Be();Uh();ii();Pl();Rg();at(Fh())});var Og=x(()=>{Cg()});var Ng=x(()=>{Og()});function Yg(e){if(e.params.ref.type!=="ref/prompt")throw new TypeError(`Expected CompleteRequestPrompt, but got ${e.params.ref.type}`)}function Xg(e){if(e.params.ref.type!=="ref/resource")throw new TypeError(`Expected CompleteRequestResourceTemplate, but got ${e.params.ref.type}`)}var Ll,Ag,hr,bi,Ae,jg,Mg,hC,Ok,Nk,Dl,ut,xo,Zg,je,gt,yt,Me,$i,Lg,ql,Dg,qg,Fl,wo,D,Ul,Fg,Ug,gC,xi,Ak,wi,jk,ko,zn,Vg,Mk,Zk,Lk,Dk,qk,Fk,Vl,Uk,Vk,Bl,ki,Bk,Hk,Si,Wk,So,To,Gk,Eo,Pn,Kk,zo,Ti,Ei,zi,yC,Pi,Ii,Ri,Bg,Hg,Wg,Hl,Gg,Po,In,Kg,Jk,Ci,Yk,Oi,Xk,Wl,Qk,Ni,e1,t1,r1,n1,o1,s1,i1,a1,c1,u1,Ai,l1,d1,ji,Gl,Kl,Jl,p1,f1,m1,Yl,h1,g1,y1,_1,v1,Jg,Mi,b1,Zi,_C,$1,Rn,x1,vC,Io,w1,Xl,k1,S1,T1,E1,z1,P1,I1,vi,R1,C1,O1,Ql,ed,N1,A1,j1,M1,Z1,L1,D1,q1,F1,U1,V1,B1,H1,W1,G1,K1,J1,Y1,Li,X1,Q1,eS,Di,tS,rS,nS,td,oS,bC,$C,xC,wC,kC,SC,M,Zl,Ro=x(()=>{Ng();Ll="2025-11-25",Ag=[Ll,"2025-06-18","2025-03-26","2024-11-05","2024-10-07"],hr="io.modelcontextprotocol/related-task",bi="2.0",Ae=Pg(e=>e!==null&&(typeof e=="object"||typeof e=="function")),jg=he([b(),ae().int()]),Mg=b(),hC=He({ttl:he([ae(),Al()]).optional(),pollInterval:ae().optional()}),Ok=N({ttl:ae().optional()}),Nk=N({taskId:b()}),Dl=He({progressToken:jg.optional(),[hr]:Nk.optional()}),ut=N({_meta:Dl.optional()}),xo=ut.extend({task:Ok.optional()}),Zg=e=>xo.safeParse(e).success,je=N({method:b(),params:ut.loose().optional()}),gt=N({_meta:Dl.optional()}),yt=N({method:b(),params:gt.loose().optional()}),Me=He({_meta:Dl.optional()}),$i=he([b(),ae().int()]),Lg=N({jsonrpc:Z(bi),id:$i,...je.shape}).strict(),ql=e=>Lg.safeParse(e).success,Dg=N({jsonrpc:Z(bi),...yt.shape}).strict(),qg=e=>Dg.safeParse(e).success,Fl=N({jsonrpc:Z(bi),id:$i,result:Me}).strict(),wo=e=>Fl.safeParse(e).success;(function(e){e[e.ConnectionClosed=-32e3]="ConnectionClosed",e[e.RequestTimeout=-32001]="RequestTimeout",e[e.ParseError=-32700]="ParseError",e[e.InvalidRequest=-32600]="InvalidRequest",e[e.MethodNotFound=-32601]="MethodNotFound",e[e.InvalidParams=-32602]="InvalidParams",e[e.InternalError=-32603]="InternalError",e[e.UrlElicitationRequired=-32042]="UrlElicitationRequired"})(D||(D={}));Ul=N({jsonrpc:Z(bi),id:$i.optional(),error:N({code:ae().int(),message:b(),data:be().optional()})}).strict(),Fg=e=>Ul.safeParse(e).success,Ug=he([Lg,Dg,Fl,Ul]),gC=he([Fl,Ul]),xi=Me.strict(),Ak=gt.extend({requestId:$i.optional(),reason:b().optional()}),wi=yt.extend({method:Z("notifications/cancelled"),params:Ak}),jk=N({src:b(),mimeType:b().optional(),sizes:te(b()).optional(),theme:tt(["light","dark"]).optional()}),ko=N({icons:te(jk).optional()}),zn=N({name:b(),title:b().optional()}),Vg=zn.extend({...zn.shape,...ko.shape,version:b(),websiteUrl:b().optional(),description:b().optional()}),Mk=_i(N({applyDefaults:Ce().optional()}),$e(b(),be())),Zk=Ml(e=>e&&typeof e=="object"&&!Array.isArray(e)&&Object.keys(e).length===0?{form:{}}:e,_i(N({form:Mk.optional(),url:Ae.optional()}),$e(b(),be()).optional())),Lk=He({list:Ae.optional(),cancel:Ae.optional(),requests:He({sampling:He({createMessage:Ae.optional()}).optional(),elicitation:He({create:Ae.optional()}).optional()}).optional()}),Dk=He({list:Ae.optional(),cancel:Ae.optional(),requests:He({tools:He({call:Ae.optional()}).optional()}).optional()}),qk=N({experimental:$e(b(),Ae).optional(),sampling:N({context:Ae.optional(),tools:Ae.optional()}).optional(),elicitation:Zk.optional(),roots:N({listChanged:Ce().optional()}).optional(),tasks:Lk.optional()}),Fk=ut.extend({protocolVersion:b(),capabilities:qk,clientInfo:Vg}),Vl=je.extend({method:Z("initialize"),params:Fk}),Uk=N({experimental:$e(b(),Ae).optional(),logging:Ae.optional(),completions:Ae.optional(),prompts:N({listChanged:Ce().optional()}).optional(),resources:N({subscribe:Ce().optional(),listChanged:Ce().optional()}).optional(),tools:N({listChanged:Ce().optional()}).optional(),tasks:Dk.optional()}),Vk=Me.extend({protocolVersion:b(),capabilities:Uk,serverInfo:Vg,instructions:b().optional()}),Bl=yt.extend({method:Z("notifications/initialized"),params:gt.optional()}),ki=je.extend({method:Z("ping"),params:ut.optional()}),Bk=N({progress:ae(),total:ke(ae()),message:ke(b())}),Hk=N({...gt.shape,...Bk.shape,progressToken:jg}),Si=yt.extend({method:Z("notifications/progress"),params:Hk}),Wk=ut.extend({cursor:Mg.optional()}),So=je.extend({params:Wk.optional()}),To=Me.extend({nextCursor:Mg.optional()}),Gk=tt(["working","input_required","completed","failed","cancelled"]),Eo=N({taskId:b(),status:Gk,ttl:he([ae(),Al()]),createdAt:b(),lastUpdatedAt:b(),pollInterval:ke(ae()),statusMessage:ke(b())}),Pn=Me.extend({task:Eo}),Kk=gt.merge(Eo),zo=yt.extend({method:Z("notifications/tasks/status"),params:Kk}),Ti=je.extend({method:Z("tasks/get"),params:ut.extend({taskId:b()})}),Ei=Me.merge(Eo),zi=je.extend({method:Z("tasks/result"),params:ut.extend({taskId:b()})}),yC=Me.loose(),Pi=So.extend({method:Z("tasks/list")}),Ii=To.extend({tasks:te(Eo)}),Ri=je.extend({method:Z("tasks/cancel"),params:ut.extend({taskId:b()})}),Bg=Me.merge(Eo),Hg=N({uri:b(),mimeType:ke(b()),_meta:$e(b(),be()).optional()}),Wg=Hg.extend({text:b()}),Hl=b().refine(e=>{try{return atob(e),!0}catch{return!1}},{message:"Invalid Base64 string"}),Gg=Hg.extend({blob:Hl}),Po=tt(["user","assistant"]),In=N({audience:te(Po).optional(),priority:ae().min(0).max(1).optional(),lastModified:bo.datetime({offset:!0}).optional()}),Kg=N({...zn.shape,...ko.shape,uri:b(),description:ke(b()),mimeType:ke(b()),annotations:In.optional(),_meta:ke(He({}))}),Jk=N({...zn.shape,...ko.shape,uriTemplate:b(),description:ke(b()),mimeType:ke(b()),annotations:In.optional(),_meta:ke(He({}))}),Ci=So.extend({method:Z("resources/list")}),Yk=To.extend({resources:te(Kg)}),Oi=So.extend({method:Z("resources/templates/list")}),Xk=To.extend({resourceTemplates:te(Jk)}),Wl=ut.extend({uri:b()}),Qk=Wl,Ni=je.extend({method:Z("resources/read"),params:Qk}),e1=Me.extend({contents:te(he([Wg,Gg]))}),t1=yt.extend({method:Z("notifications/resources/list_changed"),params:gt.optional()}),r1=Wl,n1=je.extend({method:Z("resources/subscribe"),params:r1}),o1=Wl,s1=je.extend({method:Z("resources/unsubscribe"),params:o1}),i1=gt.extend({uri:b()}),a1=yt.extend({method:Z("notifications/resources/updated"),params:i1}),c1=N({name:b(),description:ke(b()),required:ke(Ce())}),u1=N({...zn.shape,...ko.shape,description:ke(b()),arguments:ke(te(c1)),_meta:ke(He({}))}),Ai=So.extend({method:Z("prompts/list")}),l1=To.extend({prompts:te(u1)}),d1=ut.extend({name:b(),arguments:$e(b(),b()).optional()}),ji=je.extend({method:Z("prompts/get"),params:d1}),Gl=N({type:Z("text"),text:b(),annotations:In.optional(),_meta:$e(b(),be()).optional()}),Kl=N({type:Z("image"),data:Hl,mimeType:b(),annotations:In.optional(),_meta:$e(b(),be()).optional()}),Jl=N({type:Z("audio"),data:Hl,mimeType:b(),annotations:In.optional(),_meta:$e(b(),be()).optional()}),p1=N({type:Z("tool_use"),name:b(),id:b(),input:$e(b(),be()),_meta:$e(b(),be()).optional()}),f1=N({type:Z("resource"),resource:he([Wg,Gg]),annotations:In.optional(),_meta:$e(b(),be()).optional()}),m1=Kg.extend({type:Z("resource_link")}),Yl=he([Gl,Kl,Jl,m1,f1]),h1=N({role:Po,content:Yl}),g1=Me.extend({description:b().optional(),messages:te(h1)}),y1=yt.extend({method:Z("notifications/prompts/list_changed"),params:gt.optional()}),_1=N({title:b().optional(),readOnlyHint:Ce().optional(),destructiveHint:Ce().optional(),idempotentHint:Ce().optional(),openWorldHint:Ce().optional()}),v1=N({taskSupport:tt(["required","optional","forbidden"]).optional()}),Jg=N({...zn.shape,...ko.shape,description:b().optional(),inputSchema:N({type:Z("object"),properties:$e(b(),Ae).optional(),required:te(b()).optional()}).catchall(be()),outputSchema:N({type:Z("object"),properties:$e(b(),Ae).optional(),required:te(b()).optional()}).catchall(be()).optional(),annotations:_1.optional(),execution:v1.optional(),_meta:$e(b(),be()).optional()}),Mi=So.extend({method:Z("tools/list")}),b1=To.extend({tools:te(Jg)}),Zi=Me.extend({content:te(Yl).default([]),structuredContent:$e(b(),be()).optional(),isError:Ce().optional()}),_C=Zi.or(Me.extend({toolResult:be()})),$1=xo.extend({name:b(),arguments:$e(b(),be()).optional()}),Rn=je.extend({method:Z("tools/call"),params:$1}),x1=yt.extend({method:Z("notifications/tools/list_changed"),params:gt.optional()}),vC=N({autoRefresh:Ce().default(!0),debounceMs:ae().int().nonnegative().default(300)}),Io=tt(["debug","info","notice","warning","error","critical","alert","emergency"]),w1=ut.extend({level:Io}),Xl=je.extend({method:Z("logging/setLevel"),params:w1}),k1=gt.extend({level:Io,logger:b().optional(),data:be()}),S1=yt.extend({method:Z("notifications/message"),params:k1}),T1=N({name:b().optional()}),E1=N({hints:te(T1).optional(),costPriority:ae().min(0).max(1).optional(),speedPriority:ae().min(0).max(1).optional(),intelligencePriority:ae().min(0).max(1).optional()}),z1=N({mode:tt(["auto","required","none"]).optional()}),P1=N({type:Z("tool_result"),toolUseId:b().describe("The unique identifier for the corresponding tool call."),content:te(Yl).default([]),structuredContent:N({}).loose().optional(),isError:Ce().optional(),_meta:$e(b(),be()).optional()}),I1=jl("type",[Gl,Kl,Jl]),vi=jl("type",[Gl,Kl,Jl,p1,P1]),R1=N({role:Po,content:he([vi,te(vi)]),_meta:$e(b(),be()).optional()}),C1=xo.extend({messages:te(R1),modelPreferences:E1.optional(),systemPrompt:b().optional(),includeContext:tt(["none","thisServer","allServers"]).optional(),temperature:ae().optional(),maxTokens:ae().int(),stopSequences:te(b()).optional(),metadata:Ae.optional(),tools:te(Jg).optional(),toolChoice:z1.optional()}),O1=je.extend({method:Z("sampling/createMessage"),params:C1}),Ql=Me.extend({model:b(),stopReason:ke(tt(["endTurn","stopSequence","maxTokens"]).or(b())),role:Po,content:I1}),ed=Me.extend({model:b(),stopReason:ke(tt(["endTurn","stopSequence","maxTokens","toolUse"]).or(b())),role:Po,content:he([vi,te(vi)])}),N1=N({type:Z("boolean"),title:b().optional(),description:b().optional(),default:Ce().optional()}),A1=N({type:Z("string"),title:b().optional(),description:b().optional(),minLength:ae().optional(),maxLength:ae().optional(),format:tt(["email","uri","date","date-time"]).optional(),default:b().optional()}),j1=N({type:tt(["number","integer"]),title:b().optional(),description:b().optional(),minimum:ae().optional(),maximum:ae().optional(),default:ae().optional()}),M1=N({type:Z("string"),title:b().optional(),description:b().optional(),enum:te(b()),default:b().optional()}),Z1=N({type:Z("string"),title:b().optional(),description:b().optional(),oneOf:te(N({const:b(),title:b()})),default:b().optional()}),L1=N({type:Z("string"),title:b().optional(),description:b().optional(),enum:te(b()),enumNames:te(b()).optional(),default:b().optional()}),D1=he([M1,Z1]),q1=N({type:Z("array"),title:b().optional(),description:b().optional(),minItems:ae().optional(),maxItems:ae().optional(),items:N({type:Z("string"),enum:te(b())}),default:te(b()).optional()}),F1=N({type:Z("array"),title:b().optional(),description:b().optional(),minItems:ae().optional(),maxItems:ae().optional(),items:N({anyOf:te(N({const:b(),title:b()}))}),default:te(b()).optional()}),U1=he([q1,F1]),V1=he([L1,D1,U1]),B1=he([V1,N1,A1,j1]),H1=xo.extend({mode:Z("form").optional(),message:b(),requestedSchema:N({type:Z("object"),properties:$e(b(),B1),required:te(b()).optional()})}),W1=xo.extend({mode:Z("url"),message:b(),elicitationId:b(),url:b().url()}),G1=he([H1,W1]),K1=je.extend({method:Z("elicitation/create"),params:G1}),J1=gt.extend({elicitationId:b()}),Y1=yt.extend({method:Z("notifications/elicitation/complete"),params:J1}),Li=Me.extend({action:tt(["accept","decline","cancel"]),content:Ml(e=>e===null?void 0:e,$e(b(),he([b(),ae(),Ce(),te(b())])).optional())}),X1=N({type:Z("ref/resource"),uri:b()}),Q1=N({type:Z("ref/prompt"),name:b()}),eS=ut.extend({ref:he([Q1,X1]),argument:N({name:b(),value:b()}),context:N({arguments:$e(b(),b()).optional()}).optional()}),Di=je.extend({method:Z("completion/complete"),params:eS});tS=Me.extend({completion:He({values:te(b()).max(100),total:ke(ae().int()),hasMore:ke(Ce())})}),rS=N({uri:b().startsWith("file://"),name:b().optional(),_meta:$e(b(),be()).optional()}),nS=je.extend({method:Z("roots/list"),params:ut.optional()}),td=Me.extend({roots:te(rS)}),oS=yt.extend({method:Z("notifications/roots/list_changed"),params:gt.optional()}),bC=he([ki,Vl,Di,Xl,ji,Ai,Ci,Oi,Ni,n1,s1,Rn,Mi,Ti,zi,Pi,Ri]),$C=he([wi,Si,Bl,oS,zo]),xC=he([xi,Ql,ed,Li,td,Ei,Ii,Pn]),wC=he([ki,O1,K1,nS,Ti,zi,Pi,Ri]),kC=he([wi,Si,S1,a1,t1,x1,y1,zo,Y1]),SC=he([xi,Vk,tS,g1,l1,Yk,Xk,e1,Zi,b1,Ei,Ii,Pn]),M=class e extends Error{constructor(t,r,n){super(`MCP error ${t}: ${r}`),this.code=t,this.data=n,this.name="McpError"}static fromError(t,r,n){if(t===D.UrlElicitationRequired&&n){let o=n;if(o.elicitations)return new Zl(o.elicitations,r)}return new e(t,r,n)}},Zl=class extends M{constructor(t,r=`URL elicitation${t.length>1?"s":""} required`){super(D.UrlElicitationRequired,r,{elicitations:t})}get elicitations(){return this.data?.elicitations??[]}}});function gr(e){return e==="completed"||e==="failed"||e==="cancelled"}var Qg=x(()=>{});var ty,ey,ry,qi=x(()=>{ty=Symbol("Let zodToJsonSchema decide on which parser to use"),ey={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},ry=e=>typeof e=="string"?{...ey,name:e}:{...ey,...e}});var ny,rd=x(()=>{qi();ny=e=>{let t=ry(e),r=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,flags:{hasReferencedOpenAiAnyType:!1},currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([n,o])=>[o._def,{def:o._def,path:[...t.basePath,t.definitionPath,n],jsonSchema:void 0}]))}}});function nd(e,t,r,n){n?.errorMessages&&r&&(e.errorMessage={...e.errorMessage,[t]:r})}function re(e,t,r,n,o){e[t]=r,nd(e,t,n,o)}var yr=x(()=>{});var Fi,Ui=x(()=>{Fi=(e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return[(e.length-r).toString(),...t.slice(r)].join("/")}});function xe(e){if(e.target!=="openAi")return{};let t=[...e.basePath,e.definitionPath,e.openAiAnyTypeName];return e.flags.hasReferencedOpenAiAnyType=!0,{$ref:e.$refStrategy==="relative"?Fi(t,e.currentPath):t.join("/")}}var _t=x(()=>{Ui()});function oy(e,t){let r={type:"array"};return e.type?._def&&e.type?._def?.typeName!==S.ZodAny&&(r.items=U(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&re(r,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&re(r,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(re(r,"minItems",e.exactLength.value,e.exactLength.message,t),re(r,"maxItems",e.exactLength.value,e.exactLength.message,t)),r}var od=x(()=>{so();yr();Ee()});function sy(e,t){let r={type:"integer",format:"int64"};if(!e.checks)return r;for(let n of e.checks)switch(n.kind){case"min":t.target==="jsonSchema7"?n.inclusive?re(r,"minimum",n.value,n.message,t):re(r,"exclusiveMinimum",n.value,n.message,t):(n.inclusive||(r.exclusiveMinimum=!0),re(r,"minimum",n.value,n.message,t));break;case"max":t.target==="jsonSchema7"?n.inclusive?re(r,"maximum",n.value,n.message,t):re(r,"exclusiveMaximum",n.value,n.message,t):(n.inclusive||(r.exclusiveMaximum=!0),re(r,"maximum",n.value,n.message,t));break;case"multipleOf":re(r,"multipleOf",n.value,n.message,t);break}return r}var sd=x(()=>{yr()});function iy(){return{type:"boolean"}}var id=x(()=>{});function Vi(e,t){return U(e.type._def,t)}var Bi=x(()=>{Ee()});var ay,ad=x(()=>{Ee();ay=(e,t)=>U(e.innerType._def,t)});function cd(e,t,r){let n=r??t.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((o,s)=>cd(e,t,o))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return sS(e,t)}}var sS,ud=x(()=>{yr();sS=(e,t)=>{let r={type:"integer",format:"unix-time"};if(t.target==="openApi3")return r;for(let n of e.checks)switch(n.kind){case"min":re(r,"minimum",n.value,n.message,t);break;case"max":re(r,"maximum",n.value,n.message,t);break}return r}});function cy(e,t){return{...U(e.innerType._def,t),default:e.defaultValue()}}var ld=x(()=>{Ee()});function uy(e,t){return t.effectStrategy==="input"?U(e.schema._def,t):xe(t)}var dd=x(()=>{Ee();_t()});function ly(e){return{type:"string",enum:Array.from(e.values)}}var pd=x(()=>{});function dy(e,t){let r=[U(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),U(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(s=>!!s),n=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0,o=[];return r.forEach(s=>{if(iS(s))o.push(...s.allOf),s.unevaluatedProperties===void 0&&(n=void 0);else{let i=s;if("additionalProperties"in s&&s.additionalProperties===!1){let{additionalProperties:a,...c}=s;i=c}else n=void 0;o.push(i)}}),o.length?{allOf:o,...n}:void 0}var iS,fd=x(()=>{Ee();iS=e=>"type"in e&&e.type==="string"?!1:"allOf"in e});function py(e,t){let r=typeof e.value;return r!=="bigint"&&r!=="number"&&r!=="boolean"&&r!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:r==="bigint"?"integer":r,enum:[e.value]}:{type:r==="bigint"?"integer":r,const:e.value}}var md=x(()=>{});function Hi(e,t){let r={type:"string"};if(e.checks)for(let n of e.checks)switch(n.kind){case"min":re(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,n.value):n.value,n.message,t);break;case"max":re(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,n.value):n.value,n.message,t);break;case"email":switch(t.emailStrategy){case"format:email":Tt(r,"email",n.message,t);break;case"format:idn-email":Tt(r,"idn-email",n.message,t);break;case"pattern:zod":We(r,St.email,n.message,t);break}break;case"url":Tt(r,"uri",n.message,t);break;case"uuid":Tt(r,"uuid",n.message,t);break;case"regex":We(r,n.regex,n.message,t);break;case"cuid":We(r,St.cuid,n.message,t);break;case"cuid2":We(r,St.cuid2,n.message,t);break;case"startsWith":We(r,RegExp(`^${gd(n.value,t)}`),n.message,t);break;case"endsWith":We(r,RegExp(`${gd(n.value,t)}$`),n.message,t);break;case"datetime":Tt(r,"date-time",n.message,t);break;case"date":Tt(r,"date",n.message,t);break;case"time":Tt(r,"time",n.message,t);break;case"duration":Tt(r,"duration",n.message,t);break;case"length":re(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,n.value):n.value,n.message,t),re(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,n.value):n.value,n.message,t);break;case"includes":{We(r,RegExp(gd(n.value,t)),n.message,t);break}case"ip":{n.version!=="v6"&&Tt(r,"ipv4",n.message,t),n.version!=="v4"&&Tt(r,"ipv6",n.message,t);break}case"base64url":We(r,St.base64url,n.message,t);break;case"jwt":We(r,St.jwt,n.message,t);break;case"cidr":{n.version!=="v6"&&We(r,St.ipv4Cidr,n.message,t),n.version!=="v4"&&We(r,St.ipv6Cidr,n.message,t);break}case"emoji":We(r,St.emoji(),n.message,t);break;case"ulid":{We(r,St.ulid,n.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{Tt(r,"binary",n.message,t);break}case"contentEncoding:base64":{re(r,"contentEncoding","base64",n.message,t);break}case"pattern:zod":{We(r,St.base64,n.message,t);break}}break}case"nanoid":We(r,St.nanoid,n.message,t);case"toLowerCase":case"toUpperCase":case"trim":break;default:}return r}function gd(e,t){return t.patternStrategy==="escape"?cS(e):e}function cS(e){let t="";for(let r=0;r<e.length;r++)aS.has(e[r])||(t+="\\"),t+=e[r];return t}function Tt(e,t,r,n){e.format||e.anyOf?.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&n.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...r&&n.errorMessages&&{errorMessage:{format:r}}})):re(e,"format",t,r,n)}function We(e,t,r,n){e.pattern||e.allOf?.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&n.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:fy(t,n),...r&&n.errorMessages&&{errorMessage:{pattern:r}}})):re(e,"pattern",fy(t,n),r,n)}function fy(e,t){if(!t.applyRegexFlags||!e.flags)return e.source;let r={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},n=r.i?e.source.toLowerCase():e.source,o="",s=!1,i=!1,a=!1;for(let c=0;c<n.length;c++){if(s){o+=n[c],s=!1;continue}if(r.i){if(i){if(n[c].match(/[a-z]/)){a?(o+=n[c],o+=`${n[c-2]}-${n[c]}`.toUpperCase(),a=!1):n[c+1]==="-"&&n[c+2]?.match(/[a-z]/)?(o+=n[c],a=!0):o+=`${n[c]}${n[c].toUpperCase()}`;continue}}else if(n[c].match(/[a-z]/)){o+=`[${n[c]}${n[c].toUpperCase()}]`;continue}}if(r.m){if(n[c]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(n[c]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&n[c]==="."){o+=i?`${n[c]}\r
`:`[${n[c]}\r
]`;continue}o+=n[c],n[c]==="\\"?s=!0:i&&n[c]==="]"?i=!1:!i&&n[c]==="["&&(i=!0)}try{new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return o}var hd,St,aS,Wi=x(()=>{yr();St={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(hd===void 0&&(hd=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),hd),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};aS=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789")});function Gi(e,t){if(t.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),t.target==="openApi3"&&e.keyType?._def.typeName===S.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((n,o)=>({...n,[o]:U(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",o]})??xe(t)}),{}),additionalProperties:t.rejectedAdditionalProperties};let r={type:"object",additionalProperties:U(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??t.allowedAdditionalProperties};if(t.target==="openApi3")return r;if(e.keyType?._def.typeName===S.ZodString&&e.keyType._def.checks?.length){let{type:n,...o}=Hi(e.keyType._def,t);return{...r,propertyNames:o}}else{if(e.keyType?._def.typeName===S.ZodEnum)return{...r,propertyNames:{enum:e.keyType._def.values}};if(e.keyType?._def.typeName===S.ZodBranded&&e.keyType._def.type._def.typeName===S.ZodString&&e.keyType._def.type._def.checks?.length){let{type:n,...o}=Vi(e.keyType._def,t);return{...r,propertyNames:o}}}return r}var Ki=x(()=>{so();Ee();Wi();Bi();_t()});function my(e,t){if(t.mapStrategy==="record")return Gi(e,t);let r=U(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||xe(t),n=U(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||xe(t);return{type:"array",maxItems:125,items:{type:"array",items:[r,n],minItems:2,maxItems:2}}}var yd=x(()=>{Ee();Ki();_t()});function hy(e){let t=e.values,n=Object.keys(e.values).filter(s=>typeof t[t[s]]!="number").map(s=>t[s]),o=Array.from(new Set(n.map(s=>typeof s)));return{type:o.length===1?o[0]==="string"?"string":"number":["string","number"],enum:n}}var _d=x(()=>{});function gy(e){return e.target==="openAi"?void 0:{not:xe({...e,currentPath:[...e.currentPath,"not"]})}}var vd=x(()=>{_t()});function yy(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}var bd=x(()=>{});function vy(e,t){if(t.target==="openApi3")return _y(e,t);let r=e.options instanceof Map?Array.from(e.options.values()):e.options;if(r.every(n=>n._def.typeName in Co&&(!n._def.checks||!n._def.checks.length))){let n=r.reduce((o,s)=>{let i=Co[s._def.typeName];return i&&!o.includes(i)?[...o,i]:o},[]);return{type:n.length>1?n:n[0]}}else if(r.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){let n=r.reduce((o,s)=>{let i=typeof s._def.value;switch(i){case"string":case"number":case"boolean":return[...o,i];case"bigint":return[...o,"integer"];case"object":if(s._def.value===null)return[...o,"null"];default:return o}},[]);if(n.length===r.length){let o=n.filter((s,i,a)=>a.indexOf(s)===i);return{type:o.length>1?o:o[0],enum:r.reduce((s,i)=>s.includes(i._def.value)?s:[...s,i._def.value],[])}}}else if(r.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:r.reduce((n,o)=>[...n,...o._def.values.filter(s=>!n.includes(s))],[])};return _y(e,t)}var Co,_y,Ji=x(()=>{Ee();Co={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};_y=(e,t)=>{let r=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((n,o)=>U(n._def,{...t,currentPath:[...t.currentPath,"anyOf",`${o}`]})).filter(n=>!!n&&(!t.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return r.length?{anyOf:r}:void 0}});function by(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:Co[e.innerType._def.typeName],nullable:!0}:{type:[Co[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){let n=U(e.innerType._def,{...t,currentPath:[...t.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}let r=U(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}var $d=x(()=>{Ee();Ji()});function $y(e,t){let r={type:"number"};if(!e.checks)return r;for(let n of e.checks)switch(n.kind){case"int":r.type="integer",nd(r,"type",n.message,t);break;case"min":t.target==="jsonSchema7"?n.inclusive?re(r,"minimum",n.value,n.message,t):re(r,"exclusiveMinimum",n.value,n.message,t):(n.inclusive||(r.exclusiveMinimum=!0),re(r,"minimum",n.value,n.message,t));break;case"max":t.target==="jsonSchema7"?n.inclusive?re(r,"maximum",n.value,n.message,t):re(r,"exclusiveMaximum",n.value,n.message,t):(n.inclusive||(r.exclusiveMaximum=!0),re(r,"maximum",n.value,n.message,t));break;case"multipleOf":re(r,"multipleOf",n.value,n.message,t);break}return r}var xd=x(()=>{yr()});function xy(e,t){let r=t.target==="openAi",n={type:"object",properties:{}},o=[],s=e.shape();for(let a in s){let c=s[a];if(c===void 0||c._def===void 0)continue;let u=lS(c);u&&r&&(c._def.typeName==="ZodOptional"&&(c=c._def.innerType),c.isNullable()||(c=c.nullable()),u=!1);let d=U(c._def,{...t,currentPath:[...t.currentPath,"properties",a],propertyPath:[...t.currentPath,"properties",a]});d!==void 0&&(n.properties[a]=d,u||o.push(a))}o.length&&(n.required=o);let i=uS(e,t);return i!==void 0&&(n.additionalProperties=i),n}function uS(e,t){if(e.catchall._def.typeName!=="ZodNever")return U(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return t.removeAdditionalStrategy==="strict"?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}function lS(e){try{return e.isOptional()}catch{return!0}}var wd=x(()=>{Ee()});var wy,kd=x(()=>{Ee();_t();wy=(e,t)=>{if(t.currentPath.toString()===t.propertyPath?.toString())return U(e.innerType._def,t);let r=U(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return r?{anyOf:[{not:xe(t)},r]}:xe(t)}});var ky,Sd=x(()=>{Ee();ky=(e,t)=>{if(t.pipeStrategy==="input")return U(e.in._def,t);if(t.pipeStrategy==="output")return U(e.out._def,t);let r=U(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),n=U(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,n].filter(o=>o!==void 0)}}});function Sy(e,t){return U(e.type._def,t)}var Td=x(()=>{Ee()});function Ty(e,t){let n={type:"array",uniqueItems:!0,items:U(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&re(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&re(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}var Ed=x(()=>{yr();Ee()});function Ey(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((r,n)=>U(r._def,{...t,currentPath:[...t.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[]),additionalItems:U(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((r,n)=>U(r._def,{...t,currentPath:[...t.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[])}}var zd=x(()=>{Ee()});function zy(e){return{not:xe(e)}}var Pd=x(()=>{_t()});function Py(e){return xe(e)}var Id=x(()=>{_t()});var Iy,Rd=x(()=>{Ee();Iy=(e,t)=>U(e.innerType._def,t)});var Ry,Cd=x(()=>{so();_t();od();sd();id();Bi();ad();ud();ld();dd();pd();fd();md();yd();_d();vd();bd();$d();xd();wd();kd();Sd();Td();Ki();Ed();Wi();zd();Pd();Ji();Id();Rd();Ry=(e,t,r)=>{switch(t){case S.ZodString:return Hi(e,r);case S.ZodNumber:return $y(e,r);case S.ZodObject:return xy(e,r);case S.ZodBigInt:return sy(e,r);case S.ZodBoolean:return iy();case S.ZodDate:return cd(e,r);case S.ZodUndefined:return zy(r);case S.ZodNull:return yy(r);case S.ZodArray:return oy(e,r);case S.ZodUnion:case S.ZodDiscriminatedUnion:return vy(e,r);case S.ZodIntersection:return dy(e,r);case S.ZodTuple:return Ey(e,r);case S.ZodRecord:return Gi(e,r);case S.ZodLiteral:return py(e,r);case S.ZodEnum:return ly(e);case S.ZodNativeEnum:return hy(e);case S.ZodNullable:return by(e,r);case S.ZodOptional:return wy(e,r);case S.ZodMap:return my(e,r);case S.ZodSet:return Ty(e,r);case S.ZodLazy:return()=>e.getter()._def;case S.ZodPromise:return Sy(e,r);case S.ZodNaN:case S.ZodNever:return gy(r);case S.ZodEffects:return uy(e,r);case S.ZodAny:return xe(r);case S.ZodUnknown:return Py(r);case S.ZodDefault:return cy(e,r);case S.ZodBranded:return Vi(e,r);case S.ZodReadonly:return Iy(e,r);case S.ZodCatch:return ay(e,r);case S.ZodPipeline:return ky(e,r);case S.ZodFunction:case S.ZodVoid:case S.ZodSymbol:return;default:return(n=>{})(t)}}});function U(e,t,r=!1){let n=t.seen.get(e);if(t.override){let a=t.override?.(e,t,n,r);if(a!==ty)return a}if(n&&!r){let a=dS(n,t);if(a!==void 0)return a}let o={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,o);let s=Ry(e,e.typeName,t),i=typeof s=="function"?U(s(),t):s;if(i&&pS(e,t,i),t.postProcess){let a=t.postProcess(i,e,t);return o.jsonSchema=i,a}return o.jsonSchema=i,i}var dS,pS,Ee=x(()=>{qi();Cd();Ui();_t();dS=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:Fi(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((r,n)=>t.currentPath[n]===r)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),xe(t)):t.$refStrategy==="seen"?xe(t):void 0}},pS=(e,t,r)=>(e.description&&(r.description=e.description,t.markdownDescription&&(r.markdownDescription=e.description)),r)});var Cy=x(()=>{});var Od,Nd=x(()=>{Ee();rd();_t();Od=(e,t)=>{let r=ny(t),n=typeof t=="object"&&t.definitions?Object.entries(t.definitions).reduce((c,[u,d])=>({...c,[u]:U(d._def,{...r,currentPath:[...r.basePath,r.definitionPath,u]},!0)??xe(r)}),{}):void 0,o=typeof t=="string"?t:t?.nameStrategy==="title"?void 0:t?.name,s=U(e._def,o===void 0?r:{...r,currentPath:[...r.basePath,r.definitionPath,o]},!1)??xe(r),i=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;i!==void 0&&(s.title=i),r.flags.hasReferencedOpenAiAnyType&&(n||(n={}),n[r.openAiAnyTypeName]||(n[r.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:r.$refStrategy==="relative"?"1":[...r.basePath,r.definitionPath,r.openAiAnyTypeName].join("/")}}));let a=o===void 0?n?{...s,[r.definitionPath]:n}:s:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,o].join("/"),[r.definitionPath]:{...n,[o]:s}};return r.target==="jsonSchema7"?a.$schema="http://json-schema.org/draft-07/schema#":(r.target==="jsonSchema2019-09"||r.target==="openAi")&&(a.$schema="https://json-schema.org/draft/2019-09/schema#"),r.target==="openAi"&&("anyOf"in a||"oneOf"in a||"allOf"in a||"type"in a&&Array.isArray(a.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),a}});var Oy=x(()=>{qi();rd();yr();Ui();Ee();Cy();_t();od();sd();id();Bi();ad();ud();ld();dd();pd();fd();md();yd();_d();vd();bd();$d();xd();wd();kd();Sd();Td();Rd();Ki();Ed();Wi();zd();Pd();Ji();Id();Cd();Nd();Nd()});function fS(e){return!e||e==="jsonSchema7"||e==="draft-7"?"draft-7":e==="jsonSchema2019-09"||e==="draft-2020-12"?"draft-2020-12":"draft-7"}function Ad(e,t){return ht(e)?bl(e,{target:fS(t?.target),io:t?.pipeStrategy??"input"}):Od(e,{strictUnions:t?.strictUnions??!0,pipeStrategy:t?.pipeStrategy??"input"})}function jd(e){let r=mr(e)?.method;if(!r)throw new Error("Schema is missing a method literal");let n=gi(r);if(typeof n!="string")throw new Error("Schema method literal must be a string");return n}function Md(e,t){let r=fr(e,t);if(!r.success)throw r.error;return r.data}var Zd=x(()=>{wl();vo();Oy()});function Ny(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}function Ay(e,t){let r={...e};for(let n in t){let o=n,s=t[o];if(s===void 0)continue;let i=r[o];Ny(i)&&Ny(s)?r[o]={...i,...s}:r[o]=s}return r}var mS,Yi,jy=x(()=>{vo();Ro();Qg();Zd();mS=6e4,Yi=class{constructor(t){this._options=t,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this._taskProgressTokens=new Map,this._requestResolvers=new Map,this.setNotificationHandler(wi,r=>{this._oncancel(r)}),this.setNotificationHandler(Si,r=>{this._onprogress(r)}),this.setRequestHandler(ki,r=>({})),this._taskStore=t?.taskStore,this._taskMessageQueue=t?.taskMessageQueue,this._taskStore&&(this.setRequestHandler(Ti,async(r,n)=>{let o=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!o)throw new M(D.InvalidParams,"Failed to retrieve task: Task not found");return{...o}}),this.setRequestHandler(zi,async(r,n)=>{let o=async()=>{let s=r.params.taskId;if(this._taskMessageQueue){let a;for(;a=await this._taskMessageQueue.dequeue(s,n.sessionId);){if(a.type==="response"||a.type==="error"){let c=a.message,u=c.id,d=this._requestResolvers.get(u);if(d)if(this._requestResolvers.delete(u),a.type==="response")d(c);else{let l=c,m=new M(l.error.code,l.error.message,l.error.data);d(m)}else{let l=a.type==="response"?"Response":"Error";this._onerror(new Error(`${l} handler missing for request ${u}`))}continue}await this._transport?.send(a.message,{relatedRequestId:n.requestId})}}let i=await this._taskStore.getTask(s,n.sessionId);if(!i)throw new M(D.InvalidParams,`Task not found: ${s}`);if(!gr(i.status))return await this._waitForTaskUpdate(s,n.signal),await o();if(gr(i.status)){let a=await this._taskStore.getTaskResult(s,n.sessionId);return this._clearTaskQueue(s),{...a,_meta:{...a._meta,[hr]:{taskId:s}}}}return await o()};return await o()}),this.setRequestHandler(Pi,async(r,n)=>{try{let{tasks:o,nextCursor:s}=await this._taskStore.listTasks(r.params?.cursor,n.sessionId);return{tasks:o,nextCursor:s,_meta:{}}}catch(o){throw new M(D.InvalidParams,`Failed to list tasks: ${o instanceof Error?o.message:String(o)}`)}}),this.setRequestHandler(Ri,async(r,n)=>{try{let o=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!o)throw new M(D.InvalidParams,`Task not found: ${r.params.taskId}`);if(gr(o.status))throw new M(D.InvalidParams,`Cannot cancel task in terminal status: ${o.status}`);await this._taskStore.updateTaskStatus(r.params.taskId,"cancelled","Client cancelled task execution.",n.sessionId),this._clearTaskQueue(r.params.taskId);let s=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!s)throw new M(D.InvalidParams,`Task not found after cancellation: ${r.params.taskId}`);return{_meta:{},...s}}catch(o){throw o instanceof M?o:new M(D.InvalidRequest,`Failed to cancel task: ${o instanceof Error?o.message:String(o)}`)}}))}async _oncancel(t){if(!t.params.requestId)return;this._requestHandlerAbortControllers.get(t.params.requestId)?.abort(t.params.reason)}_setupTimeout(t,r,n,o,s=!1){this._timeoutInfo.set(t,{timeoutId:setTimeout(o,r),startTime:Date.now(),timeout:r,maxTotalTimeout:n,resetTimeoutOnProgress:s,onTimeout:o})}_resetTimeout(t){let r=this._timeoutInfo.get(t);if(!r)return!1;let n=Date.now()-r.startTime;if(r.maxTotalTimeout&&n>=r.maxTotalTimeout)throw this._timeoutInfo.delete(t),M.fromError(D.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:r.maxTotalTimeout,totalElapsed:n});return clearTimeout(r.timeoutId),r.timeoutId=setTimeout(r.onTimeout,r.timeout),!0}_cleanupTimeout(t){let r=this._timeoutInfo.get(t);r&&(clearTimeout(r.timeoutId),this._timeoutInfo.delete(t))}async connect(t){if(this._transport)throw new Error("Already connected to a transport. Call close() before connecting to a new transport, or use a separate Protocol instance per connection.");this._transport=t;let r=this.transport?.onclose;this._transport.onclose=()=>{r?.(),this._onclose()};let n=this.transport?.onerror;this._transport.onerror=s=>{n?.(s),this._onerror(s)};let o=this._transport?.onmessage;this._transport.onmessage=(s,i)=>{o?.(s,i),wo(s)||Fg(s)?this._onresponse(s):ql(s)?this._onrequest(s,i):qg(s)?this._onnotification(s):this._onerror(new Error(`Unknown message type: ${JSON.stringify(s)}`))},await this._transport.start()}_onclose(){let t=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._taskProgressTokens.clear(),this._pendingDebouncedNotifications.clear();for(let n of this._requestHandlerAbortControllers.values())n.abort();this._requestHandlerAbortControllers.clear();let r=M.fromError(D.ConnectionClosed,"Connection closed");this._transport=void 0,this.onclose?.();for(let n of t.values())n(r)}_onerror(t){this.onerror?.(t)}_onnotification(t){let r=this._notificationHandlers.get(t.method)??this.fallbackNotificationHandler;r!==void 0&&Promise.resolve().then(()=>r(t)).catch(n=>this._onerror(new Error(`Uncaught error in notification handler: ${n}`)))}_onrequest(t,r){let n=this._requestHandlers.get(t.method)??this.fallbackRequestHandler,o=this._transport,s=t.params?._meta?.[hr]?.taskId;if(n===void 0){let d={jsonrpc:"2.0",id:t.id,error:{code:D.MethodNotFound,message:"Method not found"}};s&&this._taskMessageQueue?this._enqueueTaskMessage(s,{type:"error",message:d,timestamp:Date.now()},o?.sessionId).catch(l=>this._onerror(new Error(`Failed to enqueue error response: ${l}`))):o?.send(d).catch(l=>this._onerror(new Error(`Failed to send an error response: ${l}`)));return}let i=new AbortController;this._requestHandlerAbortControllers.set(t.id,i);let a=Zg(t.params)?t.params.task:void 0,c=this._taskStore?this.requestTaskStore(t,o?.sessionId):void 0,u={signal:i.signal,sessionId:o?.sessionId,_meta:t.params?._meta,sendNotification:async d=>{if(i.signal.aborted)return;let l={relatedRequestId:t.id};s&&(l.relatedTask={taskId:s}),await this.notification(d,l)},sendRequest:async(d,l,m)=>{if(i.signal.aborted)throw new M(D.ConnectionClosed,"Request was cancelled");let h={...m,relatedRequestId:t.id};s&&!h.relatedTask&&(h.relatedTask={taskId:s});let p=h.relatedTask?.taskId??s;return p&&c&&await c.updateTaskStatus(p,"input_required"),await this.request(d,l,h)},authInfo:r?.authInfo,requestId:t.id,requestInfo:r?.requestInfo,taskId:s,taskStore:c,taskRequestedTtl:a?.ttl,closeSSEStream:r?.closeSSEStream,closeStandaloneSSEStream:r?.closeStandaloneSSEStream};Promise.resolve().then(()=>{a&&this.assertTaskHandlerCapability(t.method)}).then(()=>n(t,u)).then(async d=>{if(i.signal.aborted)return;let l={result:d,jsonrpc:"2.0",id:t.id};s&&this._taskMessageQueue?await this._enqueueTaskMessage(s,{type:"response",message:l,timestamp:Date.now()},o?.sessionId):await o?.send(l)},async d=>{if(i.signal.aborted)return;let l={jsonrpc:"2.0",id:t.id,error:{code:Number.isSafeInteger(d.code)?d.code:D.InternalError,message:d.message??"Internal error",...d.data!==void 0&&{data:d.data}}};s&&this._taskMessageQueue?await this._enqueueTaskMessage(s,{type:"error",message:l,timestamp:Date.now()},o?.sessionId):await o?.send(l)}).catch(d=>this._onerror(new Error(`Failed to send response: ${d}`))).finally(()=>{this._requestHandlerAbortControllers.delete(t.id)})}_onprogress(t){let{progressToken:r,...n}=t.params,o=Number(r),s=this._progressHandlers.get(o);if(!s){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(t)}`));return}let i=this._responseHandlers.get(o),a=this._timeoutInfo.get(o);if(a&&i&&a.resetTimeoutOnProgress)try{this._resetTimeout(o)}catch(c){this._responseHandlers.delete(o),this._progressHandlers.delete(o),this._cleanupTimeout(o),i(c);return}s(n)}_onresponse(t){let r=Number(t.id),n=this._requestResolvers.get(r);if(n){if(this._requestResolvers.delete(r),wo(t))n(t);else{let i=new M(t.error.code,t.error.message,t.error.data);n(i)}return}let o=this._responseHandlers.get(r);if(o===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(t)}`));return}this._responseHandlers.delete(r),this._cleanupTimeout(r);let s=!1;if(wo(t)&&t.result&&typeof t.result=="object"){let i=t.result;if(i.task&&typeof i.task=="object"){let a=i.task;typeof a.taskId=="string"&&(s=!0,this._taskProgressTokens.set(a.taskId,r))}}if(s||this._progressHandlers.delete(r),wo(t))o(t);else{let i=M.fromError(t.error.code,t.error.message,t.error.data);o(i)}}get transport(){return this._transport}async close(){await this._transport?.close()}async*requestStream(t,r,n){let{task:o}=n??{};if(!o){try{yield{type:"result",result:await this.request(t,r,n)}}catch(i){yield{type:"error",error:i instanceof M?i:new M(D.InternalError,String(i))}}return}let s;try{let i=await this.request(t,Pn,n);if(i.task)s=i.task.taskId,yield{type:"taskCreated",task:i.task};else throw new M(D.InternalError,"Task creation did not return a task");for(;;){let a=await this.getTask({taskId:s},n);if(yield{type:"taskStatus",task:a},gr(a.status)){a.status==="completed"?yield{type:"result",result:await this.getTaskResult({taskId:s},r,n)}:a.status==="failed"?yield{type:"error",error:new M(D.InternalError,`Task ${s} failed`)}:a.status==="cancelled"&&(yield{type:"error",error:new M(D.InternalError,`Task ${s} was cancelled`)});return}if(a.status==="input_required"){yield{type:"result",result:await this.getTaskResult({taskId:s},r,n)};return}let c=a.pollInterval??this._options?.defaultTaskPollInterval??1e3;await new Promise(u=>setTimeout(u,c)),n?.signal?.throwIfAborted()}}catch(i){yield{type:"error",error:i instanceof M?i:new M(D.InternalError,String(i))}}}request(t,r,n){let{relatedRequestId:o,resumptionToken:s,onresumptiontoken:i,task:a,relatedTask:c}=n??{};return new Promise((u,d)=>{let l=v=>{d(v)};if(!this._transport){l(new Error("Not connected"));return}if(this._options?.enforceStrictCapabilities===!0)try{this.assertCapabilityForMethod(t.method),a&&this.assertTaskCapability(t.method)}catch(v){l(v);return}n?.signal?.throwIfAborted();let m=this._requestMessageId++,h={...t,jsonrpc:"2.0",id:m};n?.onprogress&&(this._progressHandlers.set(m,n.onprogress),h.params={...t.params,_meta:{...t.params?._meta||{},progressToken:m}}),a&&(h.params={...h.params,task:a}),c&&(h.params={...h.params,_meta:{...h.params?._meta||{},[hr]:c}});let p=v=>{this._responseHandlers.delete(m),this._progressHandlers.delete(m),this._cleanupTimeout(m),this._transport?.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:m,reason:String(v)}},{relatedRequestId:o,resumptionToken:s,onresumptiontoken:i}).catch(w=>this._onerror(new Error(`Failed to send cancellation: ${w}`)));let _=v instanceof M?v:new M(D.RequestTimeout,String(v));d(_)};this._responseHandlers.set(m,v=>{if(!n?.signal?.aborted){if(v instanceof Error)return d(v);try{let _=fr(r,v.result);_.success?u(_.data):d(_.error)}catch(_){d(_)}}}),n?.signal?.addEventListener("abort",()=>{p(n?.signal?.reason)});let f=n?.timeout??mS,g=()=>p(M.fromError(D.RequestTimeout,"Request timed out",{timeout:f}));this._setupTimeout(m,f,n?.maxTotalTimeout,g,n?.resetTimeoutOnProgress??!1);let y=c?.taskId;if(y){let v=_=>{let w=this._responseHandlers.get(m);w?w(_):this._onerror(new Error(`Response handler missing for side-channeled request ${m}`))};this._requestResolvers.set(m,v),this._enqueueTaskMessage(y,{type:"request",message:h,timestamp:Date.now()}).catch(_=>{this._cleanupTimeout(m),d(_)})}else this._transport.send(h,{relatedRequestId:o,resumptionToken:s,onresumptiontoken:i}).catch(v=>{this._cleanupTimeout(m),d(v)})})}async getTask(t,r){return this.request({method:"tasks/get",params:t},Ei,r)}async getTaskResult(t,r,n){return this.request({method:"tasks/result",params:t},r,n)}async listTasks(t,r){return this.request({method:"tasks/list",params:t},Ii,r)}async cancelTask(t,r){return this.request({method:"tasks/cancel",params:t},Bg,r)}async notification(t,r){if(!this._transport)throw new Error("Not connected");this.assertNotificationCapability(t.method);let n=r?.relatedTask?.taskId;if(n){let a={...t,jsonrpc:"2.0",params:{...t.params,_meta:{...t.params?._meta||{},[hr]:r.relatedTask}}};await this._enqueueTaskMessage(n,{type:"notification",message:a,timestamp:Date.now()});return}if((this._options?.debouncedNotificationMethods??[]).includes(t.method)&&!t.params&&!r?.relatedRequestId&&!r?.relatedTask){if(this._pendingDebouncedNotifications.has(t.method))return;this._pendingDebouncedNotifications.add(t.method),Promise.resolve().then(()=>{if(this._pendingDebouncedNotifications.delete(t.method),!this._transport)return;let a={...t,jsonrpc:"2.0"};r?.relatedTask&&(a={...a,params:{...a.params,_meta:{...a.params?._meta||{},[hr]:r.relatedTask}}}),this._transport?.send(a,r).catch(c=>this._onerror(c))});return}let i={...t,jsonrpc:"2.0"};r?.relatedTask&&(i={...i,params:{...i.params,_meta:{...i.params?._meta||{},[hr]:r.relatedTask}}}),await this._transport.send(i,r)}setRequestHandler(t,r){let n=jd(t);this.assertRequestHandlerCapability(n),this._requestHandlers.set(n,(o,s)=>{let i=Md(t,o);return Promise.resolve(r(i,s))})}removeRequestHandler(t){this._requestHandlers.delete(t)}assertCanSetRequestHandler(t){if(this._requestHandlers.has(t))throw new Error(`A request handler for ${t} already exists, which would be overridden`)}setNotificationHandler(t,r){let n=jd(t);this._notificationHandlers.set(n,o=>{let s=Md(t,o);return Promise.resolve(r(s))})}removeNotificationHandler(t){this._notificationHandlers.delete(t)}_cleanupTaskProgressHandler(t){let r=this._taskProgressTokens.get(t);r!==void 0&&(this._progressHandlers.delete(r),this._taskProgressTokens.delete(t))}async _enqueueTaskMessage(t,r,n){if(!this._taskStore||!this._taskMessageQueue)throw new Error("Cannot enqueue task message: taskStore and taskMessageQueue are not configured");let o=this._options?.maxTaskQueueSize;await this._taskMessageQueue.enqueue(t,r,n,o)}async _clearTaskQueue(t,r){if(this._taskMessageQueue){let n=await this._taskMessageQueue.dequeueAll(t,r);for(let o of n)if(o.type==="request"&&ql(o.message)){let s=o.message.id,i=this._requestResolvers.get(s);i?(i(new M(D.InternalError,"Task cancelled or completed")),this._requestResolvers.delete(s)):this._onerror(new Error(`Resolver missing for request ${s} during task ${t} cleanup`))}}}async _waitForTaskUpdate(t,r){let n=this._options?.defaultTaskPollInterval??1e3;try{let o=await this._taskStore?.getTask(t);o?.pollInterval&&(n=o.pollInterval)}catch{}return new Promise((o,s)=>{if(r.aborted){s(new M(D.InvalidRequest,"Request cancelled"));return}let i=setTimeout(o,n);r.addEventListener("abort",()=>{clearTimeout(i),s(new M(D.InvalidRequest,"Request cancelled"))},{once:!0})})}requestTaskStore(t,r){let n=this._taskStore;if(!n)throw new Error("No task store configured");return{createTask:async o=>{if(!t)throw new Error("No request provided");return await n.createTask(o,t.id,{method:t.method,params:t.params},r)},getTask:async o=>{let s=await n.getTask(o,r);if(!s)throw new M(D.InvalidParams,"Failed to retrieve task: Task not found");return s},storeTaskResult:async(o,s,i)=>{await n.storeTaskResult(o,s,i,r);let a=await n.getTask(o,r);if(a){let c=zo.parse({method:"notifications/tasks/status",params:a});await this.notification(c),gr(a.status)&&this._cleanupTaskProgressHandler(o)}},getTaskResult:o=>n.getTaskResult(o,r),updateTaskStatus:async(o,s,i)=>{let a=await n.getTask(o,r);if(!a)throw new M(D.InvalidParams,`Task "${o}" not found - it may have been cleaned up`);if(gr(a.status))throw new M(D.InvalidParams,`Cannot update task "${o}" from terminal status "${a.status}" to "${s}". Terminal states (completed, failed, cancelled) cannot transition to other states.`);await n.updateTaskStatus(o,s,i,r);let c=await n.getTask(o,r);if(c){let u=zo.parse({method:"notifications/tasks/status",params:c});await this.notification(u),gr(c.status)&&this._cleanupTaskProgressHandler(o)}},listTasks:o=>n.listTasks(o,r)}}}});var Ao=P(ie=>{"use strict";Object.defineProperty(ie,"__esModule",{value:!0});ie.regexpCode=ie.getEsmExportName=ie.getProperty=ie.safeStringify=ie.stringify=ie.strConcat=ie.addCodeArg=ie.str=ie._=ie.nil=ie._Code=ie.Name=ie.IDENTIFIER=ie._CodeOrName=void 0;var Oo=class{};ie._CodeOrName=Oo;ie.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var Qr=class extends Oo{constructor(t){if(super(),!ie.IDENTIFIER.test(t))throw new Error("CodeGen: name must be a valid identifier");this.str=t}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}};ie.Name=Qr;var vt=class extends Oo{constructor(t){super(),this._items=typeof t=="string"?[t]:t}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let t=this._items[0];return t===""||t==='""'}get str(){var t;return(t=this._str)!==null&&t!==void 0?t:this._str=this._items.reduce((r,n)=>`${r}${n}`,"")}get names(){var t;return(t=this._names)!==null&&t!==void 0?t:this._names=this._items.reduce((r,n)=>(n instanceof Qr&&(r[n.str]=(r[n.str]||0)+1),r),{})}};ie._Code=vt;ie.nil=new vt("");function My(e,...t){let r=[e[0]],n=0;for(;n<t.length;)Dd(r,t[n]),r.push(e[++n]);return new vt(r)}ie._=My;var Ld=new vt("+");function Zy(e,...t){let r=[No(e[0])],n=0;for(;n<t.length;)r.push(Ld),Dd(r,t[n]),r.push(Ld,No(e[++n]));return hS(r),new vt(r)}ie.str=Zy;function Dd(e,t){t instanceof vt?e.push(...t._items):t instanceof Qr?e.push(t):e.push(_S(t))}ie.addCodeArg=Dd;function hS(e){let t=1;for(;t<e.length-1;){if(e[t]===Ld){let r=gS(e[t-1],e[t+1]);if(r!==void 0){e.splice(t-1,3,r);continue}e[t++]="+"}t++}}function gS(e,t){if(t==='""')return e;if(e==='""')return t;if(typeof e=="string")return t instanceof Qr||e[e.length-1]!=='"'?void 0:typeof t!="string"?`${e.slice(0,-1)}${t}"`:t[0]==='"'?e.slice(0,-1)+t.slice(1):void 0;if(typeof t=="string"&&t[0]==='"'&&!(e instanceof Qr))return`"${e}${t.slice(1)}`}function yS(e,t){return t.emptyStr()?e:e.emptyStr()?t:Zy`${e}${t}`}ie.strConcat=yS;function _S(e){return typeof e=="number"||typeof e=="boolean"||e===null?e:No(Array.isArray(e)?e.join(","):e)}function vS(e){return new vt(No(e))}ie.stringify=vS;function No(e){return JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}ie.safeStringify=No;function bS(e){return typeof e=="string"&&ie.IDENTIFIER.test(e)?new vt(`.${e}`):My`[${e}]`}ie.getProperty=bS;function $S(e){if(typeof e=="string"&&ie.IDENTIFIER.test(e))return new vt(`${e}`);throw new Error(`CodeGen: invalid export name: ${e}, use explicit $id name mapping`)}ie.getEsmExportName=$S;function xS(e){return new vt(e.toString())}ie.regexpCode=xS});var Ud=P(nt=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0});nt.ValueScope=nt.ValueScopeName=nt.Scope=nt.varKinds=nt.UsedValueState=void 0;var rt=Ao(),qd=class extends Error{constructor(t){super(`CodeGen: "code" for ${t} not defined`),this.value=t.value}},Xi;(function(e){e[e.Started=0]="Started",e[e.Completed=1]="Completed"})(Xi||(nt.UsedValueState=Xi={}));nt.varKinds={const:new rt.Name("const"),let:new rt.Name("let"),var:new rt.Name("var")};var Qi=class{constructor({prefixes:t,parent:r}={}){this._names={},this._prefixes=t,this._parent=r}toName(t){return t instanceof rt.Name?t:this.name(t)}name(t){return new rt.Name(this._newName(t))}_newName(t){let r=this._names[t]||this._nameGroup(t);return`${t}${r.index++}`}_nameGroup(t){var r,n;if(!((n=(r=this._parent)===null||r===void 0?void 0:r._prefixes)===null||n===void 0)&&n.has(t)||this._prefixes&&!this._prefixes.has(t))throw new Error(`CodeGen: prefix "${t}" is not allowed in this scope`);return this._names[t]={prefix:t,index:0}}};nt.Scope=Qi;var ea=class extends rt.Name{constructor(t,r){super(r),this.prefix=t}setValue(t,{property:r,itemIndex:n}){this.value=t,this.scopePath=(0,rt._)`.${new rt.Name(r)}[${n}]`}};nt.ValueScopeName=ea;var wS=(0,rt._)`\n`,Fd=class extends Qi{constructor(t){super(t),this._values={},this._scope=t.scope,this.opts={...t,_n:t.lines?wS:rt.nil}}get(){return this._scope}name(t){return new ea(t,this._newName(t))}value(t,r){var n;if(r.ref===void 0)throw new Error("CodeGen: ref must be passed in value");let o=this.toName(t),{prefix:s}=o,i=(n=r.key)!==null&&n!==void 0?n:r.ref,a=this._values[s];if(a){let d=a.get(i);if(d)return d}else a=this._values[s]=new Map;a.set(i,o);let c=this._scope[s]||(this._scope[s]=[]),u=c.length;return c[u]=r.ref,o.setValue(r,{property:s,itemIndex:u}),o}getValue(t,r){let n=this._values[t];if(n)return n.get(r)}scopeRefs(t,r=this._values){return this._reduceValues(r,n=>{if(n.scopePath===void 0)throw new Error(`CodeGen: name "${n}" has no value`);return(0,rt._)`${t}${n.scopePath}`})}scopeCode(t=this._values,r,n){return this._reduceValues(t,o=>{if(o.value===void 0)throw new Error(`CodeGen: name "${o}" has no value`);return o.value.code},r,n)}_reduceValues(t,r,n={},o){let s=rt.nil;for(let i in t){let a=t[i];if(!a)continue;let c=n[i]=n[i]||new Map;a.forEach(u=>{if(c.has(u))return;c.set(u,Xi.Started);let d=r(u);if(d){let l=this.opts.es5?nt.varKinds.var:nt.varKinds.const;s=(0,rt._)`${s}${l} ${u} = ${d};${this.opts._n}`}else if(d=o?.(u))s=(0,rt._)`${s}${d}${this.opts._n}`;else throw new qd(u);c.set(u,Xi.Completed)})}return s}};nt.ValueScope=Fd});var K=P(J=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});J.or=J.and=J.not=J.CodeGen=J.operators=J.varKinds=J.ValueScopeName=J.ValueScope=J.Scope=J.Name=J.regexpCode=J.stringify=J.getProperty=J.nil=J.strConcat=J.str=J._=void 0;var ne=Ao(),Et=Ud(),_r=Ao();Object.defineProperty(J,"_",{enumerable:!0,get:function(){return _r._}});Object.defineProperty(J,"str",{enumerable:!0,get:function(){return _r.str}});Object.defineProperty(J,"strConcat",{enumerable:!0,get:function(){return _r.strConcat}});Object.defineProperty(J,"nil",{enumerable:!0,get:function(){return _r.nil}});Object.defineProperty(J,"getProperty",{enumerable:!0,get:function(){return _r.getProperty}});Object.defineProperty(J,"stringify",{enumerable:!0,get:function(){return _r.stringify}});Object.defineProperty(J,"regexpCode",{enumerable:!0,get:function(){return _r.regexpCode}});Object.defineProperty(J,"Name",{enumerable:!0,get:function(){return _r.Name}});var oa=Ud();Object.defineProperty(J,"Scope",{enumerable:!0,get:function(){return oa.Scope}});Object.defineProperty(J,"ValueScope",{enumerable:!0,get:function(){return oa.ValueScope}});Object.defineProperty(J,"ValueScopeName",{enumerable:!0,get:function(){return oa.ValueScopeName}});Object.defineProperty(J,"varKinds",{enumerable:!0,get:function(){return oa.varKinds}});J.operators={GT:new ne._Code(">"),GTE:new ne._Code(">="),LT:new ne._Code("<"),LTE:new ne._Code("<="),EQ:new ne._Code("==="),NEQ:new ne._Code("!=="),NOT:new ne._Code("!"),OR:new ne._Code("||"),AND:new ne._Code("&&"),ADD:new ne._Code("+")};var Qt=class{optimizeNodes(){return this}optimizeNames(t,r){return this}},Vd=class extends Qt{constructor(t,r,n){super(),this.varKind=t,this.name=r,this.rhs=n}render({es5:t,_n:r}){let n=t?Et.varKinds.var:this.varKind,o=this.rhs===void 0?"":` = ${this.rhs}`;return`${n} ${this.name}${o};`+r}optimizeNames(t,r){if(t[this.name.str])return this.rhs&&(this.rhs=On(this.rhs,t,r)),this}get names(){return this.rhs instanceof ne._CodeOrName?this.rhs.names:{}}},ta=class extends Qt{constructor(t,r,n){super(),this.lhs=t,this.rhs=r,this.sideEffects=n}render({_n:t}){return`${this.lhs} = ${this.rhs};`+t}optimizeNames(t,r){if(!(this.lhs instanceof ne.Name&&!t[this.lhs.str]&&!this.sideEffects))return this.rhs=On(this.rhs,t,r),this}get names(){let t=this.lhs instanceof ne.Name?{}:{...this.lhs.names};return na(t,this.rhs)}},Bd=class extends ta{constructor(t,r,n,o){super(t,n,o),this.op=r}render({_n:t}){return`${this.lhs} ${this.op}= ${this.rhs};`+t}},Hd=class extends Qt{constructor(t){super(),this.label=t,this.names={}}render({_n:t}){return`${this.label}:`+t}},Wd=class extends Qt{constructor(t){super(),this.label=t,this.names={}}render({_n:t}){return`break${this.label?` ${this.label}`:""};`+t}},Gd=class extends Qt{constructor(t){super(),this.error=t}render({_n:t}){return`throw ${this.error};`+t}get names(){return this.error.names}},Kd=class extends Qt{constructor(t){super(),this.code=t}render({_n:t}){return`${this.code};`+t}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(t,r){return this.code=On(this.code,t,r),this}get names(){return this.code instanceof ne._CodeOrName?this.code.names:{}}},jo=class extends Qt{constructor(t=[]){super(),this.nodes=t}render(t){return this.nodes.reduce((r,n)=>r+n.render(t),"")}optimizeNodes(){let{nodes:t}=this,r=t.length;for(;r--;){let n=t[r].optimizeNodes();Array.isArray(n)?t.splice(r,1,...n):n?t[r]=n:t.splice(r,1)}return t.length>0?this:void 0}optimizeNames(t,r){let{nodes:n}=this,o=n.length;for(;o--;){let s=n[o];s.optimizeNames(t,r)||(kS(t,s.names),n.splice(o,1))}return n.length>0?this:void 0}get names(){return this.nodes.reduce((t,r)=>rn(t,r.names),{})}},er=class extends jo{render(t){return"{"+t._n+super.render(t)+"}"+t._n}},Jd=class extends jo{},Cn=class extends er{};Cn.kind="else";var en=class e extends er{constructor(t,r){super(r),this.condition=t}render(t){let r=`if(${this.condition})`+super.render(t);return this.else&&(r+="else "+this.else.render(t)),r}optimizeNodes(){super.optimizeNodes();let t=this.condition;if(t===!0)return this.nodes;let r=this.else;if(r){let n=r.optimizeNodes();r=this.else=Array.isArray(n)?new Cn(n):n}if(r)return t===!1?r instanceof e?r:r.nodes:this.nodes.length?this:new e(Ly(t),r instanceof e?[r]:r.nodes);if(!(t===!1||!this.nodes.length))return this}optimizeNames(t,r){var n;if(this.else=(n=this.else)===null||n===void 0?void 0:n.optimizeNames(t,r),!!(super.optimizeNames(t,r)||this.else))return this.condition=On(this.condition,t,r),this}get names(){let t=super.names;return na(t,this.condition),this.else&&rn(t,this.else.names),t}};en.kind="if";var tn=class extends er{};tn.kind="for";var Yd=class extends tn{constructor(t){super(),this.iteration=t}render(t){return`for(${this.iteration})`+super.render(t)}optimizeNames(t,r){if(super.optimizeNames(t,r))return this.iteration=On(this.iteration,t,r),this}get names(){return rn(super.names,this.iteration.names)}},Xd=class extends tn{constructor(t,r,n,o){super(),this.varKind=t,this.name=r,this.from=n,this.to=o}render(t){let r=t.es5?Et.varKinds.var:this.varKind,{name:n,from:o,to:s}=this;return`for(${r} ${n}=${o}; ${n}<${s}; ${n}++)`+super.render(t)}get names(){let t=na(super.names,this.from);return na(t,this.to)}},ra=class extends tn{constructor(t,r,n,o){super(),this.loop=t,this.varKind=r,this.name=n,this.iterable=o}render(t){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(t)}optimizeNames(t,r){if(super.optimizeNames(t,r))return this.iterable=On(this.iterable,t,r),this}get names(){return rn(super.names,this.iterable.names)}},Mo=class extends er{constructor(t,r,n){super(),this.name=t,this.args=r,this.async=n}render(t){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(t)}};Mo.kind="func";var Zo=class extends jo{render(t){return"return "+super.render(t)}};Zo.kind="return";var Qd=class extends er{render(t){let r="try"+super.render(t);return this.catch&&(r+=this.catch.render(t)),this.finally&&(r+=this.finally.render(t)),r}optimizeNodes(){var t,r;return super.optimizeNodes(),(t=this.catch)===null||t===void 0||t.optimizeNodes(),(r=this.finally)===null||r===void 0||r.optimizeNodes(),this}optimizeNames(t,r){var n,o;return super.optimizeNames(t,r),(n=this.catch)===null||n===void 0||n.optimizeNames(t,r),(o=this.finally)===null||o===void 0||o.optimizeNames(t,r),this}get names(){let t=super.names;return this.catch&&rn(t,this.catch.names),this.finally&&rn(t,this.finally.names),t}},Lo=class extends er{constructor(t){super(),this.error=t}render(t){return`catch(${this.error})`+super.render(t)}};Lo.kind="catch";var Do=class extends er{render(t){return"finally"+super.render(t)}};Do.kind="finally";var ep=class{constructor(t,r={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...r,_n:r.lines?`
`:""},this._extScope=t,this._scope=new Et.Scope({parent:t}),this._nodes=[new Jd]}toString(){return this._root.render(this.opts)}name(t){return this._scope.name(t)}scopeName(t){return this._extScope.name(t)}scopeValue(t,r){let n=this._extScope.value(t,r);return(this._values[n.prefix]||(this._values[n.prefix]=new Set)).add(n),n}getScopeValue(t,r){return this._extScope.getValue(t,r)}scopeRefs(t){return this._extScope.scopeRefs(t,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(t,r,n,o){let s=this._scope.toName(r);return n!==void 0&&o&&(this._constants[s.str]=n),this._leafNode(new Vd(t,s,n)),s}const(t,r,n){return this._def(Et.varKinds.const,t,r,n)}let(t,r,n){return this._def(Et.varKinds.let,t,r,n)}var(t,r,n){return this._def(Et.varKinds.var,t,r,n)}assign(t,r,n){return this._leafNode(new ta(t,r,n))}add(t,r){return this._leafNode(new Bd(t,J.operators.ADD,r))}code(t){return typeof t=="function"?t():t!==ne.nil&&this._leafNode(new Kd(t)),this}object(...t){let r=["{"];for(let[n,o]of t)r.length>1&&r.push(","),r.push(n),(n!==o||this.opts.es5)&&(r.push(":"),(0,ne.addCodeArg)(r,o));return r.push("}"),new ne._Code(r)}if(t,r,n){if(this._blockNode(new en(t)),r&&n)this.code(r).else().code(n).endIf();else if(r)this.code(r).endIf();else if(n)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(t){return this._elseNode(new en(t))}else(){return this._elseNode(new Cn)}endIf(){return this._endBlockNode(en,Cn)}_for(t,r){return this._blockNode(t),r&&this.code(r).endFor(),this}for(t,r){return this._for(new Yd(t),r)}forRange(t,r,n,o,s=this.opts.es5?Et.varKinds.var:Et.varKinds.let){let i=this._scope.toName(t);return this._for(new Xd(s,i,r,n),()=>o(i))}forOf(t,r,n,o=Et.varKinds.const){let s=this._scope.toName(t);if(this.opts.es5){let i=r instanceof ne.Name?r:this.var("_arr",r);return this.forRange("_i",0,(0,ne._)`${i}.length`,a=>{this.var(s,(0,ne._)`${i}[${a}]`),n(s)})}return this._for(new ra("of",o,s,r),()=>n(s))}forIn(t,r,n,o=this.opts.es5?Et.varKinds.var:Et.varKinds.const){if(this.opts.ownProperties)return this.forOf(t,(0,ne._)`Object.keys(${r})`,n);let s=this._scope.toName(t);return this._for(new ra("in",o,s,r),()=>n(s))}endFor(){return this._endBlockNode(tn)}label(t){return this._leafNode(new Hd(t))}break(t){return this._leafNode(new Wd(t))}return(t){let r=new Zo;if(this._blockNode(r),this.code(t),r.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(Zo)}try(t,r,n){if(!r&&!n)throw new Error('CodeGen: "try" without "catch" and "finally"');let o=new Qd;if(this._blockNode(o),this.code(t),r){let s=this.name("e");this._currNode=o.catch=new Lo(s),r(s)}return n&&(this._currNode=o.finally=new Do,this.code(n)),this._endBlockNode(Lo,Do)}throw(t){return this._leafNode(new Gd(t))}block(t,r){return this._blockStarts.push(this._nodes.length),t&&this.code(t).endBlock(r),this}endBlock(t){let r=this._blockStarts.pop();if(r===void 0)throw new Error("CodeGen: not in self-balancing block");let n=this._nodes.length-r;if(n<0||t!==void 0&&n!==t)throw new Error(`CodeGen: wrong number of nodes: ${n} vs ${t} expected`);return this._nodes.length=r,this}func(t,r=ne.nil,n,o){return this._blockNode(new Mo(t,r,n)),o&&this.code(o).endFunc(),this}endFunc(){return this._endBlockNode(Mo)}optimize(t=1){for(;t-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(t){return this._currNode.nodes.push(t),this}_blockNode(t){this._currNode.nodes.push(t),this._nodes.push(t)}_endBlockNode(t,r){let n=this._currNode;if(n instanceof t||r&&n instanceof r)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${r?`${t.kind}/${r.kind}`:t.kind}"`)}_elseNode(t){let r=this._currNode;if(!(r instanceof en))throw new Error('CodeGen: "else" without "if"');return this._currNode=r.else=t,this}get _root(){return this._nodes[0]}get _currNode(){let t=this._nodes;return t[t.length-1]}set _currNode(t){let r=this._nodes;r[r.length-1]=t}};J.CodeGen=ep;function rn(e,t){for(let r in t)e[r]=(e[r]||0)+(t[r]||0);return e}function na(e,t){return t instanceof ne._CodeOrName?rn(e,t.names):e}function On(e,t,r){if(e instanceof ne.Name)return n(e);if(!o(e))return e;return new ne._Code(e._items.reduce((s,i)=>(i instanceof ne.Name&&(i=n(i)),i instanceof ne._Code?s.push(...i._items):s.push(i),s),[]));function n(s){let i=r[s.str];return i===void 0||t[s.str]!==1?s:(delete t[s.str],i)}function o(s){return s instanceof ne._Code&&s._items.some(i=>i instanceof ne.Name&&t[i.str]===1&&r[i.str]!==void 0)}}function kS(e,t){for(let r in t)e[r]=(e[r]||0)-(t[r]||0)}function Ly(e){return typeof e=="boolean"||typeof e=="number"||e===null?!e:(0,ne._)`!${tp(e)}`}J.not=Ly;var SS=Dy(J.operators.AND);function TS(...e){return e.reduce(SS)}J.and=TS;var ES=Dy(J.operators.OR);function zS(...e){return e.reduce(ES)}J.or=zS;function Dy(e){return(t,r)=>t===ne.nil?r:r===ne.nil?t:(0,ne._)`${tp(t)} ${e} ${tp(r)}`}function tp(e){return e instanceof ne.Name?e:(0,ne._)`(${e})`}});var oe=P(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});Y.checkStrictMode=Y.getErrorPath=Y.Type=Y.useFunc=Y.setEvaluated=Y.evaluatedPropsToName=Y.mergeEvaluated=Y.eachItem=Y.unescapeJsonPointer=Y.escapeJsonPointer=Y.escapeFragment=Y.unescapeFragment=Y.schemaRefOrVal=Y.schemaHasRulesButRef=Y.schemaHasRules=Y.checkUnknownRules=Y.alwaysValidSchema=Y.toHash=void 0;var pe=K(),PS=Ao();function IS(e){let t={};for(let r of e)t[r]=!0;return t}Y.toHash=IS;function RS(e,t){return typeof t=="boolean"?t:Object.keys(t).length===0?!0:(Uy(e,t),!Vy(t,e.self.RULES.all))}Y.alwaysValidSchema=RS;function Uy(e,t=e.schema){let{opts:r,self:n}=e;if(!r.strictSchema||typeof t=="boolean")return;let o=n.RULES.keywords;for(let s in t)o[s]||Wy(e,`unknown keyword: "${s}"`)}Y.checkUnknownRules=Uy;function Vy(e,t){if(typeof e=="boolean")return!e;for(let r in e)if(t[r])return!0;return!1}Y.schemaHasRules=Vy;function CS(e,t){if(typeof e=="boolean")return!e;for(let r in e)if(r!=="$ref"&&t.all[r])return!0;return!1}Y.schemaHasRulesButRef=CS;function OS({topSchemaRef:e,schemaPath:t},r,n,o){if(!o){if(typeof r=="number"||typeof r=="boolean")return r;if(typeof r=="string")return(0,pe._)`${r}`}return(0,pe._)`${e}${t}${(0,pe.getProperty)(n)}`}Y.schemaRefOrVal=OS;function NS(e){return By(decodeURIComponent(e))}Y.unescapeFragment=NS;function AS(e){return encodeURIComponent(np(e))}Y.escapeFragment=AS;function np(e){return typeof e=="number"?`${e}`:e.replace(/~/g,"~0").replace(/\//g,"~1")}Y.escapeJsonPointer=np;function By(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}Y.unescapeJsonPointer=By;function jS(e,t){if(Array.isArray(e))for(let r of e)t(r);else t(e)}Y.eachItem=jS;function qy({mergeNames:e,mergeToName:t,mergeValues:r,resultToName:n}){return(o,s,i,a)=>{let c=i===void 0?s:i instanceof pe.Name?(s instanceof pe.Name?e(o,s,i):t(o,s,i),i):s instanceof pe.Name?(t(o,i,s),s):r(s,i);return a===pe.Name&&!(c instanceof pe.Name)?n(o,c):c}}Y.mergeEvaluated={props:qy({mergeNames:(e,t,r)=>e.if((0,pe._)`${r} !== true && ${t} !== undefined`,()=>{e.if((0,pe._)`${t} === true`,()=>e.assign(r,!0),()=>e.assign(r,(0,pe._)`${r} || {}`).code((0,pe._)`Object.assign(${r}, ${t})`))}),mergeToName:(e,t,r)=>e.if((0,pe._)`${r} !== true`,()=>{t===!0?e.assign(r,!0):(e.assign(r,(0,pe._)`${r} || {}`),op(e,r,t))}),mergeValues:(e,t)=>e===!0?!0:{...e,...t},resultToName:Hy}),items:qy({mergeNames:(e,t,r)=>e.if((0,pe._)`${r} !== true && ${t} !== undefined`,()=>e.assign(r,(0,pe._)`${t} === true ? true : ${r} > ${t} ? ${r} : ${t}`)),mergeToName:(e,t,r)=>e.if((0,pe._)`${r} !== true`,()=>e.assign(r,t===!0?!0:(0,pe._)`${r} > ${t} ? ${r} : ${t}`)),mergeValues:(e,t)=>e===!0?!0:Math.max(e,t),resultToName:(e,t)=>e.var("items",t)})};function Hy(e,t){if(t===!0)return e.var("props",!0);let r=e.var("props",(0,pe._)`{}`);return t!==void 0&&op(e,r,t),r}Y.evaluatedPropsToName=Hy;function op(e,t,r){Object.keys(r).forEach(n=>e.assign((0,pe._)`${t}${(0,pe.getProperty)(n)}`,!0))}Y.setEvaluated=op;var Fy={};function MS(e,t){return e.scopeValue("func",{ref:t,code:Fy[t.code]||(Fy[t.code]=new PS._Code(t.code))})}Y.useFunc=MS;var rp;(function(e){e[e.Num=0]="Num",e[e.Str=1]="Str"})(rp||(Y.Type=rp={}));function ZS(e,t,r){if(e instanceof pe.Name){let n=t===rp.Num;return r?n?(0,pe._)`"[" + ${e} + "]"`:(0,pe._)`"['" + ${e} + "']"`:n?(0,pe._)`"/" + ${e}`:(0,pe._)`"/" + ${e}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,pe.getProperty)(e).toString():"/"+np(e)}Y.getErrorPath=ZS;function Wy(e,t,r=e.opts.strictSchema){if(r){if(t=`strict mode: ${t}`,r===!0)throw new Error(t);e.self.logger.warn(t)}}Y.checkStrictMode=Wy});var tr=P(sp=>{"use strict";Object.defineProperty(sp,"__esModule",{value:!0});var Fe=K(),LS={data:new Fe.Name("data"),valCxt:new Fe.Name("valCxt"),instancePath:new Fe.Name("instancePath"),parentData:new Fe.Name("parentData"),parentDataProperty:new Fe.Name("parentDataProperty"),rootData:new Fe.Name("rootData"),dynamicAnchors:new Fe.Name("dynamicAnchors"),vErrors:new Fe.Name("vErrors"),errors:new Fe.Name("errors"),this:new Fe.Name("this"),self:new Fe.Name("self"),scope:new Fe.Name("scope"),json:new Fe.Name("json"),jsonPos:new Fe.Name("jsonPos"),jsonLen:new Fe.Name("jsonLen"),jsonPart:new Fe.Name("jsonPart")};sp.default=LS});var qo=P(Ue=>{"use strict";Object.defineProperty(Ue,"__esModule",{value:!0});Ue.extendErrors=Ue.resetErrorsCount=Ue.reportExtraError=Ue.reportError=Ue.keyword$DataError=Ue.keywordError=void 0;var se=K(),sa=oe(),Ge=tr();Ue.keywordError={message:({keyword:e})=>(0,se.str)`must pass "${e}" keyword validation`};Ue.keyword$DataError={message:({keyword:e,schemaType:t})=>t?(0,se.str)`"${e}" keyword must be ${t} ($data)`:(0,se.str)`"${e}" keyword is invalid ($data)`};function DS(e,t=Ue.keywordError,r,n){let{it:o}=e,{gen:s,compositeRule:i,allErrors:a}=o,c=Jy(e,t,r);n??(i||a)?Gy(s,c):Ky(o,(0,se._)`[${c}]`)}Ue.reportError=DS;function qS(e,t=Ue.keywordError,r){let{it:n}=e,{gen:o,compositeRule:s,allErrors:i}=n,a=Jy(e,t,r);Gy(o,a),s||i||Ky(n,Ge.default.vErrors)}Ue.reportExtraError=qS;function FS(e,t){e.assign(Ge.default.errors,t),e.if((0,se._)`${Ge.default.vErrors} !== null`,()=>e.if(t,()=>e.assign((0,se._)`${Ge.default.vErrors}.length`,t),()=>e.assign(Ge.default.vErrors,null)))}Ue.resetErrorsCount=FS;function US({gen:e,keyword:t,schemaValue:r,data:n,errsCount:o,it:s}){if(o===void 0)throw new Error("ajv implementation error");let i=e.name("err");e.forRange("i",o,Ge.default.errors,a=>{e.const(i,(0,se._)`${Ge.default.vErrors}[${a}]`),e.if((0,se._)`${i}.instancePath === undefined`,()=>e.assign((0,se._)`${i}.instancePath`,(0,se.strConcat)(Ge.default.instancePath,s.errorPath))),e.assign((0,se._)`${i}.schemaPath`,(0,se.str)`${s.errSchemaPath}/${t}`),s.opts.verbose&&(e.assign((0,se._)`${i}.schema`,r),e.assign((0,se._)`${i}.data`,n))})}Ue.extendErrors=US;function Gy(e,t){let r=e.const("err",t);e.if((0,se._)`${Ge.default.vErrors} === null`,()=>e.assign(Ge.default.vErrors,(0,se._)`[${r}]`),(0,se._)`${Ge.default.vErrors}.push(${r})`),e.code((0,se._)`${Ge.default.errors}++`)}function Ky(e,t){let{gen:r,validateName:n,schemaEnv:o}=e;o.$async?r.throw((0,se._)`new ${e.ValidationError}(${t})`):(r.assign((0,se._)`${n}.errors`,t),r.return(!1))}var nn={keyword:new se.Name("keyword"),schemaPath:new se.Name("schemaPath"),params:new se.Name("params"),propertyName:new se.Name("propertyName"),message:new se.Name("message"),schema:new se.Name("schema"),parentSchema:new se.Name("parentSchema")};function Jy(e,t,r){let{createErrors:n}=e.it;return n===!1?(0,se._)`{}`:VS(e,t,r)}function VS(e,t,r={}){let{gen:n,it:o}=e,s=[BS(o,r),HS(e,r)];return WS(e,t,s),n.object(...s)}function BS({errorPath:e},{instancePath:t}){let r=t?(0,se.str)`${e}${(0,sa.getErrorPath)(t,sa.Type.Str)}`:e;return[Ge.default.instancePath,(0,se.strConcat)(Ge.default.instancePath,r)]}function HS({keyword:e,it:{errSchemaPath:t}},{schemaPath:r,parentSchema:n}){let o=n?t:(0,se.str)`${t}/${e}`;return r&&(o=(0,se.str)`${o}${(0,sa.getErrorPath)(r,sa.Type.Str)}`),[nn.schemaPath,o]}function WS(e,{params:t,message:r},n){let{keyword:o,data:s,schemaValue:i,it:a}=e,{opts:c,propertyName:u,topSchemaRef:d,schemaPath:l}=a;n.push([nn.keyword,o],[nn.params,typeof t=="function"?t(e):t||(0,se._)`{}`]),c.messages&&n.push([nn.message,typeof r=="function"?r(e):r]),c.verbose&&n.push([nn.schema,i],[nn.parentSchema,(0,se._)`${d}${l}`],[Ge.default.data,s]),u&&n.push([nn.propertyName,u])}});var Xy=P(Nn=>{"use strict";Object.defineProperty(Nn,"__esModule",{value:!0});Nn.boolOrEmptySchema=Nn.topBoolOrEmptySchema=void 0;var GS=qo(),KS=K(),JS=tr(),YS={message:"boolean schema is false"};function XS(e){let{gen:t,schema:r,validateName:n}=e;r===!1?Yy(e,!1):typeof r=="object"&&r.$async===!0?t.return(JS.default.data):(t.assign((0,KS._)`${n}.errors`,null),t.return(!0))}Nn.topBoolOrEmptySchema=XS;function QS(e,t){let{gen:r,schema:n}=e;n===!1?(r.var(t,!1),Yy(e)):r.var(t,!0)}Nn.boolOrEmptySchema=QS;function Yy(e,t){let{gen:r,data:n}=e,o={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e};(0,GS.reportError)(o,YS,void 0,t)}});var ip=P(An=>{"use strict";Object.defineProperty(An,"__esModule",{value:!0});An.getRules=An.isJSONType=void 0;var eT=["string","number","integer","boolean","null","object","array"],tT=new Set(eT);function rT(e){return typeof e=="string"&&tT.has(e)}An.isJSONType=rT;function nT(){let e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...e,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}}An.getRules=nT});var ap=P(vr=>{"use strict";Object.defineProperty(vr,"__esModule",{value:!0});vr.shouldUseRule=vr.shouldUseGroup=vr.schemaHasRulesForType=void 0;function oT({schema:e,self:t},r){let n=t.RULES.types[r];return n&&n!==!0&&Qy(e,n)}vr.schemaHasRulesForType=oT;function Qy(e,t){return t.rules.some(r=>e_(e,r))}vr.shouldUseGroup=Qy;function e_(e,t){var r;return e[t.keyword]!==void 0||((r=t.definition.implements)===null||r===void 0?void 0:r.some(n=>e[n]!==void 0))}vr.shouldUseRule=e_});var Fo=P(Ve=>{"use strict";Object.defineProperty(Ve,"__esModule",{value:!0});Ve.reportTypeError=Ve.checkDataTypes=Ve.checkDataType=Ve.coerceAndCheckDataType=Ve.getJSONTypes=Ve.getSchemaTypes=Ve.DataType=void 0;var sT=ip(),iT=ap(),aT=qo(),W=K(),t_=oe(),jn;(function(e){e[e.Correct=0]="Correct",e[e.Wrong=1]="Wrong"})(jn||(Ve.DataType=jn={}));function cT(e){let t=r_(e.type);if(t.includes("null")){if(e.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!t.length&&e.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');e.nullable===!0&&t.push("null")}return t}Ve.getSchemaTypes=cT;function r_(e){let t=Array.isArray(e)?e:e?[e]:[];if(t.every(sT.isJSONType))return t;throw new Error("type must be JSONType or JSONType[]: "+t.join(","))}Ve.getJSONTypes=r_;function uT(e,t){let{gen:r,data:n,opts:o}=e,s=lT(t,o.coerceTypes),i=t.length>0&&!(s.length===0&&t.length===1&&(0,iT.schemaHasRulesForType)(e,t[0]));if(i){let a=up(t,n,o.strictNumbers,jn.Wrong);r.if(a,()=>{s.length?dT(e,t,s):lp(e)})}return i}Ve.coerceAndCheckDataType=uT;var n_=new Set(["string","number","integer","boolean","null"]);function lT(e,t){return t?e.filter(r=>n_.has(r)||t==="array"&&r==="array"):[]}function dT(e,t,r){let{gen:n,data:o,opts:s}=e,i=n.let("dataType",(0,W._)`typeof ${o}`),a=n.let("coerced",(0,W._)`undefined`);s.coerceTypes==="array"&&n.if((0,W._)`${i} == 'object' && Array.isArray(${o}) && ${o}.length == 1`,()=>n.assign(o,(0,W._)`${o}[0]`).assign(i,(0,W._)`typeof ${o}`).if(up(t,o,s.strictNumbers),()=>n.assign(a,o))),n.if((0,W._)`${a} !== undefined`);for(let u of r)(n_.has(u)||u==="array"&&s.coerceTypes==="array")&&c(u);n.else(),lp(e),n.endIf(),n.if((0,W._)`${a} !== undefined`,()=>{n.assign(o,a),pT(e,a)});function c(u){switch(u){case"string":n.elseIf((0,W._)`${i} == "number" || ${i} == "boolean"`).assign(a,(0,W._)`"" + ${o}`).elseIf((0,W._)`${o} === null`).assign(a,(0,W._)`""`);return;case"number":n.elseIf((0,W._)`${i} == "boolean" || ${o} === null
              || (${i} == "string" && ${o} && ${o} == +${o})`).assign(a,(0,W._)`+${o}`);return;case"integer":n.elseIf((0,W._)`${i} === "boolean" || ${o} === null
              || (${i} === "string" && ${o} && ${o} == +${o} && !(${o} % 1))`).assign(a,(0,W._)`+${o}`);return;case"boolean":n.elseIf((0,W._)`${o} === "false" || ${o} === 0 || ${o} === null`).assign(a,!1).elseIf((0,W._)`${o} === "true" || ${o} === 1`).assign(a,!0);return;case"null":n.elseIf((0,W._)`${o} === "" || ${o} === 0 || ${o} === false`),n.assign(a,null);return;case"array":n.elseIf((0,W._)`${i} === "string" || ${i} === "number"
              || ${i} === "boolean" || ${o} === null`).assign(a,(0,W._)`[${o}]`)}}}function pT({gen:e,parentData:t,parentDataProperty:r},n){e.if((0,W._)`${t} !== undefined`,()=>e.assign((0,W._)`${t}[${r}]`,n))}function cp(e,t,r,n=jn.Correct){let o=n===jn.Correct?W.operators.EQ:W.operators.NEQ,s;switch(e){case"null":return(0,W._)`${t} ${o} null`;case"array":s=(0,W._)`Array.isArray(${t})`;break;case"object":s=(0,W._)`${t} && typeof ${t} == "object" && !Array.isArray(${t})`;break;case"integer":s=i((0,W._)`!(${t} % 1) && !isNaN(${t})`);break;case"number":s=i();break;default:return(0,W._)`typeof ${t} ${o} ${e}`}return n===jn.Correct?s:(0,W.not)(s);function i(a=W.nil){return(0,W.and)((0,W._)`typeof ${t} == "number"`,a,r?(0,W._)`isFinite(${t})`:W.nil)}}Ve.checkDataType=cp;function up(e,t,r,n){if(e.length===1)return cp(e[0],t,r,n);let o,s=(0,t_.toHash)(e);if(s.array&&s.object){let i=(0,W._)`typeof ${t} != "object"`;o=s.null?i:(0,W._)`!${t} || ${i}`,delete s.null,delete s.array,delete s.object}else o=W.nil;s.number&&delete s.integer;for(let i in s)o=(0,W.and)(o,cp(i,t,r,n));return o}Ve.checkDataTypes=up;var fT={message:({schema:e})=>`must be ${e}`,params:({schema:e,schemaValue:t})=>typeof e=="string"?(0,W._)`{type: ${e}}`:(0,W._)`{type: ${t}}`};function lp(e){let t=mT(e);(0,aT.reportError)(t,fT)}Ve.reportTypeError=lp;function mT(e){let{gen:t,data:r,schema:n}=e,o=(0,t_.schemaRefOrVal)(e,n,"type");return{gen:t,keyword:"type",data:r,schema:n.type,schemaCode:o,schemaValue:o,parentSchema:n,params:{},it:e}}});var s_=P(ia=>{"use strict";Object.defineProperty(ia,"__esModule",{value:!0});ia.assignDefaults=void 0;var Mn=K(),hT=oe();function gT(e,t){let{properties:r,items:n}=e.schema;if(t==="object"&&r)for(let o in r)o_(e,o,r[o].default);else t==="array"&&Array.isArray(n)&&n.forEach((o,s)=>o_(e,s,o.default))}ia.assignDefaults=gT;function o_(e,t,r){let{gen:n,compositeRule:o,data:s,opts:i}=e;if(r===void 0)return;let a=(0,Mn._)`${s}${(0,Mn.getProperty)(t)}`;if(o){(0,hT.checkStrictMode)(e,`default is ignored for: ${a}`);return}let c=(0,Mn._)`${a} === undefined`;i.useDefaults==="empty"&&(c=(0,Mn._)`${c} || ${a} === null || ${a} === ""`),n.if(c,(0,Mn._)`${a} = ${(0,Mn.stringify)(r)}`)}});var bt=P(le=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0});le.validateUnion=le.validateArray=le.usePattern=le.callValidateCode=le.schemaProperties=le.allSchemaProperties=le.noPropertyInData=le.propertyInData=le.isOwnProperty=le.hasPropFunc=le.reportMissingProp=le.checkMissingProp=le.checkReportMissingProp=void 0;var ge=K(),dp=oe(),br=tr(),yT=oe();function _T(e,t){let{gen:r,data:n,it:o}=e;r.if(fp(r,n,t,o.opts.ownProperties),()=>{e.setParams({missingProperty:(0,ge._)`${t}`},!0),e.error()})}le.checkReportMissingProp=_T;function vT({gen:e,data:t,it:{opts:r}},n,o){return(0,ge.or)(...n.map(s=>(0,ge.and)(fp(e,t,s,r.ownProperties),(0,ge._)`${o} = ${s}`)))}le.checkMissingProp=vT;function bT(e,t){e.setParams({missingProperty:t},!0),e.error()}le.reportMissingProp=bT;function i_(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,ge._)`Object.prototype.hasOwnProperty`})}le.hasPropFunc=i_;function pp(e,t,r){return(0,ge._)`${i_(e)}.call(${t}, ${r})`}le.isOwnProperty=pp;function $T(e,t,r,n){let o=(0,ge._)`${t}${(0,ge.getProperty)(r)} !== undefined`;return n?(0,ge._)`${o} && ${pp(e,t,r)}`:o}le.propertyInData=$T;function fp(e,t,r,n){let o=(0,ge._)`${t}${(0,ge.getProperty)(r)} === undefined`;return n?(0,ge.or)(o,(0,ge.not)(pp(e,t,r))):o}le.noPropertyInData=fp;function a_(e){return e?Object.keys(e).filter(t=>t!=="__proto__"):[]}le.allSchemaProperties=a_;function xT(e,t){return a_(t).filter(r=>!(0,dp.alwaysValidSchema)(e,t[r]))}le.schemaProperties=xT;function wT({schemaCode:e,data:t,it:{gen:r,topSchemaRef:n,schemaPath:o,errorPath:s},it:i},a,c,u){let d=u?(0,ge._)`${e}, ${t}, ${n}${o}`:t,l=[[br.default.instancePath,(0,ge.strConcat)(br.default.instancePath,s)],[br.default.parentData,i.parentData],[br.default.parentDataProperty,i.parentDataProperty],[br.default.rootData,br.default.rootData]];i.opts.dynamicRef&&l.push([br.default.dynamicAnchors,br.default.dynamicAnchors]);let m=(0,ge._)`${d}, ${r.object(...l)}`;return c!==ge.nil?(0,ge._)`${a}.call(${c}, ${m})`:(0,ge._)`${a}(${m})`}le.callValidateCode=wT;var kT=(0,ge._)`new RegExp`;function ST({gen:e,it:{opts:t}},r){let n=t.unicodeRegExp?"u":"",{regExp:o}=t.code,s=o(r,n);return e.scopeValue("pattern",{key:s.toString(),ref:s,code:(0,ge._)`${o.code==="new RegExp"?kT:(0,yT.useFunc)(e,o)}(${r}, ${n})`})}le.usePattern=ST;function TT(e){let{gen:t,data:r,keyword:n,it:o}=e,s=t.name("valid");if(o.allErrors){let a=t.let("valid",!0);return i(()=>t.assign(a,!1)),a}return t.var(s,!0),i(()=>t.break()),s;function i(a){let c=t.const("len",(0,ge._)`${r}.length`);t.forRange("i",0,c,u=>{e.subschema({keyword:n,dataProp:u,dataPropType:dp.Type.Num},s),t.if((0,ge.not)(s),a)})}}le.validateArray=TT;function ET(e){let{gen:t,schema:r,keyword:n,it:o}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(c=>(0,dp.alwaysValidSchema)(o,c))&&!o.opts.unevaluated)return;let i=t.let("valid",!1),a=t.name("_valid");t.block(()=>r.forEach((c,u)=>{let d=e.subschema({keyword:n,schemaProp:u,compositeRule:!0},a);t.assign(i,(0,ge._)`${i} || ${a}`),e.mergeValidEvaluated(d,a)||t.if((0,ge.not)(i))})),e.result(i,()=>e.reset(),()=>e.error(!0))}le.validateUnion=ET});var l_=P(Dt=>{"use strict";Object.defineProperty(Dt,"__esModule",{value:!0});Dt.validateKeywordUsage=Dt.validSchemaType=Dt.funcKeywordCode=Dt.macroKeywordCode=void 0;var Ke=K(),on=tr(),zT=bt(),PT=qo();function IT(e,t){let{gen:r,keyword:n,schema:o,parentSchema:s,it:i}=e,a=t.macro.call(i.self,o,s,i),c=u_(r,n,a);i.opts.validateSchema!==!1&&i.self.validateSchema(a,!0);let u=r.name("valid");e.subschema({schema:a,schemaPath:Ke.nil,errSchemaPath:`${i.errSchemaPath}/${n}`,topSchemaRef:c,compositeRule:!0},u),e.pass(u,()=>e.error(!0))}Dt.macroKeywordCode=IT;function RT(e,t){var r;let{gen:n,keyword:o,schema:s,parentSchema:i,$data:a,it:c}=e;OT(c,t);let u=!a&&t.compile?t.compile.call(c.self,s,i,c):t.validate,d=u_(n,o,u),l=n.let("valid");e.block$data(l,m),e.ok((r=t.valid)!==null&&r!==void 0?r:l);function m(){if(t.errors===!1)f(),t.modifying&&c_(e),g(()=>e.error());else{let y=t.async?h():p();t.modifying&&c_(e),g(()=>CT(e,y))}}function h(){let y=n.let("ruleErrs",null);return n.try(()=>f((0,Ke._)`await `),v=>n.assign(l,!1).if((0,Ke._)`${v} instanceof ${c.ValidationError}`,()=>n.assign(y,(0,Ke._)`${v}.errors`),()=>n.throw(v))),y}function p(){let y=(0,Ke._)`${d}.errors`;return n.assign(y,null),f(Ke.nil),y}function f(y=t.async?(0,Ke._)`await `:Ke.nil){let v=c.opts.passContext?on.default.this:on.default.self,_=!("compile"in t&&!a||t.schema===!1);n.assign(l,(0,Ke._)`${y}${(0,zT.callValidateCode)(e,d,v,_)}`,t.modifying)}function g(y){var v;n.if((0,Ke.not)((v=t.valid)!==null&&v!==void 0?v:l),y)}}Dt.funcKeywordCode=RT;function c_(e){let{gen:t,data:r,it:n}=e;t.if(n.parentData,()=>t.assign(r,(0,Ke._)`${n.parentData}[${n.parentDataProperty}]`))}function CT(e,t){let{gen:r}=e;r.if((0,Ke._)`Array.isArray(${t})`,()=>{r.assign(on.default.vErrors,(0,Ke._)`${on.default.vErrors} === null ? ${t} : ${on.default.vErrors}.concat(${t})`).assign(on.default.errors,(0,Ke._)`${on.default.vErrors}.length`),(0,PT.extendErrors)(e)},()=>e.error())}function OT({schemaEnv:e},t){if(t.async&&!e.$async)throw new Error("async keyword in sync schema")}function u_(e,t,r){if(r===void 0)throw new Error(`keyword "${t}" failed to compile`);return e.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,Ke.stringify)(r)})}function NT(e,t,r=!1){return!t.length||t.some(n=>n==="array"?Array.isArray(e):n==="object"?e&&typeof e=="object"&&!Array.isArray(e):typeof e==n||r&&typeof e>"u")}Dt.validSchemaType=NT;function AT({schema:e,opts:t,self:r,errSchemaPath:n},o,s){if(Array.isArray(o.keyword)?!o.keyword.includes(s):o.keyword!==s)throw new Error("ajv implementation error");let i=o.dependencies;if(i?.some(a=>!Object.prototype.hasOwnProperty.call(e,a)))throw new Error(`parent schema must have dependencies of ${s}: ${i.join(",")}`);if(o.validateSchema&&!o.validateSchema(e[s])){let c=`keyword "${s}" value is invalid at path "${n}": `+r.errorsText(o.validateSchema.errors);if(t.validateSchema==="log")r.logger.error(c);else throw new Error(c)}}Dt.validateKeywordUsage=AT});var p_=P($r=>{"use strict";Object.defineProperty($r,"__esModule",{value:!0});$r.extendSubschemaMode=$r.extendSubschemaData=$r.getSubschema=void 0;var qt=K(),d_=oe();function jT(e,{keyword:t,schemaProp:r,schema:n,schemaPath:o,errSchemaPath:s,topSchemaRef:i}){if(t!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(t!==void 0){let a=e.schema[t];return r===void 0?{schema:a,schemaPath:(0,qt._)`${e.schemaPath}${(0,qt.getProperty)(t)}`,errSchemaPath:`${e.errSchemaPath}/${t}`}:{schema:a[r],schemaPath:(0,qt._)`${e.schemaPath}${(0,qt.getProperty)(t)}${(0,qt.getProperty)(r)}`,errSchemaPath:`${e.errSchemaPath}/${t}/${(0,d_.escapeFragment)(r)}`}}if(n!==void 0){if(o===void 0||s===void 0||i===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:o,topSchemaRef:i,errSchemaPath:s}}throw new Error('either "keyword" or "schema" must be passed')}$r.getSubschema=jT;function MT(e,t,{dataProp:r,dataPropType:n,data:o,dataTypes:s,propertyName:i}){if(o!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');let{gen:a}=t;if(r!==void 0){let{errorPath:u,dataPathArr:d,opts:l}=t,m=a.let("data",(0,qt._)`${t.data}${(0,qt.getProperty)(r)}`,!0);c(m),e.errorPath=(0,qt.str)`${u}${(0,d_.getErrorPath)(r,n,l.jsPropertySyntax)}`,e.parentDataProperty=(0,qt._)`${r}`,e.dataPathArr=[...d,e.parentDataProperty]}if(o!==void 0){let u=o instanceof qt.Name?o:a.let("data",o,!0);c(u),i!==void 0&&(e.propertyName=i)}s&&(e.dataTypes=s);function c(u){e.data=u,e.dataLevel=t.dataLevel+1,e.dataTypes=[],t.definedProperties=new Set,e.parentData=t.data,e.dataNames=[...t.dataNames,u]}}$r.extendSubschemaData=MT;function ZT(e,{jtdDiscriminator:t,jtdMetadata:r,compositeRule:n,createErrors:o,allErrors:s}){n!==void 0&&(e.compositeRule=n),o!==void 0&&(e.createErrors=o),s!==void 0&&(e.allErrors=s),e.jtdDiscriminator=t,e.jtdMetadata=r}$r.extendSubschemaMode=ZT});var mp=P((qA,f_)=>{"use strict";f_.exports=function e(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var n,o,s;if(Array.isArray(t)){if(n=t.length,n!=r.length)return!1;for(o=n;o--!==0;)if(!e(t[o],r[o]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(s=Object.keys(t),n=s.length,n!==Object.keys(r).length)return!1;for(o=n;o--!==0;)if(!Object.prototype.hasOwnProperty.call(r,s[o]))return!1;for(o=n;o--!==0;){var i=s[o];if(!e(t[i],r[i]))return!1}return!0}return t!==t&&r!==r}});var h_=P((FA,m_)=>{"use strict";var xr=m_.exports=function(e,t,r){typeof t=="function"&&(r=t,t={}),r=t.cb||r;var n=typeof r=="function"?r:r.pre||function(){},o=r.post||function(){};aa(t,n,o,e,"",e)};xr.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};xr.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};xr.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};xr.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function aa(e,t,r,n,o,s,i,a,c,u){if(n&&typeof n=="object"&&!Array.isArray(n)){t(n,o,s,i,a,c,u);for(var d in n){var l=n[d];if(Array.isArray(l)){if(d in xr.arrayKeywords)for(var m=0;m<l.length;m++)aa(e,t,r,l[m],o+"/"+d+"/"+m,s,o,d,n,m)}else if(d in xr.propsKeywords){if(l&&typeof l=="object")for(var h in l)aa(e,t,r,l[h],o+"/"+d+"/"+LT(h),s,o,d,n,h)}else(d in xr.keywords||e.allKeys&&!(d in xr.skipKeywords))&&aa(e,t,r,l,o+"/"+d,s,o,d,n)}r(n,o,s,i,a,c,u)}}function LT(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}});var Uo=P(ot=>{"use strict";Object.defineProperty(ot,"__esModule",{value:!0});ot.getSchemaRefs=ot.resolveUrl=ot.normalizeId=ot._getFullPath=ot.getFullPath=ot.inlineRef=void 0;var DT=oe(),qT=mp(),FT=h_(),UT=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function VT(e,t=!0){return typeof e=="boolean"?!0:t===!0?!hp(e):t?g_(e)<=t:!1}ot.inlineRef=VT;var BT=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function hp(e){for(let t in e){if(BT.has(t))return!0;let r=e[t];if(Array.isArray(r)&&r.some(hp)||typeof r=="object"&&hp(r))return!0}return!1}function g_(e){let t=0;for(let r in e){if(r==="$ref")return 1/0;if(t++,!UT.has(r)&&(typeof e[r]=="object"&&(0,DT.eachItem)(e[r],n=>t+=g_(n)),t===1/0))return 1/0}return t}function y_(e,t="",r){r!==!1&&(t=Zn(t));let n=e.parse(t);return __(e,n)}ot.getFullPath=y_;function __(e,t){return e.serialize(t).split("#")[0]+"#"}ot._getFullPath=__;var HT=/#\/?$/;function Zn(e){return e?e.replace(HT,""):""}ot.normalizeId=Zn;function WT(e,t,r){return r=Zn(r),e.resolve(t,r)}ot.resolveUrl=WT;var GT=/^[a-z_][-a-z0-9._]*$/i;function KT(e,t){if(typeof e=="boolean")return{};let{schemaId:r,uriResolver:n}=this.opts,o=Zn(e[r]||t),s={"":o},i=y_(n,o,!1),a={},c=new Set;return FT(e,{allKeys:!0},(l,m,h,p)=>{if(p===void 0)return;let f=i+m,g=s[p];typeof l[r]=="string"&&(g=y.call(this,l[r])),v.call(this,l.$anchor),v.call(this,l.$dynamicAnchor),s[m]=g;function y(_){let w=this.opts.uriResolver.resolve;if(_=Zn(g?w(g,_):_),c.has(_))throw d(_);c.add(_);let E=this.refs[_];return typeof E=="string"&&(E=this.refs[E]),typeof E=="object"?u(l,E.schema,_):_!==Zn(f)&&(_[0]==="#"?(u(l,a[_],_),a[_]=l):this.refs[_]=f),_}function v(_){if(typeof _=="string"){if(!GT.test(_))throw new Error(`invalid anchor "${_}"`);y.call(this,`#${_}`)}}}),a;function u(l,m,h){if(m!==void 0&&!qT(l,m))throw d(h)}function d(l){return new Error(`reference "${l}" resolves to more than one schema`)}}ot.getSchemaRefs=KT});var Ho=P(wr=>{"use strict";Object.defineProperty(wr,"__esModule",{value:!0});wr.getData=wr.KeywordCxt=wr.validateFunctionCode=void 0;var w_=Xy(),v_=Fo(),yp=ap(),ca=Fo(),JT=s_(),Bo=l_(),gp=p_(),L=K(),V=tr(),YT=Uo(),rr=oe(),Vo=qo();function XT(e){if(T_(e)&&(E_(e),S_(e))){tE(e);return}k_(e,()=>(0,w_.topBoolOrEmptySchema)(e))}wr.validateFunctionCode=XT;function k_({gen:e,validateName:t,schema:r,schemaEnv:n,opts:o},s){o.code.es5?e.func(t,(0,L._)`${V.default.data}, ${V.default.valCxt}`,n.$async,()=>{e.code((0,L._)`"use strict"; ${b_(r,o)}`),eE(e,o),e.code(s)}):e.func(t,(0,L._)`${V.default.data}, ${QT(o)}`,n.$async,()=>e.code(b_(r,o)).code(s))}function QT(e){return(0,L._)`{${V.default.instancePath}="", ${V.default.parentData}, ${V.default.parentDataProperty}, ${V.default.rootData}=${V.default.data}${e.dynamicRef?(0,L._)`, ${V.default.dynamicAnchors}={}`:L.nil}}={}`}function eE(e,t){e.if(V.default.valCxt,()=>{e.var(V.default.instancePath,(0,L._)`${V.default.valCxt}.${V.default.instancePath}`),e.var(V.default.parentData,(0,L._)`${V.default.valCxt}.${V.default.parentData}`),e.var(V.default.parentDataProperty,(0,L._)`${V.default.valCxt}.${V.default.parentDataProperty}`),e.var(V.default.rootData,(0,L._)`${V.default.valCxt}.${V.default.rootData}`),t.dynamicRef&&e.var(V.default.dynamicAnchors,(0,L._)`${V.default.valCxt}.${V.default.dynamicAnchors}`)},()=>{e.var(V.default.instancePath,(0,L._)`""`),e.var(V.default.parentData,(0,L._)`undefined`),e.var(V.default.parentDataProperty,(0,L._)`undefined`),e.var(V.default.rootData,V.default.data),t.dynamicRef&&e.var(V.default.dynamicAnchors,(0,L._)`{}`)})}function tE(e){let{schema:t,opts:r,gen:n}=e;k_(e,()=>{r.$comment&&t.$comment&&P_(e),iE(e),n.let(V.default.vErrors,null),n.let(V.default.errors,0),r.unevaluated&&rE(e),z_(e),uE(e)})}function rE(e){let{gen:t,validateName:r}=e;e.evaluated=t.const("evaluated",(0,L._)`${r}.evaluated`),t.if((0,L._)`${e.evaluated}.dynamicProps`,()=>t.assign((0,L._)`${e.evaluated}.props`,(0,L._)`undefined`)),t.if((0,L._)`${e.evaluated}.dynamicItems`,()=>t.assign((0,L._)`${e.evaluated}.items`,(0,L._)`undefined`))}function b_(e,t){let r=typeof e=="object"&&e[t.schemaId];return r&&(t.code.source||t.code.process)?(0,L._)`/*# sourceURL=${r} */`:L.nil}function nE(e,t){if(T_(e)&&(E_(e),S_(e))){oE(e,t);return}(0,w_.boolOrEmptySchema)(e,t)}function S_({schema:e,self:t}){if(typeof e=="boolean")return!e;for(let r in e)if(t.RULES.all[r])return!0;return!1}function T_(e){return typeof e.schema!="boolean"}function oE(e,t){let{schema:r,gen:n,opts:o}=e;o.$comment&&r.$comment&&P_(e),aE(e),cE(e);let s=n.const("_errs",V.default.errors);z_(e,s),n.var(t,(0,L._)`${s} === ${V.default.errors}`)}function E_(e){(0,rr.checkUnknownRules)(e),sE(e)}function z_(e,t){if(e.opts.jtd)return $_(e,[],!1,t);let r=(0,v_.getSchemaTypes)(e.schema),n=(0,v_.coerceAndCheckDataType)(e,r);$_(e,r,!n,t)}function sE(e){let{schema:t,errSchemaPath:r,opts:n,self:o}=e;t.$ref&&n.ignoreKeywordsWithRef&&(0,rr.schemaHasRulesButRef)(t,o.RULES)&&o.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function iE(e){let{schema:t,opts:r}=e;t.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,rr.checkStrictMode)(e,"default is ignored in the schema root")}function aE(e){let t=e.schema[e.opts.schemaId];t&&(e.baseId=(0,YT.resolveUrl)(e.opts.uriResolver,e.baseId,t))}function cE(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}function P_({gen:e,schemaEnv:t,schema:r,errSchemaPath:n,opts:o}){let s=r.$comment;if(o.$comment===!0)e.code((0,L._)`${V.default.self}.logger.log(${s})`);else if(typeof o.$comment=="function"){let i=(0,L.str)`${n}/$comment`,a=e.scopeValue("root",{ref:t.root});e.code((0,L._)`${V.default.self}.opts.$comment(${s}, ${i}, ${a}.schema)`)}}function uE(e){let{gen:t,schemaEnv:r,validateName:n,ValidationError:o,opts:s}=e;r.$async?t.if((0,L._)`${V.default.errors} === 0`,()=>t.return(V.default.data),()=>t.throw((0,L._)`new ${o}(${V.default.vErrors})`)):(t.assign((0,L._)`${n}.errors`,V.default.vErrors),s.unevaluated&&lE(e),t.return((0,L._)`${V.default.errors} === 0`))}function lE({gen:e,evaluated:t,props:r,items:n}){r instanceof L.Name&&e.assign((0,L._)`${t}.props`,r),n instanceof L.Name&&e.assign((0,L._)`${t}.items`,n)}function $_(e,t,r,n){let{gen:o,schema:s,data:i,allErrors:a,opts:c,self:u}=e,{RULES:d}=u;if(s.$ref&&(c.ignoreKeywordsWithRef||!(0,rr.schemaHasRulesButRef)(s,d))){o.block(()=>R_(e,"$ref",d.all.$ref.definition));return}c.jtd||dE(e,t),o.block(()=>{for(let m of d.rules)l(m);l(d.post)});function l(m){(0,yp.shouldUseGroup)(s,m)&&(m.type?(o.if((0,ca.checkDataType)(m.type,i,c.strictNumbers)),x_(e,m),t.length===1&&t[0]===m.type&&r&&(o.else(),(0,ca.reportTypeError)(e)),o.endIf()):x_(e,m),a||o.if((0,L._)`${V.default.errors} === ${n||0}`))}}function x_(e,t){let{gen:r,schema:n,opts:{useDefaults:o}}=e;o&&(0,JT.assignDefaults)(e,t.type),r.block(()=>{for(let s of t.rules)(0,yp.shouldUseRule)(n,s)&&R_(e,s.keyword,s.definition,t.type)})}function dE(e,t){e.schemaEnv.meta||!e.opts.strictTypes||(pE(e,t),e.opts.allowUnionTypes||fE(e,t),mE(e,e.dataTypes))}function pE(e,t){if(t.length){if(!e.dataTypes.length){e.dataTypes=t;return}t.forEach(r=>{I_(e.dataTypes,r)||_p(e,`type "${r}" not allowed by context "${e.dataTypes.join(",")}"`)}),gE(e,t)}}function fE(e,t){t.length>1&&!(t.length===2&&t.includes("null"))&&_p(e,"use allowUnionTypes to allow union type keyword")}function mE(e,t){let r=e.self.RULES.all;for(let n in r){let o=r[n];if(typeof o=="object"&&(0,yp.shouldUseRule)(e.schema,o)){let{type:s}=o.definition;s.length&&!s.some(i=>hE(t,i))&&_p(e,`missing type "${s.join(",")}" for keyword "${n}"`)}}}function hE(e,t){return e.includes(t)||t==="number"&&e.includes("integer")}function I_(e,t){return e.includes(t)||t==="integer"&&e.includes("number")}function gE(e,t){let r=[];for(let n of e.dataTypes)I_(t,n)?r.push(n):t.includes("integer")&&n==="number"&&r.push("integer");e.dataTypes=r}function _p(e,t){let r=e.schemaEnv.baseId+e.errSchemaPath;t+=` at "${r}" (strictTypes)`,(0,rr.checkStrictMode)(e,t,e.opts.strictTypes)}var ua=class{constructor(t,r,n){if((0,Bo.validateKeywordUsage)(t,r,n),this.gen=t.gen,this.allErrors=t.allErrors,this.keyword=n,this.data=t.data,this.schema=t.schema[n],this.$data=r.$data&&t.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,rr.schemaRefOrVal)(t,this.schema,n,this.$data),this.schemaType=r.schemaType,this.parentSchema=t.schema,this.params={},this.it=t,this.def=r,this.$data)this.schemaCode=t.gen.const("vSchema",C_(this.$data,t));else if(this.schemaCode=this.schemaValue,!(0,Bo.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=t.gen.const("_errs",V.default.errors))}result(t,r,n){this.failResult((0,L.not)(t),r,n)}failResult(t,r,n){this.gen.if(t),n?n():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(t,r){this.failResult((0,L.not)(t),void 0,r)}fail(t){if(t===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(t),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(t){if(!this.$data)return this.fail(t);let{schemaCode:r}=this;this.fail((0,L._)`${r} !== undefined && (${(0,L.or)(this.invalid$data(),t)})`)}error(t,r,n){if(r){this.setParams(r),this._error(t,n),this.setParams({});return}this._error(t,n)}_error(t,r){(t?Vo.reportExtraError:Vo.reportError)(this,this.def.error,r)}$dataError(){(0,Vo.reportError)(this,this.def.$dataError||Vo.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,Vo.resetErrorsCount)(this.gen,this.errsCount)}ok(t){this.allErrors||this.gen.if(t)}setParams(t,r){r?Object.assign(this.params,t):this.params=t}block$data(t,r,n=L.nil){this.gen.block(()=>{this.check$data(t,n),r()})}check$data(t=L.nil,r=L.nil){if(!this.$data)return;let{gen:n,schemaCode:o,schemaType:s,def:i}=this;n.if((0,L.or)((0,L._)`${o} === undefined`,r)),t!==L.nil&&n.assign(t,!0),(s.length||i.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),t!==L.nil&&n.assign(t,!1)),n.else()}invalid$data(){let{gen:t,schemaCode:r,schemaType:n,def:o,it:s}=this;return(0,L.or)(i(),a());function i(){if(n.length){if(!(r instanceof L.Name))throw new Error("ajv implementation error");let c=Array.isArray(n)?n:[n];return(0,L._)`${(0,ca.checkDataTypes)(c,r,s.opts.strictNumbers,ca.DataType.Wrong)}`}return L.nil}function a(){if(o.validateSchema){let c=t.scopeValue("validate$data",{ref:o.validateSchema});return(0,L._)`!${c}(${r})`}return L.nil}}subschema(t,r){let n=(0,gp.getSubschema)(this.it,t);(0,gp.extendSubschemaData)(n,this.it,t),(0,gp.extendSubschemaMode)(n,t);let o={...this.it,...n,items:void 0,props:void 0};return nE(o,r),o}mergeEvaluated(t,r){let{it:n,gen:o}=this;n.opts.unevaluated&&(n.props!==!0&&t.props!==void 0&&(n.props=rr.mergeEvaluated.props(o,t.props,n.props,r)),n.items!==!0&&t.items!==void 0&&(n.items=rr.mergeEvaluated.items(o,t.items,n.items,r)))}mergeValidEvaluated(t,r){let{it:n,gen:o}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return o.if(r,()=>this.mergeEvaluated(t,L.Name)),!0}};wr.KeywordCxt=ua;function R_(e,t,r,n){let o=new ua(e,r,t);"code"in r?r.code(o,n):o.$data&&r.validate?(0,Bo.funcKeywordCode)(o,r):"macro"in r?(0,Bo.macroKeywordCode)(o,r):(r.compile||r.validate)&&(0,Bo.funcKeywordCode)(o,r)}var yE=/^\/(?:[^~]|~0|~1)*$/,_E=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function C_(e,{dataLevel:t,dataNames:r,dataPathArr:n}){let o,s;if(e==="")return V.default.rootData;if(e[0]==="/"){if(!yE.test(e))throw new Error(`Invalid JSON-pointer: ${e}`);o=e,s=V.default.rootData}else{let u=_E.exec(e);if(!u)throw new Error(`Invalid JSON-pointer: ${e}`);let d=+u[1];if(o=u[2],o==="#"){if(d>=t)throw new Error(c("property/index",d));return n[t-d]}if(d>t)throw new Error(c("data",d));if(s=r[t-d],!o)return s}let i=s,a=o.split("/");for(let u of a)u&&(s=(0,L._)`${s}${(0,L.getProperty)((0,rr.unescapeJsonPointer)(u))}`,i=(0,L._)`${i} && ${s}`);return i;function c(u,d){return`Cannot access ${u} ${d} levels up, current level is ${t}`}}wr.getData=C_});var la=P(bp=>{"use strict";Object.defineProperty(bp,"__esModule",{value:!0});var vp=class extends Error{constructor(t){super("validation failed"),this.errors=t,this.ajv=this.validation=!0}};bp.default=vp});var Wo=P(wp=>{"use strict";Object.defineProperty(wp,"__esModule",{value:!0});var $p=Uo(),xp=class extends Error{constructor(t,r,n,o){super(o||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,$p.resolveUrl)(t,r,n),this.missingSchema=(0,$p.normalizeId)((0,$p.getFullPath)(t,this.missingRef))}};wp.default=xp});var pa=P($t=>{"use strict";Object.defineProperty($t,"__esModule",{value:!0});$t.resolveSchema=$t.getCompilingSchema=$t.resolveRef=$t.compileSchema=$t.SchemaEnv=void 0;var zt=K(),vE=la(),sn=tr(),Pt=Uo(),O_=oe(),bE=Ho(),Ln=class{constructor(t){var r;this.refs={},this.dynamicAnchors={};let n;typeof t.schema=="object"&&(n=t.schema),this.schema=t.schema,this.schemaId=t.schemaId,this.root=t.root||this,this.baseId=(r=t.baseId)!==null&&r!==void 0?r:(0,Pt.normalizeId)(n?.[t.schemaId||"$id"]),this.schemaPath=t.schemaPath,this.localRefs=t.localRefs,this.meta=t.meta,this.$async=n?.$async,this.refs={}}};$t.SchemaEnv=Ln;function Sp(e){let t=N_.call(this,e);if(t)return t;let r=(0,Pt.getFullPath)(this.opts.uriResolver,e.root.baseId),{es5:n,lines:o}=this.opts.code,{ownProperties:s}=this.opts,i=new zt.CodeGen(this.scope,{es5:n,lines:o,ownProperties:s}),a;e.$async&&(a=i.scopeValue("Error",{ref:vE.default,code:(0,zt._)`require("ajv/dist/runtime/validation_error").default`}));let c=i.scopeName("validate");e.validateName=c;let u={gen:i,allErrors:this.opts.allErrors,data:sn.default.data,parentData:sn.default.parentData,parentDataProperty:sn.default.parentDataProperty,dataNames:[sn.default.data],dataPathArr:[zt.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:i.scopeValue("schema",this.opts.code.source===!0?{ref:e.schema,code:(0,zt.stringify)(e.schema)}:{ref:e.schema}),validateName:c,ValidationError:a,schema:e.schema,schemaEnv:e,rootId:r,baseId:e.baseId||r,schemaPath:zt.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,zt._)`""`,opts:this.opts,self:this},d;try{this._compilations.add(e),(0,bE.validateFunctionCode)(u),i.optimize(this.opts.code.optimize);let l=i.toString();d=`${i.scopeRefs(sn.default.scope)}return ${l}`,this.opts.code.process&&(d=this.opts.code.process(d,e));let h=new Function(`${sn.default.self}`,`${sn.default.scope}`,d)(this,this.scope.get());if(this.scope.value(c,{ref:h}),h.errors=null,h.schema=e.schema,h.schemaEnv=e,e.$async&&(h.$async=!0),this.opts.code.source===!0&&(h.source={validateName:c,validateCode:l,scopeValues:i._values}),this.opts.unevaluated){let{props:p,items:f}=u;h.evaluated={props:p instanceof zt.Name?void 0:p,items:f instanceof zt.Name?void 0:f,dynamicProps:p instanceof zt.Name,dynamicItems:f instanceof zt.Name},h.source&&(h.source.evaluated=(0,zt.stringify)(h.evaluated))}return e.validate=h,e}catch(l){throw delete e.validate,delete e.validateName,d&&this.logger.error("Error compiling schema, function code:",d),l}finally{this._compilations.delete(e)}}$t.compileSchema=Sp;function $E(e,t,r){var n;r=(0,Pt.resolveUrl)(this.opts.uriResolver,t,r);let o=e.refs[r];if(o)return o;let s=kE.call(this,e,r);if(s===void 0){let i=(n=e.localRefs)===null||n===void 0?void 0:n[r],{schemaId:a}=this.opts;i&&(s=new Ln({schema:i,schemaId:a,root:e,baseId:t}))}if(s!==void 0)return e.refs[r]=xE.call(this,s)}$t.resolveRef=$E;function xE(e){return(0,Pt.inlineRef)(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:Sp.call(this,e)}function N_(e){for(let t of this._compilations)if(wE(t,e))return t}$t.getCompilingSchema=N_;function wE(e,t){return e.schema===t.schema&&e.root===t.root&&e.baseId===t.baseId}function kE(e,t){let r;for(;typeof(r=this.refs[t])=="string";)t=r;return r||this.schemas[t]||da.call(this,e,t)}function da(e,t){let r=this.opts.uriResolver.parse(t),n=(0,Pt._getFullPath)(this.opts.uriResolver,r),o=(0,Pt.getFullPath)(this.opts.uriResolver,e.baseId,void 0);if(Object.keys(e.schema).length>0&&n===o)return kp.call(this,r,e);let s=(0,Pt.normalizeId)(n),i=this.refs[s]||this.schemas[s];if(typeof i=="string"){let a=da.call(this,e,i);return typeof a?.schema!="object"?void 0:kp.call(this,r,a)}if(typeof i?.schema=="object"){if(i.validate||Sp.call(this,i),s===(0,Pt.normalizeId)(t)){let{schema:a}=i,{schemaId:c}=this.opts,u=a[c];return u&&(o=(0,Pt.resolveUrl)(this.opts.uriResolver,o,u)),new Ln({schema:a,schemaId:c,root:e,baseId:o})}return kp.call(this,r,i)}}$t.resolveSchema=da;var SE=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function kp(e,{baseId:t,schema:r,root:n}){var o;if(((o=e.fragment)===null||o===void 0?void 0:o[0])!=="/")return;for(let a of e.fragment.slice(1).split("/")){if(typeof r=="boolean")return;let c=r[(0,O_.unescapeFragment)(a)];if(c===void 0)return;r=c;let u=typeof r=="object"&&r[this.opts.schemaId];!SE.has(a)&&u&&(t=(0,Pt.resolveUrl)(this.opts.uriResolver,t,u))}let s;if(typeof r!="boolean"&&r.$ref&&!(0,O_.schemaHasRulesButRef)(r,this.RULES)){let a=(0,Pt.resolveUrl)(this.opts.uriResolver,t,r.$ref);s=da.call(this,n,a)}let{schemaId:i}=this.opts;if(s=s||new Ln({schema:r,schemaId:i,root:n,baseId:t}),s.schema!==s.root.schema)return s}});var A_=P((GA,TE)=>{TE.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var Ep=P((KA,L_)=>{"use strict";var EE=RegExp.prototype.test.bind(/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu),M_=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u);function Tp(e){let t="",r=0,n=0;for(n=0;n<e.length;n++)if(r=e[n].charCodeAt(0),r!==48){if(!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";t+=e[n];break}for(n+=1;n<e.length;n++){if(r=e[n].charCodeAt(0),!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";t+=e[n]}return t}var zE=RegExp.prototype.test.bind(/[^!"$&'()*+,\-.;=_`a-z{}~]/u);function j_(e){return e.length=0,!0}function PE(e,t,r){if(e.length){let n=Tp(e);if(n!=="")t.push(n);else return r.error=!0,!1;e.length=0}return!0}function IE(e){let t=0,r={error:!1,address:"",zone:""},n=[],o=[],s=!1,i=!1,a=PE;for(let c=0;c<e.length;c++){let u=e[c];if(!(u==="["||u==="]"))if(u===":"){if(s===!0&&(i=!0),!a(o,n,r))break;if(++t>7){r.error=!0;break}c>0&&e[c-1]===":"&&(s=!0),n.push(":");continue}else if(u==="%"){if(!a(o,n,r))break;a=j_}else{o.push(u);continue}}return o.length&&(a===j_?r.zone=o.join(""):i?n.push(o.join("")):n.push(Tp(o))),r.address=n.join(""),r}function Z_(e){if(RE(e,":")<2)return{host:e,isIPV6:!1};let t=IE(e);if(t.error)return{host:e,isIPV6:!1};{let r=t.address,n=t.address;return t.zone&&(r+="%"+t.zone,n+="%25"+t.zone),{host:r,isIPV6:!0,escapedHost:n}}}function RE(e,t){let r=0;for(let n=0;n<e.length;n++)e[n]===t&&r++;return r}function CE(e){let t=e,r=[],n=-1,o=0;for(;o=t.length;){if(o===1){if(t===".")break;if(t==="/"){r.push("/");break}else{r.push(t);break}}else if(o===2){if(t[0]==="."){if(t[1]===".")break;if(t[1]==="/"){t=t.slice(2);continue}}else if(t[0]==="/"&&(t[1]==="."||t[1]==="/")){r.push("/");break}}else if(o===3&&t==="/.."){r.length!==0&&r.pop(),r.push("/");break}if(t[0]==="."){if(t[1]==="."){if(t[2]==="/"){t=t.slice(3);continue}}else if(t[1]==="/"){t=t.slice(2);continue}}else if(t[0]==="/"&&t[1]==="."){if(t[2]==="/"){t=t.slice(2);continue}else if(t[2]==="."&&t[3]==="/"){t=t.slice(3),r.length!==0&&r.pop();continue}}if((n=t.indexOf("/",1))===-1){r.push(t);break}else r.push(t.slice(0,n)),t=t.slice(n)}return r.join("")}function OE(e,t){let r=t!==!0?escape:unescape;return e.scheme!==void 0&&(e.scheme=r(e.scheme)),e.userinfo!==void 0&&(e.userinfo=r(e.userinfo)),e.host!==void 0&&(e.host=r(e.host)),e.path!==void 0&&(e.path=r(e.path)),e.query!==void 0&&(e.query=r(e.query)),e.fragment!==void 0&&(e.fragment=r(e.fragment)),e}function NE(e){let t=[];if(e.userinfo!==void 0&&(t.push(e.userinfo),t.push("@")),e.host!==void 0){let r=unescape(e.host);if(!M_(r)){let n=Z_(r);n.isIPV6===!0?r=`[${n.escapedHost}]`:r=e.host}t.push(r)}return(typeof e.port=="number"||typeof e.port=="string")&&(t.push(":"),t.push(String(e.port))),t.length?t.join(""):void 0}L_.exports={nonSimpleDomain:zE,recomposeAuthority:NE,normalizeComponentEncoding:OE,removeDotSegments:CE,isIPv4:M_,isUUID:EE,normalizeIPv6:Z_,stringArrayToHexStripped:Tp}});var V_=P((JA,U_)=>{"use strict";var{isUUID:AE}=Ep(),jE=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu,ME=["http","https","ws","wss","urn","urn:uuid"];function ZE(e){return ME.indexOf(e)!==-1}function zp(e){return e.secure===!0?!0:e.secure===!1?!1:e.scheme?e.scheme.length===3&&(e.scheme[0]==="w"||e.scheme[0]==="W")&&(e.scheme[1]==="s"||e.scheme[1]==="S")&&(e.scheme[2]==="s"||e.scheme[2]==="S"):!1}function D_(e){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e}function q_(e){let t=String(e.scheme).toLowerCase()==="https";return(e.port===(t?443:80)||e.port==="")&&(e.port=void 0),e.path||(e.path="/"),e}function LE(e){return e.secure=zp(e),e.resourceName=(e.path||"/")+(e.query?"?"+e.query:""),e.path=void 0,e.query=void 0,e}function DE(e){if((e.port===(zp(e)?443:80)||e.port==="")&&(e.port=void 0),typeof e.secure=="boolean"&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){let[t,r]=e.resourceName.split("?");e.path=t&&t!=="/"?t:void 0,e.query=r,e.resourceName=void 0}return e.fragment=void 0,e}function qE(e,t){if(!e.path)return e.error="URN can not be parsed",e;let r=e.path.match(jE);if(r){let n=t.scheme||e.scheme||"urn";e.nid=r[1].toLowerCase(),e.nss=r[2];let o=`${n}:${t.nid||e.nid}`,s=Pp(o);e.path=void 0,s&&(e=s.parse(e,t))}else e.error=e.error||"URN can not be parsed.";return e}function FE(e,t){if(e.nid===void 0)throw new Error("URN without nid cannot be serialized");let r=t.scheme||e.scheme||"urn",n=e.nid.toLowerCase(),o=`${r}:${t.nid||n}`,s=Pp(o);s&&(e=s.serialize(e,t));let i=e,a=e.nss;return i.path=`${n||t.nid}:${a}`,t.skipEscape=!0,i}function UE(e,t){let r=e;return r.uuid=r.nss,r.nss=void 0,!t.tolerant&&(!r.uuid||!AE(r.uuid))&&(r.error=r.error||"UUID is not valid."),r}function VE(e){let t=e;return t.nss=(e.uuid||"").toLowerCase(),t}var F_={scheme:"http",domainHost:!0,parse:D_,serialize:q_},BE={scheme:"https",domainHost:F_.domainHost,parse:D_,serialize:q_},fa={scheme:"ws",domainHost:!0,parse:LE,serialize:DE},HE={scheme:"wss",domainHost:fa.domainHost,parse:fa.parse,serialize:fa.serialize},WE={scheme:"urn",parse:qE,serialize:FE,skipNormalize:!0},GE={scheme:"urn:uuid",parse:UE,serialize:VE,skipNormalize:!0},ma={http:F_,https:BE,ws:fa,wss:HE,urn:WE,"urn:uuid":GE};Object.setPrototypeOf(ma,null);function Pp(e){return e&&(ma[e]||ma[e.toLowerCase()])||void 0}U_.exports={wsIsSecure:zp,SCHEMES:ma,isValidSchemeName:ZE,getSchemeHandler:Pp}});var W_=P((YA,ga)=>{"use strict";var{normalizeIPv6:KE,removeDotSegments:Go,recomposeAuthority:JE,normalizeComponentEncoding:ha,isIPv4:YE,nonSimpleDomain:XE}=Ep(),{SCHEMES:QE,getSchemeHandler:B_}=V_();function ez(e,t){return typeof e=="string"?e=Ft(nr(e,t),t):typeof e=="object"&&(e=nr(Ft(e,t),t)),e}function tz(e,t,r){let n=r?Object.assign({scheme:"null"},r):{scheme:"null"},o=H_(nr(e,n),nr(t,n),n,!0);return n.skipEscape=!0,Ft(o,n)}function H_(e,t,r,n){let o={};return n||(e=nr(Ft(e,r),r),t=nr(Ft(t,r),r)),r=r||{},!r.tolerant&&t.scheme?(o.scheme=t.scheme,o.userinfo=t.userinfo,o.host=t.host,o.port=t.port,o.path=Go(t.path||""),o.query=t.query):(t.userinfo!==void 0||t.host!==void 0||t.port!==void 0?(o.userinfo=t.userinfo,o.host=t.host,o.port=t.port,o.path=Go(t.path||""),o.query=t.query):(t.path?(t.path[0]==="/"?o.path=Go(t.path):((e.userinfo!==void 0||e.host!==void 0||e.port!==void 0)&&!e.path?o.path="/"+t.path:e.path?o.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:o.path=t.path,o.path=Go(o.path)),o.query=t.query):(o.path=e.path,t.query!==void 0?o.query=t.query:o.query=e.query),o.userinfo=e.userinfo,o.host=e.host,o.port=e.port),o.scheme=e.scheme),o.fragment=t.fragment,o}function rz(e,t,r){return typeof e=="string"?(e=unescape(e),e=Ft(ha(nr(e,r),!0),{...r,skipEscape:!0})):typeof e=="object"&&(e=Ft(ha(e,!0),{...r,skipEscape:!0})),typeof t=="string"?(t=unescape(t),t=Ft(ha(nr(t,r),!0),{...r,skipEscape:!0})):typeof t=="object"&&(t=Ft(ha(t,!0),{...r,skipEscape:!0})),e.toLowerCase()===t.toLowerCase()}function Ft(e,t){let r={host:e.host,scheme:e.scheme,userinfo:e.userinfo,port:e.port,path:e.path,query:e.query,nid:e.nid,nss:e.nss,uuid:e.uuid,fragment:e.fragment,reference:e.reference,resourceName:e.resourceName,secure:e.secure,error:""},n=Object.assign({},t),o=[],s=B_(n.scheme||r.scheme);s&&s.serialize&&s.serialize(r,n),r.path!==void 0&&(n.skipEscape?r.path=unescape(r.path):(r.path=escape(r.path),r.scheme!==void 0&&(r.path=r.path.split("%3A").join(":")))),n.reference!=="suffix"&&r.scheme&&o.push(r.scheme,":");let i=JE(r);if(i!==void 0&&(n.reference!=="suffix"&&o.push("//"),o.push(i),r.path&&r.path[0]!=="/"&&o.push("/")),r.path!==void 0){let a=r.path;!n.absolutePath&&(!s||!s.absolutePath)&&(a=Go(a)),i===void 0&&a[0]==="/"&&a[1]==="/"&&(a="/%2F"+a.slice(2)),o.push(a)}return r.query!==void 0&&o.push("?",r.query),r.fragment!==void 0&&o.push("#",r.fragment),o.join("")}var nz=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function nr(e,t){let r=Object.assign({},t),n={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},o=!1;r.reference==="suffix"&&(r.scheme?e=r.scheme+":"+e:e="//"+e);let s=e.match(nz);if(s){if(n.scheme=s[1],n.userinfo=s[3],n.host=s[4],n.port=parseInt(s[5],10),n.path=s[6]||"",n.query=s[7],n.fragment=s[8],isNaN(n.port)&&(n.port=s[5]),n.host)if(YE(n.host)===!1){let c=KE(n.host);n.host=c.host.toLowerCase(),o=c.isIPV6}else o=!0;n.scheme===void 0&&n.userinfo===void 0&&n.host===void 0&&n.port===void 0&&n.query===void 0&&!n.path?n.reference="same-document":n.scheme===void 0?n.reference="relative":n.fragment===void 0?n.reference="absolute":n.reference="uri",r.reference&&r.reference!=="suffix"&&r.reference!==n.reference&&(n.error=n.error||"URI is not a "+r.reference+" reference.");let i=B_(r.scheme||n.scheme);if(!r.unicodeSupport&&(!i||!i.unicodeSupport)&&n.host&&(r.domainHost||i&&i.domainHost)&&o===!1&&XE(n.host))try{n.host=URL.domainToASCII(n.host.toLowerCase())}catch(a){n.error=n.error||"Host's domain name can not be converted to ASCII: "+a}(!i||i&&!i.skipNormalize)&&(e.indexOf("%")!==-1&&(n.scheme!==void 0&&(n.scheme=unescape(n.scheme)),n.host!==void 0&&(n.host=unescape(n.host))),n.path&&(n.path=escape(unescape(n.path))),n.fragment&&(n.fragment=encodeURI(decodeURIComponent(n.fragment)))),i&&i.parse&&i.parse(n,r)}else n.error=n.error||"URI can not be parsed.";return n}var Ip={SCHEMES:QE,normalize:ez,resolve:tz,resolveComponent:H_,equal:rz,serialize:Ft,parse:nr};ga.exports=Ip;ga.exports.default=Ip;ga.exports.fastUri=Ip});var K_=P(Rp=>{"use strict";Object.defineProperty(Rp,"__esModule",{value:!0});var G_=W_();G_.code='require("ajv/dist/runtime/uri").default';Rp.default=G_});var nv=P(Ze=>{"use strict";Object.defineProperty(Ze,"__esModule",{value:!0});Ze.CodeGen=Ze.Name=Ze.nil=Ze.stringify=Ze.str=Ze._=Ze.KeywordCxt=void 0;var oz=Ho();Object.defineProperty(Ze,"KeywordCxt",{enumerable:!0,get:function(){return oz.KeywordCxt}});var Dn=K();Object.defineProperty(Ze,"_",{enumerable:!0,get:function(){return Dn._}});Object.defineProperty(Ze,"str",{enumerable:!0,get:function(){return Dn.str}});Object.defineProperty(Ze,"stringify",{enumerable:!0,get:function(){return Dn.stringify}});Object.defineProperty(Ze,"nil",{enumerable:!0,get:function(){return Dn.nil}});Object.defineProperty(Ze,"Name",{enumerable:!0,get:function(){return Dn.Name}});Object.defineProperty(Ze,"CodeGen",{enumerable:!0,get:function(){return Dn.CodeGen}});var sz=la(),ev=Wo(),iz=ip(),Ko=pa(),az=K(),Jo=Uo(),ya=Fo(),Op=oe(),J_=A_(),cz=K_(),tv=(e,t)=>new RegExp(e,t);tv.code="new RegExp";var uz=["removeAdditional","useDefaults","coerceTypes"],lz=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),dz={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},pz={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},Y_=200;function fz(e){var t,r,n,o,s,i,a,c,u,d,l,m,h,p,f,g,y,v,_,w,E,B,I,j,Ie;let ze=e.strict,Re=(t=e.code)===null||t===void 0?void 0:t.optimize,dn=Re===!0||Re===void 0?1:Re||0,Ct=(n=(r=e.code)===null||r===void 0?void 0:r.regExp)!==null&&n!==void 0?n:tv,_e=(o=e.uriResolver)!==null&&o!==void 0?o:cz.default;return{strictSchema:(i=(s=e.strictSchema)!==null&&s!==void 0?s:ze)!==null&&i!==void 0?i:!0,strictNumbers:(c=(a=e.strictNumbers)!==null&&a!==void 0?a:ze)!==null&&c!==void 0?c:!0,strictTypes:(d=(u=e.strictTypes)!==null&&u!==void 0?u:ze)!==null&&d!==void 0?d:"log",strictTuples:(m=(l=e.strictTuples)!==null&&l!==void 0?l:ze)!==null&&m!==void 0?m:"log",strictRequired:(p=(h=e.strictRequired)!==null&&h!==void 0?h:ze)!==null&&p!==void 0?p:!1,code:e.code?{...e.code,optimize:dn,regExp:Ct}:{optimize:dn,regExp:Ct},loopRequired:(f=e.loopRequired)!==null&&f!==void 0?f:Y_,loopEnum:(g=e.loopEnum)!==null&&g!==void 0?g:Y_,meta:(y=e.meta)!==null&&y!==void 0?y:!0,messages:(v=e.messages)!==null&&v!==void 0?v:!0,inlineRefs:(_=e.inlineRefs)!==null&&_!==void 0?_:!0,schemaId:(w=e.schemaId)!==null&&w!==void 0?w:"$id",addUsedSchema:(E=e.addUsedSchema)!==null&&E!==void 0?E:!0,validateSchema:(B=e.validateSchema)!==null&&B!==void 0?B:!0,validateFormats:(I=e.validateFormats)!==null&&I!==void 0?I:!0,unicodeRegExp:(j=e.unicodeRegExp)!==null&&j!==void 0?j:!0,int32range:(Ie=e.int32range)!==null&&Ie!==void 0?Ie:!0,uriResolver:_e}}var Yo=class{constructor(t={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,t=this.opts={...t,...fz(t)};let{es5:r,lines:n}=this.opts.code;this.scope=new az.ValueScope({scope:{},prefixes:lz,es5:r,lines:n}),this.logger=vz(t.logger);let o=t.validateFormats;t.validateFormats=!1,this.RULES=(0,iz.getRules)(),X_.call(this,dz,t,"NOT SUPPORTED"),X_.call(this,pz,t,"DEPRECATED","warn"),this._metaOpts=yz.call(this),t.formats&&hz.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),t.keywords&&gz.call(this,t.keywords),typeof t.meta=="object"&&this.addMetaSchema(t.meta),mz.call(this),t.validateFormats=o}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:t,meta:r,schemaId:n}=this.opts,o=J_;n==="id"&&(o={...J_},o.id=o.$id,delete o.$id),r&&t&&this.addMetaSchema(o,o[n],!1)}defaultMeta(){let{meta:t,schemaId:r}=this.opts;return this.opts.defaultMeta=typeof t=="object"?t[r]||t:void 0}validate(t,r){let n;if(typeof t=="string"){if(n=this.getSchema(t),!n)throw new Error(`no schema with key or ref "${t}"`)}else n=this.compile(t);let o=n(r);return"$async"in n||(this.errors=n.errors),o}compile(t,r){let n=this._addSchema(t,r);return n.validate||this._compileSchemaEnv(n)}compileAsync(t,r){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");let{loadSchema:n}=this.opts;return o.call(this,t,r);async function o(d,l){await s.call(this,d.$schema);let m=this._addSchema(d,l);return m.validate||i.call(this,m)}async function s(d){d&&!this.getSchema(d)&&await o.call(this,{$ref:d},!0)}async function i(d){try{return this._compileSchemaEnv(d)}catch(l){if(!(l instanceof ev.default))throw l;return a.call(this,l),await c.call(this,l.missingSchema),i.call(this,d)}}function a({missingSchema:d,missingRef:l}){if(this.refs[d])throw new Error(`AnySchema ${d} is loaded but ${l} cannot be resolved`)}async function c(d){let l=await u.call(this,d);this.refs[d]||await s.call(this,l.$schema),this.refs[d]||this.addSchema(l,d,r)}async function u(d){let l=this._loading[d];if(l)return l;try{return await(this._loading[d]=n(d))}finally{delete this._loading[d]}}}addSchema(t,r,n,o=this.opts.validateSchema){if(Array.isArray(t)){for(let i of t)this.addSchema(i,void 0,n,o);return this}let s;if(typeof t=="object"){let{schemaId:i}=this.opts;if(s=t[i],s!==void 0&&typeof s!="string")throw new Error(`schema ${i} must be string`)}return r=(0,Jo.normalizeId)(r||s),this._checkUnique(r),this.schemas[r]=this._addSchema(t,n,r,o,!0),this}addMetaSchema(t,r,n=this.opts.validateSchema){return this.addSchema(t,r,!0,n),this}validateSchema(t,r){if(typeof t=="boolean")return!0;let n;if(n=t.$schema,n!==void 0&&typeof n!="string")throw new Error("$schema must be a string");if(n=n||this.opts.defaultMeta||this.defaultMeta(),!n)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let o=this.validate(n,t);if(!o&&r){let s="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(s);else throw new Error(s)}return o}getSchema(t){let r;for(;typeof(r=Q_.call(this,t))=="string";)t=r;if(r===void 0){let{schemaId:n}=this.opts,o=new Ko.SchemaEnv({schema:{},schemaId:n});if(r=Ko.resolveSchema.call(this,o,t),!r)return;this.refs[t]=r}return r.validate||this._compileSchemaEnv(r)}removeSchema(t){if(t instanceof RegExp)return this._removeAllSchemas(this.schemas,t),this._removeAllSchemas(this.refs,t),this;switch(typeof t){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let r=Q_.call(this,t);return typeof r=="object"&&this._cache.delete(r.schema),delete this.schemas[t],delete this.refs[t],this}case"object":{let r=t;this._cache.delete(r);let n=t[this.opts.schemaId];return n&&(n=(0,Jo.normalizeId)(n),delete this.schemas[n],delete this.refs[n]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(t){for(let r of t)this.addKeyword(r);return this}addKeyword(t,r){let n;if(typeof t=="string")n=t,typeof r=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),r.keyword=n);else if(typeof t=="object"&&r===void 0){if(r=t,n=r.keyword,Array.isArray(n)&&!n.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if($z.call(this,n,r),!r)return(0,Op.eachItem)(n,s=>Cp.call(this,s)),this;wz.call(this,r);let o={...r,type:(0,ya.getJSONTypes)(r.type),schemaType:(0,ya.getJSONTypes)(r.schemaType)};return(0,Op.eachItem)(n,o.type.length===0?s=>Cp.call(this,s,o):s=>o.type.forEach(i=>Cp.call(this,s,o,i))),this}getKeyword(t){let r=this.RULES.all[t];return typeof r=="object"?r.definition:!!r}removeKeyword(t){let{RULES:r}=this;delete r.keywords[t],delete r.all[t];for(let n of r.rules){let o=n.rules.findIndex(s=>s.keyword===t);o>=0&&n.rules.splice(o,1)}return this}addFormat(t,r){return typeof r=="string"&&(r=new RegExp(r)),this.formats[t]=r,this}errorsText(t=this.errors,{separator:r=", ",dataVar:n="data"}={}){return!t||t.length===0?"No errors":t.map(o=>`${n}${o.instancePath} ${o.message}`).reduce((o,s)=>o+r+s)}$dataMetaSchema(t,r){let n=this.RULES.all;t=JSON.parse(JSON.stringify(t));for(let o of r){let s=o.split("/").slice(1),i=t;for(let a of s)i=i[a];for(let a in n){let c=n[a];if(typeof c!="object")continue;let{$data:u}=c.definition,d=i[a];u&&d&&(i[a]=rv(d))}}return t}_removeAllSchemas(t,r){for(let n in t){let o=t[n];(!r||r.test(n))&&(typeof o=="string"?delete t[n]:o&&!o.meta&&(this._cache.delete(o.schema),delete t[n]))}}_addSchema(t,r,n,o=this.opts.validateSchema,s=this.opts.addUsedSchema){let i,{schemaId:a}=this.opts;if(typeof t=="object")i=t[a];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof t!="boolean")throw new Error("schema must be object or boolean")}let c=this._cache.get(t);if(c!==void 0)return c;n=(0,Jo.normalizeId)(i||n);let u=Jo.getSchemaRefs.call(this,t,n);return c=new Ko.SchemaEnv({schema:t,schemaId:a,meta:r,baseId:n,localRefs:u}),this._cache.set(c.schema,c),s&&!n.startsWith("#")&&(n&&this._checkUnique(n),this.refs[n]=c),o&&this.validateSchema(t,!0),c}_checkUnique(t){if(this.schemas[t]||this.refs[t])throw new Error(`schema with key or id "${t}" already exists`)}_compileSchemaEnv(t){if(t.meta?this._compileMetaSchema(t):Ko.compileSchema.call(this,t),!t.validate)throw new Error("ajv implementation error");return t.validate}_compileMetaSchema(t){let r=this.opts;this.opts=this._metaOpts;try{Ko.compileSchema.call(this,t)}finally{this.opts=r}}};Yo.ValidationError=sz.default;Yo.MissingRefError=ev.default;Ze.default=Yo;function X_(e,t,r,n="error"){for(let o in e){let s=o;s in t&&this.logger[n](`${r}: option ${o}. ${e[s]}`)}}function Q_(e){return e=(0,Jo.normalizeId)(e),this.schemas[e]||this.refs[e]}function mz(){let e=this.opts.schemas;if(e)if(Array.isArray(e))this.addSchema(e);else for(let t in e)this.addSchema(e[t],t)}function hz(){for(let e in this.opts.formats){let t=this.opts.formats[e];t&&this.addFormat(e,t)}}function gz(e){if(Array.isArray(e)){this.addVocabulary(e);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let t in e){let r=e[t];r.keyword||(r.keyword=t),this.addKeyword(r)}}function yz(){let e={...this.opts};for(let t of uz)delete e[t];return e}var _z={log(){},warn(){},error(){}};function vz(e){if(e===!1)return _z;if(e===void 0)return console;if(e.log&&e.warn&&e.error)return e;throw new Error("logger must implement log, warn and error methods")}var bz=/^[a-z_$][a-z0-9_$:-]*$/i;function $z(e,t){let{RULES:r}=this;if((0,Op.eachItem)(e,n=>{if(r.keywords[n])throw new Error(`Keyword ${n} is already defined`);if(!bz.test(n))throw new Error(`Keyword ${n} has invalid name`)}),!!t&&t.$data&&!("code"in t||"validate"in t))throw new Error('$data keyword must have "code" or "validate" function')}function Cp(e,t,r){var n;let o=t?.post;if(r&&o)throw new Error('keyword with "post" flag cannot have "type"');let{RULES:s}=this,i=o?s.post:s.rules.find(({type:c})=>c===r);if(i||(i={type:r,rules:[]},s.rules.push(i)),s.keywords[e]=!0,!t)return;let a={keyword:e,definition:{...t,type:(0,ya.getJSONTypes)(t.type),schemaType:(0,ya.getJSONTypes)(t.schemaType)}};t.before?xz.call(this,i,a,t.before):i.rules.push(a),s.all[e]=a,(n=t.implements)===null||n===void 0||n.forEach(c=>this.addKeyword(c))}function xz(e,t,r){let n=e.rules.findIndex(o=>o.keyword===r);n>=0?e.rules.splice(n,0,t):(e.rules.push(t),this.logger.warn(`rule ${r} is not defined`))}function wz(e){let{metaSchema:t}=e;t!==void 0&&(e.$data&&this.opts.$data&&(t=rv(t)),e.validateSchema=this.compile(t,!0))}var kz={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function rv(e){return{anyOf:[e,kz]}}});var ov=P(Np=>{"use strict";Object.defineProperty(Np,"__esModule",{value:!0});var Sz={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};Np.default=Sz});var cv=P(an=>{"use strict";Object.defineProperty(an,"__esModule",{value:!0});an.callRef=an.getValidate=void 0;var Tz=Wo(),sv=bt(),st=K(),qn=tr(),iv=pa(),_a=oe(),Ez={keyword:"$ref",schemaType:"string",code(e){let{gen:t,schema:r,it:n}=e,{baseId:o,schemaEnv:s,validateName:i,opts:a,self:c}=n,{root:u}=s;if((r==="#"||r==="#/")&&o===u.baseId)return l();let d=iv.resolveRef.call(c,u,o,r);if(d===void 0)throw new Tz.default(n.opts.uriResolver,o,r);if(d instanceof iv.SchemaEnv)return m(d);return h(d);function l(){if(s===u)return va(e,i,s,s.$async);let p=t.scopeValue("root",{ref:u});return va(e,(0,st._)`${p}.validate`,u,u.$async)}function m(p){let f=av(e,p);va(e,f,p,p.$async)}function h(p){let f=t.scopeValue("schema",a.code.source===!0?{ref:p,code:(0,st.stringify)(p)}:{ref:p}),g=t.name("valid"),y=e.subschema({schema:p,dataTypes:[],schemaPath:st.nil,topSchemaRef:f,errSchemaPath:r},g);e.mergeEvaluated(y),e.ok(g)}}};function av(e,t){let{gen:r}=e;return t.validate?r.scopeValue("validate",{ref:t.validate}):(0,st._)`${r.scopeValue("wrapper",{ref:t})}.validate`}an.getValidate=av;function va(e,t,r,n){let{gen:o,it:s}=e,{allErrors:i,schemaEnv:a,opts:c}=s,u=c.passContext?qn.default.this:st.nil;n?d():l();function d(){if(!a.$async)throw new Error("async schema referenced by sync schema");let p=o.let("valid");o.try(()=>{o.code((0,st._)`await ${(0,sv.callValidateCode)(e,t,u)}`),h(t),i||o.assign(p,!0)},f=>{o.if((0,st._)`!(${f} instanceof ${s.ValidationError})`,()=>o.throw(f)),m(f),i||o.assign(p,!1)}),e.ok(p)}function l(){e.result((0,sv.callValidateCode)(e,t,u),()=>h(t),()=>m(t))}function m(p){let f=(0,st._)`${p}.errors`;o.assign(qn.default.vErrors,(0,st._)`${qn.default.vErrors} === null ? ${f} : ${qn.default.vErrors}.concat(${f})`),o.assign(qn.default.errors,(0,st._)`${qn.default.vErrors}.length`)}function h(p){var f;if(!s.opts.unevaluated)return;let g=(f=r?.validate)===null||f===void 0?void 0:f.evaluated;if(s.props!==!0)if(g&&!g.dynamicProps)g.props!==void 0&&(s.props=_a.mergeEvaluated.props(o,g.props,s.props));else{let y=o.var("props",(0,st._)`${p}.evaluated.props`);s.props=_a.mergeEvaluated.props(o,y,s.props,st.Name)}if(s.items!==!0)if(g&&!g.dynamicItems)g.items!==void 0&&(s.items=_a.mergeEvaluated.items(o,g.items,s.items));else{let y=o.var("items",(0,st._)`${p}.evaluated.items`);s.items=_a.mergeEvaluated.items(o,y,s.items,st.Name)}}}an.callRef=va;an.default=Ez});var uv=P(Ap=>{"use strict";Object.defineProperty(Ap,"__esModule",{value:!0});var zz=ov(),Pz=cv(),Iz=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",zz.default,Pz.default];Ap.default=Iz});var lv=P(jp=>{"use strict";Object.defineProperty(jp,"__esModule",{value:!0});var ba=K(),kr=ba.operators,$a={maximum:{okStr:"<=",ok:kr.LTE,fail:kr.GT},minimum:{okStr:">=",ok:kr.GTE,fail:kr.LT},exclusiveMaximum:{okStr:"<",ok:kr.LT,fail:kr.GTE},exclusiveMinimum:{okStr:">",ok:kr.GT,fail:kr.LTE}},Rz={message:({keyword:e,schemaCode:t})=>(0,ba.str)`must be ${$a[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>(0,ba._)`{comparison: ${$a[e].okStr}, limit: ${t}}`},Cz={keyword:Object.keys($a),type:"number",schemaType:"number",$data:!0,error:Rz,code(e){let{keyword:t,data:r,schemaCode:n}=e;e.fail$data((0,ba._)`${r} ${$a[t].fail} ${n} || isNaN(${r})`)}};jp.default=Cz});var dv=P(Mp=>{"use strict";Object.defineProperty(Mp,"__esModule",{value:!0});var Xo=K(),Oz={message:({schemaCode:e})=>(0,Xo.str)`must be multiple of ${e}`,params:({schemaCode:e})=>(0,Xo._)`{multipleOf: ${e}}`},Nz={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:Oz,code(e){let{gen:t,data:r,schemaCode:n,it:o}=e,s=o.opts.multipleOfPrecision,i=t.let("res"),a=s?(0,Xo._)`Math.abs(Math.round(${i}) - ${i}) > 1e-${s}`:(0,Xo._)`${i} !== parseInt(${i})`;e.fail$data((0,Xo._)`(${n} === 0 || (${i} = ${r}/${n}, ${a}))`)}};Mp.default=Nz});var fv=P(Zp=>{"use strict";Object.defineProperty(Zp,"__esModule",{value:!0});function pv(e){let t=e.length,r=0,n=0,o;for(;n<t;)r++,o=e.charCodeAt(n++),o>=55296&&o<=56319&&n<t&&(o=e.charCodeAt(n),(o&64512)===56320&&n++);return r}Zp.default=pv;pv.code='require("ajv/dist/runtime/ucs2length").default'});var mv=P(Lp=>{"use strict";Object.defineProperty(Lp,"__esModule",{value:!0});var cn=K(),Az=oe(),jz=fv(),Mz={message({keyword:e,schemaCode:t}){let r=e==="maxLength"?"more":"fewer";return(0,cn.str)`must NOT have ${r} than ${t} characters`},params:({schemaCode:e})=>(0,cn._)`{limit: ${e}}`},Zz={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:Mz,code(e){let{keyword:t,data:r,schemaCode:n,it:o}=e,s=t==="maxLength"?cn.operators.GT:cn.operators.LT,i=o.opts.unicode===!1?(0,cn._)`${r}.length`:(0,cn._)`${(0,Az.useFunc)(e.gen,jz.default)}(${r})`;e.fail$data((0,cn._)`${i} ${s} ${n}`)}};Lp.default=Zz});var hv=P(Dp=>{"use strict";Object.defineProperty(Dp,"__esModule",{value:!0});var Lz=bt(),Dz=oe(),Fn=K(),qz={message:({schemaCode:e})=>(0,Fn.str)`must match pattern "${e}"`,params:({schemaCode:e})=>(0,Fn._)`{pattern: ${e}}`},Fz={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:qz,code(e){let{gen:t,data:r,$data:n,schema:o,schemaCode:s,it:i}=e,a=i.opts.unicodeRegExp?"u":"";if(n){let{regExp:c}=i.opts.code,u=c.code==="new RegExp"?(0,Fn._)`new RegExp`:(0,Dz.useFunc)(t,c),d=t.let("valid");t.try(()=>t.assign(d,(0,Fn._)`${u}(${s}, ${a}).test(${r})`),()=>t.assign(d,!1)),e.fail$data((0,Fn._)`!${d}`)}else{let c=(0,Lz.usePattern)(e,o);e.fail$data((0,Fn._)`!${c}.test(${r})`)}}};Dp.default=Fz});var gv=P(qp=>{"use strict";Object.defineProperty(qp,"__esModule",{value:!0});var Qo=K(),Uz={message({keyword:e,schemaCode:t}){let r=e==="maxProperties"?"more":"fewer";return(0,Qo.str)`must NOT have ${r} than ${t} properties`},params:({schemaCode:e})=>(0,Qo._)`{limit: ${e}}`},Vz={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:Uz,code(e){let{keyword:t,data:r,schemaCode:n}=e,o=t==="maxProperties"?Qo.operators.GT:Qo.operators.LT;e.fail$data((0,Qo._)`Object.keys(${r}).length ${o} ${n}`)}};qp.default=Vz});var yv=P(Fp=>{"use strict";Object.defineProperty(Fp,"__esModule",{value:!0});var es=bt(),ts=K(),Bz=oe(),Hz={message:({params:{missingProperty:e}})=>(0,ts.str)`must have required property '${e}'`,params:({params:{missingProperty:e}})=>(0,ts._)`{missingProperty: ${e}}`},Wz={keyword:"required",type:"object",schemaType:"array",$data:!0,error:Hz,code(e){let{gen:t,schema:r,schemaCode:n,data:o,$data:s,it:i}=e,{opts:a}=i;if(!s&&r.length===0)return;let c=r.length>=a.loopRequired;if(i.allErrors?u():d(),a.strictRequired){let h=e.parentSchema.properties,{definedProperties:p}=e.it;for(let f of r)if(h?.[f]===void 0&&!p.has(f)){let g=i.schemaEnv.baseId+i.errSchemaPath,y=`required property "${f}" is not defined at "${g}" (strictRequired)`;(0,Bz.checkStrictMode)(i,y,i.opts.strictRequired)}}function u(){if(c||s)e.block$data(ts.nil,l);else for(let h of r)(0,es.checkReportMissingProp)(e,h)}function d(){let h=t.let("missing");if(c||s){let p=t.let("valid",!0);e.block$data(p,()=>m(h,p)),e.ok(p)}else t.if((0,es.checkMissingProp)(e,r,h)),(0,es.reportMissingProp)(e,h),t.else()}function l(){t.forOf("prop",n,h=>{e.setParams({missingProperty:h}),t.if((0,es.noPropertyInData)(t,o,h,a.ownProperties),()=>e.error())})}function m(h,p){e.setParams({missingProperty:h}),t.forOf(h,n,()=>{t.assign(p,(0,es.propertyInData)(t,o,h,a.ownProperties)),t.if((0,ts.not)(p),()=>{e.error(),t.break()})},ts.nil)}}};Fp.default=Wz});var _v=P(Up=>{"use strict";Object.defineProperty(Up,"__esModule",{value:!0});var rs=K(),Gz={message({keyword:e,schemaCode:t}){let r=e==="maxItems"?"more":"fewer";return(0,rs.str)`must NOT have ${r} than ${t} items`},params:({schemaCode:e})=>(0,rs._)`{limit: ${e}}`},Kz={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:Gz,code(e){let{keyword:t,data:r,schemaCode:n}=e,o=t==="maxItems"?rs.operators.GT:rs.operators.LT;e.fail$data((0,rs._)`${r}.length ${o} ${n}`)}};Up.default=Kz});var xa=P(Vp=>{"use strict";Object.defineProperty(Vp,"__esModule",{value:!0});var vv=mp();vv.code='require("ajv/dist/runtime/equal").default';Vp.default=vv});var bv=P(Hp=>{"use strict";Object.defineProperty(Hp,"__esModule",{value:!0});var Bp=Fo(),Le=K(),Jz=oe(),Yz=xa(),Xz={message:({params:{i:e,j:t}})=>(0,Le.str)`must NOT have duplicate items (items ## ${t} and ${e} are identical)`,params:({params:{i:e,j:t}})=>(0,Le._)`{i: ${e}, j: ${t}}`},Qz={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:Xz,code(e){let{gen:t,data:r,$data:n,schema:o,parentSchema:s,schemaCode:i,it:a}=e;if(!n&&!o)return;let c=t.let("valid"),u=s.items?(0,Bp.getSchemaTypes)(s.items):[];e.block$data(c,d,(0,Le._)`${i} === false`),e.ok(c);function d(){let p=t.let("i",(0,Le._)`${r}.length`),f=t.let("j");e.setParams({i:p,j:f}),t.assign(c,!0),t.if((0,Le._)`${p} > 1`,()=>(l()?m:h)(p,f))}function l(){return u.length>0&&!u.some(p=>p==="object"||p==="array")}function m(p,f){let g=t.name("item"),y=(0,Bp.checkDataTypes)(u,g,a.opts.strictNumbers,Bp.DataType.Wrong),v=t.const("indices",(0,Le._)`{}`);t.for((0,Le._)`;${p}--;`,()=>{t.let(g,(0,Le._)`${r}[${p}]`),t.if(y,(0,Le._)`continue`),u.length>1&&t.if((0,Le._)`typeof ${g} == "string"`,(0,Le._)`${g} += "_"`),t.if((0,Le._)`typeof ${v}[${g}] == "number"`,()=>{t.assign(f,(0,Le._)`${v}[${g}]`),e.error(),t.assign(c,!1).break()}).code((0,Le._)`${v}[${g}] = ${p}`)})}function h(p,f){let g=(0,Jz.useFunc)(t,Yz.default),y=t.name("outer");t.label(y).for((0,Le._)`;${p}--;`,()=>t.for((0,Le._)`${f} = ${p}; ${f}--;`,()=>t.if((0,Le._)`${g}(${r}[${p}], ${r}[${f}])`,()=>{e.error(),t.assign(c,!1).break(y)})))}}};Hp.default=Qz});var $v=P(Gp=>{"use strict";Object.defineProperty(Gp,"__esModule",{value:!0});var Wp=K(),eP=oe(),tP=xa(),rP={message:"must be equal to constant",params:({schemaCode:e})=>(0,Wp._)`{allowedValue: ${e}}`},nP={keyword:"const",$data:!0,error:rP,code(e){let{gen:t,data:r,$data:n,schemaCode:o,schema:s}=e;n||s&&typeof s=="object"?e.fail$data((0,Wp._)`!${(0,eP.useFunc)(t,tP.default)}(${r}, ${o})`):e.fail((0,Wp._)`${s} !== ${r}`)}};Gp.default=nP});var xv=P(Kp=>{"use strict";Object.defineProperty(Kp,"__esModule",{value:!0});var ns=K(),oP=oe(),sP=xa(),iP={message:"must be equal to one of the allowed values",params:({schemaCode:e})=>(0,ns._)`{allowedValues: ${e}}`},aP={keyword:"enum",schemaType:"array",$data:!0,error:iP,code(e){let{gen:t,data:r,$data:n,schema:o,schemaCode:s,it:i}=e;if(!n&&o.length===0)throw new Error("enum must have non-empty array");let a=o.length>=i.opts.loopEnum,c,u=()=>c??(c=(0,oP.useFunc)(t,sP.default)),d;if(a||n)d=t.let("valid"),e.block$data(d,l);else{if(!Array.isArray(o))throw new Error("ajv implementation error");let h=t.const("vSchema",s);d=(0,ns.or)(...o.map((p,f)=>m(h,f)))}e.pass(d);function l(){t.assign(d,!1),t.forOf("v",s,h=>t.if((0,ns._)`${u()}(${r}, ${h})`,()=>t.assign(d,!0).break()))}function m(h,p){let f=o[p];return typeof f=="object"&&f!==null?(0,ns._)`${u()}(${r}, ${h}[${p}])`:(0,ns._)`${r} === ${f}`}}};Kp.default=aP});var wv=P(Jp=>{"use strict";Object.defineProperty(Jp,"__esModule",{value:!0});var cP=lv(),uP=dv(),lP=mv(),dP=hv(),pP=gv(),fP=yv(),mP=_v(),hP=bv(),gP=$v(),yP=xv(),_P=[cP.default,uP.default,lP.default,dP.default,pP.default,fP.default,mP.default,hP.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},gP.default,yP.default];Jp.default=_P});var Xp=P(os=>{"use strict";Object.defineProperty(os,"__esModule",{value:!0});os.validateAdditionalItems=void 0;var un=K(),Yp=oe(),vP={message:({params:{len:e}})=>(0,un.str)`must NOT have more than ${e} items`,params:({params:{len:e}})=>(0,un._)`{limit: ${e}}`},bP={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:vP,code(e){let{parentSchema:t,it:r}=e,{items:n}=t;if(!Array.isArray(n)){(0,Yp.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}kv(e,n)}};function kv(e,t){let{gen:r,schema:n,data:o,keyword:s,it:i}=e;i.items=!0;let a=r.const("len",(0,un._)`${o}.length`);if(n===!1)e.setParams({len:t.length}),e.pass((0,un._)`${a} <= ${t.length}`);else if(typeof n=="object"&&!(0,Yp.alwaysValidSchema)(i,n)){let u=r.var("valid",(0,un._)`${a} <= ${t.length}`);r.if((0,un.not)(u),()=>c(u)),e.ok(u)}function c(u){r.forRange("i",t.length,a,d=>{e.subschema({keyword:s,dataProp:d,dataPropType:Yp.Type.Num},u),i.allErrors||r.if((0,un.not)(u),()=>r.break())})}}os.validateAdditionalItems=kv;os.default=bP});var Qp=P(ss=>{"use strict";Object.defineProperty(ss,"__esModule",{value:!0});ss.validateTuple=void 0;var Sv=K(),wa=oe(),$P=bt(),xP={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){let{schema:t,it:r}=e;if(Array.isArray(t))return Tv(e,"additionalItems",t);r.items=!0,!(0,wa.alwaysValidSchema)(r,t)&&e.ok((0,$P.validateArray)(e))}};function Tv(e,t,r=e.schema){let{gen:n,parentSchema:o,data:s,keyword:i,it:a}=e;d(o),a.opts.unevaluated&&r.length&&a.items!==!0&&(a.items=wa.mergeEvaluated.items(n,r.length,a.items));let c=n.name("valid"),u=n.const("len",(0,Sv._)`${s}.length`);r.forEach((l,m)=>{(0,wa.alwaysValidSchema)(a,l)||(n.if((0,Sv._)`${u} > ${m}`,()=>e.subschema({keyword:i,schemaProp:m,dataProp:m},c)),e.ok(c))});function d(l){let{opts:m,errSchemaPath:h}=a,p=r.length,f=p===l.minItems&&(p===l.maxItems||l[t]===!1);if(m.strictTuples&&!f){let g=`"${i}" is ${p}-tuple, but minItems or maxItems/${t} are not specified or different at path "${h}"`;(0,wa.checkStrictMode)(a,g,m.strictTuples)}}}ss.validateTuple=Tv;ss.default=xP});var Ev=P(ef=>{"use strict";Object.defineProperty(ef,"__esModule",{value:!0});var wP=Qp(),kP={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:e=>(0,wP.validateTuple)(e,"items")};ef.default=kP});var Pv=P(tf=>{"use strict";Object.defineProperty(tf,"__esModule",{value:!0});var zv=K(),SP=oe(),TP=bt(),EP=Xp(),zP={message:({params:{len:e}})=>(0,zv.str)`must NOT have more than ${e} items`,params:({params:{len:e}})=>(0,zv._)`{limit: ${e}}`},PP={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:zP,code(e){let{schema:t,parentSchema:r,it:n}=e,{prefixItems:o}=r;n.items=!0,!(0,SP.alwaysValidSchema)(n,t)&&(o?(0,EP.validateAdditionalItems)(e,o):e.ok((0,TP.validateArray)(e)))}};tf.default=PP});var Iv=P(rf=>{"use strict";Object.defineProperty(rf,"__esModule",{value:!0});var xt=K(),ka=oe(),IP={message:({params:{min:e,max:t}})=>t===void 0?(0,xt.str)`must contain at least ${e} valid item(s)`:(0,xt.str)`must contain at least ${e} and no more than ${t} valid item(s)`,params:({params:{min:e,max:t}})=>t===void 0?(0,xt._)`{minContains: ${e}}`:(0,xt._)`{minContains: ${e}, maxContains: ${t}}`},RP={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:IP,code(e){let{gen:t,schema:r,parentSchema:n,data:o,it:s}=e,i,a,{minContains:c,maxContains:u}=n;s.opts.next?(i=c===void 0?1:c,a=u):i=1;let d=t.const("len",(0,xt._)`${o}.length`);if(e.setParams({min:i,max:a}),a===void 0&&i===0){(0,ka.checkStrictMode)(s,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&i>a){(0,ka.checkStrictMode)(s,'"minContains" > "maxContains" is always invalid'),e.fail();return}if((0,ka.alwaysValidSchema)(s,r)){let f=(0,xt._)`${d} >= ${i}`;a!==void 0&&(f=(0,xt._)`${f} && ${d} <= ${a}`),e.pass(f);return}s.items=!0;let l=t.name("valid");a===void 0&&i===1?h(l,()=>t.if(l,()=>t.break())):i===0?(t.let(l,!0),a!==void 0&&t.if((0,xt._)`${o}.length > 0`,m)):(t.let(l,!1),m()),e.result(l,()=>e.reset());function m(){let f=t.name("_valid"),g=t.let("count",0);h(f,()=>t.if(f,()=>p(g)))}function h(f,g){t.forRange("i",0,d,y=>{e.subschema({keyword:"contains",dataProp:y,dataPropType:ka.Type.Num,compositeRule:!0},f),g()})}function p(f){t.code((0,xt._)`${f}++`),a===void 0?t.if((0,xt._)`${f} >= ${i}`,()=>t.assign(l,!0).break()):(t.if((0,xt._)`${f} > ${a}`,()=>t.assign(l,!1).break()),i===1?t.assign(l,!0):t.if((0,xt._)`${f} >= ${i}`,()=>t.assign(l,!0)))}}};rf.default=RP});var Ov=P(Ut=>{"use strict";Object.defineProperty(Ut,"__esModule",{value:!0});Ut.validateSchemaDeps=Ut.validatePropertyDeps=Ut.error=void 0;var nf=K(),CP=oe(),is=bt();Ut.error={message:({params:{property:e,depsCount:t,deps:r}})=>{let n=t===1?"property":"properties";return(0,nf.str)`must have ${n} ${r} when property ${e} is present`},params:({params:{property:e,depsCount:t,deps:r,missingProperty:n}})=>(0,nf._)`{property: ${e},
    missingProperty: ${n},
    depsCount: ${t},
    deps: ${r}}`};var OP={keyword:"dependencies",type:"object",schemaType:"object",error:Ut.error,code(e){let[t,r]=NP(e);Rv(e,t),Cv(e,r)}};function NP({schema:e}){let t={},r={};for(let n in e){if(n==="__proto__")continue;let o=Array.isArray(e[n])?t:r;o[n]=e[n]}return[t,r]}function Rv(e,t=e.schema){let{gen:r,data:n,it:o}=e;if(Object.keys(t).length===0)return;let s=r.let("missing");for(let i in t){let a=t[i];if(a.length===0)continue;let c=(0,is.propertyInData)(r,n,i,o.opts.ownProperties);e.setParams({property:i,depsCount:a.length,deps:a.join(", ")}),o.allErrors?r.if(c,()=>{for(let u of a)(0,is.checkReportMissingProp)(e,u)}):(r.if((0,nf._)`${c} && (${(0,is.checkMissingProp)(e,a,s)})`),(0,is.reportMissingProp)(e,s),r.else())}}Ut.validatePropertyDeps=Rv;function Cv(e,t=e.schema){let{gen:r,data:n,keyword:o,it:s}=e,i=r.name("valid");for(let a in t)(0,CP.alwaysValidSchema)(s,t[a])||(r.if((0,is.propertyInData)(r,n,a,s.opts.ownProperties),()=>{let c=e.subschema({keyword:o,schemaProp:a},i);e.mergeValidEvaluated(c,i)},()=>r.var(i,!0)),e.ok(i))}Ut.validateSchemaDeps=Cv;Ut.default=OP});var Av=P(of=>{"use strict";Object.defineProperty(of,"__esModule",{value:!0});var Nv=K(),AP=oe(),jP={message:"property name must be valid",params:({params:e})=>(0,Nv._)`{propertyName: ${e.propertyName}}`},MP={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:jP,code(e){let{gen:t,schema:r,data:n,it:o}=e;if((0,AP.alwaysValidSchema)(o,r))return;let s=t.name("valid");t.forIn("key",n,i=>{e.setParams({propertyName:i}),e.subschema({keyword:"propertyNames",data:i,dataTypes:["string"],propertyName:i,compositeRule:!0},s),t.if((0,Nv.not)(s),()=>{e.error(!0),o.allErrors||t.break()})}),e.ok(s)}};of.default=MP});var af=P(sf=>{"use strict";Object.defineProperty(sf,"__esModule",{value:!0});var Sa=bt(),It=K(),ZP=tr(),Ta=oe(),LP={message:"must NOT have additional properties",params:({params:e})=>(0,It._)`{additionalProperty: ${e.additionalProperty}}`},DP={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:LP,code(e){let{gen:t,schema:r,parentSchema:n,data:o,errsCount:s,it:i}=e;if(!s)throw new Error("ajv implementation error");let{allErrors:a,opts:c}=i;if(i.props=!0,c.removeAdditional!=="all"&&(0,Ta.alwaysValidSchema)(i,r))return;let u=(0,Sa.allSchemaProperties)(n.properties),d=(0,Sa.allSchemaProperties)(n.patternProperties);l(),e.ok((0,It._)`${s} === ${ZP.default.errors}`);function l(){t.forIn("key",o,g=>{!u.length&&!d.length?p(g):t.if(m(g),()=>p(g))})}function m(g){let y;if(u.length>8){let v=(0,Ta.schemaRefOrVal)(i,n.properties,"properties");y=(0,Sa.isOwnProperty)(t,v,g)}else u.length?y=(0,It.or)(...u.map(v=>(0,It._)`${g} === ${v}`)):y=It.nil;return d.length&&(y=(0,It.or)(y,...d.map(v=>(0,It._)`${(0,Sa.usePattern)(e,v)}.test(${g})`))),(0,It.not)(y)}function h(g){t.code((0,It._)`delete ${o}[${g}]`)}function p(g){if(c.removeAdditional==="all"||c.removeAdditional&&r===!1){h(g);return}if(r===!1){e.setParams({additionalProperty:g}),e.error(),a||t.break();return}if(typeof r=="object"&&!(0,Ta.alwaysValidSchema)(i,r)){let y=t.name("valid");c.removeAdditional==="failing"?(f(g,y,!1),t.if((0,It.not)(y),()=>{e.reset(),h(g)})):(f(g,y),a||t.if((0,It.not)(y),()=>t.break()))}}function f(g,y,v){let _={keyword:"additionalProperties",dataProp:g,dataPropType:Ta.Type.Str};v===!1&&Object.assign(_,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(_,y)}}};sf.default=DP});var Zv=P(uf=>{"use strict";Object.defineProperty(uf,"__esModule",{value:!0});var qP=Ho(),jv=bt(),cf=oe(),Mv=af(),FP={keyword:"properties",type:"object",schemaType:"object",code(e){let{gen:t,schema:r,parentSchema:n,data:o,it:s}=e;s.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&Mv.default.code(new qP.KeywordCxt(s,Mv.default,"additionalProperties"));let i=(0,jv.allSchemaProperties)(r);for(let l of i)s.definedProperties.add(l);s.opts.unevaluated&&i.length&&s.props!==!0&&(s.props=cf.mergeEvaluated.props(t,(0,cf.toHash)(i),s.props));let a=i.filter(l=>!(0,cf.alwaysValidSchema)(s,r[l]));if(a.length===0)return;let c=t.name("valid");for(let l of a)u(l)?d(l):(t.if((0,jv.propertyInData)(t,o,l,s.opts.ownProperties)),d(l),s.allErrors||t.else().var(c,!0),t.endIf()),e.it.definedProperties.add(l),e.ok(c);function u(l){return s.opts.useDefaults&&!s.compositeRule&&r[l].default!==void 0}function d(l){e.subschema({keyword:"properties",schemaProp:l,dataProp:l},c)}}};uf.default=FP});var Fv=P(lf=>{"use strict";Object.defineProperty(lf,"__esModule",{value:!0});var Lv=bt(),Ea=K(),Dv=oe(),qv=oe(),UP={keyword:"patternProperties",type:"object",schemaType:"object",code(e){let{gen:t,schema:r,data:n,parentSchema:o,it:s}=e,{opts:i}=s,a=(0,Lv.allSchemaProperties)(r),c=a.filter(f=>(0,Dv.alwaysValidSchema)(s,r[f]));if(a.length===0||c.length===a.length&&(!s.opts.unevaluated||s.props===!0))return;let u=i.strictSchema&&!i.allowMatchingProperties&&o.properties,d=t.name("valid");s.props!==!0&&!(s.props instanceof Ea.Name)&&(s.props=(0,qv.evaluatedPropsToName)(t,s.props));let{props:l}=s;m();function m(){for(let f of a)u&&h(f),s.allErrors?p(f):(t.var(d,!0),p(f),t.if(d))}function h(f){for(let g in u)new RegExp(f).test(g)&&(0,Dv.checkStrictMode)(s,`property ${g} matches pattern ${f} (use allowMatchingProperties)`)}function p(f){t.forIn("key",n,g=>{t.if((0,Ea._)`${(0,Lv.usePattern)(e,f)}.test(${g})`,()=>{let y=c.includes(f);y||e.subschema({keyword:"patternProperties",schemaProp:f,dataProp:g,dataPropType:qv.Type.Str},d),s.opts.unevaluated&&l!==!0?t.assign((0,Ea._)`${l}[${g}]`,!0):!y&&!s.allErrors&&t.if((0,Ea.not)(d),()=>t.break())})})}}};lf.default=UP});var Uv=P(df=>{"use strict";Object.defineProperty(df,"__esModule",{value:!0});var VP=oe(),BP={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){let{gen:t,schema:r,it:n}=e;if((0,VP.alwaysValidSchema)(n,r)){e.fail();return}let o=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},o),e.failResult(o,()=>e.reset(),()=>e.error())},error:{message:"must NOT be valid"}};df.default=BP});var Vv=P(pf=>{"use strict";Object.defineProperty(pf,"__esModule",{value:!0});var HP=bt(),WP={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:HP.validateUnion,error:{message:"must match a schema in anyOf"}};pf.default=WP});var Bv=P(ff=>{"use strict";Object.defineProperty(ff,"__esModule",{value:!0});var za=K(),GP=oe(),KP={message:"must match exactly one schema in oneOf",params:({params:e})=>(0,za._)`{passingSchemas: ${e.passing}}`},JP={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:KP,code(e){let{gen:t,schema:r,parentSchema:n,it:o}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(o.opts.discriminator&&n.discriminator)return;let s=r,i=t.let("valid",!1),a=t.let("passing",null),c=t.name("_valid");e.setParams({passing:a}),t.block(u),e.result(i,()=>e.reset(),()=>e.error(!0));function u(){s.forEach((d,l)=>{let m;(0,GP.alwaysValidSchema)(o,d)?t.var(c,!0):m=e.subschema({keyword:"oneOf",schemaProp:l,compositeRule:!0},c),l>0&&t.if((0,za._)`${c} && ${i}`).assign(i,!1).assign(a,(0,za._)`[${a}, ${l}]`).else(),t.if(c,()=>{t.assign(i,!0),t.assign(a,l),m&&e.mergeEvaluated(m,za.Name)})})}}};ff.default=JP});var Hv=P(mf=>{"use strict";Object.defineProperty(mf,"__esModule",{value:!0});var YP=oe(),XP={keyword:"allOf",schemaType:"array",code(e){let{gen:t,schema:r,it:n}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");let o=t.name("valid");r.forEach((s,i)=>{if((0,YP.alwaysValidSchema)(n,s))return;let a=e.subschema({keyword:"allOf",schemaProp:i},o);e.ok(o),e.mergeEvaluated(a)})}};mf.default=XP});var Kv=P(hf=>{"use strict";Object.defineProperty(hf,"__esModule",{value:!0});var Pa=K(),Gv=oe(),QP={message:({params:e})=>(0,Pa.str)`must match "${e.ifClause}" schema`,params:({params:e})=>(0,Pa._)`{failingKeyword: ${e.ifClause}}`},eI={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:QP,code(e){let{gen:t,parentSchema:r,it:n}=e;r.then===void 0&&r.else===void 0&&(0,Gv.checkStrictMode)(n,'"if" without "then" and "else" is ignored');let o=Wv(n,"then"),s=Wv(n,"else");if(!o&&!s)return;let i=t.let("valid",!0),a=t.name("_valid");if(c(),e.reset(),o&&s){let d=t.let("ifClause");e.setParams({ifClause:d}),t.if(a,u("then",d),u("else",d))}else o?t.if(a,u("then")):t.if((0,Pa.not)(a),u("else"));e.pass(i,()=>e.error(!0));function c(){let d=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);e.mergeEvaluated(d)}function u(d,l){return()=>{let m=e.subschema({keyword:d},a);t.assign(i,a),e.mergeValidEvaluated(m,i),l?t.assign(l,(0,Pa._)`${d}`):e.setParams({ifClause:d})}}}};function Wv(e,t){let r=e.schema[t];return r!==void 0&&!(0,Gv.alwaysValidSchema)(e,r)}hf.default=eI});var Jv=P(gf=>{"use strict";Object.defineProperty(gf,"__esModule",{value:!0});var tI=oe(),rI={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:e,parentSchema:t,it:r}){t.if===void 0&&(0,tI.checkStrictMode)(r,`"${e}" without "if" is ignored`)}};gf.default=rI});var Yv=P(yf=>{"use strict";Object.defineProperty(yf,"__esModule",{value:!0});var nI=Xp(),oI=Ev(),sI=Qp(),iI=Pv(),aI=Iv(),cI=Ov(),uI=Av(),lI=af(),dI=Zv(),pI=Fv(),fI=Uv(),mI=Vv(),hI=Bv(),gI=Hv(),yI=Kv(),_I=Jv();function vI(e=!1){let t=[fI.default,mI.default,hI.default,gI.default,yI.default,_I.default,uI.default,lI.default,cI.default,dI.default,pI.default];return e?t.push(oI.default,iI.default):t.push(nI.default,sI.default),t.push(aI.default),t}yf.default=vI});var Xv=P(_f=>{"use strict";Object.defineProperty(_f,"__esModule",{value:!0});var Te=K(),bI={message:({schemaCode:e})=>(0,Te.str)`must match format "${e}"`,params:({schemaCode:e})=>(0,Te._)`{format: ${e}}`},$I={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:bI,code(e,t){let{gen:r,data:n,$data:o,schema:s,schemaCode:i,it:a}=e,{opts:c,errSchemaPath:u,schemaEnv:d,self:l}=a;if(!c.validateFormats)return;o?m():h();function m(){let p=r.scopeValue("formats",{ref:l.formats,code:c.code.formats}),f=r.const("fDef",(0,Te._)`${p}[${i}]`),g=r.let("fType"),y=r.let("format");r.if((0,Te._)`typeof ${f} == "object" && !(${f} instanceof RegExp)`,()=>r.assign(g,(0,Te._)`${f}.type || "string"`).assign(y,(0,Te._)`${f}.validate`),()=>r.assign(g,(0,Te._)`"string"`).assign(y,f)),e.fail$data((0,Te.or)(v(),_()));function v(){return c.strictSchema===!1?Te.nil:(0,Te._)`${i} && !${y}`}function _(){let w=d.$async?(0,Te._)`(${f}.async ? await ${y}(${n}) : ${y}(${n}))`:(0,Te._)`${y}(${n})`,E=(0,Te._)`(typeof ${y} == "function" ? ${w} : ${y}.test(${n}))`;return(0,Te._)`${y} && ${y} !== true && ${g} === ${t} && !${E}`}}function h(){let p=l.formats[s];if(!p){v();return}if(p===!0)return;let[f,g,y]=_(p);f===t&&e.pass(w());function v(){if(c.strictSchema===!1){l.logger.warn(E());return}throw new Error(E());function E(){return`unknown format "${s}" ignored in schema at path "${u}"`}}function _(E){let B=E instanceof RegExp?(0,Te.regexpCode)(E):c.code.formats?(0,Te._)`${c.code.formats}${(0,Te.getProperty)(s)}`:void 0,I=r.scopeValue("formats",{key:s,ref:E,code:B});return typeof E=="object"&&!(E instanceof RegExp)?[E.type||"string",E.validate,(0,Te._)`${I}.validate`]:["string",E,I]}function w(){if(typeof p=="object"&&!(p instanceof RegExp)&&p.async){if(!d.$async)throw new Error("async format in sync schema");return(0,Te._)`await ${y}(${n})`}return typeof g=="function"?(0,Te._)`${y}(${n})`:(0,Te._)`${y}.test(${n})`}}}};_f.default=$I});var Qv=P(vf=>{"use strict";Object.defineProperty(vf,"__esModule",{value:!0});var xI=Xv(),wI=[xI.default];vf.default=wI});var e0=P(Un=>{"use strict";Object.defineProperty(Un,"__esModule",{value:!0});Un.contentVocabulary=Un.metadataVocabulary=void 0;Un.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];Un.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var r0=P(bf=>{"use strict";Object.defineProperty(bf,"__esModule",{value:!0});var kI=uv(),SI=wv(),TI=Yv(),EI=Qv(),t0=e0(),zI=[kI.default,SI.default,(0,TI.default)(),EI.default,t0.metadataVocabulary,t0.contentVocabulary];bf.default=zI});var o0=P(Ia=>{"use strict";Object.defineProperty(Ia,"__esModule",{value:!0});Ia.DiscrError=void 0;var n0;(function(e){e.Tag="tag",e.Mapping="mapping"})(n0||(Ia.DiscrError=n0={}))});var i0=P(xf=>{"use strict";Object.defineProperty(xf,"__esModule",{value:!0});var Vn=K(),$f=o0(),s0=pa(),PI=Wo(),II=oe(),RI={message:({params:{discrError:e,tagName:t}})=>e===$f.DiscrError.Tag?`tag "${t}" must be string`:`value of tag "${t}" must be in oneOf`,params:({params:{discrError:e,tag:t,tagName:r}})=>(0,Vn._)`{error: ${e}, tag: ${r}, tagValue: ${t}}`},CI={keyword:"discriminator",type:"object",schemaType:"object",error:RI,code(e){let{gen:t,data:r,schema:n,parentSchema:o,it:s}=e,{oneOf:i}=o;if(!s.opts.discriminator)throw new Error("discriminator: requires discriminator option");let a=n.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!i)throw new Error("discriminator: requires oneOf keyword");let c=t.let("valid",!1),u=t.const("tag",(0,Vn._)`${r}${(0,Vn.getProperty)(a)}`);t.if((0,Vn._)`typeof ${u} == "string"`,()=>d(),()=>e.error(!1,{discrError:$f.DiscrError.Tag,tag:u,tagName:a})),e.ok(c);function d(){let h=m();t.if(!1);for(let p in h)t.elseIf((0,Vn._)`${u} === ${p}`),t.assign(c,l(h[p]));t.else(),e.error(!1,{discrError:$f.DiscrError.Mapping,tag:u,tagName:a}),t.endIf()}function l(h){let p=t.name("valid"),f=e.subschema({keyword:"oneOf",schemaProp:h},p);return e.mergeEvaluated(f,Vn.Name),p}function m(){var h;let p={},f=y(o),g=!0;for(let w=0;w<i.length;w++){let E=i[w];if(E?.$ref&&!(0,II.schemaHasRulesButRef)(E,s.self.RULES)){let I=E.$ref;if(E=s0.resolveRef.call(s.self,s.schemaEnv.root,s.baseId,I),E instanceof s0.SchemaEnv&&(E=E.schema),E===void 0)throw new PI.default(s.opts.uriResolver,s.baseId,I)}let B=(h=E?.properties)===null||h===void 0?void 0:h[a];if(typeof B!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);g=g&&(f||y(E)),v(B,w)}if(!g)throw new Error(`discriminator: "${a}" must be required`);return p;function y({required:w}){return Array.isArray(w)&&w.includes(a)}function v(w,E){if(w.const)_(w.const,E);else if(w.enum)for(let B of w.enum)_(B,E);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function _(w,E){if(typeof w!="string"||w in p)throw new Error(`discriminator: "${a}" values must be unique strings`);p[w]=E}}}};xf.default=CI});var a0=P((Lj,OI)=>{OI.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var kf=P((ye,wf)=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});ye.MissingRefError=ye.ValidationError=ye.CodeGen=ye.Name=ye.nil=ye.stringify=ye.str=ye._=ye.KeywordCxt=ye.Ajv=void 0;var NI=nv(),AI=r0(),jI=i0(),c0=a0(),MI=["/properties"],Ra="http://json-schema.org/draft-07/schema",Bn=class extends NI.default{_addVocabularies(){super._addVocabularies(),AI.default.forEach(t=>this.addVocabulary(t)),this.opts.discriminator&&this.addKeyword(jI.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let t=this.opts.$data?this.$dataMetaSchema(c0,MI):c0;this.addMetaSchema(t,Ra,!1),this.refs["http://json-schema.org/schema"]=Ra}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(Ra)?Ra:void 0)}};ye.Ajv=Bn;wf.exports=ye=Bn;wf.exports.Ajv=Bn;Object.defineProperty(ye,"__esModule",{value:!0});ye.default=Bn;var ZI=Ho();Object.defineProperty(ye,"KeywordCxt",{enumerable:!0,get:function(){return ZI.KeywordCxt}});var Hn=K();Object.defineProperty(ye,"_",{enumerable:!0,get:function(){return Hn._}});Object.defineProperty(ye,"str",{enumerable:!0,get:function(){return Hn.str}});Object.defineProperty(ye,"stringify",{enumerable:!0,get:function(){return Hn.stringify}});Object.defineProperty(ye,"nil",{enumerable:!0,get:function(){return Hn.nil}});Object.defineProperty(ye,"Name",{enumerable:!0,get:function(){return Hn.Name}});Object.defineProperty(ye,"CodeGen",{enumerable:!0,get:function(){return Hn.CodeGen}});var LI=la();Object.defineProperty(ye,"ValidationError",{enumerable:!0,get:function(){return LI.default}});var DI=Wo();Object.defineProperty(ye,"MissingRefError",{enumerable:!0,get:function(){return DI.default}})});var g0=P(Bt=>{"use strict";Object.defineProperty(Bt,"__esModule",{value:!0});Bt.formatNames=Bt.fastFormats=Bt.fullFormats=void 0;function Vt(e,t){return{validate:e,compare:t}}Bt.fullFormats={date:Vt(p0,zf),time:Vt(Tf(!0),Pf),"date-time":Vt(u0(!0),m0),"iso-time":Vt(Tf(),f0),"iso-date-time":Vt(u0(),h0),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:HI,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:QI,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:WI,int32:{type:"number",validate:JI},int64:{type:"number",validate:YI},float:{type:"number",validate:d0},double:{type:"number",validate:d0},password:!0,binary:!0};Bt.fastFormats={...Bt.fullFormats,date:Vt(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,zf),time:Vt(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,Pf),"date-time":Vt(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,m0),"iso-time":Vt(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,f0),"iso-date-time":Vt(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,h0),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i};Bt.formatNames=Object.keys(Bt.fullFormats);function qI(e){return e%4===0&&(e%100!==0||e%400===0)}var FI=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,UI=[0,31,28,31,30,31,30,31,31,30,31,30,31];function p0(e){let t=FI.exec(e);if(!t)return!1;let r=+t[1],n=+t[2],o=+t[3];return n>=1&&n<=12&&o>=1&&o<=(n===2&&qI(r)?29:UI[n])}function zf(e,t){if(e&&t)return e>t?1:e<t?-1:0}var Sf=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function Tf(e){return function(r){let n=Sf.exec(r);if(!n)return!1;let o=+n[1],s=+n[2],i=+n[3],a=n[4],c=n[5]==="-"?-1:1,u=+(n[6]||0),d=+(n[7]||0);if(u>23||d>59||e&&!a)return!1;if(o<=23&&s<=59&&i<60)return!0;let l=s-d*c,m=o-u*c-(l<0?1:0);return(m===23||m===-1)&&(l===59||l===-1)&&i<61}}function Pf(e,t){if(!(e&&t))return;let r=new Date("2020-01-01T"+e).valueOf(),n=new Date("2020-01-01T"+t).valueOf();if(r&&n)return r-n}function f0(e,t){if(!(e&&t))return;let r=Sf.exec(e),n=Sf.exec(t);if(r&&n)return e=r[1]+r[2]+r[3],t=n[1]+n[2]+n[3],e>t?1:e<t?-1:0}var Ef=/t|\s/i;function u0(e){let t=Tf(e);return function(n){let o=n.split(Ef);return o.length===2&&p0(o[0])&&t(o[1])}}function m0(e,t){if(!(e&&t))return;let r=new Date(e).valueOf(),n=new Date(t).valueOf();if(r&&n)return r-n}function h0(e,t){if(!(e&&t))return;let[r,n]=e.split(Ef),[o,s]=t.split(Ef),i=zf(r,o);if(i!==void 0)return i||Pf(n,s)}var VI=/\/|:/,BI=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function HI(e){return VI.test(e)&&BI.test(e)}var l0=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function WI(e){return l0.lastIndex=0,l0.test(e)}var GI=-(2**31),KI=2**31-1;function JI(e){return Number.isInteger(e)&&e<=KI&&e>=GI}function YI(e){return Number.isInteger(e)}function d0(){return!0}var XI=/[^\\]\\Z/;function QI(e){if(XI.test(e))return!1;try{return new RegExp(e),!0}catch{return!1}}});var y0=P(Wn=>{"use strict";Object.defineProperty(Wn,"__esModule",{value:!0});Wn.formatLimitDefinition=void 0;var eR=kf(),Rt=K(),Sr=Rt.operators,Ca={formatMaximum:{okStr:"<=",ok:Sr.LTE,fail:Sr.GT},formatMinimum:{okStr:">=",ok:Sr.GTE,fail:Sr.LT},formatExclusiveMaximum:{okStr:"<",ok:Sr.LT,fail:Sr.GTE},formatExclusiveMinimum:{okStr:">",ok:Sr.GT,fail:Sr.LTE}},tR={message:({keyword:e,schemaCode:t})=>(0,Rt.str)`should be ${Ca[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>(0,Rt._)`{comparison: ${Ca[e].okStr}, limit: ${t}}`};Wn.formatLimitDefinition={keyword:Object.keys(Ca),type:"string",schemaType:"string",$data:!0,error:tR,code(e){let{gen:t,data:r,schemaCode:n,keyword:o,it:s}=e,{opts:i,self:a}=s;if(!i.validateFormats)return;let c=new eR.KeywordCxt(s,a.RULES.all.format.definition,"format");c.$data?u():d();function u(){let m=t.scopeValue("formats",{ref:a.formats,code:i.code.formats}),h=t.const("fmt",(0,Rt._)`${m}[${c.schemaCode}]`);e.fail$data((0,Rt.or)((0,Rt._)`typeof ${h} != "object"`,(0,Rt._)`${h} instanceof RegExp`,(0,Rt._)`typeof ${h}.compare != "function"`,l(h)))}function d(){let m=c.schema,h=a.formats[m];if(!h||h===!0)return;if(typeof h!="object"||h instanceof RegExp||typeof h.compare!="function")throw new Error(`"${o}": format "${m}" does not define "compare" function`);let p=t.scopeValue("formats",{key:m,ref:h,code:i.code.formats?(0,Rt._)`${i.code.formats}${(0,Rt.getProperty)(m)}`:void 0});e.fail$data(l(p))}function l(m){return(0,Rt._)`${m}.compare(${r}, ${n}) ${Ca[o].fail} 0`}},dependencies:["format"]};var rR=e=>(e.addKeyword(Wn.formatLimitDefinition),e);Wn.default=rR});var $0=P((as,b0)=>{"use strict";Object.defineProperty(as,"__esModule",{value:!0});var Gn=g0(),nR=y0(),If=K(),_0=new If.Name("fullFormats"),oR=new If.Name("fastFormats"),Rf=(e,t={keywords:!0})=>{if(Array.isArray(t))return v0(e,t,Gn.fullFormats,_0),e;let[r,n]=t.mode==="fast"?[Gn.fastFormats,oR]:[Gn.fullFormats,_0],o=t.formats||Gn.formatNames;return v0(e,o,r,n),t.keywords&&(0,nR.default)(e),e};Rf.get=(e,t="full")=>{let n=(t==="fast"?Gn.fastFormats:Gn.fullFormats)[e];if(!n)throw new Error(`Unknown format "${e}"`);return n};function v0(e,t,r,n){var o,s;(o=(s=e.opts.code).formats)!==null&&o!==void 0||(s.formats=(0,If._)`require("ajv-formats/dist/formats").${n}`);for(let i of t)e.addFormat(i,r[i])}b0.exports=as=Rf;Object.defineProperty(as,"__esModule",{value:!0});as.default=Rf});function sR(){let e=new x0.default({strict:!1,validateFormats:!0,validateSchema:!1,allErrors:!0});return(0,w0.default)(e),e}var x0,w0,Oa,k0=x(()=>{x0=pn(kf(),1),w0=pn($0(),1);Oa=class{constructor(t){this._ajv=t??sR()}getValidator(t){let r="$id"in t&&typeof t.$id=="string"?this._ajv.getSchema(t.$id)??this._ajv.compile(t):this._ajv.compile(t);return n=>r(n)?{valid:!0,data:n,errorMessage:void 0}:{valid:!1,data:void 0,errorMessage:this._ajv.errorsText(r.errors)}}}});var Na,S0=x(()=>{Na=class{constructor(t){this._server=t}requestStream(t,r,n){return this._server.requestStream(t,r,n)}async getTask(t,r){return this._server.getTask({taskId:t},r)}async getTaskResult(t,r,n){return this._server.getTaskResult({taskId:t},r,n)}async listTasks(t,r){return this._server.listTasks(t?{cursor:t}:void 0,r)}async cancelTask(t,r){return this._server.cancelTask({taskId:t},r)}}});function T0(e,t,r){if(!e)throw new Error(`${r} does not support task creation (required for ${t})`);switch(t){case"tools/call":if(!e.tools?.call)throw new Error(`${r} does not support task creation for tools/call (required for ${t})`);break;default:break}}function E0(e,t,r){if(!e)throw new Error(`${r} does not support task creation (required for ${t})`);switch(t){case"sampling/createMessage":if(!e.sampling?.createMessage)throw new Error(`${r} does not support task creation for sampling/createMessage (required for ${t})`);break;case"elicitation/create":if(!e.elicitation?.create)throw new Error(`${r} does not support task creation for elicitation/create (required for ${t})`);break;default:break}}var z0=x(()=>{});var Aa,P0=x(()=>{jy();Ro();k0();vo();S0();z0();Aa=class extends Yi{constructor(t,r){super(r),this._serverInfo=t,this._loggingLevels=new Map,this.LOG_LEVEL_SEVERITY=new Map(Io.options.map((n,o)=>[n,o])),this.isMessageIgnored=(n,o)=>{let s=this._loggingLevels.get(o);return s?this.LOG_LEVEL_SEVERITY.get(n)<this.LOG_LEVEL_SEVERITY.get(s):!1},this._capabilities=r?.capabilities??{},this._instructions=r?.instructions,this._jsonSchemaValidator=r?.jsonSchemaValidator??new Oa,this.setRequestHandler(Vl,n=>this._oninitialize(n)),this.setNotificationHandler(Bl,()=>this.oninitialized?.()),this._capabilities.logging&&this.setRequestHandler(Xl,async(n,o)=>{let s=o.sessionId||o.requestInfo?.headers["mcp-session-id"]||void 0,{level:i}=n.params,a=Io.safeParse(i);return a.success&&this._loggingLevels.set(s,a.data),{}})}get experimental(){return this._experimental||(this._experimental={tasks:new Na(this)}),this._experimental}registerCapabilities(t){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=Ay(this._capabilities,t)}setRequestHandler(t,r){let o=mr(t)?.method;if(!o)throw new Error("Schema is missing a method literal");let s;if(ht(o)){let a=o;s=a._zod?.def?.value??a.value}else{let a=o;s=a._def?.value??a.value}if(typeof s!="string")throw new Error("Schema method literal must be a string");if(s==="tools/call"){let a=async(c,u)=>{let d=fr(Rn,c);if(!d.success){let p=d.error instanceof Error?d.error.message:String(d.error);throw new M(D.InvalidParams,`Invalid tools/call request: ${p}`)}let{params:l}=d.data,m=await Promise.resolve(r(c,u));if(l.task){let p=fr(Pn,m);if(!p.success){let f=p.error instanceof Error?p.error.message:String(p.error);throw new M(D.InvalidParams,`Invalid task creation result: ${f}`)}return p.data}let h=fr(Zi,m);if(!h.success){let p=h.error instanceof Error?h.error.message:String(h.error);throw new M(D.InvalidParams,`Invalid tools/call result: ${p}`)}return h.data};return super.setRequestHandler(t,a)}return super.setRequestHandler(t,r)}assertCapabilityForMethod(t){switch(t){case"sampling/createMessage":if(!this._clientCapabilities?.sampling)throw new Error(`Client does not support sampling (required for ${t})`);break;case"elicitation/create":if(!this._clientCapabilities?.elicitation)throw new Error(`Client does not support elicitation (required for ${t})`);break;case"roots/list":if(!this._clientCapabilities?.roots)throw new Error(`Client does not support listing roots (required for ${t})`);break;case"ping":break}}assertNotificationCapability(t){switch(t){case"notifications/message":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${t})`);break;case"notifications/resources/updated":case"notifications/resources/list_changed":if(!this._capabilities.resources)throw new Error(`Server does not support notifying about resources (required for ${t})`);break;case"notifications/tools/list_changed":if(!this._capabilities.tools)throw new Error(`Server does not support notifying of tool list changes (required for ${t})`);break;case"notifications/prompts/list_changed":if(!this._capabilities.prompts)throw new Error(`Server does not support notifying of prompt list changes (required for ${t})`);break;case"notifications/elicitation/complete":if(!this._clientCapabilities?.elicitation?.url)throw new Error(`Client does not support URL elicitation (required for ${t})`);break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(t){if(this._capabilities)switch(t){case"completion/complete":if(!this._capabilities.completions)throw new Error(`Server does not support completions (required for ${t})`);break;case"logging/setLevel":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${t})`);break;case"prompts/get":case"prompts/list":if(!this._capabilities.prompts)throw new Error(`Server does not support prompts (required for ${t})`);break;case"resources/list":case"resources/templates/list":case"resources/read":if(!this._capabilities.resources)throw new Error(`Server does not support resources (required for ${t})`);break;case"tools/call":case"tools/list":if(!this._capabilities.tools)throw new Error(`Server does not support tools (required for ${t})`);break;case"tasks/get":case"tasks/list":case"tasks/result":case"tasks/cancel":if(!this._capabilities.tasks)throw new Error(`Server does not support tasks capability (required for ${t})`);break;case"ping":case"initialize":break}}assertTaskCapability(t){E0(this._clientCapabilities?.tasks?.requests,t,"Client")}assertTaskHandlerCapability(t){this._capabilities&&T0(this._capabilities.tasks?.requests,t,"Server")}async _oninitialize(t){let r=t.params.protocolVersion;return this._clientCapabilities=t.params.capabilities,this._clientVersion=t.params.clientInfo,{protocolVersion:Ag.includes(r)?r:Ll,capabilities:this.getCapabilities(),serverInfo:this._serverInfo,...this._instructions&&{instructions:this._instructions}}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return this._capabilities}async ping(){return this.request({method:"ping"},xi)}async createMessage(t,r){if((t.tools||t.toolChoice)&&!this._clientCapabilities?.sampling?.tools)throw new Error("Client does not support sampling tools capability.");if(t.messages.length>0){let n=t.messages[t.messages.length-1],o=Array.isArray(n.content)?n.content:[n.content],s=o.some(u=>u.type==="tool_result"),i=t.messages.length>1?t.messages[t.messages.length-2]:void 0,a=i?Array.isArray(i.content)?i.content:[i.content]:[],c=a.some(u=>u.type==="tool_use");if(s){if(o.some(u=>u.type!=="tool_result"))throw new Error("The last message must contain only tool_result content if any is present");if(!c)throw new Error("tool_result blocks are not matching any tool_use from the previous message")}if(c){let u=new Set(a.filter(l=>l.type==="tool_use").map(l=>l.id)),d=new Set(o.filter(l=>l.type==="tool_result").map(l=>l.toolUseId));if(u.size!==d.size||![...u].every(l=>d.has(l)))throw new Error("ids of tool_result blocks and tool_use blocks from previous message do not match")}}return t.tools?this.request({method:"sampling/createMessage",params:t},ed,r):this.request({method:"sampling/createMessage",params:t},Ql,r)}async elicitInput(t,r){switch(t.mode??"form"){case"url":{if(!this._clientCapabilities?.elicitation?.url)throw new Error("Client does not support url elicitation.");let o=t;return this.request({method:"elicitation/create",params:o},Li,r)}case"form":{if(!this._clientCapabilities?.elicitation?.form)throw new Error("Client does not support form elicitation.");let o=t.mode==="form"?t:{...t,mode:"form"},s=await this.request({method:"elicitation/create",params:o},Li,r);if(s.action==="accept"&&s.content&&o.requestedSchema)try{let a=this._jsonSchemaValidator.getValidator(o.requestedSchema)(s.content);if(!a.valid)throw new M(D.InvalidParams,`Elicitation response content does not match requested schema: ${a.errorMessage}`)}catch(i){throw i instanceof M?i:new M(D.InternalError,`Error validating elicitation response: ${i instanceof Error?i.message:String(i)}`)}return s}}}createElicitationCompletionNotifier(t,r){if(!this._clientCapabilities?.elicitation?.url)throw new Error("Client does not support URL elicitation (required for notifications/elicitation/complete)");return()=>this.notification({method:"notifications/elicitation/complete",params:{elicitationId:t}},r)}async listRoots(t,r){return this.request({method:"roots/list",params:t},td,r)}async sendLoggingMessage(t,r){if(this._capabilities.logging&&!this.isMessageIgnored(t.level,r))return this.notification({method:"notifications/message",params:t})}async sendResourceUpdated(t){return this.notification({method:"notifications/resources/updated",params:t})}async sendResourceListChanged(){return this.notification({method:"notifications/resources/list_changed"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}}});function Cf(e){return!!e&&typeof e=="object"&&R0 in e}function C0(e){return e[R0]?.complete}var R0,I0,O0=x(()=>{R0=Symbol.for("mcp.completable");(function(e){e.Completable="McpCompletable"})(I0||(I0={}))});var N0=x(()=>{});function aR(e){let t=[];if(e.length===0)return{isValid:!1,warnings:["Tool name cannot be empty"]};if(e.length>128)return{isValid:!1,warnings:[`Tool name exceeds maximum length of 128 characters (current: ${e.length})`]};if(e.includes(" ")&&t.push("Tool name contains spaces, which may cause parsing issues"),e.includes(",")&&t.push("Tool name contains commas, which may cause parsing issues"),(e.startsWith("-")||e.endsWith("-"))&&t.push("Tool name starts or ends with a dash, which may cause parsing issues in some contexts"),(e.startsWith(".")||e.endsWith("."))&&t.push("Tool name starts or ends with a dot, which may cause parsing issues in some contexts"),!iR.test(e)){let r=e.split("").filter(n=>!/[A-Za-z0-9._-]/.test(n)).filter((n,o,s)=>s.indexOf(n)===o);return t.push(`Tool name contains invalid characters: ${r.map(n=>`"${n}"`).join(", ")}`,"Allowed characters are: A-Z, a-z, 0-9, underscore (_), dash (-), and dot (.)"),{isValid:!1,warnings:t}}return{isValid:!0,warnings:t}}function cR(e,t){if(t.length>0){console.warn(`Tool name validation warning for "${e}":`);for(let r of t)console.warn(`  - ${r}`);console.warn("Tool registration will proceed, but this may cause compatibility issues."),console.warn("Consider updating the tool name to conform to the MCP tool naming standard."),console.warn("See SEP: Specify Format for Tool Names (https://github.com/modelcontextprotocol/modelcontextprotocol/issues/986) for more details.")}}function Of(e){let t=aR(e);return cR(e,t.warnings),t.isValid}var iR,A0=x(()=>{iR=/^[A-Za-z0-9._-]{1,128}$/});var ja,j0=x(()=>{ja=class{constructor(t){this._mcpServer=t}registerToolTask(t,r,n){let o={taskSupport:"required",...r.execution};if(o.taskSupport==="forbidden")throw new Error(`Cannot register task-based tool '${t}' with taskSupport 'forbidden'. Use registerTool() instead.`);return this._mcpServer._createRegisteredTool(t,r.title,r.description,r.inputSchema,r.outputSchema,r.annotations,o,r._meta,n)}}});var Nf=x(()=>{Hs();Hs()});function L0(e){return e!==null&&typeof e=="object"&&"parse"in e&&typeof e.parse=="function"&&"safeParse"in e&&typeof e.safeParse=="function"}function lR(e){return"_def"in e||"_zod"in e||L0(e)}function Af(e){return typeof e!="object"||e===null||lR(e)?!1:Object.keys(e).length===0?!0:Object.values(e).some(L0)}function M0(e){if(e)return Af(e)?Xr(e):e}function dR(e){let t=mr(e);return t?Object.entries(t).map(([r,n])=>{let o=ag(n),s=cg(n);return{name:r,description:o,required:!s}}):[]}function Tr(e){let r=mr(e)?.method;if(!r)throw new Error("Schema is missing a method literal");let n=gi(r);if(typeof n=="string")return n;throw new Error("Schema method literal must be a string")}function Z0(e){return{completion:{values:e.slice(0,100),total:e.length,hasMore:e.length>100}}}var Ma,uR,cs,D0=x(()=>{P0();vo();Zd();Ro();O0();N0();A0();j0();Nf();Ma=class{constructor(t,r){this._registeredResources={},this._registeredResourceTemplates={},this._registeredTools={},this._registeredPrompts={},this._toolHandlersInitialized=!1,this._completionHandlerInitialized=!1,this._resourceHandlersInitialized=!1,this._promptHandlersInitialized=!1,this.server=new Aa(t,r)}get experimental(){return this._experimental||(this._experimental={tasks:new ja(this)}),this._experimental}async connect(t){return await this.server.connect(t)}async close(){await this.server.close()}setToolRequestHandlers(){this._toolHandlersInitialized||(this.server.assertCanSetRequestHandler(Tr(Mi)),this.server.assertCanSetRequestHandler(Tr(Rn)),this.server.registerCapabilities({tools:{listChanged:!0}}),this.server.setRequestHandler(Mi,()=>({tools:Object.entries(this._registeredTools).filter(([,t])=>t.enabled).map(([t,r])=>{let n={name:t,title:r.title,description:r.description,inputSchema:(()=>{let o=En(r.inputSchema);return o?Ad(o,{strictUnions:!0,pipeStrategy:"input"}):uR})(),annotations:r.annotations,execution:r.execution,_meta:r._meta};if(r.outputSchema){let o=En(r.outputSchema);o&&(n.outputSchema=Ad(o,{strictUnions:!0,pipeStrategy:"output"}))}return n})})),this.server.setRequestHandler(Rn,async(t,r)=>{try{let n=this._registeredTools[t.params.name];if(!n)throw new M(D.InvalidParams,`Tool ${t.params.name} not found`);if(!n.enabled)throw new M(D.InvalidParams,`Tool ${t.params.name} disabled`);let o=!!t.params.task,s=n.execution?.taskSupport,i="createTask"in n.handler;if((s==="required"||s==="optional")&&!i)throw new M(D.InternalError,`Tool ${t.params.name} has taskSupport '${s}' but was not registered with registerToolTask`);if(s==="required"&&!o)throw new M(D.MethodNotFound,`Tool ${t.params.name} requires task augmentation (taskSupport: 'required')`);if(s==="optional"&&!o&&i)return await this.handleAutomaticTaskPolling(n,t,r);let a=await this.validateToolInput(n,t.params.arguments,t.params.name),c=await this.executeToolHandler(n,a,r);return o||await this.validateToolOutput(n,c,t.params.name),c}catch(n){if(n instanceof M&&n.code===D.UrlElicitationRequired)throw n;return this.createToolError(n instanceof Error?n.message:String(n))}}),this._toolHandlersInitialized=!0)}createToolError(t){return{content:[{type:"text",text:t}],isError:!0}}async validateToolInput(t,r,n){if(!t.inputSchema)return;let s=En(t.inputSchema)??t.inputSchema,i=await mi(s,r);if(!i.success){let a="error"in i?i.error:"Unknown error",c=hi(a);throw new M(D.InvalidParams,`Input validation error: Invalid arguments for tool ${n}: ${c}`)}return i.data}async validateToolOutput(t,r,n){if(!t.outputSchema||!("content"in r)||r.isError)return;if(!r.structuredContent)throw new M(D.InvalidParams,`Output validation error: Tool ${n} has an output schema but no structured content was provided`);let o=En(t.outputSchema),s=await mi(o,r.structuredContent);if(!s.success){let i="error"in s?s.error:"Unknown error",a=hi(i);throw new M(D.InvalidParams,`Output validation error: Invalid structured content for tool ${n}: ${a}`)}}async executeToolHandler(t,r,n){let o=t.handler;if("createTask"in o){if(!n.taskStore)throw new Error("No task store provided.");let i={...n,taskStore:n.taskStore};if(t.inputSchema){let a=o;return await Promise.resolve(a.createTask(r,i))}else{let a=o;return await Promise.resolve(a.createTask(i))}}if(t.inputSchema){let i=o;return await Promise.resolve(i(r,n))}else{let i=o;return await Promise.resolve(i(n))}}async handleAutomaticTaskPolling(t,r,n){if(!n.taskStore)throw new Error("No task store provided for task-capable tool.");let o=await this.validateToolInput(t,r.params.arguments,r.params.name),s=t.handler,i={...n,taskStore:n.taskStore},a=o?await Promise.resolve(s.createTask(o,i)):await Promise.resolve(s.createTask(i)),c=a.task.taskId,u=a.task,d=u.pollInterval??5e3;for(;u.status!=="completed"&&u.status!=="failed"&&u.status!=="cancelled";){await new Promise(m=>setTimeout(m,d));let l=await n.taskStore.getTask(c);if(!l)throw new M(D.InternalError,`Task ${c} not found during polling`);u=l}return await n.taskStore.getTaskResult(c)}setCompletionRequestHandler(){this._completionHandlerInitialized||(this.server.assertCanSetRequestHandler(Tr(Di)),this.server.registerCapabilities({completions:{}}),this.server.setRequestHandler(Di,async t=>{switch(t.params.ref.type){case"ref/prompt":return Yg(t),this.handlePromptCompletion(t,t.params.ref);case"ref/resource":return Xg(t),this.handleResourceCompletion(t,t.params.ref);default:throw new M(D.InvalidParams,`Invalid completion reference: ${t.params.ref}`)}}),this._completionHandlerInitialized=!0)}async handlePromptCompletion(t,r){let n=this._registeredPrompts[r.name];if(!n)throw new M(D.InvalidParams,`Prompt ${r.name} not found`);if(!n.enabled)throw new M(D.InvalidParams,`Prompt ${r.name} disabled`);if(!n.argsSchema)return cs;let s=mr(n.argsSchema)?.[t.params.argument.name];if(!Cf(s))return cs;let i=C0(s);if(!i)return cs;let a=await i(t.params.argument.value,t.params.context);return Z0(a)}async handleResourceCompletion(t,r){let n=Object.values(this._registeredResourceTemplates).find(i=>i.resourceTemplate.uriTemplate.toString()===r.uri);if(!n){if(this._registeredResources[r.uri])return cs;throw new M(D.InvalidParams,`Resource template ${t.params.ref.uri} not found`)}let o=n.resourceTemplate.completeCallback(t.params.argument.name);if(!o)return cs;let s=await o(t.params.argument.value,t.params.context);return Z0(s)}setResourceRequestHandlers(){this._resourceHandlersInitialized||(this.server.assertCanSetRequestHandler(Tr(Ci)),this.server.assertCanSetRequestHandler(Tr(Oi)),this.server.assertCanSetRequestHandler(Tr(Ni)),this.server.registerCapabilities({resources:{listChanged:!0}}),this.server.setRequestHandler(Ci,async(t,r)=>{let n=Object.entries(this._registeredResources).filter(([s,i])=>i.enabled).map(([s,i])=>({uri:s,name:i.name,...i.metadata})),o=[];for(let s of Object.values(this._registeredResourceTemplates)){if(!s.resourceTemplate.listCallback)continue;let i=await s.resourceTemplate.listCallback(r);for(let a of i.resources)o.push({...s.metadata,...a})}return{resources:[...n,...o]}}),this.server.setRequestHandler(Oi,async()=>({resourceTemplates:Object.entries(this._registeredResourceTemplates).map(([r,n])=>({name:r,uriTemplate:n.resourceTemplate.uriTemplate.toString(),...n.metadata}))})),this.server.setRequestHandler(Ni,async(t,r)=>{let n=new URL(t.params.uri),o=this._registeredResources[n.toString()];if(o){if(!o.enabled)throw new M(D.InvalidParams,`Resource ${n} disabled`);return o.readCallback(n,r)}for(let s of Object.values(this._registeredResourceTemplates)){let i=s.resourceTemplate.uriTemplate.match(n.toString());if(i)return s.readCallback(n,i,r)}throw new M(D.InvalidParams,`Resource ${n} not found`)}),this._resourceHandlersInitialized=!0)}setPromptRequestHandlers(){this._promptHandlersInitialized||(this.server.assertCanSetRequestHandler(Tr(Ai)),this.server.assertCanSetRequestHandler(Tr(ji)),this.server.registerCapabilities({prompts:{listChanged:!0}}),this.server.setRequestHandler(Ai,()=>({prompts:Object.entries(this._registeredPrompts).filter(([,t])=>t.enabled).map(([t,r])=>({name:t,title:r.title,description:r.description,arguments:r.argsSchema?dR(r.argsSchema):void 0}))})),this.server.setRequestHandler(ji,async(t,r)=>{let n=this._registeredPrompts[t.params.name];if(!n)throw new M(D.InvalidParams,`Prompt ${t.params.name} not found`);if(!n.enabled)throw new M(D.InvalidParams,`Prompt ${t.params.name} disabled`);if(n.argsSchema){let o=En(n.argsSchema),s=await mi(o,t.params.arguments);if(!s.success){let c="error"in s?s.error:"Unknown error",u=hi(c);throw new M(D.InvalidParams,`Invalid arguments for prompt ${t.params.name}: ${u}`)}let i=s.data,a=n.callback;return await Promise.resolve(a(i,r))}else{let o=n.callback;return await Promise.resolve(o(r))}}),this._promptHandlersInitialized=!0)}resource(t,r,...n){let o;typeof n[0]=="object"&&(o=n.shift());let s=n[0];if(typeof r=="string"){if(this._registeredResources[r])throw new Error(`Resource ${r} is already registered`);let i=this._createRegisteredResource(t,void 0,r,o,s);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),i}else{if(this._registeredResourceTemplates[t])throw new Error(`Resource template ${t} is already registered`);let i=this._createRegisteredResourceTemplate(t,void 0,r,o,s);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),i}}registerResource(t,r,n,o){if(typeof r=="string"){if(this._registeredResources[r])throw new Error(`Resource ${r} is already registered`);let s=this._createRegisteredResource(t,n.title,r,n,o);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),s}else{if(this._registeredResourceTemplates[t])throw new Error(`Resource template ${t} is already registered`);let s=this._createRegisteredResourceTemplate(t,n.title,r,n,o);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),s}}_createRegisteredResource(t,r,n,o,s){let i={name:t,title:r,metadata:o,readCallback:s,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({uri:null}),update:a=>{typeof a.uri<"u"&&a.uri!==n&&(delete this._registeredResources[n],a.uri&&(this._registeredResources[a.uri]=i)),typeof a.name<"u"&&(i.name=a.name),typeof a.title<"u"&&(i.title=a.title),typeof a.metadata<"u"&&(i.metadata=a.metadata),typeof a.callback<"u"&&(i.readCallback=a.callback),typeof a.enabled<"u"&&(i.enabled=a.enabled),this.sendResourceListChanged()}};return this._registeredResources[n]=i,i}_createRegisteredResourceTemplate(t,r,n,o,s){let i={resourceTemplate:n,title:r,metadata:o,readCallback:s,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({name:null}),update:u=>{typeof u.name<"u"&&u.name!==t&&(delete this._registeredResourceTemplates[t],u.name&&(this._registeredResourceTemplates[u.name]=i)),typeof u.title<"u"&&(i.title=u.title),typeof u.template<"u"&&(i.resourceTemplate=u.template),typeof u.metadata<"u"&&(i.metadata=u.metadata),typeof u.callback<"u"&&(i.readCallback=u.callback),typeof u.enabled<"u"&&(i.enabled=u.enabled),this.sendResourceListChanged()}};this._registeredResourceTemplates[t]=i;let a=n.uriTemplate.variableNames;return Array.isArray(a)&&a.some(u=>!!n.completeCallback(u))&&this.setCompletionRequestHandler(),i}_createRegisteredPrompt(t,r,n,o,s){let i={title:r,description:n,argsSchema:o===void 0?void 0:Xr(o),callback:s,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({name:null}),update:a=>{typeof a.name<"u"&&a.name!==t&&(delete this._registeredPrompts[t],a.name&&(this._registeredPrompts[a.name]=i)),typeof a.title<"u"&&(i.title=a.title),typeof a.description<"u"&&(i.description=a.description),typeof a.argsSchema<"u"&&(i.argsSchema=Xr(a.argsSchema)),typeof a.callback<"u"&&(i.callback=a.callback),typeof a.enabled<"u"&&(i.enabled=a.enabled),this.sendPromptListChanged()}};return this._registeredPrompts[t]=i,o&&Object.values(o).some(c=>{let u=c instanceof Qe?c._def?.innerType:c;return Cf(u)})&&this.setCompletionRequestHandler(),i}_createRegisteredTool(t,r,n,o,s,i,a,c,u){Of(t);let d={title:r,description:n,inputSchema:M0(o),outputSchema:M0(s),annotations:i,execution:a,_meta:c,handler:u,enabled:!0,disable:()=>d.update({enabled:!1}),enable:()=>d.update({enabled:!0}),remove:()=>d.update({name:null}),update:l=>{typeof l.name<"u"&&l.name!==t&&(typeof l.name=="string"&&Of(l.name),delete this._registeredTools[t],l.name&&(this._registeredTools[l.name]=d)),typeof l.title<"u"&&(d.title=l.title),typeof l.description<"u"&&(d.description=l.description),typeof l.paramsSchema<"u"&&(d.inputSchema=Xr(l.paramsSchema)),typeof l.outputSchema<"u"&&(d.outputSchema=Xr(l.outputSchema)),typeof l.callback<"u"&&(d.handler=l.callback),typeof l.annotations<"u"&&(d.annotations=l.annotations),typeof l._meta<"u"&&(d._meta=l._meta),typeof l.enabled<"u"&&(d.enabled=l.enabled),this.sendToolListChanged()}};return this._registeredTools[t]=d,this.setToolRequestHandlers(),this.sendToolListChanged(),d}tool(t,...r){if(this._registeredTools[t])throw new Error(`Tool ${t} is already registered`);let n,o,s,i;if(typeof r[0]=="string"&&(n=r.shift()),r.length>1){let c=r[0];Af(c)?(o=r.shift(),r.length>1&&typeof r[0]=="object"&&r[0]!==null&&!Af(r[0])&&(i=r.shift())):typeof c=="object"&&c!==null&&(i=r.shift())}let a=r[0];return this._createRegisteredTool(t,void 0,n,o,s,i,{taskSupport:"forbidden"},void 0,a)}registerTool(t,r,n){if(this._registeredTools[t])throw new Error(`Tool ${t} is already registered`);let{title:o,description:s,inputSchema:i,outputSchema:a,annotations:c,_meta:u}=r;return this._createRegisteredTool(t,o,s,i,a,c,{taskSupport:"forbidden"},u,n)}prompt(t,...r){if(this._registeredPrompts[t])throw new Error(`Prompt ${t} is already registered`);let n;typeof r[0]=="string"&&(n=r.shift());let o;r.length>1&&(o=r.shift());let s=r[0],i=this._createRegisteredPrompt(t,void 0,n,o,s);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),i}registerPrompt(t,r,n){if(this._registeredPrompts[t])throw new Error(`Prompt ${t} is already registered`);let{title:o,description:s,argsSchema:i}=r,a=this._createRegisteredPrompt(t,o,s,i,n);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),a}isConnected(){return this.server.transport!==void 0}async sendLoggingMessage(t,r){return this.server.sendLoggingMessage(t,r)}sendResourceListChanged(){this.isConnected()&&this.server.sendResourceListChanged()}sendToolListChanged(){this.isConnected()&&this.server.sendToolListChanged()}sendPromptListChanged(){this.isConnected()&&this.server.sendPromptListChanged()}},uR={type:"object",properties:{}};cs={completion:{values:[],hasMore:!1}}});function pR(e){return Ug.parse(JSON.parse(e))}function q0(e){return JSON.stringify(e)+`
`}var Za,F0=x(()=>{Ro();Za=class{append(t){this._buffer=this._buffer?Buffer.concat([this._buffer,t]):t}readMessage(){if(!this._buffer)return null;let t=this._buffer.indexOf(`
`);if(t===-1)return null;let r=this._buffer.toString("utf8",0,t).replace(/\r$/,"");return this._buffer=this._buffer.subarray(t+1),pR(r)}clear(){this._buffer=void 0}}});import U0 from"node:process";var La,V0=x(()=>{F0();La=class{constructor(t=U0.stdin,r=U0.stdout){this._stdin=t,this._stdout=r,this._readBuffer=new Za,this._started=!1,this._ondata=n=>{this._readBuffer.append(n),this.processReadBuffer()},this._onerror=n=>{this.onerror?.(n)}}async start(){if(this._started)throw new Error("StdioServerTransport already started! If using Server class, note that connect() calls start() automatically.");this._started=!0,this._stdin.on("data",this._ondata),this._stdin.on("error",this._onerror)}processReadBuffer(){for(;;)try{let t=this._readBuffer.readMessage();if(t===null)break;this.onmessage?.(t)}catch(t){this.onerror?.(t)}}async close(){this._stdin.off("data",this._ondata),this._stdin.off("error",this._onerror),this._stdin.listenerCount("data")===0&&this._stdin.pause(),this._readBuffer.clear(),this.onclose?.()}send(t){return new Promise(r=>{let n=q0(t);this._stdout.write(n)?r():this._stdout.once("drain",r)})}}});var W0={};ms(W0,{PolyglotExecutor:()=>us});import{spawn as fR,execSync as mR}from"node:child_process";import{mkdtempSync as hR,writeFileSync as B0,rmSync as gR}from"node:fs";import{join as H0,resolve as yR}from"node:path";import{tmpdir as _R}from"node:os";var us,jf=x(()=>{"use strict";Zs();us=class e{#e;#t;#r;constructor(t){this.#e=t?.maxOutputBytes??102400,this.#t=t?.projectRoot??process.cwd(),this.#r=t?.runtimes??ir()}get runtimes(){return{...this.#r}}async execute(t){let{language:r,code:n,timeout:o=3e4}=t,s=hR(H0(_R(),"ctx-mode-"));try{let i=this.#n(s,n,r),a=_m(this.#r,r,i);return a[0]==="__rust_compile_run__"?await this.#i(i,s,o):await this.#s(a,s,o)}finally{gR(s,{recursive:!0,force:!0})}}async executeFile(t){let{path:r,language:n,code:o,timeout:s=3e4}=t,i=yR(this.#t,r),a=this.#c(i,n,o);return this.execute({language:n,code:a,timeout:s})}#n(t,r,n){let o={javascript:"js",typescript:"ts",python:"py",shell:"sh",ruby:"rb",go:"go",rust:"rs",php:"php",perl:"pl",r:"R"};n==="go"&&!r.includes("package ")&&(r=`package main

import "fmt"

func main() {
${r}
}
`),n==="php"&&!r.trimStart().startsWith("<?")&&(r=`<?php
${r}`);let s=H0(t,`script.${o[n]}`);return n==="shell"?B0(s,r,{encoding:"utf-8",mode:448}):B0(s,r,"utf-8"),s}async#i(t,r,n){let o=t.replace(/\.rs$/,"");try{mR(`rustc ${t} -o ${o} 2>&1`,{cwd:r,timeout:Math.min(n,3e4),encoding:"utf-8"})}catch(s){return{stdout:"",stderr:`Compilation failed:
${s instanceof Error?s.stderr||s.message:String(s)}`,exitCode:1,timedOut:!1}}return this.#s([o],r,n)}static#o(t,r){if(Buffer.byteLength(t)<=r)return t;let n=t.split(`
`),o=Math.floor(r*.6),s=r-o,i=[],a=0;for(let h of n){let p=Buffer.byteLength(h)+1;if(a+p>o)break;i.push(h),a+=p}let c=[],u=0;for(let h=n.length-1;h>=i.length;h--){let p=Buffer.byteLength(n[h])+1;if(u+p>s)break;c.unshift(n[h]),u+=p}let d=n.length-i.length-c.length,l=Buffer.byteLength(t)-a-u,m=`

... [${d} lines / ${(l/1024).toFixed(1)}KB truncated \u2014 showing first ${i.length} + last ${c.length} lines] ...

`;return i.join(`
`)+m+c.join(`
`)}async#s(t,r,n){return new Promise(o=>{let s=fR(t[0],t.slice(1),{cwd:r,stdio:["ignore","pipe","pipe"],env:this.#a(r)}),i=!1,a=setTimeout(()=>{i=!0,s.kill("SIGKILL")},n),c=[],u=[];s.stdout.on("data",d=>{c.push(d)}),s.stderr.on("data",d=>{u.push(d)}),s.on("close",d=>{clearTimeout(a);let l=Buffer.concat(c).toString("utf-8"),m=Buffer.concat(u).toString("utf-8"),h=this.#e,p=e.#o(l,h),f=e.#o(m,h);o({stdout:p,stderr:f,exitCode:i?1:d??1,timedOut:i})}),s.on("error",d=>{clearTimeout(a),o({stdout:"",stderr:d.message,exitCode:1,timedOut:!1})})})}#a(t){let r=process.env.HOME??process.env.USERPROFILE??t,n=["GH_TOKEN","GITHUB_TOKEN","GH_HOST","AWS_ACCESS_KEY_ID","AWS_SECRET_ACCESS_KEY","AWS_SESSION_TOKEN","AWS_REGION","AWS_DEFAULT_REGION","AWS_PROFILE","GOOGLE_APPLICATION_CREDENTIALS","CLOUDSDK_CONFIG","DOCKER_HOST","KUBECONFIG","NPM_TOKEN","NODE_AUTH_TOKEN","npm_config_registry","HTTP_PROXY","HTTPS_PROXY","NO_PROXY","SSL_CERT_FILE","CURL_CA_BUNDLE","XDG_CONFIG_HOME","XDG_DATA_HOME"],o={PATH:process.env.PATH??"/usr/local/bin:/usr/bin:/bin",HOME:r,TMPDIR:t,LANG:"en_US.UTF-8",PYTHONDONTWRITEBYTECODE:"1",PYTHONUNBUFFERED:"1",NO_COLOR:"1"};for(let s of n)process.env[s]&&(o[s]=process.env[s]);return o}#c(t,r,n){let o=JSON.stringify(t);switch(r){case"javascript":case"typescript":return`const FILE_CONTENT_PATH = ${o};
const FILE_CONTENT = require("fs").readFileSync(FILE_CONTENT_PATH, "utf-8");
${n}`;case"python":return`FILE_CONTENT_PATH = ${o}
with open(FILE_CONTENT_PATH, "r") as _f:
    FILE_CONTENT = _f.read()
${n}`;case"shell":return`FILE_CONTENT_PATH=${o}
FILE_CONTENT=$(cat ${o})
${n}`;case"ruby":return`FILE_CONTENT_PATH = ${o}
FILE_CONTENT = File.read(FILE_CONTENT_PATH)
${n}`;case"go":return`package main

import (
	"fmt"
	"os"
)

var FILE_CONTENT_PATH = ${o}

func main() {
	b, _ := os.ReadFile(FILE_CONTENT_PATH)
	FILE_CONTENT := string(b)
	_ = FILE_CONTENT
	_ = fmt.Sprint()
${n}
}
`;case"rust":return`use std::fs;

fn main() {
    let file_content_path = ${o};
    let file_content = fs::read_to_string(file_content_path).unwrap();
${n}
}
`;case"php":return`<?php
$FILE_CONTENT_PATH = ${o};
$FILE_CONTENT = file_get_contents($FILE_CONTENT_PATH);
${n}`;case"perl":return`my $FILE_CONTENT_PATH = ${o};
open(my $fh, '<', $FILE_CONTENT_PATH) or die "Cannot open: $!";
my $FILE_CONTENT = do { local $/; <$fh> };
close($fh);
${n}`;case"r":return`FILE_CONTENT_PATH <- ${o}
FILE_CONTENT <- readLines(FILE_CONTENT_PATH, warn=FALSE)
FILE_CONTENT <- paste(FILE_CONTENT, collapse="\\n")
${n}`}}}});import{createRequire as vR}from"node:module";import{readFileSync as bR,readdirSync as $R,unlinkSync as K0}from"node:fs";import{tmpdir as J0}from"node:os";import{join as Y0}from"node:path";function xR(){return Mf||(Mf=vR(import.meta.url)("better-sqlite3")),Mf}function wR(e){let t=e.replace(/['"(){}[\]*:^~]/g," ").split(/\s+/).filter(r=>r.length>0&&!["AND","OR","NOT","NEAR"].includes(r.toUpperCase()));return t.length===0?'""':t.map(r=>`"${r}"`).join(" OR ")}function kR(e){let t=e.replace(/["'(){}[\]*:^~]/g,"").trim();if(t.length<3)return"";let r=t.split(/\s+/).filter(n=>n.length>=3);return r.length===0?"":r.map(n=>`"${n}"`).join(" OR ")}function SR(e,t){if(e.length===0)return t.length;if(t.length===0)return e.length;let r=Array.from({length:t.length+1},(n,o)=>o);for(let n=1;n<=e.length;n++){let o=[n];for(let s=1;s<=t.length;s++)o[s]=e[n-1]===t[s-1]?r[s-1]:1+Math.min(r[s],o[s-1],r[s-1]);r=o}return r[t.length]}function TR(e){return e<=4?1:e<=12?2:3}function X0(){let e=J0(),t=0;try{let r=$R(e);for(let n of r){let o=n.match(/^context-mode-(\d+)\.db$/);if(!o)continue;let s=parseInt(o[1],10);if(s!==process.pid)try{process.kill(s,0)}catch{let i=Y0(e,n);for(let a of["","-wal","-shm"])try{K0(i+a)}catch{}t++}}}catch{}return t}var Mf,G0,ls,Q0=x(()=>{"use strict";Mf=null;G0=new Set(["the","and","for","are","but","not","you","all","can","had","her","was","one","our","out","has","his","how","its","may","new","now","old","see","way","who","did","get","got","let","say","she","too","use","will","with","this","that","from","they","been","have","many","some","them","than","each","make","like","just","over","such","take","into","year","your","good","could","would","about","which","their","there","other","after","should","through","also","more","most","only","very","when","what","then","these","those","being","does","done","both","same","still","while","where","here","were","much","update","updates","updated","deps","dev","tests","test","add","added","fix","fixed","run","running","using"]);ls=class{#e;#t;constructor(t){let r=xR();this.#t=t??Y0(J0(),`context-mode-${process.pid}.db`),this.#e=new r(this.#t,{timeout:5e3}),this.#e.pragma("journal_mode = WAL"),this.#e.pragma("synchronous = NORMAL"),this.#r()}cleanup(){try{this.#e.close()}catch{}for(let t of["","-wal","-shm"])try{K0(this.#t+t)}catch{}}#r(){this.#e.exec(`
      CREATE TABLE IF NOT EXISTS sources (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        label TEXT NOT NULL,
        chunk_count INTEGER NOT NULL DEFAULT 0,
        code_chunk_count INTEGER NOT NULL DEFAULT 0,
        indexed_at TEXT NOT NULL DEFAULT (datetime('now'))
      );

      CREATE VIRTUAL TABLE IF NOT EXISTS chunks USING fts5(
        title,
        content,
        source_id UNINDEXED,
        content_type UNINDEXED,
        tokenize='porter unicode61'
      );

      CREATE VIRTUAL TABLE IF NOT EXISTS chunks_trigram USING fts5(
        title,
        content,
        source_id UNINDEXED,
        content_type UNINDEXED,
        tokenize='trigram'
      );

      CREATE TABLE IF NOT EXISTS vocabulary (
        word TEXT PRIMARY KEY
      );
    `)}index(t){let{content:r,path:n,source:o}=t;if(!r&&!n)throw new Error("Either content or path must be provided");let s=r??bR(n,"utf-8"),i=o??n??"untitled",a=this.#i(s);if(a.length===0){let f=this.#e.prepare("INSERT INTO sources (label, chunk_count, code_chunk_count) VALUES (?, 0, 0)").run(i);return{sourceId:Number(f.lastInsertRowid),label:i,totalChunks:0,codeChunks:0}}let c=a.filter(p=>p.hasCode).length,u=this.#e.prepare("INSERT INTO sources (label, chunk_count, code_chunk_count) VALUES (?, ?, ?)"),d=this.#e.prepare("INSERT INTO chunks (title, content, source_id, content_type) VALUES (?, ?, ?, ?)"),l=this.#e.prepare("INSERT INTO chunks_trigram (title, content, source_id, content_type) VALUES (?, ?, ?, ?)"),h=this.#e.transaction(()=>{let p=u.run(i,a.length,c),f=Number(p.lastInsertRowid);for(let g of a){let y=g.hasCode?"code":"prose";d.run(g.title,g.content,f,y),l.run(g.title,g.content,f,y)}return f})();return this.#n(s),{sourceId:h,label:i,totalChunks:a.length,codeChunks:c}}indexPlainText(t,r,n=20){if(!t||t.trim().length===0){let l=this.#e.prepare("INSERT INTO sources (label, chunk_count, code_chunk_count) VALUES (?, 0, 0)").run(r);return{sourceId:Number(l.lastInsertRowid),label:r,totalChunks:0,codeChunks:0}}let o=this.#o(t,n),s=this.#e.prepare("INSERT INTO sources (label, chunk_count, code_chunk_count) VALUES (?, ?, ?)"),i=this.#e.prepare("INSERT INTO chunks (title, content, source_id, content_type) VALUES (?, ?, ?, ?)"),a=this.#e.prepare("INSERT INTO chunks_trigram (title, content, source_id, content_type) VALUES (?, ?, ?, ?)"),u=this.#e.transaction(()=>{let d=s.run(r,o.length,0),l=Number(d.lastInsertRowid);for(let m of o)i.run(m.title,m.content,l,"prose"),a.run(m.title,m.content,l,"prose");return l})();return this.#n(t),{sourceId:u,label:r,totalChunks:o.length,codeChunks:0}}search(t,r=3,n){let o=wR(t),s=n?"AND sources.label LIKE ?":"",i=this.#e.prepare(`
      SELECT
        chunks.title,
        chunks.content,
        chunks.content_type,
        sources.label,
        bm25(chunks, 2.0, 1.0) AS rank
      FROM chunks
      JOIN sources ON sources.id = chunks.source_id
      WHERE chunks MATCH ? ${s}
      ORDER BY rank
      LIMIT ?
    `),a=n?[o,`%${n}%`,r]:[o,r];return i.all(...a).map(u=>({title:u.title,content:u.content,source:u.label,rank:u.rank,contentType:u.content_type}))}searchTrigram(t,r=3,n){let o=kR(t);if(!o)return[];let s=n?"AND sources.label LIKE ?":"",i=this.#e.prepare(`
      SELECT
        chunks_trigram.title,
        chunks_trigram.content,
        chunks_trigram.content_type,
        sources.label,
        bm25(chunks_trigram, 2.0, 1.0) AS rank
      FROM chunks_trigram
      JOIN sources ON sources.id = chunks_trigram.source_id
      WHERE chunks_trigram MATCH ? ${s}
      ORDER BY rank
      LIMIT ?
    `),a=n?[o,`%${n}%`,r]:[o,r];return i.all(...a).map(u=>({title:u.title,content:u.content,source:u.label,rank:u.rank,contentType:u.content_type}))}fuzzyCorrect(t){let r=t.toLowerCase().trim();if(r.length<3)return null;let n=TR(r.length),o=this.#e.prepare("SELECT word FROM vocabulary WHERE length(word) BETWEEN ? AND ?").all(r.length-n,r.length+n),s=null,i=n+1;for(let{word:a}of o){if(a===r)return null;let c=SR(r,a);c<i&&(i=c,s=a)}return i<=n?s:null}searchWithFallback(t,r=3,n){let o=this.search(t,r,n);if(o.length>0)return o.map(d=>({...d,matchLayer:"porter"}));let s=this.searchTrigram(t,r,n);if(s.length>0)return s.map(d=>({...d,matchLayer:"trigram"}));let i=t.toLowerCase().trim().split(/\s+/).filter(d=>d.length>=3),a=i.join(" "),u=i.map(d=>this.fuzzyCorrect(d)??d).join(" ");if(u!==a){let d=this.search(u,r,n);if(d.length>0)return d.map(m=>({...m,matchLayer:"fuzzy"}));let l=this.searchTrigram(u,r,n);if(l.length>0)return l.map(m=>({...m,matchLayer:"fuzzy"}))}return[]}listSources(){return this.#e.prepare("SELECT label, chunk_count as chunkCount FROM sources ORDER BY id DESC").all()}getChunksBySource(t){return this.#e.prepare(`SELECT c.title, c.content, c.content_type, s.label
         FROM chunks c
         JOIN sources s ON s.id = c.source_id
         WHERE c.source_id = ?
         ORDER BY c.rowid`).all(t).map(n=>({title:n.title,content:n.content,source:n.label,rank:0,contentType:n.content_type}))}getDistinctiveTerms(t,r=40){let n=this.#e.prepare("SELECT chunk_count FROM sources WHERE id = ?").get(t);if(!n||n.chunk_count<3)return[];let o=n.chunk_count,s=2,i=Math.max(3,Math.ceil(o*.4)),a=this.#e.prepare("SELECT content FROM chunks WHERE source_id = ?").all(t),c=new Map;for(let l of a){let m=new Set(l.content.toLowerCase().split(/[^\p{L}\p{N}_-]+/u).filter(h=>h.length>=3&&!G0.has(h)));for(let h of m)c.set(h,(c.get(h)??0)+1)}return Array.from(c.entries()).filter(([,l])=>l>=s&&l<=i).map(([l,m])=>{let h=Math.log(o/m),p=Math.min(l.length/20,.5),f=/[_]/.test(l),g=l.length>=12,y=f?1.5:g?.8:0;return{word:l,score:h+p+y}}).sort((l,m)=>m.score-l.score).slice(0,r).map(l=>l.word)}getStats(){let t=this.#e.prepare("SELECT COUNT(*) as c FROM sources").get()?.c??0,r=this.#e.prepare("SELECT COUNT(*) as c FROM chunks").get()?.c??0,n=this.#e.prepare("SELECT COUNT(*) as c FROM chunks WHERE content_type = 'code'").get()?.c??0;return{sources:t,chunks:r,codeChunks:n}}close(){this.#e.close()}#n(t){let r=t.toLowerCase().split(/[^\p{L}\p{N}_-]+/u).filter(s=>s.length>=3&&!G0.has(s)),n=[...new Set(r)],o=this.#e.prepare("INSERT OR IGNORE INTO vocabulary (word) VALUES (?)");for(let s of n)o.run(s)}#i(t){let r=[],n=t.split(`
`),o=[],s=[],i="",a=()=>{let u=s.join(`
`).trim();u.length!==0&&(r.push({title:this.#s(o,i),content:u,hasCode:s.some(d=>/^`{3,}/.test(d))}),s=[])},c=0;for(;c<n.length;){let u=n[c];if(/^[-_*]{3,}\s*$/.test(u)){a(),c++;continue}let d=u.match(/^(#{1,4})\s+(.+)$/);if(d){a();let m=d[1].length,h=d[2].trim();for(;o.length>0&&o[o.length-1].level>=m;)o.pop();o.push({level:m,text:h}),i=h,s.push(u),c++;continue}let l=u.match(/^(`{3,})(.*)?$/);if(l){let m=l[1],h=[u];for(c++;c<n.length;){if(h.push(n[c]),n[c].startsWith(m)&&n[c].trim()===m){c++;break}c++}s.push(...h);continue}s.push(u),c++}return a(),r}#o(t,r){let n=t.split(/\n\s*\n/);if(n.length>=3&&n.length<=200&&n.every(c=>Buffer.byteLength(c)<5e3))return n.map((c,u)=>{let d=c.trim();return{title:d.split(`
`)[0].slice(0,80)||`Section ${u+1}`,content:d}}).filter(c=>c.content.length>0);let o=t.split(`
`);if(o.length<=r)return[{title:"Output",content:t}];let s=[],a=Math.max(r-2,1);for(let c=0;c<o.length;c+=a){let u=o.slice(c,c+r);if(u.length===0)break;let d=c+1,l=Math.min(c+u.length,o.length),m=u[0]?.trim().slice(0,80);s.push({title:m||`Lines ${d}-${l}`,content:u.join(`
`)})}return s}#s(t,r){return t.length===0?r||"Untitled":t.map(n=>n.text).join(" > ")}}});var OR={};function ps(){return ds||(ds=new ls),ds}function de(e,t){let r=t.content.reduce((n,o)=>n+Buffer.byteLength(o.text),0);return Je.calls[e]=(Je.calls[e]||0)+1,Je.bytesReturned[e]=(Je.bytesReturned[e]||0)+r,t}function Er(e){Je.bytesIndexed+=e}function nb(e,t,r=1500){if(e.length<=r)return e;let n=t.toLowerCase().split(/\s+/).filter(d=>d.length>2),o=e.toLowerCase(),s=[];for(let d of n){let l=o.indexOf(d);for(;l!==-1;)s.push(l),l=o.indexOf(d,l+1)}if(s.length===0)return e.slice(0,r)+`
\u2026`;s.sort((d,l)=>d-l);let i=300,a=[];for(let d of s){let l=Math.max(0,d-i),m=Math.min(e.length,d+i);a.length>0&&l<=a[a.length-1][1]?a[a.length-1][1]=m:a.push([l,m])}let c=[],u=0;for(let[d,l]of a){if(u>=r)break;let m=e.slice(d,Math.min(l,d+(r-u)));c.push((d>0?"\u2026":"")+m+(l<e.length?"\u2026":"")),u+=m.length}return c.join(`

`)}function qa(e,t,r,n=5){let o=e.split(`
`).length,s=Buffer.byteLength(e),i=ps(),a=i.indexPlainText(e,r),c=new ls(":memory:");try{c.indexPlainText(e,r);let u=c.search(t,n);if(u.length===0){let m=t.trim().split(/\s+/).filter(h=>h.length>2).slice(0,20);if(m.length>0){let h=new Map;for(let p of m){let f=c.search(p,10);for(let g of f){let y=h.get(g.title);y?(y.score+=1,g.rank<y.bestRank&&(y.bestRank=g.rank,y.result=g)):h.set(g.title,{result:g,score:1,bestRank:g.rank})}}u=Array.from(h.values()).sort((p,f)=>f.score-p.score||p.bestRank-f.bestRank).slice(0,n).map(p=>p.result)}}let d=i.getDistinctiveTerms(a.sourceId);if(u.length===0){let m=[`Indexed ${a.totalChunks} sections from "${r}" into knowledge base.`,`No sections matched intent "${t}" in ${o}-line output (${(s/1024).toFixed(1)}KB).`];return d.length>0&&(m.push(""),m.push(`Searchable terms: ${d.join(", ")}`)),m.push(""),m.push("Use search() to explore the indexed content."),m.join(`
`)}let l=[`Indexed ${a.totalChunks} sections from "${r}" into knowledge base.`,`${u.length} sections matched "${t}" (${o} lines, ${(s/1024).toFixed(1)}KB):`,""];for(let m of u){let h=m.content.split(`
`)[0].slice(0,120);l.push(`  - ${m.title}: ${h}`)}return d.length>0&&(l.push(""),l.push(`Searchable terms: ${d.join(", ")}`)),l.push(""),l.push("Use search(queries: [...]) to retrieve full content of any section."),l.join(`
`)}finally{c.close()}}async function CR(){let e=X0();e>0&&console.error(`Cleaned up ${e} stale DB file(s) from previous sessions`);let t=()=>{ds&&ds.cleanup()};process.on("exit",t),process.on("SIGINT",()=>{t(),process.exit(0)}),process.on("SIGTERM",()=>{t(),process.exit(0)});let r=new La;await zr.connect(r),console.error(`Context Mode MCP server v${rb} running on stdio`),console.error(`Detected runtimes:
${mn(Lf)}`),Pr()||(console.error(`
Performance tip: Install Bun for 3-5x faster JS/TS execution`),console.error("  curl -fsSL https://bun.sh/install | bash"))}var rb,Lf,ER,zr,Fa,ds,Je,zR,PR,Da,ln,Zf,IR,eb,tb,RR,ob=x(()=>{"use strict";D0();V0();Nf();jf();Q0();Zs();rb="0.7.3",Lf=ir(),ER=eo(Lf),zr=new Ma({name:"context-mode",version:rb}),Fa=new us({runtimes:Lf}),ds=null;Je={calls:{},bytesReturned:{},bytesIndexed:0,bytesSandboxed:0,sessionStart:Date.now()};zR=ER.join(", "),PR=Pr()?" (Bun detected \u2014 JS/TS runs 3-5x faster)":"";zr.registerTool("execute",{title:"Execute Code",description:`Execute code in a sandboxed subprocess. Only stdout enters context \u2014 raw data stays in the subprocess. Use instead of bash/cat when output would exceed 20 lines.${PR} Available: ${zR}.

PREFER THIS OVER BASH for: API calls (gh, curl, aws), test runners (npm test, pytest), git queries (git log, git diff), data processing, and ANY CLI command that may produce large output. Bash should only be used for file mutations, git writes, and navigation.`,inputSchema:ee.object({language:ee.enum(["javascript","typescript","python","shell","ruby","go","rust","php","perl","r"]).describe("Runtime language"),code:ee.string().describe("Source code to execute. Use console.log (JS/TS), print (Python/Ruby/Perl/R), echo (Shell), echo (PHP), or fmt.Println (Go) to output a summary to context."),timeout:ee.number().optional().default(3e4).describe("Max execution time in ms"),intent:ee.string().optional().describe(`What you're looking for in the output. When provided and output is large (>5KB), indexes output into knowledge base and returns section titles + previews \u2014 not full content. Use search(queries: [...]) to retrieve specific sections. Example: 'failing tests', 'HTTP 500 errors'.

TIP: Use specific technical terms, not just concepts. Check 'Searchable terms' in the response for available vocabulary.`)})},async({language:e,code:t,timeout:r,intent:n})=>{try{let o=t;(e==="javascript"||e==="typescript")&&(o=`
let __cm_net=0;const __cm_f=globalThis.fetch;
globalThis.fetch=async(...a)=>{const r=await __cm_f(...a);
try{const cl=r.clone();const b=await cl.arrayBuffer();__cm_net+=b.byteLength}catch{}
return r};
async function __cm_main(){
${t}
}
__cm_main().catch(e=>{console.error(e);process.exitCode=1}).finally(()=>{
if(__cm_net>0)process.stderr.write('__CM_NET__:'+__cm_net+'\\n');
});`);let s=await Fa.execute({language:e,code:o,timeout:r}),i=s.stderr?.match(/__CM_NET__:(\d+)/);if(i&&(Je.bytesSandboxed+=parseInt(i[1]),s.stderr=s.stderr.replace(/\n?__CM_NET__:\d+\n?/g,"")),s.timedOut)return de("execute",{content:[{type:"text",text:`Execution timed out after ${r}ms

Partial stdout:
${s.stdout}

stderr:
${s.stderr}`}],isError:!0});if(s.exitCode!==0){let c=`Exit code: ${s.exitCode}

stdout:
${s.stdout}

stderr:
${s.stderr}`;return n&&n.trim().length>0&&Buffer.byteLength(c)>Da?(Er(Buffer.byteLength(c)),de("execute",{content:[{type:"text",text:qa(c,n,`execute:${e}:error`)}],isError:!0})):de("execute",{content:[{type:"text",text:c}],isError:!0})}let a=s.stdout||"(no output)";return n&&n.trim().length>0&&Buffer.byteLength(a)>Da?(Er(Buffer.byteLength(a)),de("execute",{content:[{type:"text",text:qa(a,n,`execute:${e}`)}]})):de("execute",{content:[{type:"text",text:a}]})}catch(o){let s=o instanceof Error?o.message:String(o);return de("execute",{content:[{type:"text",text:`Runtime error: ${s}`}],isError:!0})}});Da=5e3;zr.registerTool("execute_file",{title:"Execute File Processing",description:`Read a file and process it without loading contents into context. The file is read into a FILE_CONTENT variable inside the sandbox. Only your printed summary enters context.

PREFER THIS OVER Read/cat for: log files, data files (CSV, JSON, XML), large source files for analysis, and any file where you need to extract specific information rather than read the entire content.`,inputSchema:ee.object({path:ee.string().describe("Absolute file path or relative to project root"),language:ee.enum(["javascript","typescript","python","shell","ruby","go","rust","php","perl","r"]).describe("Runtime language"),code:ee.string().describe("Code to process FILE_CONTENT. Print summary via console.log/print/echo."),timeout:ee.number().optional().default(3e4).describe("Max execution time in ms"),intent:ee.string().optional().describe("What you're looking for in the output. When provided and output is large (>5KB), returns only matching sections via BM25 search instead of truncated output.")})},async({path:e,language:t,code:r,timeout:n,intent:o})=>{try{let s=await Fa.executeFile({path:e,language:t,code:r,timeout:n});if(s.timedOut)return de("execute_file",{content:[{type:"text",text:`Timed out processing ${e} after ${n}ms`}],isError:!0});if(s.exitCode!==0){let a=`Error processing ${e} (exit ${s.exitCode}):
${s.stderr||s.stdout}`;return o&&o.trim().length>0&&Buffer.byteLength(a)>Da?(Er(Buffer.byteLength(a)),de("execute_file",{content:[{type:"text",text:qa(a,o,`file:${e}:error`)}],isError:!0})):de("execute_file",{content:[{type:"text",text:a}],isError:!0})}let i=s.stdout||"(no output)";return o&&o.trim().length>0&&Buffer.byteLength(i)>Da?(Er(Buffer.byteLength(i)),de("execute_file",{content:[{type:"text",text:qa(i,o,`file:${e}`)}]})):de("execute_file",{content:[{type:"text",text:i}]})}catch(s){let i=s instanceof Error?s.message:String(s);return de("execute_file",{content:[{type:"text",text:`Runtime error: ${i}`}],isError:!0})}});zr.registerTool("index",{title:"Index Content",description:`Index documentation or knowledge content into a searchable BM25 knowledge base. Chunks markdown by headings (keeping code blocks intact) and stores in ephemeral FTS5 database. The full content does NOT stay in context \u2014 only a brief summary is returned.

WHEN TO USE:
- Documentation from Context7, Skills, or MCP tools (API docs, framework guides, code examples)
- API references (endpoint details, parameter specs, response schemas)
- MCP tools/list output (exact tool signatures and descriptions)
- Skill prompts and instructions that are too large for context
- README files, migration guides, changelog entries
- Any content with code examples you may need to reference precisely

After indexing, use 'search' to retrieve specific sections on-demand.
Do NOT use for: log files, test output, CSV, build output \u2014 use 'execute_file' for those.`,inputSchema:ee.object({content:ee.string().optional().describe("Raw text/markdown to index. Provide this OR path, not both."),path:ee.string().optional().describe("File path to read and index (content never enters context). Provide this OR content."),source:ee.string().optional().describe("Label for the indexed content (e.g., 'Context7: React useEffect', 'Skill: frontend-design')")})},async({content:e,path:t,source:r})=>{if(!e&&!t)return de("index",{content:[{type:"text",text:"Error: Either content or path must be provided"}],isError:!0});try{if(e)Er(Buffer.byteLength(e));else if(t)try{let s=await import("fs");Er(s.readFileSync(t).byteLength)}catch{}let o=ps().index({content:e,path:t,source:r});return de("index",{content:[{type:"text",text:`Indexed ${o.totalChunks} sections (${o.codeChunks} with code) from: ${o.label}
Use search(queries: ["..."]) to query this content. Use source: "${o.label}" to scope results.`}]})}catch(n){let o=n instanceof Error?n.message:String(n);return de("index",{content:[{type:"text",text:`Index error: ${o}`}],isError:!0})}});ln=0,Zf=Date.now(),IR=6e4,eb=3,tb=8;zr.registerTool("search",{title:"Search Indexed Content",description:`Search indexed content. Pass ALL search questions as queries array in ONE call.

TIPS: 2-4 specific terms per query. Use 'source' to scope results.`,inputSchema:ee.object({queries:ee.array(ee.string()).optional().describe("Array of search queries. Batch ALL questions in one call."),limit:ee.number().optional().default(3).describe("Results per query (default: 3)"),source:ee.string().optional().describe("Filter to a specific indexed source (partial match).")})},async e=>{try{let t=ps(),r=e,n=[];if(Array.isArray(r.queries)&&r.queries.length>0?n.push(...r.queries):typeof r.query=="string"&&r.query.length>0&&n.push(r.query),n.length===0)return de("search",{content:[{type:"text",text:"Error: provide query or queries."}],isError:!0});let{limit:o=3,source:s}=e,i=Date.now();if(i-Zf>IR&&(ln=0,Zf=i),ln++,ln>tb)return de("search",{content:[{type:"text",text:`BLOCKED: ${ln} search calls in ${Math.round((i-Zf)/1e3)}s. You're flooding context. STOP making individual search calls. Use batch_execute(commands, queries) for your next research step.`}],isError:!0});let a=ln>eb?1:Math.min(o,2),c=40*1024,u=0,d=[];for(let m of n){if(u>c){d.push(`## ${m}
(output cap reached)
`);continue}let h=t.search(m,a,s);if(h.length===0){d.push(`## ${m}
No results found.`);continue}let p=h.map((f,g)=>{let y=`--- [${f.source}] ---`,v=`### ${f.title}`,_=nb(f.content,m);return`${y}
${v}

${_}`}).join(`

`);d.push(`## ${m}

${p}`),u+=p.length}let l=d.join(`

---

`);if(ln>=eb&&(l+=`

\u26A0 search call #${ln}/${tb} in this window. Results limited to ${a}/query. Batch queries: search(queries: ["q1","q2","q3"]) or use batch_execute.`),l.trim().length===0){let m=t.listSources(),h=m.length>0?`
Indexed sources: ${m.map(p=>`"${p.label}" (${p.chunkCount} sections)`).join(", ")}`:"";return de("search",{content:[{type:"text",text:`No results found.${h}`}]})}return de("search",{content:[{type:"text",text:l}]})}catch(t){let r=t instanceof Error?t.message:String(t);return de("search",{content:[{type:"text",text:`Search error: ${r}`}],isError:!0})}});RR=`
const url = process.argv[1];
if (!url) { console.error("No URL provided"); process.exit(1); }

async function main() {
  const resp = await fetch(url);
  if (!resp.ok) { console.error("HTTP " + resp.status); process.exit(1); }

  let html = await resp.text();

  // Strip script, style, nav, header, footer tags with content
  html = html.replace(/<script[^>]*>[\\s\\S]*?<\\/script>/gi, "");
  html = html.replace(/<style[^>]*>[\\s\\S]*?<\\/style>/gi, "");
  html = html.replace(/<nav[^>]*>[\\s\\S]*?<\\/nav>/gi, "");
  html = html.replace(/<header[^>]*>[\\s\\S]*?<\\/header>/gi, "");
  html = html.replace(/<footer[^>]*>[\\s\\S]*?<\\/footer>/gi, "");

  // Convert headings to markdown
  html = html.replace(/<h1[^>]*>(.*?)<\\/h1>/gi, "\\n# $1\\n");
  html = html.replace(/<h2[^>]*>(.*?)<\\/h2>/gi, "\\n## $1\\n");
  html = html.replace(/<h3[^>]*>(.*?)<\\/h3>/gi, "\\n### $1\\n");
  html = html.replace(/<h4[^>]*>(.*?)<\\/h4>/gi, "\\n#### $1\\n");

  // Convert code blocks
  html = html.replace(/<pre[^>]*><code[^>]*class="[^"]*language-(\\w+)"[^>]*>([\\s\\S]*?)<\\/code><\\/pre>/gi,
    (_, lang, code) => "\\n\\\`\\\`\\\`" + lang + "\\n" + decodeEntities(code) + "\\n\\\`\\\`\\\`\\n");
  html = html.replace(/<pre[^>]*><code[^>]*>([\\s\\S]*?)<\\/code><\\/pre>/gi,
    (_, code) => "\\n\\\`\\\`\\\`\\n" + decodeEntities(code) + "\\n\\\`\\\`\\\`\\n");
  html = html.replace(/<code[^>]*>([^<]*)<\\/code>/gi, "\\\`$1\\\`");

  // Convert links
  html = html.replace(/<a[^>]*href="([^"]*)"[^>]*>(.*?)<\\/a>/gi, "[$2]($1)");

  // Convert lists
  html = html.replace(/<li[^>]*>(.*?)<\\/li>/gi, "- $1\\n");

  // Convert paragraphs and line breaks
  html = html.replace(/<p[^>]*>(.*?)<\\/p>/gi, "\\n$1\\n");
  html = html.replace(/<br\\s*\\/?>/gi, "\\n");
  html = html.replace(/<hr\\s*\\/?>/gi, "\\n---\\n");

  // Strip remaining HTML tags
  html = html.replace(/<[^>]+>/g, "");

  // Decode HTML entities
  html = decodeEntities(html);

  // Clean up whitespace
  html = html.replace(/\\n{3,}/g, "\\n\\n").trim();

  console.log(html);
}

function decodeEntities(s) {
  return s
    .replace(/&amp;/g, "&")
    .replace(/&lt;/g, "<")
    .replace(/&gt;/g, ">")
    .replace(/&quot;/g, '"')
    .replace(/&#39;/g, "'")
    .replace(/&#x27;/g, "'")
    .replace(/&#x2F;/g, "/")
    .replace(/&nbsp;/g, " ");
}

main();
`;zr.registerTool("fetch_and_index",{title:"Fetch & Index URL",description:`Fetches URL content, converts HTML to markdown, indexes into searchable knowledge base, and returns a ~3KB preview. Full content stays in sandbox \u2014 use search() for deeper lookups.

Better than WebFetch: preview is immediate, full content is searchable, raw HTML never enters context.`,inputSchema:ee.object({url:ee.string().describe("The URL to fetch and index"),source:ee.string().optional().describe("Label for the indexed content (e.g., 'React useEffect docs', 'Supabase Auth API')")})},async({url:e,source:t})=>{try{let r=`process.argv[1] = ${JSON.stringify(e)};
${RR}`,n=await Fa.execute({language:"javascript",code:r,timeout:3e4});if(n.exitCode!==0)return de("fetch_and_index",{content:[{type:"text",text:`Failed to fetch ${e}: ${n.stderr||n.stdout}`}],isError:!0});if(!n.stdout||n.stdout.trim().length===0)return de("fetch_and_index",{content:[{type:"text",text:`Fetched ${e} but got empty content after HTML conversion`}],isError:!0});let o=ps(),s=n.stdout.trim();Er(Buffer.byteLength(s));let i=o.index({content:s,source:t??e}),a=3072,c=s.length>a?s.slice(0,a)+`

\u2026[truncated \u2014 use search() for full content]`:s,u=(Buffer.byteLength(s)/1024).toFixed(1),d=[`Fetched and indexed **${i.totalChunks} sections** (${u}KB) from: ${i.label}`,`Full content indexed in sandbox \u2014 use search(queries: [...], source: "${i.label}") for specific lookups.`,"","---","",c].join(`
`);return de("fetch_and_index",{content:[{type:"text",text:d}]})}catch(r){let n=r instanceof Error?r.message:String(r);return de("fetch_and_index",{content:[{type:"text",text:`Fetch error: ${n}`}],isError:!0})}});zr.registerTool("batch_execute",{title:"Batch Execute & Search",description:`Execute multiple commands in ONE call, auto-index all output, and search with multiple queries. Returns search results directly \u2014 no follow-up calls needed.

THIS IS THE PRIMARY TOOL. Use this instead of multiple execute() calls.

One batch_execute call replaces 30+ execute calls + 10+ search calls.
Provide all commands to run and all queries to search \u2014 everything happens in one round trip.`,inputSchema:ee.object({commands:ee.array(ee.object({label:ee.string().describe("Section header for this command's output (e.g., 'README', 'Package.json', 'Source Tree')"),command:ee.string().describe("Shell command to execute")})).min(1).describe("Commands to execute as a batch. Each runs sequentially, output is labeled with the section header."),queries:ee.array(ee.string()).min(1).describe("Search queries to extract information from indexed output. Use 5-8 comprehensive queries. Each returns top 5 matching sections with full content. This is your ONLY chance \u2014 put ALL your questions here. No follow-up calls needed."),timeout:ee.number().optional().default(6e4).describe("Max execution time in ms (default: 60s)")})},async({commands:e,queries:t,timeout:r})=>{try{let n=e.map(_=>`echo '# ${_.label.replace(/'/g,"'\\''")}'
echo ''
${_.command} 2>&1
echo ''`).join(`
`),o=await Fa.execute({language:"shell",code:n,timeout:r});if(o.timedOut)return de("batch_execute",{content:[{type:"text",text:`Batch timed out after ${r}ms. Partial output:
${o.stdout?.slice(0,2e3)||"(none)"}`}],isError:!0});let s=o.stdout||"(no output)",i=Buffer.byteLength(s),a=s.split(`
`).length;Er(i);let c=ps(),u=`batch:${e.map(_=>_.label).join(",").slice(0,80)}`,d=c.index({content:s,source:u}),l=c.getChunksBySource(d.sourceId),m=["## Indexed Sections",""],h=[];for(let _ of l){let w=Buffer.byteLength(_.content);m.push(`- ${_.title} (${(w/1024).toFixed(1)}KB)`),h.push(_.title)}let p=80*1024,f=[],g=0;for(let _ of t){if(g>p){f.push(`## ${_}
(output cap reached \u2014 use search(queries: ["${_}"]) for details)
`);continue}let w=c.search(_,3,u);if(w.length===0&&h.length>0){let E=`${_} ${h.join(" ")}`;w=c.search(E,3,u)}if(w.length===0&&(w=c.search(_,3)),f.push(`## ${_}`),f.push(""),w.length>0)for(let E of w){let B=nb(E.content,_);f.push(`### ${E.title}`),f.push(B),f.push(""),g+=B.length+E.title.length}else f.push("No matching sections found."),f.push("")}let y=c.getDistinctiveTerms?c.getDistinctiveTerms(d.sourceId):[],v=[`Executed ${e.length} commands (${a} lines, ${(i/1024).toFixed(1)}KB). Indexed ${d.totalChunks} sections. Searched ${t.length} queries.`,"",...m,"",...f,y.length>0?`
Searchable terms for follow-up: ${y.join(", ")}`:""].join(`
`);return de("batch_execute",{content:[{type:"text",text:v}]})}catch(n){let o=n instanceof Error?n.message:String(n);return de("batch_execute",{content:[{type:"text",text:`Batch execution error: ${o}`}],isError:!0})}});zr.registerTool("stats",{title:"Session Statistics",description:"Returns context consumption statistics for the current session. Shows total bytes returned to context, breakdown by tool, call counts, estimated token usage, and context savings ratio.",inputSchema:ee.object({})},async()=>{let e=Object.values(Je.bytesReturned).reduce((h,p)=>h+p,0),t=Object.values(Je.calls).reduce((h,p)=>h+p,0),n=((Date.now()-Je.sessionStart)/6e4).toFixed(1),o=Je.bytesIndexed+Je.bytesSandboxed,s=o+e,i=s/Math.max(e,1),a=s>0?((1-e/s)*100).toFixed(0):"0",c=h=>h>=1024*1024?`${(h/1024/1024).toFixed(1)}MB`:`${(h/1024).toFixed(1)}KB`,u=["## context-mode session stats","","| Metric | Value |","|--------|------:|",`| Session | ${n} min |`,`| Tool calls | ${t} |`,`| Total data processed | **${c(s)}** |`,`| Kept in sandbox | **${c(o)}** |`,`| Entered context | ${c(e)} |`,`| Tokens consumed | ~${Math.round(e/4).toLocaleString()} |`,`| **Context savings** | **${i.toFixed(1)}x (${a}% reduction)** |`],d=new Set([...Object.keys(Je.calls),...Object.keys(Je.bytesReturned)]);if(d.size>0){u.push("","| Tool | Calls | Context | Tokens |","|------|------:|--------:|-------:|");for(let h of Array.from(d).sort()){let p=Je.calls[h]||0,f=Je.bytesReturned[h]||0,g=Math.round(f/4);u.push(`| ${h} | ${p} | ${c(f)} | ~${g.toLocaleString()} |`)}u.push(`| **Total** | **${t}** | **${c(e)}** | **~${Math.round(e/4).toLocaleString()}** |`)}let l=Math.round(o/4);t===0?u.push("","> No context-mode calls this session. Use `batch_execute` to run commands, `fetch_and_index` for URLs, or `execute` to process data in sandbox."):o===0?u.push("",`> context-mode handled **${t}** tool calls. All outputs were compact enough to enter context directly. Process larger data or batch multiple commands for bigger savings.`):u.push("",`> Without context-mode, **${c(s)}** of raw tool output would flood your context window. Instead, **${c(o)}** (${a}%) stayed in sandbox \u2014 saving **~${l.toLocaleString()} tokens** of context space.`);let m=u.join(`
`);return de("stats",{content:[{type:"text",text:m}]})});CR().catch(e=>{console.error("Fatal:",e),process.exit(1)})});var De=pn(Ga(),1);import{stdout as ec,stdin as Xf}from"node:process";import*as sr from"node:readline";import xb from"node:readline";import{ReadStream as Gf}from"node:tty";function $s(e,t,r){if(!r.some(i=>!i.disabled))return e;let n=e+t,o=Math.max(r.length-1,0),s=n<0?o:n>o?0:n;return r[s].disabled?$s(s,t<0?-1:1,r):s}var wb=e=>e===161||e===164||e===167||e===168||e===170||e===173||e===174||e>=176&&e<=180||e>=182&&e<=186||e>=188&&e<=191||e===198||e===208||e===215||e===216||e>=222&&e<=225||e===230||e>=232&&e<=234||e===236||e===237||e===240||e===242||e===243||e>=247&&e<=250||e===252||e===254||e===257||e===273||e===275||e===283||e===294||e===295||e===299||e>=305&&e<=307||e===312||e>=319&&e<=322||e===324||e>=328&&e<=331||e===333||e===338||e===339||e===358||e===359||e===363||e===462||e===464||e===466||e===468||e===470||e===472||e===474||e===476||e===593||e===609||e===708||e===711||e>=713&&e<=715||e===717||e===720||e>=728&&e<=731||e===733||e===735||e>=768&&e<=879||e>=913&&e<=929||e>=931&&e<=937||e>=945&&e<=961||e>=963&&e<=969||e===1025||e>=1040&&e<=1103||e===1105||e===8208||e>=8211&&e<=8214||e===8216||e===8217||e===8220||e===8221||e>=8224&&e<=8226||e>=8228&&e<=8231||e===8240||e===8242||e===8243||e===8245||e===8251||e===8254||e===8308||e===8319||e>=8321&&e<=8324||e===8364||e===8451||e===8453||e===8457||e===8467||e===8470||e===8481||e===8482||e===8486||e===8491||e===8531||e===8532||e>=8539&&e<=8542||e>=8544&&e<=8555||e>=8560&&e<=8569||e===8585||e>=8592&&e<=8601||e===8632||e===8633||e===8658||e===8660||e===8679||e===8704||e===8706||e===8707||e===8711||e===8712||e===8715||e===8719||e===8721||e===8725||e===8730||e>=8733&&e<=8736||e===8739||e===8741||e>=8743&&e<=8748||e===8750||e>=8756&&e<=8759||e===8764||e===8765||e===8776||e===8780||e===8786||e===8800||e===8801||e>=8804&&e<=8807||e===8810||e===8811||e===8814||e===8815||e===8834||e===8835||e===8838||e===8839||e===8853||e===8857||e===8869||e===8895||e===8978||e>=9312&&e<=9449||e>=9451&&e<=9547||e>=9552&&e<=9587||e>=9600&&e<=9615||e>=9618&&e<=9621||e===9632||e===9633||e>=9635&&e<=9641||e===9650||e===9651||e===9654||e===9655||e===9660||e===9661||e===9664||e===9665||e>=9670&&e<=9672||e===9675||e>=9678&&e<=9681||e>=9698&&e<=9701||e===9711||e===9733||e===9734||e===9737||e===9742||e===9743||e===9756||e===9758||e===9792||e===9794||e===9824||e===9825||e>=9827&&e<=9829||e>=9831&&e<=9834||e===9836||e===9837||e===9839||e===9886||e===9887||e===9919||e>=9926&&e<=9933||e>=9935&&e<=9939||e>=9941&&e<=9953||e===9955||e===9960||e===9961||e>=9963&&e<=9969||e===9972||e>=9974&&e<=9977||e===9979||e===9980||e===9982||e===9983||e===10045||e>=10102&&e<=10111||e>=11094&&e<=11097||e>=12872&&e<=12879||e>=57344&&e<=63743||e>=65024&&e<=65039||e===65533||e>=127232&&e<=127242||e>=127248&&e<=127277||e>=127280&&e<=127337||e>=127344&&e<=127373||e===127375||e===127376||e>=127387&&e<=127404||e>=917760&&e<=917999||e>=983040&&e<=1048573||e>=1048576&&e<=1114109,kb=e=>e===12288||e>=65281&&e<=65376||e>=65504&&e<=65510,Sb=e=>e>=4352&&e<=4447||e===8986||e===8987||e===9001||e===9002||e>=9193&&e<=9196||e===9200||e===9203||e===9725||e===9726||e===9748||e===9749||e>=9800&&e<=9811||e===9855||e===9875||e===9889||e===9898||e===9899||e===9917||e===9918||e===9924||e===9925||e===9934||e===9940||e===9962||e===9970||e===9971||e===9973||e===9978||e===9981||e===9989||e===9994||e===9995||e===10024||e===10060||e===10062||e>=10067&&e<=10069||e===10071||e>=10133&&e<=10135||e===10160||e===10175||e===11035||e===11036||e===11088||e===11093||e>=11904&&e<=11929||e>=11931&&e<=12019||e>=12032&&e<=12245||e>=12272&&e<=12287||e>=12289&&e<=12350||e>=12353&&e<=12438||e>=12441&&e<=12543||e>=12549&&e<=12591||e>=12593&&e<=12686||e>=12688&&e<=12771||e>=12783&&e<=12830||e>=12832&&e<=12871||e>=12880&&e<=19903||e>=19968&&e<=42124||e>=42128&&e<=42182||e>=43360&&e<=43388||e>=44032&&e<=55203||e>=63744&&e<=64255||e>=65040&&e<=65049||e>=65072&&e<=65106||e>=65108&&e<=65126||e>=65128&&e<=65131||e>=94176&&e<=94180||e===94192||e===94193||e>=94208&&e<=100343||e>=100352&&e<=101589||e>=101632&&e<=101640||e>=110576&&e<=110579||e>=110581&&e<=110587||e===110589||e===110590||e>=110592&&e<=110882||e===110898||e>=110928&&e<=110930||e===110933||e>=110948&&e<=110951||e>=110960&&e<=111355||e===126980||e===127183||e===127374||e>=127377&&e<=127386||e>=127488&&e<=127490||e>=127504&&e<=127547||e>=127552&&e<=127560||e===127568||e===127569||e>=127584&&e<=127589||e>=127744&&e<=127776||e>=127789&&e<=127797||e>=127799&&e<=127868||e>=127870&&e<=127891||e>=127904&&e<=127946||e>=127951&&e<=127955||e>=127968&&e<=127984||e===127988||e>=127992&&e<=128062||e===128064||e>=128066&&e<=128252||e>=128255&&e<=128317||e>=128331&&e<=128334||e>=128336&&e<=128359||e===128378||e===128405||e===128406||e===128420||e>=128507&&e<=128591||e>=128640&&e<=128709||e===128716||e>=128720&&e<=128722||e>=128725&&e<=128727||e>=128732&&e<=128735||e===128747||e===128748||e>=128756&&e<=128764||e>=128992&&e<=129003||e===129008||e>=129292&&e<=129338||e>=129340&&e<=129349||e>=129351&&e<=129535||e>=129648&&e<=129660||e>=129664&&e<=129672||e>=129680&&e<=129725||e>=129727&&e<=129733||e>=129742&&e<=129755||e>=129760&&e<=129768||e>=129776&&e<=129784||e>=131072&&e<=196605||e>=196608&&e<=262141,Ka=/[\u001b\u009b][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-ORZcf-nqry=><]/y,ys=/[\x00-\x08\x0A-\x1F\x7F-\x9F]{1,1000}/y,_s=/\t{1,1000}/y,Ja=new RegExp("[\\u{1F1E6}-\\u{1F1FF}]{2}|\\u{1F3F4}[\\u{E0061}-\\u{E007A}]{2}[\\u{E0030}-\\u{E0039}\\u{E0061}-\\u{E007A}]{1,3}\\u{E007F}|(?:\\p{Emoji}\\uFE0F\\u20E3?|\\p{Emoji_Modifier_Base}\\p{Emoji_Modifier}?|\\p{Emoji_Presentation})(?:\\u200D(?:\\p{Emoji_Modifier_Base}\\p{Emoji_Modifier}?|\\p{Emoji_Presentation}|\\p{Emoji}\\uFE0F\\u20E3?))*","yu"),vs=/(?:[\x20-\x7E\xA0-\xFF](?!\uFE0F)){1,1000}/y,Tb=new RegExp("\\p{M}+","gu"),Eb={limit:1/0,ellipsis:""},Qf=(e,t={},r={})=>{let n=t.limit??1/0,o=t.ellipsis??"",s=t?.ellipsisWidth??(o?Qf(o,Eb,r).width:0),i=r.ansiWidth??0,a=r.controlWidth??0,c=r.tabWidth??8,u=r.ambiguousWidth??1,d=r.emojiWidth??2,l=r.fullWidthWidth??2,m=r.regularWidth??1,h=r.wideWidth??2,p=0,f=0,g=e.length,y=0,v=!1,_=g,w=Math.max(0,n-s),E=0,B=0,I=0,j=0;e:for(;;){if(B>E||f>=g&&f>p){let Ie=e.slice(E,B)||e.slice(p,f);y=0;for(let ze of Ie.replaceAll(Tb,"")){let Re=ze.codePointAt(0)||0;if(kb(Re)?j=l:Sb(Re)?j=h:u!==m&&wb(Re)?j=u:j=m,I+j>w&&(_=Math.min(_,Math.max(E,p)+y)),I+j>n){v=!0;break e}y+=ze.length,I+=j}E=B=0}if(f>=g)break;if(vs.lastIndex=f,vs.test(e)){if(y=vs.lastIndex-f,j=y*m,I+j>w&&(_=Math.min(_,f+Math.floor((w-I)/m))),I+j>n){v=!0;break}I+=j,E=p,B=f,f=p=vs.lastIndex;continue}if(Ka.lastIndex=f,Ka.test(e)){if(I+i>w&&(_=Math.min(_,f)),I+i>n){v=!0;break}I+=i,E=p,B=f,f=p=Ka.lastIndex;continue}if(ys.lastIndex=f,ys.test(e)){if(y=ys.lastIndex-f,j=y*a,I+j>w&&(_=Math.min(_,f+Math.floor((w-I)/a))),I+j>n){v=!0;break}I+=j,E=p,B=f,f=p=ys.lastIndex;continue}if(_s.lastIndex=f,_s.test(e)){if(y=_s.lastIndex-f,j=y*c,I+j>w&&(_=Math.min(_,f+Math.floor((w-I)/c))),I+j>n){v=!0;break}I+=j,E=p,B=f,f=p=_s.lastIndex;continue}if(Ja.lastIndex=f,Ja.test(e)){if(I+d>w&&(_=Math.min(_,f)),I+d>n){v=!0;break}I+=d,E=p,B=f,f=p=Ja.lastIndex;continue}f+=1}return{width:v?w:I,index:v?_:g,truncated:v,ellipsed:v&&n>=s}},zb={limit:1/0,ellipsis:"",ellipsisWidth:0},Kn=(e,t={})=>Qf(e,zb,t).width,Ss="\x1B",em="\x9B",Pb=39,tc="\x07",tm="[",Ib="]",rm="m",rc=`${Ib}8;;`,Kf=new RegExp(`(?:\\${tm}(?<code>\\d+)m|\\${rc}(?<uri>.*)${tc})`,"y"),Rb=e=>{if(e>=30&&e<=37||e>=90&&e<=97)return 39;if(e>=40&&e<=47||e>=100&&e<=107)return 49;if(e===1||e===2)return 22;if(e===3)return 23;if(e===4)return 24;if(e===7)return 27;if(e===8)return 28;if(e===9)return 29;if(e===0)return 0},Jf=e=>`${Ss}${tm}${e}${rm}`,Yf=e=>`${Ss}${rc}${e}${tc}`,Cb=e=>e.map(t=>Kn(t)),Ya=(e,t,r)=>{let n=t[Symbol.iterator](),o=!1,s=!1,i=e.at(-1),a=i===void 0?0:Kn(i),c=n.next(),u=n.next(),d=0;for(;!c.done;){let l=c.value,m=Kn(l);a+m<=r?e[e.length-1]+=l:(e.push(l),a=0),(l===Ss||l===em)&&(o=!0,s=t.startsWith(rc,d+1)),o?s?l===tc&&(o=!1,s=!1):l===rm&&(o=!1):(a+=m,a===r&&!u.done&&(e.push(""),a=0)),c=u,u=n.next(),d+=l.length}i=e.at(-1),!a&&i!==void 0&&i.length>0&&e.length>1&&(e[e.length-2]+=e.pop())},Ob=e=>{let t=e.split(" "),r=t.length;for(;r>0&&!(Kn(t[r-1])>0);)r--;return r===t.length?e:t.slice(0,r).join(" ")+t.slice(r).join("")},Nb=(e,t,r={})=>{if(r.trim!==!1&&e.trim()==="")return"";let n="",o,s,i=e.split(" "),a=Cb(i),c=[""];for(let[p,f]of i.entries()){r.trim!==!1&&(c[c.length-1]=(c.at(-1)??"").trimStart());let g=Kn(c.at(-1)??"");if(p!==0&&(g>=t&&(r.wordWrap===!1||r.trim===!1)&&(c.push(""),g=0),(g>0||r.trim===!1)&&(c[c.length-1]+=" ",g++)),r.hard&&a[p]>t){let y=t-g,v=1+Math.floor((a[p]-y-1)/t);Math.floor((a[p]-1)/t)<v&&c.push(""),Ya(c,f,t);continue}if(g+a[p]>t&&g>0&&a[p]>0){if(r.wordWrap===!1&&g<t){Ya(c,f,t);continue}c.push("")}if(g+a[p]>t&&r.wordWrap===!1){Ya(c,f,t);continue}c[c.length-1]+=f}r.trim!==!1&&(c=c.map(p=>Ob(p)));let u=c.join(`
`),d=u[Symbol.iterator](),l=d.next(),m=d.next(),h=0;for(;!l.done;){let p=l.value,f=m.value;if(n+=p,p===Ss||p===em){Kf.lastIndex=h+1;let y=Kf.exec(u)?.groups;if(y?.code!==void 0){let v=Number.parseFloat(y.code);o=v===Pb?void 0:v}else y?.uri!==void 0&&(s=y.uri.length===0?void 0:y.uri)}let g=o?Rb(o):void 0;f===`
`?(s&&(n+=Yf("")),o&&g&&(n+=Jf(g))):p===`
`&&(o&&g&&(n+=Jf(o)),s&&(n+=Yf(s))),h+=p.length,l=m,m=d.next()}return n};function Xa(e,t,r){return String(e).normalize().replaceAll(`\r
`,`
`).split(`
`).map(n=>Nb(n,t,r)).join(`
`)}var Ab=["up","down","left","right","space","enter","cancel"],it={actions:new Set(Ab),aliases:new Map([["k","up"],["j","down"],["h","left"],["l","right"],["","cancel"],["escape","cancel"]]),messages:{cancel:"Canceled",error:"Something went wrong"},withGuide:!0};function nc(e,t){if(typeof e=="string")return it.aliases.get(e)===t;for(let r of e)if(r!==void 0&&nc(r,t))return!0;return!1}function jb(e,t){if(e===t)return;let r=e.split(`
`),n=t.split(`
`),o=Math.max(r.length,n.length),s=[];for(let i=0;i<o;i++)r[i]!==n[i]&&s.push(i);return{lines:s,numLinesBefore:r.length,numLinesAfter:n.length,numLines:o}}var Mb=globalThis.process.platform.startsWith("win"),Qa=Symbol("clack:cancel");function Jn(e){return e===Qa}function bs(e,t){let r=e;r.isTTY&&r.setRawMode(t)}function nm({input:e=Xf,output:t=ec,overwrite:r=!0,hideCursor:n=!0}={}){let o=sr.createInterface({input:e,output:t,prompt:"",tabSize:1});sr.emitKeypressEvents(e,o),e instanceof Gf&&e.isTTY&&e.setRawMode(!0);let s=(i,{name:a,sequence:c})=>{let u=String(i);if(nc([u,a,c],"cancel")){n&&t.write(De.cursor.show),process.exit(0);return}if(!r)return;sr.moveCursor(t,a==="return"?0:-1,a==="return"?-1:0,()=>{sr.clearLine(t,1,()=>{e.once("keypress",s)})})};return n&&t.write(De.cursor.hide),e.once("keypress",s),()=>{e.off("keypress",s),n&&t.write(De.cursor.show),e instanceof Gf&&e.isTTY&&!Mb&&e.setRawMode(!1),o.terminal=!1,o.close()}}var Yn=e=>"columns"in e&&typeof e.columns=="number"?e.columns:80,oc=e=>"rows"in e&&typeof e.rows=="number"?e.rows:20;function Ts(e,t,r,n=r){let o=Yn(e??ec);return Xa(t,o-r.length,{hard:!0,trim:!1}).split(`
`).map((s,i)=>`${i===0?n:r}${s}`).join(`
`)}var xs=class{input;output;_abortSignal;rl;opts;_render;_track=!1;_prevFrame="";_subscribers=new Map;_cursor=0;state="initial";error="";value;userInput="";constructor(t,r=!0){let{input:n=Xf,output:o=ec,render:s,signal:i,...a}=t;this.opts=a,this.onKeypress=this.onKeypress.bind(this),this.close=this.close.bind(this),this.render=this.render.bind(this),this._render=s.bind(this),this._track=r,this._abortSignal=i,this.input=n,this.output=o}unsubscribe(){this._subscribers.clear()}setSubscriber(t,r){let n=this._subscribers.get(t)??[];n.push(r),this._subscribers.set(t,n)}on(t,r){this.setSubscriber(t,{cb:r})}once(t,r){this.setSubscriber(t,{cb:r,once:!0})}emit(t,...r){let n=this._subscribers.get(t)??[],o=[];for(let s of n)s.cb(...r),s.once&&o.push(()=>n.splice(n.indexOf(s),1));for(let s of o)s()}prompt(){return new Promise(t=>{if(this._abortSignal){if(this._abortSignal.aborted)return this.state="cancel",this.close(),t(Qa);this._abortSignal.addEventListener("abort",()=>{this.state="cancel",this.close()},{once:!0})}this.rl=xb.createInterface({input:this.input,tabSize:2,prompt:"",escapeCodeTimeout:50,terminal:!0}),this.rl.prompt(),this.opts.initialUserInput!==void 0&&this._setUserInput(this.opts.initialUserInput,!0),this.input.on("keypress",this.onKeypress),bs(this.input,!0),this.output.on("resize",this.render),this.render(),this.once("submit",()=>{this.output.write(De.cursor.show),this.output.off("resize",this.render),bs(this.input,!1),t(this.value)}),this.once("cancel",()=>{this.output.write(De.cursor.show),this.output.off("resize",this.render),bs(this.input,!1),t(Qa)})})}_isActionKey(t,r){return t==="	"}_setValue(t){this.value=t,this.emit("value",this.value)}_setUserInput(t,r){this.userInput=t??"",this.emit("userInput",this.userInput),r&&this._track&&this.rl&&(this.rl.write(this.userInput),this._cursor=this.rl.cursor)}_clearUserInput(){this.rl?.write(null,{ctrl:!0,name:"u"}),this._setUserInput("")}onKeypress(t,r){if(this._track&&r.name!=="return"&&(r.name&&this._isActionKey(t,r)&&this.rl?.write(null,{ctrl:!0,name:"h"}),this._cursor=this.rl?.cursor??0,this._setUserInput(this.rl?.line)),this.state==="error"&&(this.state="active"),r?.name&&(!this._track&&it.aliases.has(r.name)&&this.emit("cursor",it.aliases.get(r.name)),it.actions.has(r.name)&&this.emit("cursor",r.name)),t&&(t.toLowerCase()==="y"||t.toLowerCase()==="n")&&this.emit("confirm",t.toLowerCase()==="y"),this.emit("key",t?.toLowerCase(),r),r?.name==="return"){if(this.opts.validate){let n=this.opts.validate(this.value);n&&(this.error=n instanceof Error?n.message:n,this.state="error",this.rl?.write(this.userInput))}this.state!=="error"&&(this.state="submit")}nc([t,r?.name,r?.sequence],"cancel")&&(this.state="cancel"),(this.state==="submit"||this.state==="cancel")&&this.emit("finalize"),this.render(),(this.state==="submit"||this.state==="cancel")&&this.close()}close(){this.input.unpipe(),this.input.removeListener("keypress",this.onKeypress),this.output.write(`
`),bs(this.input,!1),this.rl?.close(),this.rl=void 0,this.emit(`${this.state}`,this.value),this.unsubscribe()}restoreCursor(){let t=Xa(this._prevFrame,process.stdout.columns,{hard:!0,trim:!1}).split(`
`).length-1;this.output.write(De.cursor.move(-999,t*-1))}render(){let t=Xa(this._render(this)??"",process.stdout.columns,{hard:!0,trim:!1});if(t!==this._prevFrame){if(this.state==="initial")this.output.write(De.cursor.hide);else{let r=jb(this._prevFrame,t),n=oc(this.output);if(this.restoreCursor(),r){let o=Math.max(0,r.numLinesAfter-n),s=Math.max(0,r.numLinesBefore-n),i=r.lines.find(a=>a>=o);if(i===void 0){this._prevFrame=t;return}if(r.lines.length===1){this.output.write(De.cursor.move(0,i-s)),this.output.write(De.erase.lines(1));let a=t.split(`
`);this.output.write(a[i]),this._prevFrame=t,this.output.write(De.cursor.move(0,a.length-i-1));return}else if(r.lines.length>1){if(o<s)i=o;else{let c=i-s;c>0&&this.output.write(De.cursor.move(0,c))}this.output.write(De.erase.down());let a=t.split(`
`).slice(i);this.output.write(a.join(`
`)),this._prevFrame=t;return}}this.output.write(De.erase.down())}this.output.write(t),this.state==="initial"&&(this.state="active"),this._prevFrame=t}}};var ws=class extends xs{get cursor(){return this.value?0:1}get _value(){return this.cursor===0}constructor(t){super(t,!1),this.value=!!t.initialValue,this.on("userInput",()=>{this.value=this._value}),this.on("confirm",r=>{this.output.write(De.cursor.move(0,-1)),this.value=r,this.state="submit",this.close()}),this.on("cursor",()=>{this.value=!this.value})}};var ks=class extends xs{options;cursor=0;get _selectedValue(){return this.options[this.cursor]}changeValue(){this.value=this._selectedValue.value}constructor(t){super(t,!1),this.options=t.options;let r=this.options.findIndex(({value:o})=>o===t.initialValue),n=r===-1?0:r;this.cursor=this.options[n].disabled?$s(n,1,this.options):n,this.changeValue(),this.on("cursor",o=>{switch(o){case"left":case"up":this.cursor=$s(this.cursor,-1,this.options);break;case"down":case"right":this.cursor=$s(this.cursor,1,this.options);break}this.changeValue()})}};var C=pn(Ha(),1);import pt from"node:process";var Xn=pn(Ga(),1);function Zb(){return pt.platform!=="win32"?pt.env.TERM!=="linux":!!pt.env.CI||!!pt.env.WT_SESSION||!!pt.env.TERMINUS_SUBLIME||pt.env.ConEmuTask==="{cmd::Cmder}"||pt.env.TERM_PROGRAM==="Terminus-Sublime"||pt.env.TERM_PROGRAM==="vscode"||pt.env.TERM==="xterm-256color"||pt.env.TERM==="alacritty"||pt.env.TERMINAL_EMULATOR==="JetBrains-JediTerm"}var cc=Zb(),Lb=()=>process.env.CI==="true";var ce=(e,t)=>cc?e:t,Db=ce("\u25C6","*"),cm=ce("\u25A0","x"),um=ce("\u25B2","x"),Cs=ce("\u25C7","o"),qb=ce("\u250C","T"),we=ce("\u2502","|"),Os=ce("\u2514","\u2014"),a2=ce("\u2510","T"),c2=ce("\u2518","\u2014"),uc=ce("\u25CF",">"),Rs=ce("\u25CB"," "),u2=ce("\u25FB","[\u2022]"),l2=ce("\u25FC","[+]"),d2=ce("\u25FB","[ ]"),p2=ce("\u25AA","\u2022"),om=ce("\u2500","-"),Fb=ce("\u256E","+"),Ub=ce("\u251C","+"),Vb=ce("\u256F","+"),Bb=ce("\u2570","+"),f2=ce("\u256D","+"),Hb=ce("\u25CF","\u2022"),Wb=ce("\u25C6","*"),Gb=ce("\u25B2","!"),Kb=ce("\u25A0","x"),lm=e=>{switch(e){case"initial":case"active":return C.default.cyan(Db);case"cancel":return C.default.red(cm);case"error":return C.default.yellow(um);case"submit":return C.default.green(Cs)}},Jb=e=>{switch(e){case"initial":case"active":return C.default.cyan(we);case"cancel":return C.default.red(we);case"error":return C.default.yellow(we);case"submit":return C.default.green(we)}},Yb=e=>e===161||e===164||e===167||e===168||e===170||e===173||e===174||e>=176&&e<=180||e>=182&&e<=186||e>=188&&e<=191||e===198||e===208||e===215||e===216||e>=222&&e<=225||e===230||e>=232&&e<=234||e===236||e===237||e===240||e===242||e===243||e>=247&&e<=250||e===252||e===254||e===257||e===273||e===275||e===283||e===294||e===295||e===299||e>=305&&e<=307||e===312||e>=319&&e<=322||e===324||e>=328&&e<=331||e===333||e===338||e===339||e===358||e===359||e===363||e===462||e===464||e===466||e===468||e===470||e===472||e===474||e===476||e===593||e===609||e===708||e===711||e>=713&&e<=715||e===717||e===720||e>=728&&e<=731||e===733||e===735||e>=768&&e<=879||e>=913&&e<=929||e>=931&&e<=937||e>=945&&e<=961||e>=963&&e<=969||e===1025||e>=1040&&e<=1103||e===1105||e===8208||e>=8211&&e<=8214||e===8216||e===8217||e===8220||e===8221||e>=8224&&e<=8226||e>=8228&&e<=8231||e===8240||e===8242||e===8243||e===8245||e===8251||e===8254||e===8308||e===8319||e>=8321&&e<=8324||e===8364||e===8451||e===8453||e===8457||e===8467||e===8470||e===8481||e===8482||e===8486||e===8491||e===8531||e===8532||e>=8539&&e<=8542||e>=8544&&e<=8555||e>=8560&&e<=8569||e===8585||e>=8592&&e<=8601||e===8632||e===8633||e===8658||e===8660||e===8679||e===8704||e===8706||e===8707||e===8711||e===8712||e===8715||e===8719||e===8721||e===8725||e===8730||e>=8733&&e<=8736||e===8739||e===8741||e>=8743&&e<=8748||e===8750||e>=8756&&e<=8759||e===8764||e===8765||e===8776||e===8780||e===8786||e===8800||e===8801||e>=8804&&e<=8807||e===8810||e===8811||e===8814||e===8815||e===8834||e===8835||e===8838||e===8839||e===8853||e===8857||e===8869||e===8895||e===8978||e>=9312&&e<=9449||e>=9451&&e<=9547||e>=9552&&e<=9587||e>=9600&&e<=9615||e>=9618&&e<=9621||e===9632||e===9633||e>=9635&&e<=9641||e===9650||e===9651||e===9654||e===9655||e===9660||e===9661||e===9664||e===9665||e>=9670&&e<=9672||e===9675||e>=9678&&e<=9681||e>=9698&&e<=9701||e===9711||e===9733||e===9734||e===9737||e===9742||e===9743||e===9756||e===9758||e===9792||e===9794||e===9824||e===9825||e>=9827&&e<=9829||e>=9831&&e<=9834||e===9836||e===9837||e===9839||e===9886||e===9887||e===9919||e>=9926&&e<=9933||e>=9935&&e<=9939||e>=9941&&e<=9953||e===9955||e===9960||e===9961||e>=9963&&e<=9969||e===9972||e>=9974&&e<=9977||e===9979||e===9980||e===9982||e===9983||e===10045||e>=10102&&e<=10111||e>=11094&&e<=11097||e>=12872&&e<=12879||e>=57344&&e<=63743||e>=65024&&e<=65039||e===65533||e>=127232&&e<=127242||e>=127248&&e<=127277||e>=127280&&e<=127337||e>=127344&&e<=127373||e===127375||e===127376||e>=127387&&e<=127404||e>=917760&&e<=917999||e>=983040&&e<=1048573||e>=1048576&&e<=1114109,Xb=e=>e===12288||e>=65281&&e<=65376||e>=65504&&e<=65510,Qb=e=>e>=4352&&e<=4447||e===8986||e===8987||e===9001||e===9002||e>=9193&&e<=9196||e===9200||e===9203||e===9725||e===9726||e===9748||e===9749||e>=9800&&e<=9811||e===9855||e===9875||e===9889||e===9898||e===9899||e===9917||e===9918||e===9924||e===9925||e===9934||e===9940||e===9962||e===9970||e===9971||e===9973||e===9978||e===9981||e===9989||e===9994||e===9995||e===10024||e===10060||e===10062||e>=10067&&e<=10069||e===10071||e>=10133&&e<=10135||e===10160||e===10175||e===11035||e===11036||e===11088||e===11093||e>=11904&&e<=11929||e>=11931&&e<=12019||e>=12032&&e<=12245||e>=12272&&e<=12287||e>=12289&&e<=12350||e>=12353&&e<=12438||e>=12441&&e<=12543||e>=12549&&e<=12591||e>=12593&&e<=12686||e>=12688&&e<=12771||e>=12783&&e<=12830||e>=12832&&e<=12871||e>=12880&&e<=19903||e>=19968&&e<=42124||e>=42128&&e<=42182||e>=43360&&e<=43388||e>=44032&&e<=55203||e>=63744&&e<=64255||e>=65040&&e<=65049||e>=65072&&e<=65106||e>=65108&&e<=65126||e>=65128&&e<=65131||e>=94176&&e<=94180||e===94192||e===94193||e>=94208&&e<=100343||e>=100352&&e<=101589||e>=101632&&e<=101640||e>=110576&&e<=110579||e>=110581&&e<=110587||e===110589||e===110590||e>=110592&&e<=110882||e===110898||e>=110928&&e<=110930||e===110933||e>=110948&&e<=110951||e>=110960&&e<=111355||e===126980||e===127183||e===127374||e>=127377&&e<=127386||e>=127488&&e<=127490||e>=127504&&e<=127547||e>=127552&&e<=127560||e===127568||e===127569||e>=127584&&e<=127589||e>=127744&&e<=127776||e>=127789&&e<=127797||e>=127799&&e<=127868||e>=127870&&e<=127891||e>=127904&&e<=127946||e>=127951&&e<=127955||e>=127968&&e<=127984||e===127988||e>=127992&&e<=128062||e===128064||e>=128066&&e<=128252||e>=128255&&e<=128317||e>=128331&&e<=128334||e>=128336&&e<=128359||e===128378||e===128405||e===128406||e===128420||e>=128507&&e<=128591||e>=128640&&e<=128709||e===128716||e>=128720&&e<=128722||e>=128725&&e<=128727||e>=128732&&e<=128735||e===128747||e===128748||e>=128756&&e<=128764||e>=128992&&e<=129003||e===129008||e>=129292&&e<=129338||e>=129340&&e<=129349||e>=129351&&e<=129535||e>=129648&&e<=129660||e>=129664&&e<=129672||e>=129680&&e<=129725||e>=129727&&e<=129733||e>=129742&&e<=129755||e>=129760&&e<=129768||e>=129776&&e<=129784||e>=131072&&e<=196605||e>=196608&&e<=262141,sc=/[\u001b\u009b][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-ORZcf-nqry=><]/y,Es=/[\x00-\x08\x0A-\x1F\x7F-\x9F]{1,1000}/y,zs=/\t{1,1000}/y,ic=new RegExp("[\\u{1F1E6}-\\u{1F1FF}]{2}|\\u{1F3F4}[\\u{E0061}-\\u{E007A}]{2}[\\u{E0030}-\\u{E0039}\\u{E0061}-\\u{E007A}]{1,3}\\u{E007F}|(?:\\p{Emoji}\\uFE0F\\u20E3?|\\p{Emoji_Modifier_Base}\\p{Emoji_Modifier}?|\\p{Emoji_Presentation})(?:\\u200D(?:\\p{Emoji_Modifier_Base}\\p{Emoji_Modifier}?|\\p{Emoji_Presentation}|\\p{Emoji}\\uFE0F\\u20E3?))*","yu"),Ps=/(?:[\x20-\x7E\xA0-\xFF](?!\uFE0F)){1,1000}/y,e$=new RegExp("\\p{M}+","gu"),t$={limit:1/0,ellipsis:""},dm=(e,t={},r={})=>{let n=t.limit??1/0,o=t.ellipsis??"",s=t?.ellipsisWidth??(o?dm(o,t$,r).width:0),i=r.ansiWidth??0,a=r.controlWidth??0,c=r.tabWidth??8,u=r.ambiguousWidth??1,d=r.emojiWidth??2,l=r.fullWidthWidth??2,m=r.regularWidth??1,h=r.wideWidth??2,p=0,f=0,g=e.length,y=0,v=!1,_=g,w=Math.max(0,n-s),E=0,B=0,I=0,j=0;e:for(;;){if(B>E||f>=g&&f>p){let Ie=e.slice(E,B)||e.slice(p,f);y=0;for(let ze of Ie.replaceAll(e$,"")){let Re=ze.codePointAt(0)||0;if(Xb(Re)?j=l:Qb(Re)?j=h:u!==m&&Yb(Re)?j=u:j=m,I+j>w&&(_=Math.min(_,Math.max(E,p)+y)),I+j>n){v=!0;break e}y+=ze.length,I+=j}E=B=0}if(f>=g)break;if(Ps.lastIndex=f,Ps.test(e)){if(y=Ps.lastIndex-f,j=y*m,I+j>w&&(_=Math.min(_,f+Math.floor((w-I)/m))),I+j>n){v=!0;break}I+=j,E=p,B=f,f=p=Ps.lastIndex;continue}if(sc.lastIndex=f,sc.test(e)){if(I+i>w&&(_=Math.min(_,f)),I+i>n){v=!0;break}I+=i,E=p,B=f,f=p=sc.lastIndex;continue}if(Es.lastIndex=f,Es.test(e)){if(y=Es.lastIndex-f,j=y*a,I+j>w&&(_=Math.min(_,f+Math.floor((w-I)/a))),I+j>n){v=!0;break}I+=j,E=p,B=f,f=p=Es.lastIndex;continue}if(zs.lastIndex=f,zs.test(e)){if(y=zs.lastIndex-f,j=y*c,I+j>w&&(_=Math.min(_,f+Math.floor((w-I)/c))),I+j>n){v=!0;break}I+=j,E=p,B=f,f=p=zs.lastIndex;continue}if(ic.lastIndex=f,ic.test(e)){if(I+d>w&&(_=Math.min(_,f)),I+d>n){v=!0;break}I+=d,E=p,B=f,f=p=ic.lastIndex;continue}f+=1}return{width:v?w:I,index:v?_:g,truncated:v,ellipsed:v&&n>=s}},r$={limit:1/0,ellipsis:"",ellipsisWidth:0},Ot=(e,t={})=>dm(e,r$,t).width,Ns="\x1B",pm="\x9B",n$=39,lc="\x07",fm="[",o$="]",mm="m",dc=`${o$}8;;`,sm=new RegExp(`(?:\\${fm}(?<code>\\d+)m|\\${dc}(?<uri>.*)${lc})`,"y"),s$=e=>{if(e>=30&&e<=37||e>=90&&e<=97)return 39;if(e>=40&&e<=47||e>=100&&e<=107)return 49;if(e===1||e===2)return 22;if(e===3)return 23;if(e===4)return 24;if(e===7)return 27;if(e===8)return 28;if(e===9)return 29;if(e===0)return 0},im=e=>`${Ns}${fm}${e}${mm}`,am=e=>`${Ns}${dc}${e}${lc}`,i$=e=>e.map(t=>Ot(t)),ac=(e,t,r)=>{let n=t[Symbol.iterator](),o=!1,s=!1,i=e.at(-1),a=i===void 0?0:Ot(i),c=n.next(),u=n.next(),d=0;for(;!c.done;){let l=c.value,m=Ot(l);a+m<=r?e[e.length-1]+=l:(e.push(l),a=0),(l===Ns||l===pm)&&(o=!0,s=t.startsWith(dc,d+1)),o?s?l===lc&&(o=!1,s=!1):l===mm&&(o=!1):(a+=m,a===r&&!u.done&&(e.push(""),a=0)),c=u,u=n.next(),d+=l.length}i=e.at(-1),!a&&i!==void 0&&i.length>0&&e.length>1&&(e[e.length-2]+=e.pop())},a$=e=>{let t=e.split(" "),r=t.length;for(;r>0&&!(Ot(t[r-1])>0);)r--;return r===t.length?e:t.slice(0,r).join(" ")+t.slice(r).join("")},c$=(e,t,r={})=>{if(r.trim!==!1&&e.trim()==="")return"";let n="",o,s,i=e.split(" "),a=i$(i),c=[""];for(let[p,f]of i.entries()){r.trim!==!1&&(c[c.length-1]=(c.at(-1)??"").trimStart());let g=Ot(c.at(-1)??"");if(p!==0&&(g>=t&&(r.wordWrap===!1||r.trim===!1)&&(c.push(""),g=0),(g>0||r.trim===!1)&&(c[c.length-1]+=" ",g++)),r.hard&&a[p]>t){let y=t-g,v=1+Math.floor((a[p]-y-1)/t);Math.floor((a[p]-1)/t)<v&&c.push(""),ac(c,f,t);continue}if(g+a[p]>t&&g>0&&a[p]>0){if(r.wordWrap===!1&&g<t){ac(c,f,t);continue}c.push("")}if(g+a[p]>t&&r.wordWrap===!1){ac(c,f,t);continue}c[c.length-1]+=f}r.trim!==!1&&(c=c.map(p=>a$(p)));let u=c.join(`
`),d=u[Symbol.iterator](),l=d.next(),m=d.next(),h=0;for(;!l.done;){let p=l.value,f=m.value;if(n+=p,p===Ns||p===pm){sm.lastIndex=h+1;let y=sm.exec(u)?.groups;if(y?.code!==void 0){let v=Number.parseFloat(y.code);o=v===n$?void 0:v}else y?.uri!==void 0&&(s=y.uri.length===0?void 0:y.uri)}let g=o?s$(o):void 0;f===`
`?(s&&(n+=am("")),o&&g&&(n+=im(g))):p===`
`&&(o&&g&&(n+=im(o)),s&&(n+=am(s))),h+=p.length,l=m,m=d.next()}return n};function Qn(e,t,r){return String(e).normalize().replaceAll(`\r
`,`
`).split(`
`).map(n=>c$(n,t,r)).join(`
`)}var u$=(e,t,r,n,o)=>{let s=t,i=0;for(let a=r;a<n;a++){let c=e[a];if(s=s-c.length,i++,s<=o)break}return{lineCount:s,removals:i}},l$=e=>{let{cursor:t,options:r,style:n}=e,o=e.output??process.stdout,s=Yn(o),i=e.columnPadding??0,a=e.rowPadding??4,c=s-i,u=oc(o),d=C.default.dim("..."),l=e.maxItems??Number.POSITIVE_INFINITY,m=Math.max(u-a,0),h=Math.max(Math.min(l,m),5),p=0;t>=h-3&&(p=Math.max(Math.min(t-h+3,r.length-h),0));let f=h<r.length&&p>0,g=h<r.length&&p+h<r.length,y=Math.min(p+h,r.length),v=[],_=0;f&&_++,g&&_++;let w=p+(f?1:0),E=y-(g?1:0);for(let I=w;I<E;I++){let j=Qn(n(r[I],I===t),c,{hard:!0,trim:!1}).split(`
`);v.push(j),_+=j.length}if(_>m){let I=0,j=0,Ie=_,ze=t-w,Re=(dn,Ct)=>u$(v,Ie,dn,Ct,m);f?({lineCount:Ie,removals:I}=Re(0,ze),Ie>m&&({lineCount:Ie,removals:j}=Re(ze+1,v.length))):({lineCount:Ie,removals:j}=Re(ze+1,v.length),Ie>m&&({lineCount:Ie,removals:I}=Re(0,ze))),I>0&&(f=!0,v.splice(0,I)),j>0&&(g=!0,v.splice(v.length-j,j))}let B=[];f&&B.push(d);for(let I of v)for(let j of I)B.push(j);return g&&B.push(d),B};var hm=e=>{let t=e.active??"Yes",r=e.inactive??"No";return new ws({active:t,inactive:r,signal:e.signal,input:e.input,output:e.output,initialValue:e.initialValue??!0,render(){let n=e.withGuide??it.withGuide,o=`${n?`${C.default.gray(we)}
`:""}${lm(this.state)}  ${e.message}
`,s=this.value?t:r;switch(this.state){case"submit":{let i=n?`${C.default.gray(we)}  `:"";return`${o}${i}${C.default.dim(s)}`}case"cancel":{let i=n?`${C.default.gray(we)}  `:"";return`${o}${i}${C.default.strikethrough(C.default.dim(s))}${n?`
${C.default.gray(we)}`:""}`}default:{let i=n?`${C.default.cyan(we)}  `:"",a=n?C.default.cyan(Os):"";return`${o}${i}${this.value?`${C.default.green(uc)} ${t}`:`${C.default.dim(Rs)} ${C.default.dim(t)}`}${e.vertical?n?`
${C.default.cyan(we)}  `:`
`:` ${C.default.dim("/")} `}${this.value?`${C.default.dim(Rs)} ${C.default.dim(r)}`:`${C.default.green(uc)} ${r}`}
${a}
`}}}}).prompt()};var O={message:(e=[],{symbol:t=C.default.gray(we),secondarySymbol:r=C.default.gray(we),output:n=process.stdout,spacing:o=1,withGuide:s}={})=>{let i=[],a=s??it.withGuide,c=a?r:"",u=a?`${t}  `:"",d=a?`${r}  `:"";for(let m=0;m<o;m++)i.push(c);let l=Array.isArray(e)?e:e.split(`
`);if(l.length>0){let[m,...h]=l;m.length>0?i.push(`${u}${m}`):i.push(a?t:"");for(let p of h)p.length>0?i.push(`${d}${p}`):i.push(a?r:"")}n.write(`${i.join(`
`)}
`)},info:(e,t)=>{O.message(e,{...t,symbol:C.default.blue(Hb)})},success:(e,t)=>{O.message(e,{...t,symbol:C.default.green(Wb)})},step:(e,t)=>{O.message(e,{...t,symbol:C.default.green(Cs)})},warn:(e,t)=>{O.message(e,{...t,symbol:C.default.yellow(Gb)})},warning:(e,t)=>{O.warn(e,t)},error:(e,t)=>{O.message(e,{...t,symbol:C.default.red(Kb)})}},pc=(e="",t)=>{(t?.output??process.stdout).write(`${C.default.gray(Os)}  ${C.default.red(e)}

`)},As=(e="",t)=>{(t?.output??process.stdout).write(`${C.default.gray(qb)}  ${e}
`)},js=(e="",t)=>{(t?.output??process.stdout).write(`${C.default.gray(we)}
${C.default.gray(Os)}  ${e}

`)};var d$=e=>C.default.dim(e),p$=(e,t,r)=>{let n={hard:!0,trim:!1},o=Qn(e,t,n).split(`
`),s=o.reduce((c,u)=>Math.max(Ot(u),c),0),i=o.map(r).reduce((c,u)=>Math.max(Ot(u),c),0),a=t-(i-s);return Qn(e,a,n)},fn=(e="",t="",r)=>{let n=r?.output??pt.stdout,o=r?.withGuide??it.withGuide,s=r?.format??d$,i=["",...p$(e,Yn(n)-6,s).split(`
`).map(s),""],a=Ot(t),c=Math.max(i.reduce((m,h)=>{let p=Ot(h);return p>m?p:m},0),a)+2,u=i.map(m=>`${C.default.gray(we)}  ${m}${" ".repeat(c-Ot(m))}${C.default.gray(we)}`).join(`
`),d=o?`${C.default.gray(we)}
`:"",l=o?Ub:Bb;n.write(`${d}${C.default.green(Cs)}  ${C.default.reset(t)} ${C.default.gray(om.repeat(Math.max(c-a-1,1))+Fb)}
${u}
${C.default.gray(l+om.repeat(c+2)+Vb)}
`)};var f$=C.default.magenta,Ms=({indicator:e="dots",onCancel:t,output:r=process.stdout,cancelMessage:n,errorMessage:o,frames:s=cc?["\u25D2","\u25D0","\u25D3","\u25D1"]:["\u2022","o","O","0"],delay:i=cc?80:120,signal:a,...c}={})=>{let u=Lb(),d,l,m=!1,h=!1,p="",f,g=performance.now(),y=Yn(r),v=c?.styleFrame??f$,_=_e=>{let dt=_e>1?o??it.messages.error:n??it.messages.cancel;h=_e===1,m&&(Ct(dt,_e),h&&typeof t=="function"&&t())},w=()=>_(2),E=()=>_(1),B=()=>{process.on("uncaughtExceptionMonitor",w),process.on("unhandledRejection",w),process.on("SIGINT",E),process.on("SIGTERM",E),process.on("exit",_),a&&a.addEventListener("abort",E)},I=()=>{process.removeListener("uncaughtExceptionMonitor",w),process.removeListener("unhandledRejection",w),process.removeListener("SIGINT",E),process.removeListener("SIGTERM",E),process.removeListener("exit",_),a&&a.removeEventListener("abort",E)},j=()=>{if(f===void 0)return;u&&r.write(`
`);let _e=Qn(f,y,{hard:!0,trim:!1}).split(`
`);_e.length>1&&r.write(Xn.cursor.up(_e.length-1)),r.write(Xn.cursor.to(0)),r.write(Xn.erase.down())},Ie=_e=>_e.replace(/\.+$/,""),ze=_e=>{let dt=(performance.now()-_e)/1e3,Ht=Math.floor(dt/60),Wt=Math.floor(dt%60);return Ht>0?`[${Ht}m ${Wt}s]`:`[${Wt}s]`},Re=c.withGuide??it.withGuide,dn=(_e="")=>{m=!0,d=nm({output:r}),p=Ie(_e),g=performance.now(),Re&&r.write(`${C.default.gray(we)}
`);let dt=0,Ht=0;B(),l=setInterval(()=>{if(u&&p===f)return;j(),f=p;let Wt=v(s[dt]),fs;if(u)fs=`${Wt}  ${p}...`;else if(e==="timer")fs=`${Wt}  ${p} ${ze(g)}`;else{let lb=".".repeat(Math.floor(Ht)).slice(0,3);fs=`${Wt}  ${p}${lb}`}let ub=Qn(fs,y,{hard:!0,trim:!1});r.write(ub),dt=dt+1<s.length?dt+1:0,Ht=Ht<4?Ht+.125:0},i)},Ct=(_e="",dt=0,Ht=!1)=>{if(!m)return;m=!1,clearInterval(l),j();let Wt=dt===0?C.default.green(Cs):dt===1?C.default.red(cm):C.default.red(um);p=_e??p,Ht||(e==="timer"?r.write(`${Wt}  ${p} ${ze(g)}
`):r.write(`${Wt}  ${p}
`)),I(),d()};return{start:dn,stop:(_e="")=>Ct(_e,0),message:(_e="")=>{p=Ie(_e??p)},cancel:(_e="")=>Ct(_e,1),error:(_e="")=>Ct(_e,2),clear:()=>Ct("",0,!0),get isCancelled(){return h}}},m2={light:ce("\u2500","-"),heavy:ce("\u2501","="),block:ce("\u2588","#")};var Is=(e,t)=>e.includes(`
`)?e.split(`
`).map(r=>t(r)).join(`
`):t(e),gm=e=>{let t=(r,n)=>{let o=r.label??String(r.value);switch(n){case"disabled":return`${C.default.gray(Rs)} ${Is(o,C.default.gray)}${r.hint?` ${C.default.dim(`(${r.hint??"disabled"})`)}`:""}`;case"selected":return`${Is(o,C.default.dim)}`;case"active":return`${C.default.green(uc)} ${o}${r.hint?` ${C.default.dim(`(${r.hint})`)}`:""}`;case"cancelled":return`${Is(o,s=>C.default.strikethrough(C.default.dim(s)))}`;default:return`${C.default.dim(Rs)} ${Is(o,C.default.dim)}`}};return new ks({options:e.options,signal:e.signal,input:e.input,output:e.output,initialValue:e.initialValue,render(){let r=e.withGuide??it.withGuide,n=`${lm(this.state)}  `,o=`${Jb(this.state)}  `,s=Ts(e.output,e.message,o,n),i=`${r?`${C.default.gray(we)}
`:""}${s}
`;switch(this.state){case"submit":{let a=r?`${C.default.gray(we)}  `:"",c=Ts(e.output,t(this.options[this.cursor],"selected"),a);return`${i}${c}`}case"cancel":{let a=r?`${C.default.gray(we)}  `:"",c=Ts(e.output,t(this.options[this.cursor],"cancelled"),a);return`${i}${c}${r?`
${C.default.gray(we)}`:""}`}default:{let a=r?`${C.default.cyan(we)}  `:"",c=r?C.default.cyan(Os):"",u=i.split(`
`).length,d=r?2:1;return`${i}${a}${l$({output:e.output,cursor:this.cursor,options:this.options,maxItems:e.maxItems,columnPadding:a.length,rowPadding:u+d,style:(l,m)=>t(l,l.disabled?"disabled":m?"active":"inactive")}).join(`
${a}`)}
${c}
`}}}}).prompt()};var h2=`${C.default.gray(we)}  `;var T=pn(Ha(),1);Zs();import{execSync as lt}from"node:child_process";import{readFileSync as Vf,writeFileSync as NR,copyFileSync as AR,chmodSync as jR,accessSync as qf,readdirSync as MR,constants as Ff}from"node:fs";import{resolve as or,dirname as ZR}from"node:path";import{fileURLToPath as LR}from"node:url";import{homedir as Uf}from"node:os";var Df=process.argv.slice(2);Df[0]==="setup"?VR():Df[0]==="doctor"?cb():Df[0]==="upgrade"?UR():Promise.resolve().then(()=>(ob(),OR));function Ua(){let e=LR(import.meta.url),t=ZR(e);return or(t,"..")}function sb(){return or(Uf(),".claude","settings.json")}function ib(){try{let e=Vf(sb(),"utf-8");return JSON.parse(e)}catch{return null}}function DR(){return or(Ua(),"hooks","pretooluse.sh")}function ab(){try{return JSON.parse(Vf(or(Ua(),"package.json"),"utf-8")).version??"unknown"}catch{return"unknown"}}async function qR(){try{let e=await fetch("https://registry.npmjs.org/context-mode/latest");return e.ok?(await e.json()).version??"unknown":"unknown"}catch{return"unknown"}}function FR(){let t=Ua().match(/plugins\/cache\/[^/]+\/[^/]+\/(\d+\.\d+\.\d+[^/]*)/);if(t)return t[1];let r=[or(Uf(),".claude"),or(Uf(),".config","claude")];for(let n of r){let o=or(n,"plugins","cache","claude-context-mode","context-mode");try{let i=MR(o).filter(a=>/^\d+\.\d+\.\d+/.test(a)).sort((a,c)=>{let u=a.split(".").map(Number),d=c.split(".").map(Number);for(let l=0;l<3;l++)if((u[l]??0)!==(d[l]??0))return(u[l]??0)-(d[l]??0);return 0});if(i.length>0)return i[i.length-1]}catch{}}return"not installed"}async function cb(){console.clear(),As(T.default.bgMagenta(T.default.white(" context-mode doctor ")));let e=Ms();e.start("Running diagnostics");let t=ir(),r=eo(t);e.stop("Diagnostics complete"),fn(mn(t),"Runtimes"),Pr()?O.success(T.default.green("Performance: FAST")+" \u2014 Bun detected for JS/TS execution"):O.warn(T.default.yellow("Performance: NORMAL")+" \u2014 Using Node.js (install Bun for 3-5x speed boost)");let n=10,o=(r.length/n*100).toFixed(0);O.info(`Language coverage: ${r.length}/${n} (${o}%)`+T.default.dim(` \u2014 ${r.join(", ")}`)),O.step("Testing server initialization...");try{let{PolyglotExecutor:d}=await Promise.resolve().then(()=>(jf(),W0)),m=await new d({runtimes:t}).execute({language:"javascript",code:'console.log("ok");',timeout:5e3});m.exitCode===0&&m.stdout.trim()==="ok"?O.success(T.default.green("Server test: PASS")):O.error(T.default.red("Server test: FAIL")+` \u2014 exit ${m.exitCode}`)}catch(d){let l=d instanceof Error?d.message:String(d);O.error(T.default.red("Server test: FAIL")+` \u2014 ${l}`)}O.step("Checking hooks configuration...");let s=ib(),i=DR();if(s){let l=s.hooks?.PreToolUse;l&&l.length>0?l.some(h=>h.hooks?.some(p=>p.command?.includes("pretooluse.sh")))?O.success(T.default.green("Hooks installed: PASS")+" \u2014 PreToolUse hook configured"):O.error(T.default.red("Hooks installed: FAIL")+" \u2014 PreToolUse exists but does not point to pretooluse.sh"+T.default.dim(`
  Run: npx context-mode upgrade`)):O.error(T.default.red("Hooks installed: FAIL")+" \u2014 No PreToolUse hooks found"+T.default.dim(`
  Run: npx context-mode upgrade`))}else O.error(T.default.red("Hooks installed: FAIL")+" \u2014 Could not read ~/.claude/settings.json"+T.default.dim(`
  Run: npx context-mode upgrade`));O.step("Checking hook script...");try{qf(i,Ff.R_OK),O.success(T.default.green("Hook script exists: PASS")+T.default.dim(` \u2014 ${i}`))}catch{O.error(T.default.red("Hook script exists: FAIL")+T.default.dim(` \u2014 not found at ${i}`))}if(O.step("Checking plugin registration..."),s){let d=s.enabledPlugins;if(d){let l=Object.keys(d).find(m=>m.startsWith("context-mode"));l&&d[l]?O.success(T.default.green("Plugin enabled: PASS")+T.default.dim(` \u2014 ${l}`)):O.warn(T.default.yellow("Plugin enabled: WARN")+" \u2014 context-mode not in enabledPlugins"+T.default.dim(" (might be using standalone MCP mode)"))}else O.warn(T.default.yellow("Plugin enabled: WARN")+" \u2014 no enabledPlugins section found"+T.default.dim(" (might be using standalone MCP mode)"))}else O.warn(T.default.yellow("Plugin enabled: WARN")+" \u2014 could not read settings.json");O.step("Checking FTS5 / better-sqlite3...");try{let d=(await import("better-sqlite3")).default,l=new d(":memory:");l.exec("CREATE VIRTUAL TABLE fts_test USING fts5(content)"),l.exec("INSERT INTO fts_test(content) VALUES ('hello world')");let m=l.prepare("SELECT * FROM fts_test WHERE fts_test MATCH 'hello'").get();l.close(),m&&m.content==="hello world"?O.success(T.default.green("FTS5 / better-sqlite3: PASS")+" \u2014 native module works"):O.error(T.default.red("FTS5 / better-sqlite3: FAIL")+" \u2014 query returned unexpected result")}catch(d){let l=d instanceof Error?d.message:String(d);O.error(T.default.red("FTS5 / better-sqlite3: FAIL")+` \u2014 ${l}`+T.default.dim(`
  Try: npm rebuild better-sqlite3`))}O.step("Checking versions...");let a=ab(),c=await qR(),u=FR();c==="unknown"?O.warn(T.default.yellow("npm (MCP): WARN")+` \u2014 local v${a}, could not reach npm registry`):a===c?O.success(T.default.green("npm (MCP): PASS")+` \u2014 v${a}`):O.warn(T.default.yellow("npm (MCP): WARN")+` \u2014 local v${a}, latest v${c}`+T.default.dim(`
  Run: npm install -g context-mode@latest`)),u==="not installed"?O.info(T.default.dim("Marketplace: not installed")+" \u2014 using standalone MCP mode"):c!=="unknown"&&u===c?O.success(T.default.green("Marketplace: PASS")+` \u2014 v${u}`):c!=="unknown"?O.warn(T.default.yellow("Marketplace: WARN")+` \u2014 v${u}, latest v${c}`+T.default.dim(`
  Update via Claude Code marketplace or reinstall plugin`)):O.info(`Marketplace: v${u}`+T.default.dim(" \u2014 could not verify against npm registry")),js(r.length>=4?T.default.green("Diagnostics complete!"):T.default.yellow("Some checks need attention \u2014 see above for details"))}async function UR(){console.clear(),As(T.default.bgCyan(T.default.black(" context-mode upgrade ")));let e=Ua(),t=sb(),r=[],n=Ms();O.step("Pulling latest from GitHub...");let o=ab(),s=`/tmp/context-mode-upgrade-${Date.now()}`;n.start("Cloning mksglu/claude-context-mode");try{lt(`git clone --depth 1 https://github.com/mksglu/claude-context-mode.git "${s}"`,{stdio:"pipe",timeout:3e4}),n.stop("Downloaded");let l=s,h=JSON.parse(Vf(or(l,"package.json"),"utf-8")).version??"unknown";h===o?O.success(T.default.green("Already on latest")+` \u2014 v${o}`):O.info(`Update available: ${T.default.yellow("v"+o)} \u2192 ${T.default.green("v"+h)}`),n.start("Installing dependencies & building"),lt("npm install --no-audit --no-fund 2>/dev/null",{cwd:l,stdio:"pipe",timeout:6e4}),lt("npm run build 2>/dev/null",{cwd:l,stdio:"pipe",timeout:3e4}),n.stop("Built successfully"),n.start("Installing files");let p=["build","hooks","skills",".claude-plugin","start.sh","server.bundle.mjs","package.json",".mcp.json"];for(let g of p)try{lt(`rm -rf "${e}/${g}"`,{stdio:"pipe"}),lt(`cp -r "${l}/${g}" "${e}/"`,{stdio:"pipe"})}catch{}n.stop(T.default.green("Files installed")),n.start("Installing production dependencies"),lt("npm install --production --no-audit --no-fund 2>/dev/null",{cwd:e,stdio:"pipe",timeout:6e4}),n.stop("Dependencies ready");let f=e.match(/^(.*\/plugins\/cache\/[^/]+\/[^/]+\/)(\d+\.\d+\.\d+[^/]*)$/);if(f&&h!==f[2]&&h!=="unknown"){let g=f[2],y=f[1]+h;n.start(`Migrating cache: ${g} \u2192 ${h}`);try{lt(`rm -rf "${y}"`,{stdio:"pipe"}),lt(`mv "${e}" "${y}"`,{stdio:"pipe"}),e=y,n.stop(T.default.green(`Cache directory: ${h}`)),r.push(`Migrated cache: ${g} \u2192 ${h}`)}catch{n.stop(T.default.yellow("Cache migration skipped \u2014 using existing directory"))}}n.start("Updating npm global package");try{lt(`npm install -g "${e}" --no-audit --no-fund 2>/dev/null`,{stdio:"pipe",timeout:3e4}),n.stop(T.default.green("npm global updated")),r.push("Updated npm global package")}catch{n.stop(T.default.yellow("npm global update skipped")),O.info(T.default.dim("  Could not update global npm \u2014 may need sudo or standalone install"))}lt(`rm -rf "${s}"`,{stdio:"pipe"}),r.push(h!==o?`Updated v${o} \u2192 v${h}`:`Reinstalled v${o} from GitHub`),O.success(T.default.green("Plugin reinstalled from GitHub!")+T.default.dim(` \u2014 v${h}`))}catch(l){let m=l instanceof Error?l.message:String(l);n.stop(T.default.red("Update failed")),O.error(T.default.red("GitHub pull failed")+` \u2014 ${m}`),O.info(T.default.dim("Continuing with hooks/settings fix..."));try{lt(`rm -rf "${s}"`,{stdio:"pipe"})}catch{}}O.step("Backing up settings.json...");try{qf(t,Ff.R_OK);let l=t+".bak";AR(t,l),O.success(T.default.green("Backup created")+T.default.dim(" -> "+l)),r.push("Backed up settings.json")}catch{O.warn(T.default.yellow("No existing settings.json to backup")+" \u2014 a new one will be created")}O.step("Configuring PreToolUse hooks...");let i=or(e,"hooks","pretooluse.sh"),a=ib()??{},c={matcher:"Bash|Read|Grep|Glob|WebFetch|WebSearch|Task",hooks:[{type:"command",command:"bash "+i}]},u=a.hooks??{},d=u.PreToolUse;if(d&&Array.isArray(d)){let l=d.findIndex(m=>m.hooks?.some(p=>p.command?.includes("pretooluse.sh")));l>=0?(d[l]=c,O.info(T.default.dim("Updated existing PreToolUse hook entry")),r.push("Updated existing PreToolUse hook entry")):(d.push(c),O.info(T.default.dim("Added PreToolUse hook entry")),r.push("Added PreToolUse hook entry to existing hooks")),u.PreToolUse=d}else u.PreToolUse=[c],O.info(T.default.dim("Created PreToolUse hooks section")),r.push("Created PreToolUse hooks section");a.hooks=u;try{NR(t,JSON.stringify(a,null,2)+`
`,"utf-8"),O.success(T.default.green("Hooks configured")+T.default.dim(" -> "+t))}catch(l){let m=l instanceof Error?l.message:String(l);O.error(T.default.red("Failed to write settings.json")+" \u2014 "+m),js(T.default.red("Upgrade failed.")),process.exit(1)}O.step("Setting hook script permissions...");try{qf(i,Ff.R_OK),jR(i,493),O.success(T.default.green("Permissions set")+T.default.dim(" \u2014 chmod +x "+i)),r.push("Set pretooluse.sh as executable")}catch{O.error(T.default.red("Hook script not found")+T.default.dim(" \u2014 expected at "+i))}r.length>0?fn(r.map(l=>T.default.green("  + ")+l).join(`
`),"Changes Applied"):O.info(T.default.dim("No changes were needed.")),O.step("Running doctor to verify..."),console.log(),await cb()}async function VR(){console.clear(),As(T.default.bgCyan(T.default.black(" context-mode setup ")));let e=Ms();e.start("Detecting installed runtimes");let t=ir(),r=eo(t);if(e.stop("Detected "+r.length+" languages"),fn(mn(t),"Detected Runtimes"),Pr())O.success(T.default.green("Bun detected!")+" JS/TS will run at maximum speed.");else{O.warn(T.default.yellow("Bun is not installed.")+" JS/TS will run with Node.js (3-5x slower).");let i=await hm({message:"Would you like to install Bun for faster execution?",initialValue:!0});if(Jn(i)&&(pc("Setup cancelled."),process.exit(0)),i){e.start("Installing Bun");try{lt("curl -fsSL https://bun.sh/install | bash",{stdio:"pipe",timeout:6e4}),e.stop(T.default.green("Bun installed successfully!"));let a=ir();Pr()&&O.success("JavaScript and TypeScript will now use Bun "+T.default.dim("(3-5x faster)")),fn(mn(a),"Updated Runtimes")}catch(a){let c=a instanceof Error?a.message:String(a);e.stop(T.default.red("Failed to install Bun")),O.error("Installation failed: "+c+`
You can install manually: curl -fsSL https://bun.sh/install | bash`),O.info(T.default.dim("Continuing with Node.js \u2014 everything will still work."))}}else O.info(T.default.dim("No problem! Using Node.js. You can install Bun later: curl -fsSL https://bun.sh/install | bash"))}let n=[];t.python||n.push("Python (python3)"),t.ruby||n.push("Ruby (ruby)"),t.go||n.push("Go (go)"),t.php||n.push("PHP (php)"),t.r||n.push("R (Rscript)"),n.length>0&&(O.info(T.default.dim("Optional runtimes not found: "+n.join(", "))),O.info(T.default.dim("Install them to enable additional language support in context-mode.")));let o=await gm({message:"How would you like to configure context-mode?",options:[{value:"claude-code",label:"Claude Code (recommended)",hint:"claude mcp add"},{value:"manual",label:"Show manual configuration",hint:".mcp.json"},{value:"skip",label:"Skip \u2014 I'll configure later"}]});Jn(o)&&(pc("Setup cancelled."),process.exit(0));let s=new URL("./server.js",import.meta.url).pathname;if(o==="claude-code"){e.start("Adding to Claude Code");try{lt(`claude mcp add context-mode -- node ${s}`,{stdio:"pipe",timeout:1e4}),e.stop(T.default.green("Added to Claude Code!"))}catch{e.stop(T.default.yellow("Could not add automatically")),O.info(`Run manually:
`+T.default.cyan(`  claude mcp add context-mode -- node ${s}`))}}else o==="manual"&&fn(JSON.stringify({mcpServers:{"context-mode":{command:"node",args:[s]}}},null,2),"Add to your .mcp.json or Claude Code settings");js(T.default.green("Setup complete!")+" "+T.default.dim(r.length+" languages ready."))}
