#!/usr/bin/env node
var my=Object.create;var bi=Object.defineProperty;var hy=Object.getOwnPropertyDescriptor;var gy=Object.getOwnPropertyNames;var yy=Object.getPrototypeOf,_y=Object.prototype.hasOwnProperty;var z=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),xi=(t,e)=>{for(var r in e)bi(t,r,{get:e[r],enumerable:!0})},vy=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of gy(e))!_y.call(t,o)&&o!==r&&bi(t,o,{get:()=>e[o],enumerable:!(n=hy(e,o))||n.enumerable});return t};var sd=(t,e,r)=>(r=t!=null?my(yy(t)):{},vy(e||!t||!t.__esModule?bi(r,"default",{value:t,enumerable:!0}):r,t));var Bn=z(Q=>{"use strict";Object.defineProperty(Q,"__esModule",{value:!0});Q.regexpCode=Q.getEsmExportName=Q.getProperty=Q.safeStringify=Q.stringify=Q.strConcat=Q.addCodeArg=Q.str=Q._=Q.nil=Q._Code=Q.Name=Q.IDENTIFIER=Q._CodeOrName=void 0;var Vn=class{};Q._CodeOrName=Vn;Q.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var kr=class extends Vn{constructor(e){if(super(),!Q.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}};Q.Name=kr;var et=class extends Vn{constructor(e){super(),this._items=typeof e=="string"?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let e=this._items[0];return e===""||e==='""'}get str(){var e;return(e=this._str)!==null&&e!==void 0?e:this._str=this._items.reduce((r,n)=>`${r}${n}`,"")}get names(){var e;return(e=this._names)!==null&&e!==void 0?e:this._names=this._items.reduce((r,n)=>(n instanceof kr&&(r[n.str]=(r[n.str]||0)+1),r),{})}};Q._Code=et;Q.nil=new et("");function tm(t,...e){let r=[t[0]],n=0;for(;n<e.length;)su(r,e[n]),r.push(t[++n]);return new et(r)}Q._=tm;var ou=new et("+");function rm(t,...e){let r=[Hn(t[0])],n=0;for(;n<e.length;)r.push(ou),su(r,e[n]),r.push(ou,Hn(t[++n]));return g$(r),new et(r)}Q.str=rm;function su(t,e){e instanceof et?t.push(...e._items):e instanceof kr?t.push(e):t.push(v$(e))}Q.addCodeArg=su;function g$(t){let e=1;for(;e<t.length-1;){if(t[e]===ou){let r=y$(t[e-1],t[e+1]);if(r!==void 0){t.splice(e-1,3,r);continue}t[e++]="+"}e++}}function y$(t,e){if(e==='""')return t;if(t==='""')return e;if(typeof t=="string")return e instanceof kr||t[t.length-1]!=='"'?void 0:typeof e!="string"?`${t.slice(0,-1)}${e}"`:e[0]==='"'?t.slice(0,-1)+e.slice(1):void 0;if(typeof e=="string"&&e[0]==='"'&&!(t instanceof kr))return`"${t}${e.slice(1)}`}function _$(t,e){return e.emptyStr()?t:t.emptyStr()?e:rm`${t}${e}`}Q.strConcat=_$;function v$(t){return typeof t=="number"||typeof t=="boolean"||t===null?t:Hn(Array.isArray(t)?t.join(","):t)}function b$(t){return new et(Hn(t))}Q.stringify=b$;function Hn(t){return JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}Q.safeStringify=Hn;function x$(t){return typeof t=="string"&&Q.IDENTIFIER.test(t)?new et(`.${t}`):tm`[${t}]`}Q.getProperty=x$;function $$(t){if(typeof t=="string"&&Q.IDENTIFIER.test(t))return new et(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)}Q.getEsmExportName=$$;function w$(t){return new et(t.toString())}Q.regexpCode=w$});var cu=z(qe=>{"use strict";Object.defineProperty(qe,"__esModule",{value:!0});qe.ValueScope=qe.ValueScopeName=qe.Scope=qe.varKinds=qe.UsedValueState=void 0;var De=Bn(),iu=class extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}},Ss;(function(t){t[t.Started=0]="Started",t[t.Completed=1]="Completed"})(Ss||(qe.UsedValueState=Ss={}));qe.varKinds={const:new De.Name("const"),let:new De.Name("let"),var:new De.Name("var")};var zs=class{constructor({prefixes:e,parent:r}={}){this._names={},this._prefixes=e,this._parent=r}toName(e){return e instanceof De.Name?e:this.name(e)}name(e){return new De.Name(this._newName(e))}_newName(e){let r=this._names[e]||this._nameGroup(e);return`${e}${r.index++}`}_nameGroup(e){var r,n;if(!((n=(r=this._parent)===null||r===void 0?void 0:r._prefixes)===null||n===void 0)&&n.has(e)||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}};qe.Scope=zs;var Ts=class extends De.Name{constructor(e,r){super(r),this.prefix=e}setValue(e,{property:r,itemIndex:n}){this.value=e,this.scopePath=(0,De._)`.${new De.Name(r)}[${n}]`}};qe.ValueScopeName=Ts;var k$=(0,De._)`\n`,au=class extends zs{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?k$:De.nil}}get(){return this._scope}name(e){return new Ts(e,this._newName(e))}value(e,r){var n;if(r.ref===void 0)throw new Error("CodeGen: ref must be passed in value");let o=this.toName(e),{prefix:s}=o,i=(n=r.key)!==null&&n!==void 0?n:r.ref,a=this._values[s];if(a){let l=a.get(i);if(l)return l}else a=this._values[s]=new Map;a.set(i,o);let c=this._scope[s]||(this._scope[s]=[]),u=c.length;return c[u]=r.ref,o.setValue(r,{property:s,itemIndex:u}),o}getValue(e,r){let n=this._values[e];if(n)return n.get(r)}scopeRefs(e,r=this._values){return this._reduceValues(r,n=>{if(n.scopePath===void 0)throw new Error(`CodeGen: name "${n}" has no value`);return(0,De._)`${e}${n.scopePath}`})}scopeCode(e=this._values,r,n){return this._reduceValues(e,o=>{if(o.value===void 0)throw new Error(`CodeGen: name "${o}" has no value`);return o.value.code},r,n)}_reduceValues(e,r,n={},o){let s=De.nil;for(let i in e){let a=e[i];if(!a)continue;let c=n[i]=n[i]||new Map;a.forEach(u=>{if(c.has(u))return;c.set(u,Ss.Started);let l=r(u);if(l){let d=this.opts.es5?qe.varKinds.var:qe.varKinds.const;s=(0,De._)`${s}${d} ${u} = ${l};${this.opts._n}`}else if(l=o?.(u))s=(0,De._)`${s}${l}${this.opts._n}`;else throw new iu(u);c.set(u,Ss.Completed)})}return s}};qe.ValueScope=au});var U=z(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});F.or=F.and=F.not=F.CodeGen=F.operators=F.varKinds=F.ValueScopeName=F.ValueScope=F.Scope=F.Name=F.regexpCode=F.stringify=F.getProperty=F.nil=F.strConcat=F.str=F._=void 0;var J=Bn(),ct=cu(),Vt=Bn();Object.defineProperty(F,"_",{enumerable:!0,get:function(){return Vt._}});Object.defineProperty(F,"str",{enumerable:!0,get:function(){return Vt.str}});Object.defineProperty(F,"strConcat",{enumerable:!0,get:function(){return Vt.strConcat}});Object.defineProperty(F,"nil",{enumerable:!0,get:function(){return Vt.nil}});Object.defineProperty(F,"getProperty",{enumerable:!0,get:function(){return Vt.getProperty}});Object.defineProperty(F,"stringify",{enumerable:!0,get:function(){return Vt.stringify}});Object.defineProperty(F,"regexpCode",{enumerable:!0,get:function(){return Vt.regexpCode}});Object.defineProperty(F,"Name",{enumerable:!0,get:function(){return Vt.Name}});var Is=cu();Object.defineProperty(F,"Scope",{enumerable:!0,get:function(){return Is.Scope}});Object.defineProperty(F,"ValueScope",{enumerable:!0,get:function(){return Is.ValueScope}});Object.defineProperty(F,"ValueScopeName",{enumerable:!0,get:function(){return Is.ValueScopeName}});Object.defineProperty(F,"varKinds",{enumerable:!0,get:function(){return Is.varKinds}});F.operators={GT:new J._Code(">"),GTE:new J._Code(">="),LT:new J._Code("<"),LTE:new J._Code("<="),EQ:new J._Code("==="),NEQ:new J._Code("!=="),NOT:new J._Code("!"),OR:new J._Code("||"),AND:new J._Code("&&"),ADD:new J._Code("+")};var Pt=class{optimizeNodes(){return this}optimizeNames(e,r){return this}},uu=class extends Pt{constructor(e,r,n){super(),this.varKind=e,this.name=r,this.rhs=n}render({es5:e,_n:r}){let n=e?ct.varKinds.var:this.varKind,o=this.rhs===void 0?"":` = ${this.rhs}`;return`${n} ${this.name}${o};`+r}optimizeNames(e,r){if(e[this.name.str])return this.rhs&&(this.rhs=Qr(this.rhs,e,r)),this}get names(){return this.rhs instanceof J._CodeOrName?this.rhs.names:{}}},Es=class extends Pt{constructor(e,r,n){super(),this.lhs=e,this.rhs=r,this.sideEffects=n}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,r){if(!(this.lhs instanceof J.Name&&!e[this.lhs.str]&&!this.sideEffects))return this.rhs=Qr(this.rhs,e,r),this}get names(){let e=this.lhs instanceof J.Name?{}:{...this.lhs.names};return Rs(e,this.rhs)}},lu=class extends Es{constructor(e,r,n,o){super(e,n,o),this.op=r}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}},du=class extends Pt{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}},pu=class extends Pt{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}},fu=class extends Pt{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}},mu=class extends Pt{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,r){return this.code=Qr(this.code,e,r),this}get names(){return this.code instanceof J._CodeOrName?this.code.names:{}}},Kn=class extends Pt{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((r,n)=>r+n.render(e),"")}optimizeNodes(){let{nodes:e}=this,r=e.length;for(;r--;){let n=e[r].optimizeNodes();Array.isArray(n)?e.splice(r,1,...n):n?e[r]=n:e.splice(r,1)}return e.length>0?this:void 0}optimizeNames(e,r){let{nodes:n}=this,o=n.length;for(;o--;){let s=n[o];s.optimizeNames(e,r)||(S$(e,s.names),n.splice(o,1))}return n.length>0?this:void 0}get names(){return this.nodes.reduce((e,r)=>Tr(e,r.names),{})}},Rt=class extends Kn{render(e){return"{"+e._n+super.render(e)+"}"+e._n}},hu=class extends Kn{},Yr=class extends Rt{};Yr.kind="else";var Sr=class t extends Rt{constructor(e,r){super(r),this.condition=e}render(e){let r=`if(${this.condition})`+super.render(e);return this.else&&(r+="else "+this.else.render(e)),r}optimizeNodes(){super.optimizeNodes();let e=this.condition;if(e===!0)return this.nodes;let r=this.else;if(r){let n=r.optimizeNodes();r=this.else=Array.isArray(n)?new Yr(n):n}if(r)return e===!1?r instanceof t?r:r.nodes:this.nodes.length?this:new t(nm(e),r instanceof t?[r]:r.nodes);if(!(e===!1||!this.nodes.length))return this}optimizeNames(e,r){var n;if(this.else=(n=this.else)===null||n===void 0?void 0:n.optimizeNames(e,r),!!(super.optimizeNames(e,r)||this.else))return this.condition=Qr(this.condition,e,r),this}get names(){let e=super.names;return Rs(e,this.condition),this.else&&Tr(e,this.else.names),e}};Sr.kind="if";var zr=class extends Rt{};zr.kind="for";var gu=class extends zr{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iteration=Qr(this.iteration,e,r),this}get names(){return Tr(super.names,this.iteration.names)}},yu=class extends zr{constructor(e,r,n,o){super(),this.varKind=e,this.name=r,this.from=n,this.to=o}render(e){let r=e.es5?ct.varKinds.var:this.varKind,{name:n,from:o,to:s}=this;return`for(${r} ${n}=${o}; ${n}<${s}; ${n}++)`+super.render(e)}get names(){let e=Rs(super.names,this.from);return Rs(e,this.to)}},Ps=class extends zr{constructor(e,r,n,o){super(),this.loop=e,this.varKind=r,this.name=n,this.iterable=o}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iterable=Qr(this.iterable,e,r),this}get names(){return Tr(super.names,this.iterable.names)}},Wn=class extends Rt{constructor(e,r,n){super(),this.name=e,this.args=r,this.async=n}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}};Wn.kind="func";var Gn=class extends Kn{render(e){return"return "+super.render(e)}};Gn.kind="return";var _u=class extends Rt{render(e){let r="try"+super.render(e);return this.catch&&(r+=this.catch.render(e)),this.finally&&(r+=this.finally.render(e)),r}optimizeNodes(){var e,r;return super.optimizeNodes(),(e=this.catch)===null||e===void 0||e.optimizeNodes(),(r=this.finally)===null||r===void 0||r.optimizeNodes(),this}optimizeNames(e,r){var n,o;return super.optimizeNames(e,r),(n=this.catch)===null||n===void 0||n.optimizeNames(e,r),(o=this.finally)===null||o===void 0||o.optimizeNames(e,r),this}get names(){let e=super.names;return this.catch&&Tr(e,this.catch.names),this.finally&&Tr(e,this.finally.names),e}},Jn=class extends Rt{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}};Jn.kind="catch";var Xn=class extends Rt{render(e){return"finally"+super.render(e)}};Xn.kind="finally";var vu=class{constructor(e,r={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...r,_n:r.lines?`
`:""},this._extScope=e,this._scope=new ct.Scope({parent:e}),this._nodes=[new hu]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,r){let n=this._extScope.value(e,r);return(this._values[n.prefix]||(this._values[n.prefix]=new Set)).add(n),n}getScopeValue(e,r){return this._extScope.getValue(e,r)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,r,n,o){let s=this._scope.toName(r);return n!==void 0&&o&&(this._constants[s.str]=n),this._leafNode(new uu(e,s,n)),s}const(e,r,n){return this._def(ct.varKinds.const,e,r,n)}let(e,r,n){return this._def(ct.varKinds.let,e,r,n)}var(e,r,n){return this._def(ct.varKinds.var,e,r,n)}assign(e,r,n){return this._leafNode(new Es(e,r,n))}add(e,r){return this._leafNode(new lu(e,F.operators.ADD,r))}code(e){return typeof e=="function"?e():e!==J.nil&&this._leafNode(new mu(e)),this}object(...e){let r=["{"];for(let[n,o]of e)r.length>1&&r.push(","),r.push(n),(n!==o||this.opts.es5)&&(r.push(":"),(0,J.addCodeArg)(r,o));return r.push("}"),new J._Code(r)}if(e,r,n){if(this._blockNode(new Sr(e)),r&&n)this.code(r).else().code(n).endIf();else if(r)this.code(r).endIf();else if(n)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new Sr(e))}else(){return this._elseNode(new Yr)}endIf(){return this._endBlockNode(Sr,Yr)}_for(e,r){return this._blockNode(e),r&&this.code(r).endFor(),this}for(e,r){return this._for(new gu(e),r)}forRange(e,r,n,o,s=this.opts.es5?ct.varKinds.var:ct.varKinds.let){let i=this._scope.toName(e);return this._for(new yu(s,i,r,n),()=>o(i))}forOf(e,r,n,o=ct.varKinds.const){let s=this._scope.toName(e);if(this.opts.es5){let i=r instanceof J.Name?r:this.var("_arr",r);return this.forRange("_i",0,(0,J._)`${i}.length`,a=>{this.var(s,(0,J._)`${i}[${a}]`),n(s)})}return this._for(new Ps("of",o,s,r),()=>n(s))}forIn(e,r,n,o=this.opts.es5?ct.varKinds.var:ct.varKinds.const){if(this.opts.ownProperties)return this.forOf(e,(0,J._)`Object.keys(${r})`,n);let s=this._scope.toName(e);return this._for(new Ps("in",o,s,r),()=>n(s))}endFor(){return this._endBlockNode(zr)}label(e){return this._leafNode(new du(e))}break(e){return this._leafNode(new pu(e))}return(e){let r=new Gn;if(this._blockNode(r),this.code(e),r.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(Gn)}try(e,r,n){if(!r&&!n)throw new Error('CodeGen: "try" without "catch" and "finally"');let o=new _u;if(this._blockNode(o),this.code(e),r){let s=this.name("e");this._currNode=o.catch=new Jn(s),r(s)}return n&&(this._currNode=o.finally=new Xn,this.code(n)),this._endBlockNode(Jn,Xn)}throw(e){return this._leafNode(new fu(e))}block(e,r){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(r),this}endBlock(e){let r=this._blockStarts.pop();if(r===void 0)throw new Error("CodeGen: not in self-balancing block");let n=this._nodes.length-r;if(n<0||e!==void 0&&n!==e)throw new Error(`CodeGen: wrong number of nodes: ${n} vs ${e} expected`);return this._nodes.length=r,this}func(e,r=J.nil,n,o){return this._blockNode(new Wn(e,r,n)),o&&this.code(o).endFunc(),this}endFunc(){return this._endBlockNode(Wn)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,r){let n=this._currNode;if(n instanceof e||r&&n instanceof r)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${r?`${e.kind}/${r.kind}`:e.kind}"`)}_elseNode(e){let r=this._currNode;if(!(r instanceof Sr))throw new Error('CodeGen: "else" without "if"');return this._currNode=r.else=e,this}get _root(){return this._nodes[0]}get _currNode(){let e=this._nodes;return e[e.length-1]}set _currNode(e){let r=this._nodes;r[r.length-1]=e}};F.CodeGen=vu;function Tr(t,e){for(let r in e)t[r]=(t[r]||0)+(e[r]||0);return t}function Rs(t,e){return e instanceof J._CodeOrName?Tr(t,e.names):t}function Qr(t,e,r){if(t instanceof J.Name)return n(t);if(!o(t))return t;return new J._Code(t._items.reduce((s,i)=>(i instanceof J.Name&&(i=n(i)),i instanceof J._Code?s.push(...i._items):s.push(i),s),[]));function n(s){let i=r[s.str];return i===void 0||e[s.str]!==1?s:(delete e[s.str],i)}function o(s){return s instanceof J._Code&&s._items.some(i=>i instanceof J.Name&&e[i.str]===1&&r[i.str]!==void 0)}}function S$(t,e){for(let r in e)t[r]=(t[r]||0)-(e[r]||0)}function nm(t){return typeof t=="boolean"||typeof t=="number"||t===null?!t:(0,J._)`!${bu(t)}`}F.not=nm;var z$=om(F.operators.AND);function T$(...t){return t.reduce(z$)}F.and=T$;var E$=om(F.operators.OR);function P$(...t){return t.reduce(E$)}F.or=P$;function om(t){return(e,r)=>e===J.nil?r:r===J.nil?e:(0,J._)`${bu(e)} ${t} ${bu(r)}`}function bu(t){return t instanceof J.Name?t:(0,J._)`(${t})`}});var X=z(V=>{"use strict";Object.defineProperty(V,"__esModule",{value:!0});V.checkStrictMode=V.getErrorPath=V.Type=V.useFunc=V.setEvaluated=V.evaluatedPropsToName=V.mergeEvaluated=V.eachItem=V.unescapeJsonPointer=V.escapeJsonPointer=V.escapeFragment=V.unescapeFragment=V.schemaRefOrVal=V.schemaHasRulesButRef=V.schemaHasRules=V.checkUnknownRules=V.alwaysValidSchema=V.toHash=void 0;var oe=U(),R$=Bn();function I$(t){let e={};for(let r of t)e[r]=!0;return e}V.toHash=I$;function O$(t,e){return typeof e=="boolean"?e:Object.keys(e).length===0?!0:(am(t,e),!cm(e,t.self.RULES.all))}V.alwaysValidSchema=O$;function am(t,e=t.schema){let{opts:r,self:n}=t;if(!r.strictSchema||typeof e=="boolean")return;let o=n.RULES.keywords;for(let s in e)o[s]||dm(t,`unknown keyword: "${s}"`)}V.checkUnknownRules=am;function cm(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(e[r])return!0;return!1}V.schemaHasRules=cm;function N$(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(r!=="$ref"&&e.all[r])return!0;return!1}V.schemaHasRulesButRef=N$;function C$({topSchemaRef:t,schemaPath:e},r,n,o){if(!o){if(typeof r=="number"||typeof r=="boolean")return r;if(typeof r=="string")return(0,oe._)`${r}`}return(0,oe._)`${t}${e}${(0,oe.getProperty)(n)}`}V.schemaRefOrVal=C$;function Z$(t){return um(decodeURIComponent(t))}V.unescapeFragment=Z$;function j$(t){return encodeURIComponent($u(t))}V.escapeFragment=j$;function $u(t){return typeof t=="number"?`${t}`:t.replace(/~/g,"~0").replace(/\//g,"~1")}V.escapeJsonPointer=$u;function um(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}V.unescapeJsonPointer=um;function A$(t,e){if(Array.isArray(t))for(let r of t)e(r);else e(t)}V.eachItem=A$;function sm({mergeNames:t,mergeToName:e,mergeValues:r,resultToName:n}){return(o,s,i,a)=>{let c=i===void 0?s:i instanceof oe.Name?(s instanceof oe.Name?t(o,s,i):e(o,s,i),i):s instanceof oe.Name?(e(o,i,s),s):r(s,i);return a===oe.Name&&!(c instanceof oe.Name)?n(o,c):c}}V.mergeEvaluated={props:sm({mergeNames:(t,e,r)=>t.if((0,oe._)`${r} !== true && ${e} !== undefined`,()=>{t.if((0,oe._)`${e} === true`,()=>t.assign(r,!0),()=>t.assign(r,(0,oe._)`${r} || {}`).code((0,oe._)`Object.assign(${r}, ${e})`))}),mergeToName:(t,e,r)=>t.if((0,oe._)`${r} !== true`,()=>{e===!0?t.assign(r,!0):(t.assign(r,(0,oe._)`${r} || {}`),wu(t,r,e))}),mergeValues:(t,e)=>t===!0?!0:{...t,...e},resultToName:lm}),items:sm({mergeNames:(t,e,r)=>t.if((0,oe._)`${r} !== true && ${e} !== undefined`,()=>t.assign(r,(0,oe._)`${e} === true ? true : ${r} > ${e} ? ${r} : ${e}`)),mergeToName:(t,e,r)=>t.if((0,oe._)`${r} !== true`,()=>t.assign(r,e===!0?!0:(0,oe._)`${r} > ${e} ? ${r} : ${e}`)),mergeValues:(t,e)=>t===!0?!0:Math.max(t,e),resultToName:(t,e)=>t.var("items",e)})};function lm(t,e){if(e===!0)return t.var("props",!0);let r=t.var("props",(0,oe._)`{}`);return e!==void 0&&wu(t,r,e),r}V.evaluatedPropsToName=lm;function wu(t,e,r){Object.keys(r).forEach(n=>t.assign((0,oe._)`${e}${(0,oe.getProperty)(n)}`,!0))}V.setEvaluated=wu;var im={};function M$(t,e){return t.scopeValue("func",{ref:e,code:im[e.code]||(im[e.code]=new R$._Code(e.code))})}V.useFunc=M$;var xu;(function(t){t[t.Num=0]="Num",t[t.Str=1]="Str"})(xu||(V.Type=xu={}));function L$(t,e,r){if(t instanceof oe.Name){let n=e===xu.Num;return r?n?(0,oe._)`"[" + ${t} + "]"`:(0,oe._)`"['" + ${t} + "']"`:n?(0,oe._)`"/" + ${t}`:(0,oe._)`"/" + ${t}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,oe.getProperty)(t).toString():"/"+$u(t)}V.getErrorPath=L$;function dm(t,e,r=t.opts.strictSchema){if(r){if(e=`strict mode: ${e}`,r===!0)throw new Error(e);t.self.logger.warn(e)}}V.checkStrictMode=dm});var It=z(ku=>{"use strict";Object.defineProperty(ku,"__esModule",{value:!0});var Ee=U(),D$={data:new Ee.Name("data"),valCxt:new Ee.Name("valCxt"),instancePath:new Ee.Name("instancePath"),parentData:new Ee.Name("parentData"),parentDataProperty:new Ee.Name("parentDataProperty"),rootData:new Ee.Name("rootData"),dynamicAnchors:new Ee.Name("dynamicAnchors"),vErrors:new Ee.Name("vErrors"),errors:new Ee.Name("errors"),this:new Ee.Name("this"),self:new Ee.Name("self"),scope:new Ee.Name("scope"),json:new Ee.Name("json"),jsonPos:new Ee.Name("jsonPos"),jsonLen:new Ee.Name("jsonLen"),jsonPart:new Ee.Name("jsonPart")};ku.default=D$});var Yn=z(Pe=>{"use strict";Object.defineProperty(Pe,"__esModule",{value:!0});Pe.extendErrors=Pe.resetErrorsCount=Pe.reportExtraError=Pe.reportError=Pe.keyword$DataError=Pe.keywordError=void 0;var Y=U(),Os=X(),Ne=It();Pe.keywordError={message:({keyword:t})=>(0,Y.str)`must pass "${t}" keyword validation`};Pe.keyword$DataError={message:({keyword:t,schemaType:e})=>e?(0,Y.str)`"${t}" keyword must be ${e} ($data)`:(0,Y.str)`"${t}" keyword is invalid ($data)`};function q$(t,e=Pe.keywordError,r,n){let{it:o}=t,{gen:s,compositeRule:i,allErrors:a}=o,c=mm(t,e,r);n??(i||a)?pm(s,c):fm(o,(0,Y._)`[${c}]`)}Pe.reportError=q$;function U$(t,e=Pe.keywordError,r){let{it:n}=t,{gen:o,compositeRule:s,allErrors:i}=n,a=mm(t,e,r);pm(o,a),s||i||fm(n,Ne.default.vErrors)}Pe.reportExtraError=U$;function F$(t,e){t.assign(Ne.default.errors,e),t.if((0,Y._)`${Ne.default.vErrors} !== null`,()=>t.if(e,()=>t.assign((0,Y._)`${Ne.default.vErrors}.length`,e),()=>t.assign(Ne.default.vErrors,null)))}Pe.resetErrorsCount=F$;function V$({gen:t,keyword:e,schemaValue:r,data:n,errsCount:o,it:s}){if(o===void 0)throw new Error("ajv implementation error");let i=t.name("err");t.forRange("i",o,Ne.default.errors,a=>{t.const(i,(0,Y._)`${Ne.default.vErrors}[${a}]`),t.if((0,Y._)`${i}.instancePath === undefined`,()=>t.assign((0,Y._)`${i}.instancePath`,(0,Y.strConcat)(Ne.default.instancePath,s.errorPath))),t.assign((0,Y._)`${i}.schemaPath`,(0,Y.str)`${s.errSchemaPath}/${e}`),s.opts.verbose&&(t.assign((0,Y._)`${i}.schema`,r),t.assign((0,Y._)`${i}.data`,n))})}Pe.extendErrors=V$;function pm(t,e){let r=t.const("err",e);t.if((0,Y._)`${Ne.default.vErrors} === null`,()=>t.assign(Ne.default.vErrors,(0,Y._)`[${r}]`),(0,Y._)`${Ne.default.vErrors}.push(${r})`),t.code((0,Y._)`${Ne.default.errors}++`)}function fm(t,e){let{gen:r,validateName:n,schemaEnv:o}=t;o.$async?r.throw((0,Y._)`new ${t.ValidationError}(${e})`):(r.assign((0,Y._)`${n}.errors`,e),r.return(!1))}var Er={keyword:new Y.Name("keyword"),schemaPath:new Y.Name("schemaPath"),params:new Y.Name("params"),propertyName:new Y.Name("propertyName"),message:new Y.Name("message"),schema:new Y.Name("schema"),parentSchema:new Y.Name("parentSchema")};function mm(t,e,r){let{createErrors:n}=t.it;return n===!1?(0,Y._)`{}`:H$(t,e,r)}function H$(t,e,r={}){let{gen:n,it:o}=t,s=[B$(o,r),K$(t,r)];return W$(t,e,s),n.object(...s)}function B$({errorPath:t},{instancePath:e}){let r=e?(0,Y.str)`${t}${(0,Os.getErrorPath)(e,Os.Type.Str)}`:t;return[Ne.default.instancePath,(0,Y.strConcat)(Ne.default.instancePath,r)]}function K$({keyword:t,it:{errSchemaPath:e}},{schemaPath:r,parentSchema:n}){let o=n?e:(0,Y.str)`${e}/${t}`;return r&&(o=(0,Y.str)`${o}${(0,Os.getErrorPath)(r,Os.Type.Str)}`),[Er.schemaPath,o]}function W$(t,{params:e,message:r},n){let{keyword:o,data:s,schemaValue:i,it:a}=t,{opts:c,propertyName:u,topSchemaRef:l,schemaPath:d}=a;n.push([Er.keyword,o],[Er.params,typeof e=="function"?e(t):e||(0,Y._)`{}`]),c.messages&&n.push([Er.message,typeof r=="function"?r(t):r]),c.verbose&&n.push([Er.schema,i],[Er.parentSchema,(0,Y._)`${l}${d}`],[Ne.default.data,s]),u&&n.push([Er.propertyName,u])}});var gm=z(en=>{"use strict";Object.defineProperty(en,"__esModule",{value:!0});en.boolOrEmptySchema=en.topBoolOrEmptySchema=void 0;var G$=Yn(),J$=U(),X$=It(),Y$={message:"boolean schema is false"};function Q$(t){let{gen:e,schema:r,validateName:n}=t;r===!1?hm(t,!1):typeof r=="object"&&r.$async===!0?e.return(X$.default.data):(e.assign((0,J$._)`${n}.errors`,null),e.return(!0))}en.topBoolOrEmptySchema=Q$;function e0(t,e){let{gen:r,schema:n}=t;n===!1?(r.var(e,!1),hm(t)):r.var(e,!0)}en.boolOrEmptySchema=e0;function hm(t,e){let{gen:r,data:n}=t,o={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,G$.reportError)(o,Y$,void 0,e)}});var Su=z(tn=>{"use strict";Object.defineProperty(tn,"__esModule",{value:!0});tn.getRules=tn.isJSONType=void 0;var t0=["string","number","integer","boolean","null","object","array"],r0=new Set(t0);function n0(t){return typeof t=="string"&&r0.has(t)}tn.isJSONType=n0;function o0(){let t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...t,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}tn.getRules=o0});var zu=z(Ht=>{"use strict";Object.defineProperty(Ht,"__esModule",{value:!0});Ht.shouldUseRule=Ht.shouldUseGroup=Ht.schemaHasRulesForType=void 0;function s0({schema:t,self:e},r){let n=e.RULES.types[r];return n&&n!==!0&&ym(t,n)}Ht.schemaHasRulesForType=s0;function ym(t,e){return e.rules.some(r=>_m(t,r))}Ht.shouldUseGroup=ym;function _m(t,e){var r;return t[e.keyword]!==void 0||((r=e.definition.implements)===null||r===void 0?void 0:r.some(n=>t[n]!==void 0))}Ht.shouldUseRule=_m});var Qn=z(Re=>{"use strict";Object.defineProperty(Re,"__esModule",{value:!0});Re.reportTypeError=Re.checkDataTypes=Re.checkDataType=Re.coerceAndCheckDataType=Re.getJSONTypes=Re.getSchemaTypes=Re.DataType=void 0;var i0=Su(),a0=zu(),c0=Yn(),D=U(),vm=X(),rn;(function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong"})(rn||(Re.DataType=rn={}));function u0(t){let e=bm(t.type);if(e.includes("null")){if(t.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!e.length&&t.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');t.nullable===!0&&e.push("null")}return e}Re.getSchemaTypes=u0;function bm(t){let e=Array.isArray(t)?t:t?[t]:[];if(e.every(i0.isJSONType))return e;throw new Error("type must be JSONType or JSONType[]: "+e.join(","))}Re.getJSONTypes=bm;function l0(t,e){let{gen:r,data:n,opts:o}=t,s=d0(e,o.coerceTypes),i=e.length>0&&!(s.length===0&&e.length===1&&(0,a0.schemaHasRulesForType)(t,e[0]));if(i){let a=Eu(e,n,o.strictNumbers,rn.Wrong);r.if(a,()=>{s.length?p0(t,e,s):Pu(t)})}return i}Re.coerceAndCheckDataType=l0;var xm=new Set(["string","number","integer","boolean","null"]);function d0(t,e){return e?t.filter(r=>xm.has(r)||e==="array"&&r==="array"):[]}function p0(t,e,r){let{gen:n,data:o,opts:s}=t,i=n.let("dataType",(0,D._)`typeof ${o}`),a=n.let("coerced",(0,D._)`undefined`);s.coerceTypes==="array"&&n.if((0,D._)`${i} == 'object' && Array.isArray(${o}) && ${o}.length == 1`,()=>n.assign(o,(0,D._)`${o}[0]`).assign(i,(0,D._)`typeof ${o}`).if(Eu(e,o,s.strictNumbers),()=>n.assign(a,o))),n.if((0,D._)`${a} !== undefined`);for(let u of r)(xm.has(u)||u==="array"&&s.coerceTypes==="array")&&c(u);n.else(),Pu(t),n.endIf(),n.if((0,D._)`${a} !== undefined`,()=>{n.assign(o,a),f0(t,a)});function c(u){switch(u){case"string":n.elseIf((0,D._)`${i} == "number" || ${i} == "boolean"`).assign(a,(0,D._)`"" + ${o}`).elseIf((0,D._)`${o} === null`).assign(a,(0,D._)`""`);return;case"number":n.elseIf((0,D._)`${i} == "boolean" || ${o} === null
              || (${i} == "string" && ${o} && ${o} == +${o})`).assign(a,(0,D._)`+${o}`);return;case"integer":n.elseIf((0,D._)`${i} === "boolean" || ${o} === null
              || (${i} === "string" && ${o} && ${o} == +${o} && !(${o} % 1))`).assign(a,(0,D._)`+${o}`);return;case"boolean":n.elseIf((0,D._)`${o} === "false" || ${o} === 0 || ${o} === null`).assign(a,!1).elseIf((0,D._)`${o} === "true" || ${o} === 1`).assign(a,!0);return;case"null":n.elseIf((0,D._)`${o} === "" || ${o} === 0 || ${o} === false`),n.assign(a,null);return;case"array":n.elseIf((0,D._)`${i} === "string" || ${i} === "number"
              || ${i} === "boolean" || ${o} === null`).assign(a,(0,D._)`[${o}]`)}}}function f0({gen:t,parentData:e,parentDataProperty:r},n){t.if((0,D._)`${e} !== undefined`,()=>t.assign((0,D._)`${e}[${r}]`,n))}function Tu(t,e,r,n=rn.Correct){let o=n===rn.Correct?D.operators.EQ:D.operators.NEQ,s;switch(t){case"null":return(0,D._)`${e} ${o} null`;case"array":s=(0,D._)`Array.isArray(${e})`;break;case"object":s=(0,D._)`${e} && typeof ${e} == "object" && !Array.isArray(${e})`;break;case"integer":s=i((0,D._)`!(${e} % 1) && !isNaN(${e})`);break;case"number":s=i();break;default:return(0,D._)`typeof ${e} ${o} ${t}`}return n===rn.Correct?s:(0,D.not)(s);function i(a=D.nil){return(0,D.and)((0,D._)`typeof ${e} == "number"`,a,r?(0,D._)`isFinite(${e})`:D.nil)}}Re.checkDataType=Tu;function Eu(t,e,r,n){if(t.length===1)return Tu(t[0],e,r,n);let o,s=(0,vm.toHash)(t);if(s.array&&s.object){let i=(0,D._)`typeof ${e} != "object"`;o=s.null?i:(0,D._)`!${e} || ${i}`,delete s.null,delete s.array,delete s.object}else o=D.nil;s.number&&delete s.integer;for(let i in s)o=(0,D.and)(o,Tu(i,e,r,n));return o}Re.checkDataTypes=Eu;var m0={message:({schema:t})=>`must be ${t}`,params:({schema:t,schemaValue:e})=>typeof t=="string"?(0,D._)`{type: ${t}}`:(0,D._)`{type: ${e}}`};function Pu(t){let e=h0(t);(0,c0.reportError)(e,m0)}Re.reportTypeError=Pu;function h0(t){let{gen:e,data:r,schema:n}=t,o=(0,vm.schemaRefOrVal)(t,n,"type");return{gen:e,keyword:"type",data:r,schema:n.type,schemaCode:o,schemaValue:o,parentSchema:n,params:{},it:t}}});var wm=z(Ns=>{"use strict";Object.defineProperty(Ns,"__esModule",{value:!0});Ns.assignDefaults=void 0;var nn=U(),g0=X();function y0(t,e){let{properties:r,items:n}=t.schema;if(e==="object"&&r)for(let o in r)$m(t,o,r[o].default);else e==="array"&&Array.isArray(n)&&n.forEach((o,s)=>$m(t,s,o.default))}Ns.assignDefaults=y0;function $m(t,e,r){let{gen:n,compositeRule:o,data:s,opts:i}=t;if(r===void 0)return;let a=(0,nn._)`${s}${(0,nn.getProperty)(e)}`;if(o){(0,g0.checkStrictMode)(t,`default is ignored for: ${a}`);return}let c=(0,nn._)`${a} === undefined`;i.useDefaults==="empty"&&(c=(0,nn._)`${c} || ${a} === null || ${a} === ""`),n.if(c,(0,nn._)`${a} = ${(0,nn.stringify)(r)}`)}});var tt=z(re=>{"use strict";Object.defineProperty(re,"__esModule",{value:!0});re.validateUnion=re.validateArray=re.usePattern=re.callValidateCode=re.schemaProperties=re.allSchemaProperties=re.noPropertyInData=re.propertyInData=re.isOwnProperty=re.hasPropFunc=re.reportMissingProp=re.checkMissingProp=re.checkReportMissingProp=void 0;var ce=U(),Ru=X(),Bt=It(),_0=X();function v0(t,e){let{gen:r,data:n,it:o}=t;r.if(Ou(r,n,e,o.opts.ownProperties),()=>{t.setParams({missingProperty:(0,ce._)`${e}`},!0),t.error()})}re.checkReportMissingProp=v0;function b0({gen:t,data:e,it:{opts:r}},n,o){return(0,ce.or)(...n.map(s=>(0,ce.and)(Ou(t,e,s,r.ownProperties),(0,ce._)`${o} = ${s}`)))}re.checkMissingProp=b0;function x0(t,e){t.setParams({missingProperty:e},!0),t.error()}re.reportMissingProp=x0;function km(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,ce._)`Object.prototype.hasOwnProperty`})}re.hasPropFunc=km;function Iu(t,e,r){return(0,ce._)`${km(t)}.call(${e}, ${r})`}re.isOwnProperty=Iu;function $0(t,e,r,n){let o=(0,ce._)`${e}${(0,ce.getProperty)(r)} !== undefined`;return n?(0,ce._)`${o} && ${Iu(t,e,r)}`:o}re.propertyInData=$0;function Ou(t,e,r,n){let o=(0,ce._)`${e}${(0,ce.getProperty)(r)} === undefined`;return n?(0,ce.or)(o,(0,ce.not)(Iu(t,e,r))):o}re.noPropertyInData=Ou;function Sm(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}re.allSchemaProperties=Sm;function w0(t,e){return Sm(e).filter(r=>!(0,Ru.alwaysValidSchema)(t,e[r]))}re.schemaProperties=w0;function k0({schemaCode:t,data:e,it:{gen:r,topSchemaRef:n,schemaPath:o,errorPath:s},it:i},a,c,u){let l=u?(0,ce._)`${t}, ${e}, ${n}${o}`:e,d=[[Bt.default.instancePath,(0,ce.strConcat)(Bt.default.instancePath,s)],[Bt.default.parentData,i.parentData],[Bt.default.parentDataProperty,i.parentDataProperty],[Bt.default.rootData,Bt.default.rootData]];i.opts.dynamicRef&&d.push([Bt.default.dynamicAnchors,Bt.default.dynamicAnchors]);let m=(0,ce._)`${l}, ${r.object(...d)}`;return c!==ce.nil?(0,ce._)`${a}.call(${c}, ${m})`:(0,ce._)`${a}(${m})`}re.callValidateCode=k0;var S0=(0,ce._)`new RegExp`;function z0({gen:t,it:{opts:e}},r){let n=e.unicodeRegExp?"u":"",{regExp:o}=e.code,s=o(r,n);return t.scopeValue("pattern",{key:s.toString(),ref:s,code:(0,ce._)`${o.code==="new RegExp"?S0:(0,_0.useFunc)(t,o)}(${r}, ${n})`})}re.usePattern=z0;function T0(t){let{gen:e,data:r,keyword:n,it:o}=t,s=e.name("valid");if(o.allErrors){let a=e.let("valid",!0);return i(()=>e.assign(a,!1)),a}return e.var(s,!0),i(()=>e.break()),s;function i(a){let c=e.const("len",(0,ce._)`${r}.length`);e.forRange("i",0,c,u=>{t.subschema({keyword:n,dataProp:u,dataPropType:Ru.Type.Num},s),e.if((0,ce.not)(s),a)})}}re.validateArray=T0;function E0(t){let{gen:e,schema:r,keyword:n,it:o}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(c=>(0,Ru.alwaysValidSchema)(o,c))&&!o.opts.unevaluated)return;let i=e.let("valid",!1),a=e.name("_valid");e.block(()=>r.forEach((c,u)=>{let l=t.subschema({keyword:n,schemaProp:u,compositeRule:!0},a);e.assign(i,(0,ce._)`${i} || ${a}`),t.mergeValidEvaluated(l,a)||e.if((0,ce.not)(i))})),t.result(i,()=>t.reset(),()=>t.error(!0))}re.validateUnion=E0});var Em=z(yt=>{"use strict";Object.defineProperty(yt,"__esModule",{value:!0});yt.validateKeywordUsage=yt.validSchemaType=yt.funcKeywordCode=yt.macroKeywordCode=void 0;var Ce=U(),Pr=It(),P0=tt(),R0=Yn();function I0(t,e){let{gen:r,keyword:n,schema:o,parentSchema:s,it:i}=t,a=e.macro.call(i.self,o,s,i),c=Tm(r,n,a);i.opts.validateSchema!==!1&&i.self.validateSchema(a,!0);let u=r.name("valid");t.subschema({schema:a,schemaPath:Ce.nil,errSchemaPath:`${i.errSchemaPath}/${n}`,topSchemaRef:c,compositeRule:!0},u),t.pass(u,()=>t.error(!0))}yt.macroKeywordCode=I0;function O0(t,e){var r;let{gen:n,keyword:o,schema:s,parentSchema:i,$data:a,it:c}=t;C0(c,e);let u=!a&&e.compile?e.compile.call(c.self,s,i,c):e.validate,l=Tm(n,o,u),d=n.let("valid");t.block$data(d,m),t.ok((r=e.valid)!==null&&r!==void 0?r:d);function m(){if(e.errors===!1)h(),e.modifying&&zm(t),g(()=>t.error());else{let v=e.async?f():p();e.modifying&&zm(t),g(()=>N0(t,v))}}function f(){let v=n.let("ruleErrs",null);return n.try(()=>h((0,Ce._)`await `),x=>n.assign(d,!1).if((0,Ce._)`${x} instanceof ${c.ValidationError}`,()=>n.assign(v,(0,Ce._)`${x}.errors`),()=>n.throw(x))),v}function p(){let v=(0,Ce._)`${l}.errors`;return n.assign(v,null),h(Ce.nil),v}function h(v=e.async?(0,Ce._)`await `:Ce.nil){let x=c.opts.passContext?Pr.default.this:Pr.default.self,b=!("compile"in e&&!a||e.schema===!1);n.assign(d,(0,Ce._)`${v}${(0,P0.callValidateCode)(t,l,x,b)}`,e.modifying)}function g(v){var x;n.if((0,Ce.not)((x=e.valid)!==null&&x!==void 0?x:d),v)}}yt.funcKeywordCode=O0;function zm(t){let{gen:e,data:r,it:n}=t;e.if(n.parentData,()=>e.assign(r,(0,Ce._)`${n.parentData}[${n.parentDataProperty}]`))}function N0(t,e){let{gen:r}=t;r.if((0,Ce._)`Array.isArray(${e})`,()=>{r.assign(Pr.default.vErrors,(0,Ce._)`${Pr.default.vErrors} === null ? ${e} : ${Pr.default.vErrors}.concat(${e})`).assign(Pr.default.errors,(0,Ce._)`${Pr.default.vErrors}.length`),(0,R0.extendErrors)(t)},()=>t.error())}function C0({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function Tm(t,e,r){if(r===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,Ce.stringify)(r)})}function Z0(t,e,r=!1){return!e.length||e.some(n=>n==="array"?Array.isArray(t):n==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==n||r&&typeof t>"u")}yt.validSchemaType=Z0;function j0({schema:t,opts:e,self:r,errSchemaPath:n},o,s){if(Array.isArray(o.keyword)?!o.keyword.includes(s):o.keyword!==s)throw new Error("ajv implementation error");let i=o.dependencies;if(i?.some(a=>!Object.prototype.hasOwnProperty.call(t,a)))throw new Error(`parent schema must have dependencies of ${s}: ${i.join(",")}`);if(o.validateSchema&&!o.validateSchema(t[s])){let c=`keyword "${s}" value is invalid at path "${n}": `+r.errorsText(o.validateSchema.errors);if(e.validateSchema==="log")r.logger.error(c);else throw new Error(c)}}yt.validateKeywordUsage=j0});var Rm=z(Kt=>{"use strict";Object.defineProperty(Kt,"__esModule",{value:!0});Kt.extendSubschemaMode=Kt.extendSubschemaData=Kt.getSubschema=void 0;var _t=U(),Pm=X();function A0(t,{keyword:e,schemaProp:r,schema:n,schemaPath:o,errSchemaPath:s,topSchemaRef:i}){if(e!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){let a=t.schema[e];return r===void 0?{schema:a,schemaPath:(0,_t._)`${t.schemaPath}${(0,_t.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:a[r],schemaPath:(0,_t._)`${t.schemaPath}${(0,_t.getProperty)(e)}${(0,_t.getProperty)(r)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,Pm.escapeFragment)(r)}`}}if(n!==void 0){if(o===void 0||s===void 0||i===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:o,topSchemaRef:i,errSchemaPath:s}}throw new Error('either "keyword" or "schema" must be passed')}Kt.getSubschema=A0;function M0(t,e,{dataProp:r,dataPropType:n,data:o,dataTypes:s,propertyName:i}){if(o!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');let{gen:a}=e;if(r!==void 0){let{errorPath:u,dataPathArr:l,opts:d}=e,m=a.let("data",(0,_t._)`${e.data}${(0,_t.getProperty)(r)}`,!0);c(m),t.errorPath=(0,_t.str)`${u}${(0,Pm.getErrorPath)(r,n,d.jsPropertySyntax)}`,t.parentDataProperty=(0,_t._)`${r}`,t.dataPathArr=[...l,t.parentDataProperty]}if(o!==void 0){let u=o instanceof _t.Name?o:a.let("data",o,!0);c(u),i!==void 0&&(t.propertyName=i)}s&&(t.dataTypes=s);function c(u){t.data=u,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,u]}}Kt.extendSubschemaData=M0;function L0(t,{jtdDiscriminator:e,jtdMetadata:r,compositeRule:n,createErrors:o,allErrors:s}){n!==void 0&&(t.compositeRule=n),o!==void 0&&(t.createErrors=o),s!==void 0&&(t.allErrors=s),t.jtdDiscriminator=e,t.jtdMetadata=r}Kt.extendSubschemaMode=L0});var Nu=z((YO,Im)=>{"use strict";Im.exports=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,o,s;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(o=n;o--!==0;)if(!t(e[o],r[o]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(s=Object.keys(e),n=s.length,n!==Object.keys(r).length)return!1;for(o=n;o--!==0;)if(!Object.prototype.hasOwnProperty.call(r,s[o]))return!1;for(o=n;o--!==0;){var i=s[o];if(!t(e[i],r[i]))return!1}return!0}return e!==e&&r!==r}});var Nm=z((QO,Om)=>{"use strict";var Wt=Om.exports=function(t,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var n=typeof r=="function"?r:r.pre||function(){},o=r.post||function(){};Cs(e,n,o,t,"",t)};Wt.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};Wt.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};Wt.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};Wt.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function Cs(t,e,r,n,o,s,i,a,c,u){if(n&&typeof n=="object"&&!Array.isArray(n)){e(n,o,s,i,a,c,u);for(var l in n){var d=n[l];if(Array.isArray(d)){if(l in Wt.arrayKeywords)for(var m=0;m<d.length;m++)Cs(t,e,r,d[m],o+"/"+l+"/"+m,s,o,l,n,m)}else if(l in Wt.propsKeywords){if(d&&typeof d=="object")for(var f in d)Cs(t,e,r,d[f],o+"/"+l+"/"+D0(f),s,o,l,n,f)}else(l in Wt.keywords||t.allKeys&&!(l in Wt.skipKeywords))&&Cs(t,e,r,d,o+"/"+l,s,o,l,n)}r(n,o,s,i,a,c,u)}}function D0(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}});var eo=z(Ue=>{"use strict";Object.defineProperty(Ue,"__esModule",{value:!0});Ue.getSchemaRefs=Ue.resolveUrl=Ue.normalizeId=Ue._getFullPath=Ue.getFullPath=Ue.inlineRef=void 0;var q0=X(),U0=Nu(),F0=Nm(),V0=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function H0(t,e=!0){return typeof t=="boolean"?!0:e===!0?!Cu(t):e?Cm(t)<=e:!1}Ue.inlineRef=H0;var B0=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function Cu(t){for(let e in t){if(B0.has(e))return!0;let r=t[e];if(Array.isArray(r)&&r.some(Cu)||typeof r=="object"&&Cu(r))return!0}return!1}function Cm(t){let e=0;for(let r in t){if(r==="$ref")return 1/0;if(e++,!V0.has(r)&&(typeof t[r]=="object"&&(0,q0.eachItem)(t[r],n=>e+=Cm(n)),e===1/0))return 1/0}return e}function Zm(t,e="",r){r!==!1&&(e=on(e));let n=t.parse(e);return jm(t,n)}Ue.getFullPath=Zm;function jm(t,e){return t.serialize(e).split("#")[0]+"#"}Ue._getFullPath=jm;var K0=/#\/?$/;function on(t){return t?t.replace(K0,""):""}Ue.normalizeId=on;function W0(t,e,r){return r=on(r),t.resolve(e,r)}Ue.resolveUrl=W0;var G0=/^[a-z_][-a-z0-9._]*$/i;function J0(t,e){if(typeof t=="boolean")return{};let{schemaId:r,uriResolver:n}=this.opts,o=on(t[r]||e),s={"":o},i=Zm(n,o,!1),a={},c=new Set;return F0(t,{allKeys:!0},(d,m,f,p)=>{if(p===void 0)return;let h=i+m,g=s[p];typeof d[r]=="string"&&(g=v.call(this,d[r])),x.call(this,d.$anchor),x.call(this,d.$dynamicAnchor),s[m]=g;function v(b){let S=this.opts.uriResolver.resolve;if(b=on(g?S(g,b):b),c.has(b))throw l(b);c.add(b);let N=this.refs[b];return typeof N=="string"&&(N=this.refs[N]),typeof N=="object"?u(d,N.schema,b):b!==on(h)&&(b[0]==="#"?(u(d,a[b],b),a[b]=d):this.refs[b]=h),b}function x(b){if(typeof b=="string"){if(!G0.test(b))throw new Error(`invalid anchor "${b}"`);v.call(this,`#${b}`)}}}),a;function u(d,m,f){if(m!==void 0&&!U0(d,m))throw l(f)}function l(d){return new Error(`reference "${d}" resolves to more than one schema`)}}Ue.getSchemaRefs=J0});var no=z(Gt=>{"use strict";Object.defineProperty(Gt,"__esModule",{value:!0});Gt.getData=Gt.KeywordCxt=Gt.validateFunctionCode=void 0;var qm=gm(),Am=Qn(),ju=zu(),Zs=Qn(),X0=wm(),ro=Em(),Zu=Rm(),O=U(),M=It(),Y0=eo(),Ot=X(),to=Yn();function Q0(t){if(Vm(t)&&(Hm(t),Fm(t))){rw(t);return}Um(t,()=>(0,qm.topBoolOrEmptySchema)(t))}Gt.validateFunctionCode=Q0;function Um({gen:t,validateName:e,schema:r,schemaEnv:n,opts:o},s){o.code.es5?t.func(e,(0,O._)`${M.default.data}, ${M.default.valCxt}`,n.$async,()=>{t.code((0,O._)`"use strict"; ${Mm(r,o)}`),tw(t,o),t.code(s)}):t.func(e,(0,O._)`${M.default.data}, ${ew(o)}`,n.$async,()=>t.code(Mm(r,o)).code(s))}function ew(t){return(0,O._)`{${M.default.instancePath}="", ${M.default.parentData}, ${M.default.parentDataProperty}, ${M.default.rootData}=${M.default.data}${t.dynamicRef?(0,O._)`, ${M.default.dynamicAnchors}={}`:O.nil}}={}`}function tw(t,e){t.if(M.default.valCxt,()=>{t.var(M.default.instancePath,(0,O._)`${M.default.valCxt}.${M.default.instancePath}`),t.var(M.default.parentData,(0,O._)`${M.default.valCxt}.${M.default.parentData}`),t.var(M.default.parentDataProperty,(0,O._)`${M.default.valCxt}.${M.default.parentDataProperty}`),t.var(M.default.rootData,(0,O._)`${M.default.valCxt}.${M.default.rootData}`),e.dynamicRef&&t.var(M.default.dynamicAnchors,(0,O._)`${M.default.valCxt}.${M.default.dynamicAnchors}`)},()=>{t.var(M.default.instancePath,(0,O._)`""`),t.var(M.default.parentData,(0,O._)`undefined`),t.var(M.default.parentDataProperty,(0,O._)`undefined`),t.var(M.default.rootData,M.default.data),e.dynamicRef&&t.var(M.default.dynamicAnchors,(0,O._)`{}`)})}function rw(t){let{schema:e,opts:r,gen:n}=t;Um(t,()=>{r.$comment&&e.$comment&&Km(t),aw(t),n.let(M.default.vErrors,null),n.let(M.default.errors,0),r.unevaluated&&nw(t),Bm(t),lw(t)})}function nw(t){let{gen:e,validateName:r}=t;t.evaluated=e.const("evaluated",(0,O._)`${r}.evaluated`),e.if((0,O._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,O._)`${t.evaluated}.props`,(0,O._)`undefined`)),e.if((0,O._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,O._)`${t.evaluated}.items`,(0,O._)`undefined`))}function Mm(t,e){let r=typeof t=="object"&&t[e.schemaId];return r&&(e.code.source||e.code.process)?(0,O._)`/*# sourceURL=${r} */`:O.nil}function ow(t,e){if(Vm(t)&&(Hm(t),Fm(t))){sw(t,e);return}(0,qm.boolOrEmptySchema)(t,e)}function Fm({schema:t,self:e}){if(typeof t=="boolean")return!t;for(let r in t)if(e.RULES.all[r])return!0;return!1}function Vm(t){return typeof t.schema!="boolean"}function sw(t,e){let{schema:r,gen:n,opts:o}=t;o.$comment&&r.$comment&&Km(t),cw(t),uw(t);let s=n.const("_errs",M.default.errors);Bm(t,s),n.var(e,(0,O._)`${s} === ${M.default.errors}`)}function Hm(t){(0,Ot.checkUnknownRules)(t),iw(t)}function Bm(t,e){if(t.opts.jtd)return Lm(t,[],!1,e);let r=(0,Am.getSchemaTypes)(t.schema),n=(0,Am.coerceAndCheckDataType)(t,r);Lm(t,r,!n,e)}function iw(t){let{schema:e,errSchemaPath:r,opts:n,self:o}=t;e.$ref&&n.ignoreKeywordsWithRef&&(0,Ot.schemaHasRulesButRef)(e,o.RULES)&&o.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function aw(t){let{schema:e,opts:r}=t;e.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,Ot.checkStrictMode)(t,"default is ignored in the schema root")}function cw(t){let e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,Y0.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function uw(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function Km({gen:t,schemaEnv:e,schema:r,errSchemaPath:n,opts:o}){let s=r.$comment;if(o.$comment===!0)t.code((0,O._)`${M.default.self}.logger.log(${s})`);else if(typeof o.$comment=="function"){let i=(0,O.str)`${n}/$comment`,a=t.scopeValue("root",{ref:e.root});t.code((0,O._)`${M.default.self}.opts.$comment(${s}, ${i}, ${a}.schema)`)}}function lw(t){let{gen:e,schemaEnv:r,validateName:n,ValidationError:o,opts:s}=t;r.$async?e.if((0,O._)`${M.default.errors} === 0`,()=>e.return(M.default.data),()=>e.throw((0,O._)`new ${o}(${M.default.vErrors})`)):(e.assign((0,O._)`${n}.errors`,M.default.vErrors),s.unevaluated&&dw(t),e.return((0,O._)`${M.default.errors} === 0`))}function dw({gen:t,evaluated:e,props:r,items:n}){r instanceof O.Name&&t.assign((0,O._)`${e}.props`,r),n instanceof O.Name&&t.assign((0,O._)`${e}.items`,n)}function Lm(t,e,r,n){let{gen:o,schema:s,data:i,allErrors:a,opts:c,self:u}=t,{RULES:l}=u;if(s.$ref&&(c.ignoreKeywordsWithRef||!(0,Ot.schemaHasRulesButRef)(s,l))){o.block(()=>Gm(t,"$ref",l.all.$ref.definition));return}c.jtd||pw(t,e),o.block(()=>{for(let m of l.rules)d(m);d(l.post)});function d(m){(0,ju.shouldUseGroup)(s,m)&&(m.type?(o.if((0,Zs.checkDataType)(m.type,i,c.strictNumbers)),Dm(t,m),e.length===1&&e[0]===m.type&&r&&(o.else(),(0,Zs.reportTypeError)(t)),o.endIf()):Dm(t,m),a||o.if((0,O._)`${M.default.errors} === ${n||0}`))}}function Dm(t,e){let{gen:r,schema:n,opts:{useDefaults:o}}=t;o&&(0,X0.assignDefaults)(t,e.type),r.block(()=>{for(let s of e.rules)(0,ju.shouldUseRule)(n,s)&&Gm(t,s.keyword,s.definition,e.type)})}function pw(t,e){t.schemaEnv.meta||!t.opts.strictTypes||(fw(t,e),t.opts.allowUnionTypes||mw(t,e),hw(t,t.dataTypes))}function fw(t,e){if(e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(r=>{Wm(t.dataTypes,r)||Au(t,`type "${r}" not allowed by context "${t.dataTypes.join(",")}"`)}),yw(t,e)}}function mw(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&Au(t,"use allowUnionTypes to allow union type keyword")}function hw(t,e){let r=t.self.RULES.all;for(let n in r){let o=r[n];if(typeof o=="object"&&(0,ju.shouldUseRule)(t.schema,o)){let{type:s}=o.definition;s.length&&!s.some(i=>gw(e,i))&&Au(t,`missing type "${s.join(",")}" for keyword "${n}"`)}}}function gw(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function Wm(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function yw(t,e){let r=[];for(let n of t.dataTypes)Wm(e,n)?r.push(n):e.includes("integer")&&n==="number"&&r.push("integer");t.dataTypes=r}function Au(t,e){let r=t.schemaEnv.baseId+t.errSchemaPath;e+=` at "${r}" (strictTypes)`,(0,Ot.checkStrictMode)(t,e,t.opts.strictTypes)}var js=class{constructor(e,r,n){if((0,ro.validateKeywordUsage)(e,r,n),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=n,this.data=e.data,this.schema=e.schema[n],this.$data=r.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,Ot.schemaRefOrVal)(e,this.schema,n,this.$data),this.schemaType=r.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=r,this.$data)this.schemaCode=e.gen.const("vSchema",Jm(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,ro.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=e.gen.const("_errs",M.default.errors))}result(e,r,n){this.failResult((0,O.not)(e),r,n)}failResult(e,r,n){this.gen.if(e),n?n():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,r){this.failResult((0,O.not)(e),void 0,r)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);let{schemaCode:r}=this;this.fail((0,O._)`${r} !== undefined && (${(0,O.or)(this.invalid$data(),e)})`)}error(e,r,n){if(r){this.setParams(r),this._error(e,n),this.setParams({});return}this._error(e,n)}_error(e,r){(e?to.reportExtraError:to.reportError)(this,this.def.error,r)}$dataError(){(0,to.reportError)(this,this.def.$dataError||to.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,to.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,r){r?Object.assign(this.params,e):this.params=e}block$data(e,r,n=O.nil){this.gen.block(()=>{this.check$data(e,n),r()})}check$data(e=O.nil,r=O.nil){if(!this.$data)return;let{gen:n,schemaCode:o,schemaType:s,def:i}=this;n.if((0,O.or)((0,O._)`${o} === undefined`,r)),e!==O.nil&&n.assign(e,!0),(s.length||i.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==O.nil&&n.assign(e,!1)),n.else()}invalid$data(){let{gen:e,schemaCode:r,schemaType:n,def:o,it:s}=this;return(0,O.or)(i(),a());function i(){if(n.length){if(!(r instanceof O.Name))throw new Error("ajv implementation error");let c=Array.isArray(n)?n:[n];return(0,O._)`${(0,Zs.checkDataTypes)(c,r,s.opts.strictNumbers,Zs.DataType.Wrong)}`}return O.nil}function a(){if(o.validateSchema){let c=e.scopeValue("validate$data",{ref:o.validateSchema});return(0,O._)`!${c}(${r})`}return O.nil}}subschema(e,r){let n=(0,Zu.getSubschema)(this.it,e);(0,Zu.extendSubschemaData)(n,this.it,e),(0,Zu.extendSubschemaMode)(n,e);let o={...this.it,...n,items:void 0,props:void 0};return ow(o,r),o}mergeEvaluated(e,r){let{it:n,gen:o}=this;n.opts.unevaluated&&(n.props!==!0&&e.props!==void 0&&(n.props=Ot.mergeEvaluated.props(o,e.props,n.props,r)),n.items!==!0&&e.items!==void 0&&(n.items=Ot.mergeEvaluated.items(o,e.items,n.items,r)))}mergeValidEvaluated(e,r){let{it:n,gen:o}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return o.if(r,()=>this.mergeEvaluated(e,O.Name)),!0}};Gt.KeywordCxt=js;function Gm(t,e,r,n){let o=new js(t,r,e);"code"in r?r.code(o,n):o.$data&&r.validate?(0,ro.funcKeywordCode)(o,r):"macro"in r?(0,ro.macroKeywordCode)(o,r):(r.compile||r.validate)&&(0,ro.funcKeywordCode)(o,r)}var _w=/^\/(?:[^~]|~0|~1)*$/,vw=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function Jm(t,{dataLevel:e,dataNames:r,dataPathArr:n}){let o,s;if(t==="")return M.default.rootData;if(t[0]==="/"){if(!_w.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);o=t,s=M.default.rootData}else{let u=vw.exec(t);if(!u)throw new Error(`Invalid JSON-pointer: ${t}`);let l=+u[1];if(o=u[2],o==="#"){if(l>=e)throw new Error(c("property/index",l));return n[e-l]}if(l>e)throw new Error(c("data",l));if(s=r[e-l],!o)return s}let i=s,a=o.split("/");for(let u of a)u&&(s=(0,O._)`${s}${(0,O.getProperty)((0,Ot.unescapeJsonPointer)(u))}`,i=(0,O._)`${i} && ${s}`);return i;function c(u,l){return`Cannot access ${u} ${l} levels up, current level is ${e}`}}Gt.getData=Jm});var As=z(Lu=>{"use strict";Object.defineProperty(Lu,"__esModule",{value:!0});var Mu=class extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}};Lu.default=Mu});var oo=z(Uu=>{"use strict";Object.defineProperty(Uu,"__esModule",{value:!0});var Du=eo(),qu=class extends Error{constructor(e,r,n,o){super(o||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,Du.resolveUrl)(e,r,n),this.missingSchema=(0,Du.normalizeId)((0,Du.getFullPath)(e,this.missingRef))}};Uu.default=qu});var Ls=z(rt=>{"use strict";Object.defineProperty(rt,"__esModule",{value:!0});rt.resolveSchema=rt.getCompilingSchema=rt.resolveRef=rt.compileSchema=rt.SchemaEnv=void 0;var ut=U(),bw=As(),Rr=It(),lt=eo(),Xm=X(),xw=no(),sn=class{constructor(e){var r;this.refs={},this.dynamicAnchors={};let n;typeof e.schema=="object"&&(n=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(r=e.baseId)!==null&&r!==void 0?r:(0,lt.normalizeId)(n?.[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=n?.$async,this.refs={}}};rt.SchemaEnv=sn;function Vu(t){let e=Ym.call(this,t);if(e)return e;let r=(0,lt.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:n,lines:o}=this.opts.code,{ownProperties:s}=this.opts,i=new ut.CodeGen(this.scope,{es5:n,lines:o,ownProperties:s}),a;t.$async&&(a=i.scopeValue("Error",{ref:bw.default,code:(0,ut._)`require("ajv/dist/runtime/validation_error").default`}));let c=i.scopeName("validate");t.validateName=c;let u={gen:i,allErrors:this.opts.allErrors,data:Rr.default.data,parentData:Rr.default.parentData,parentDataProperty:Rr.default.parentDataProperty,dataNames:[Rr.default.data],dataPathArr:[ut.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:i.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,ut.stringify)(t.schema)}:{ref:t.schema}),validateName:c,ValidationError:a,schema:t.schema,schemaEnv:t,rootId:r,baseId:t.baseId||r,schemaPath:ut.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,ut._)`""`,opts:this.opts,self:this},l;try{this._compilations.add(t),(0,xw.validateFunctionCode)(u),i.optimize(this.opts.code.optimize);let d=i.toString();l=`${i.scopeRefs(Rr.default.scope)}return ${d}`,this.opts.code.process&&(l=this.opts.code.process(l,t));let f=new Function(`${Rr.default.self}`,`${Rr.default.scope}`,l)(this,this.scope.get());if(this.scope.value(c,{ref:f}),f.errors=null,f.schema=t.schema,f.schemaEnv=t,t.$async&&(f.$async=!0),this.opts.code.source===!0&&(f.source={validateName:c,validateCode:d,scopeValues:i._values}),this.opts.unevaluated){let{props:p,items:h}=u;f.evaluated={props:p instanceof ut.Name?void 0:p,items:h instanceof ut.Name?void 0:h,dynamicProps:p instanceof ut.Name,dynamicItems:h instanceof ut.Name},f.source&&(f.source.evaluated=(0,ut.stringify)(f.evaluated))}return t.validate=f,t}catch(d){throw delete t.validate,delete t.validateName,l&&this.logger.error("Error compiling schema, function code:",l),d}finally{this._compilations.delete(t)}}rt.compileSchema=Vu;function $w(t,e,r){var n;r=(0,lt.resolveUrl)(this.opts.uriResolver,e,r);let o=t.refs[r];if(o)return o;let s=Sw.call(this,t,r);if(s===void 0){let i=(n=t.localRefs)===null||n===void 0?void 0:n[r],{schemaId:a}=this.opts;i&&(s=new sn({schema:i,schemaId:a,root:t,baseId:e}))}if(s!==void 0)return t.refs[r]=ww.call(this,s)}rt.resolveRef=$w;function ww(t){return(0,lt.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:Vu.call(this,t)}function Ym(t){for(let e of this._compilations)if(kw(e,t))return e}rt.getCompilingSchema=Ym;function kw(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function Sw(t,e){let r;for(;typeof(r=this.refs[e])=="string";)e=r;return r||this.schemas[e]||Ms.call(this,t,e)}function Ms(t,e){let r=this.opts.uriResolver.parse(e),n=(0,lt._getFullPath)(this.opts.uriResolver,r),o=(0,lt.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&n===o)return Fu.call(this,r,t);let s=(0,lt.normalizeId)(n),i=this.refs[s]||this.schemas[s];if(typeof i=="string"){let a=Ms.call(this,t,i);return typeof a?.schema!="object"?void 0:Fu.call(this,r,a)}if(typeof i?.schema=="object"){if(i.validate||Vu.call(this,i),s===(0,lt.normalizeId)(e)){let{schema:a}=i,{schemaId:c}=this.opts,u=a[c];return u&&(o=(0,lt.resolveUrl)(this.opts.uriResolver,o,u)),new sn({schema:a,schemaId:c,root:t,baseId:o})}return Fu.call(this,r,i)}}rt.resolveSchema=Ms;var zw=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Fu(t,{baseId:e,schema:r,root:n}){var o;if(((o=t.fragment)===null||o===void 0?void 0:o[0])!=="/")return;for(let a of t.fragment.slice(1).split("/")){if(typeof r=="boolean")return;let c=r[(0,Xm.unescapeFragment)(a)];if(c===void 0)return;r=c;let u=typeof r=="object"&&r[this.opts.schemaId];!zw.has(a)&&u&&(e=(0,lt.resolveUrl)(this.opts.uriResolver,e,u))}let s;if(typeof r!="boolean"&&r.$ref&&!(0,Xm.schemaHasRulesButRef)(r,this.RULES)){let a=(0,lt.resolveUrl)(this.opts.uriResolver,e,r.$ref);s=Ms.call(this,n,a)}let{schemaId:i}=this.opts;if(s=s||new sn({schema:r,schemaId:i,root:n,baseId:e}),s.schema!==s.root.schema)return s}});var Qm=z((sN,Tw)=>{Tw.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var Bu=z((iN,nh)=>{"use strict";var Ew=RegExp.prototype.test.bind(/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu),th=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u);function Hu(t){let e="",r=0,n=0;for(n=0;n<t.length;n++)if(r=t[n].charCodeAt(0),r!==48){if(!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";e+=t[n];break}for(n+=1;n<t.length;n++){if(r=t[n].charCodeAt(0),!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";e+=t[n]}return e}var Pw=RegExp.prototype.test.bind(/[^!"$&'()*+,\-.;=_`a-z{}~]/u);function eh(t){return t.length=0,!0}function Rw(t,e,r){if(t.length){let n=Hu(t);if(n!=="")e.push(n);else return r.error=!0,!1;t.length=0}return!0}function Iw(t){let e=0,r={error:!1,address:"",zone:""},n=[],o=[],s=!1,i=!1,a=Rw;for(let c=0;c<t.length;c++){let u=t[c];if(!(u==="["||u==="]"))if(u===":"){if(s===!0&&(i=!0),!a(o,n,r))break;if(++e>7){r.error=!0;break}c>0&&t[c-1]===":"&&(s=!0),n.push(":");continue}else if(u==="%"){if(!a(o,n,r))break;a=eh}else{o.push(u);continue}}return o.length&&(a===eh?r.zone=o.join(""):i?n.push(o.join("")):n.push(Hu(o))),r.address=n.join(""),r}function rh(t){if(Ow(t,":")<2)return{host:t,isIPV6:!1};let e=Iw(t);if(e.error)return{host:t,isIPV6:!1};{let r=e.address,n=e.address;return e.zone&&(r+="%"+e.zone,n+="%25"+e.zone),{host:r,isIPV6:!0,escapedHost:n}}}function Ow(t,e){let r=0;for(let n=0;n<t.length;n++)t[n]===e&&r++;return r}function Nw(t){let e=t,r=[],n=-1,o=0;for(;o=e.length;){if(o===1){if(e===".")break;if(e==="/"){r.push("/");break}else{r.push(e);break}}else if(o===2){if(e[0]==="."){if(e[1]===".")break;if(e[1]==="/"){e=e.slice(2);continue}}else if(e[0]==="/"&&(e[1]==="."||e[1]==="/")){r.push("/");break}}else if(o===3&&e==="/.."){r.length!==0&&r.pop(),r.push("/");break}if(e[0]==="."){if(e[1]==="."){if(e[2]==="/"){e=e.slice(3);continue}}else if(e[1]==="/"){e=e.slice(2);continue}}else if(e[0]==="/"&&e[1]==="."){if(e[2]==="/"){e=e.slice(2);continue}else if(e[2]==="."&&e[3]==="/"){e=e.slice(3),r.length!==0&&r.pop();continue}}if((n=e.indexOf("/",1))===-1){r.push(e);break}else r.push(e.slice(0,n)),e=e.slice(n)}return r.join("")}function Cw(t,e){let r=e!==!0?escape:unescape;return t.scheme!==void 0&&(t.scheme=r(t.scheme)),t.userinfo!==void 0&&(t.userinfo=r(t.userinfo)),t.host!==void 0&&(t.host=r(t.host)),t.path!==void 0&&(t.path=r(t.path)),t.query!==void 0&&(t.query=r(t.query)),t.fragment!==void 0&&(t.fragment=r(t.fragment)),t}function Zw(t){let e=[];if(t.userinfo!==void 0&&(e.push(t.userinfo),e.push("@")),t.host!==void 0){let r=unescape(t.host);if(!th(r)){let n=rh(r);n.isIPV6===!0?r=`[${n.escapedHost}]`:r=t.host}e.push(r)}return(typeof t.port=="number"||typeof t.port=="string")&&(e.push(":"),e.push(String(t.port))),e.length?e.join(""):void 0}nh.exports={nonSimpleDomain:Pw,recomposeAuthority:Zw,normalizeComponentEncoding:Cw,removeDotSegments:Nw,isIPv4:th,isUUID:Ew,normalizeIPv6:rh,stringArrayToHexStripped:Hu}});var ch=z((aN,ah)=>{"use strict";var{isUUID:jw}=Bu(),Aw=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu,Mw=["http","https","ws","wss","urn","urn:uuid"];function Lw(t){return Mw.indexOf(t)!==-1}function Ku(t){return t.secure===!0?!0:t.secure===!1?!1:t.scheme?t.scheme.length===3&&(t.scheme[0]==="w"||t.scheme[0]==="W")&&(t.scheme[1]==="s"||t.scheme[1]==="S")&&(t.scheme[2]==="s"||t.scheme[2]==="S"):!1}function oh(t){return t.host||(t.error=t.error||"HTTP URIs must have a host."),t}function sh(t){let e=String(t.scheme).toLowerCase()==="https";return(t.port===(e?443:80)||t.port==="")&&(t.port=void 0),t.path||(t.path="/"),t}function Dw(t){return t.secure=Ku(t),t.resourceName=(t.path||"/")+(t.query?"?"+t.query:""),t.path=void 0,t.query=void 0,t}function qw(t){if((t.port===(Ku(t)?443:80)||t.port==="")&&(t.port=void 0),typeof t.secure=="boolean"&&(t.scheme=t.secure?"wss":"ws",t.secure=void 0),t.resourceName){let[e,r]=t.resourceName.split("?");t.path=e&&e!=="/"?e:void 0,t.query=r,t.resourceName=void 0}return t.fragment=void 0,t}function Uw(t,e){if(!t.path)return t.error="URN can not be parsed",t;let r=t.path.match(Aw);if(r){let n=e.scheme||t.scheme||"urn";t.nid=r[1].toLowerCase(),t.nss=r[2];let o=`${n}:${e.nid||t.nid}`,s=Wu(o);t.path=void 0,s&&(t=s.parse(t,e))}else t.error=t.error||"URN can not be parsed.";return t}function Fw(t,e){if(t.nid===void 0)throw new Error("URN without nid cannot be serialized");let r=e.scheme||t.scheme||"urn",n=t.nid.toLowerCase(),o=`${r}:${e.nid||n}`,s=Wu(o);s&&(t=s.serialize(t,e));let i=t,a=t.nss;return i.path=`${n||e.nid}:${a}`,e.skipEscape=!0,i}function Vw(t,e){let r=t;return r.uuid=r.nss,r.nss=void 0,!e.tolerant&&(!r.uuid||!jw(r.uuid))&&(r.error=r.error||"UUID is not valid."),r}function Hw(t){let e=t;return e.nss=(t.uuid||"").toLowerCase(),e}var ih={scheme:"http",domainHost:!0,parse:oh,serialize:sh},Bw={scheme:"https",domainHost:ih.domainHost,parse:oh,serialize:sh},Ds={scheme:"ws",domainHost:!0,parse:Dw,serialize:qw},Kw={scheme:"wss",domainHost:Ds.domainHost,parse:Ds.parse,serialize:Ds.serialize},Ww={scheme:"urn",parse:Uw,serialize:Fw,skipNormalize:!0},Gw={scheme:"urn:uuid",parse:Vw,serialize:Hw,skipNormalize:!0},qs={http:ih,https:Bw,ws:Ds,wss:Kw,urn:Ww,"urn:uuid":Gw};Object.setPrototypeOf(qs,null);function Wu(t){return t&&(qs[t]||qs[t.toLowerCase()])||void 0}ah.exports={wsIsSecure:Ku,SCHEMES:qs,isValidSchemeName:Lw,getSchemeHandler:Wu}});var dh=z((cN,Fs)=>{"use strict";var{normalizeIPv6:Jw,removeDotSegments:so,recomposeAuthority:Xw,normalizeComponentEncoding:Us,isIPv4:Yw,nonSimpleDomain:Qw}=Bu(),{SCHEMES:ek,getSchemeHandler:uh}=ch();function tk(t,e){return typeof t=="string"?t=vt(Nt(t,e),e):typeof t=="object"&&(t=Nt(vt(t,e),e)),t}function rk(t,e,r){let n=r?Object.assign({scheme:"null"},r):{scheme:"null"},o=lh(Nt(t,n),Nt(e,n),n,!0);return n.skipEscape=!0,vt(o,n)}function lh(t,e,r,n){let o={};return n||(t=Nt(vt(t,r),r),e=Nt(vt(e,r),r)),r=r||{},!r.tolerant&&e.scheme?(o.scheme=e.scheme,o.userinfo=e.userinfo,o.host=e.host,o.port=e.port,o.path=so(e.path||""),o.query=e.query):(e.userinfo!==void 0||e.host!==void 0||e.port!==void 0?(o.userinfo=e.userinfo,o.host=e.host,o.port=e.port,o.path=so(e.path||""),o.query=e.query):(e.path?(e.path[0]==="/"?o.path=so(e.path):((t.userinfo!==void 0||t.host!==void 0||t.port!==void 0)&&!t.path?o.path="/"+e.path:t.path?o.path=t.path.slice(0,t.path.lastIndexOf("/")+1)+e.path:o.path=e.path,o.path=so(o.path)),o.query=e.query):(o.path=t.path,e.query!==void 0?o.query=e.query:o.query=t.query),o.userinfo=t.userinfo,o.host=t.host,o.port=t.port),o.scheme=t.scheme),o.fragment=e.fragment,o}function nk(t,e,r){return typeof t=="string"?(t=unescape(t),t=vt(Us(Nt(t,r),!0),{...r,skipEscape:!0})):typeof t=="object"&&(t=vt(Us(t,!0),{...r,skipEscape:!0})),typeof e=="string"?(e=unescape(e),e=vt(Us(Nt(e,r),!0),{...r,skipEscape:!0})):typeof e=="object"&&(e=vt(Us(e,!0),{...r,skipEscape:!0})),t.toLowerCase()===e.toLowerCase()}function vt(t,e){let r={host:t.host,scheme:t.scheme,userinfo:t.userinfo,port:t.port,path:t.path,query:t.query,nid:t.nid,nss:t.nss,uuid:t.uuid,fragment:t.fragment,reference:t.reference,resourceName:t.resourceName,secure:t.secure,error:""},n=Object.assign({},e),o=[],s=uh(n.scheme||r.scheme);s&&s.serialize&&s.serialize(r,n),r.path!==void 0&&(n.skipEscape?r.path=unescape(r.path):(r.path=escape(r.path),r.scheme!==void 0&&(r.path=r.path.split("%3A").join(":")))),n.reference!=="suffix"&&r.scheme&&o.push(r.scheme,":");let i=Xw(r);if(i!==void 0&&(n.reference!=="suffix"&&o.push("//"),o.push(i),r.path&&r.path[0]!=="/"&&o.push("/")),r.path!==void 0){let a=r.path;!n.absolutePath&&(!s||!s.absolutePath)&&(a=so(a)),i===void 0&&a[0]==="/"&&a[1]==="/"&&(a="/%2F"+a.slice(2)),o.push(a)}return r.query!==void 0&&o.push("?",r.query),r.fragment!==void 0&&o.push("#",r.fragment),o.join("")}var ok=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function Nt(t,e){let r=Object.assign({},e),n={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},o=!1;r.reference==="suffix"&&(r.scheme?t=r.scheme+":"+t:t="//"+t);let s=t.match(ok);if(s){if(n.scheme=s[1],n.userinfo=s[3],n.host=s[4],n.port=parseInt(s[5],10),n.path=s[6]||"",n.query=s[7],n.fragment=s[8],isNaN(n.port)&&(n.port=s[5]),n.host)if(Yw(n.host)===!1){let c=Jw(n.host);n.host=c.host.toLowerCase(),o=c.isIPV6}else o=!0;n.scheme===void 0&&n.userinfo===void 0&&n.host===void 0&&n.port===void 0&&n.query===void 0&&!n.path?n.reference="same-document":n.scheme===void 0?n.reference="relative":n.fragment===void 0?n.reference="absolute":n.reference="uri",r.reference&&r.reference!=="suffix"&&r.reference!==n.reference&&(n.error=n.error||"URI is not a "+r.reference+" reference.");let i=uh(r.scheme||n.scheme);if(!r.unicodeSupport&&(!i||!i.unicodeSupport)&&n.host&&(r.domainHost||i&&i.domainHost)&&o===!1&&Qw(n.host))try{n.host=URL.domainToASCII(n.host.toLowerCase())}catch(a){n.error=n.error||"Host's domain name can not be converted to ASCII: "+a}(!i||i&&!i.skipNormalize)&&(t.indexOf("%")!==-1&&(n.scheme!==void 0&&(n.scheme=unescape(n.scheme)),n.host!==void 0&&(n.host=unescape(n.host))),n.path&&(n.path=escape(unescape(n.path))),n.fragment&&(n.fragment=encodeURI(decodeURIComponent(n.fragment)))),i&&i.parse&&i.parse(n,r)}else n.error=n.error||"URI can not be parsed.";return n}var Gu={SCHEMES:ek,normalize:tk,resolve:rk,resolveComponent:lh,equal:nk,serialize:vt,parse:Nt};Fs.exports=Gu;Fs.exports.default=Gu;Fs.exports.fastUri=Gu});var fh=z(Ju=>{"use strict";Object.defineProperty(Ju,"__esModule",{value:!0});var ph=dh();ph.code='require("ajv/dist/runtime/uri").default';Ju.default=ph});var xh=z(Se=>{"use strict";Object.defineProperty(Se,"__esModule",{value:!0});Se.CodeGen=Se.Name=Se.nil=Se.stringify=Se.str=Se._=Se.KeywordCxt=void 0;var sk=no();Object.defineProperty(Se,"KeywordCxt",{enumerable:!0,get:function(){return sk.KeywordCxt}});var an=U();Object.defineProperty(Se,"_",{enumerable:!0,get:function(){return an._}});Object.defineProperty(Se,"str",{enumerable:!0,get:function(){return an.str}});Object.defineProperty(Se,"stringify",{enumerable:!0,get:function(){return an.stringify}});Object.defineProperty(Se,"nil",{enumerable:!0,get:function(){return an.nil}});Object.defineProperty(Se,"Name",{enumerable:!0,get:function(){return an.Name}});Object.defineProperty(Se,"CodeGen",{enumerable:!0,get:function(){return an.CodeGen}});var ik=As(),_h=oo(),ak=Su(),io=Ls(),ck=U(),ao=eo(),Vs=Qn(),Yu=X(),mh=Qm(),uk=fh(),vh=(t,e)=>new RegExp(t,e);vh.code="new RegExp";var lk=["removeAdditional","useDefaults","coerceTypes"],dk=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),pk={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},fk={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},hh=200;function mk(t){var e,r,n,o,s,i,a,c,u,l,d,m,f,p,h,g,v,x,b,S,N,_e,We,Zr,_i;let gn=t.strict,vi=(e=t.code)===null||e===void 0?void 0:e.optimize,nd=vi===!0||vi===void 0?1:vi||0,od=(n=(r=t.code)===null||r===void 0?void 0:r.regExp)!==null&&n!==void 0?n:vh,fy=(o=t.uriResolver)!==null&&o!==void 0?o:uk.default;return{strictSchema:(i=(s=t.strictSchema)!==null&&s!==void 0?s:gn)!==null&&i!==void 0?i:!0,strictNumbers:(c=(a=t.strictNumbers)!==null&&a!==void 0?a:gn)!==null&&c!==void 0?c:!0,strictTypes:(l=(u=t.strictTypes)!==null&&u!==void 0?u:gn)!==null&&l!==void 0?l:"log",strictTuples:(m=(d=t.strictTuples)!==null&&d!==void 0?d:gn)!==null&&m!==void 0?m:"log",strictRequired:(p=(f=t.strictRequired)!==null&&f!==void 0?f:gn)!==null&&p!==void 0?p:!1,code:t.code?{...t.code,optimize:nd,regExp:od}:{optimize:nd,regExp:od},loopRequired:(h=t.loopRequired)!==null&&h!==void 0?h:hh,loopEnum:(g=t.loopEnum)!==null&&g!==void 0?g:hh,meta:(v=t.meta)!==null&&v!==void 0?v:!0,messages:(x=t.messages)!==null&&x!==void 0?x:!0,inlineRefs:(b=t.inlineRefs)!==null&&b!==void 0?b:!0,schemaId:(S=t.schemaId)!==null&&S!==void 0?S:"$id",addUsedSchema:(N=t.addUsedSchema)!==null&&N!==void 0?N:!0,validateSchema:(_e=t.validateSchema)!==null&&_e!==void 0?_e:!0,validateFormats:(We=t.validateFormats)!==null&&We!==void 0?We:!0,unicodeRegExp:(Zr=t.unicodeRegExp)!==null&&Zr!==void 0?Zr:!0,int32range:(_i=t.int32range)!==null&&_i!==void 0?_i:!0,uriResolver:fy}}var co=class{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...mk(e)};let{es5:r,lines:n}=this.opts.code;this.scope=new ck.ValueScope({scope:{},prefixes:dk,es5:r,lines:n}),this.logger=bk(e.logger);let o=e.validateFormats;e.validateFormats=!1,this.RULES=(0,ak.getRules)(),gh.call(this,pk,e,"NOT SUPPORTED"),gh.call(this,fk,e,"DEPRECATED","warn"),this._metaOpts=_k.call(this),e.formats&&gk.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&yk.call(this,e.keywords),typeof e.meta=="object"&&this.addMetaSchema(e.meta),hk.call(this),e.validateFormats=o}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:e,meta:r,schemaId:n}=this.opts,o=mh;n==="id"&&(o={...mh},o.id=o.$id,delete o.$id),r&&e&&this.addMetaSchema(o,o[n],!1)}defaultMeta(){let{meta:e,schemaId:r}=this.opts;return this.opts.defaultMeta=typeof e=="object"?e[r]||e:void 0}validate(e,r){let n;if(typeof e=="string"){if(n=this.getSchema(e),!n)throw new Error(`no schema with key or ref "${e}"`)}else n=this.compile(e);let o=n(r);return"$async"in n||(this.errors=n.errors),o}compile(e,r){let n=this._addSchema(e,r);return n.validate||this._compileSchemaEnv(n)}compileAsync(e,r){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");let{loadSchema:n}=this.opts;return o.call(this,e,r);async function o(l,d){await s.call(this,l.$schema);let m=this._addSchema(l,d);return m.validate||i.call(this,m)}async function s(l){l&&!this.getSchema(l)&&await o.call(this,{$ref:l},!0)}async function i(l){try{return this._compileSchemaEnv(l)}catch(d){if(!(d instanceof _h.default))throw d;return a.call(this,d),await c.call(this,d.missingSchema),i.call(this,l)}}function a({missingSchema:l,missingRef:d}){if(this.refs[l])throw new Error(`AnySchema ${l} is loaded but ${d} cannot be resolved`)}async function c(l){let d=await u.call(this,l);this.refs[l]||await s.call(this,d.$schema),this.refs[l]||this.addSchema(d,l,r)}async function u(l){let d=this._loading[l];if(d)return d;try{return await(this._loading[l]=n(l))}finally{delete this._loading[l]}}}addSchema(e,r,n,o=this.opts.validateSchema){if(Array.isArray(e)){for(let i of e)this.addSchema(i,void 0,n,o);return this}let s;if(typeof e=="object"){let{schemaId:i}=this.opts;if(s=e[i],s!==void 0&&typeof s!="string")throw new Error(`schema ${i} must be string`)}return r=(0,ao.normalizeId)(r||s),this._checkUnique(r),this.schemas[r]=this._addSchema(e,n,r,o,!0),this}addMetaSchema(e,r,n=this.opts.validateSchema){return this.addSchema(e,r,!0,n),this}validateSchema(e,r){if(typeof e=="boolean")return!0;let n;if(n=e.$schema,n!==void 0&&typeof n!="string")throw new Error("$schema must be a string");if(n=n||this.opts.defaultMeta||this.defaultMeta(),!n)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let o=this.validate(n,e);if(!o&&r){let s="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(s);else throw new Error(s)}return o}getSchema(e){let r;for(;typeof(r=yh.call(this,e))=="string";)e=r;if(r===void 0){let{schemaId:n}=this.opts,o=new io.SchemaEnv({schema:{},schemaId:n});if(r=io.resolveSchema.call(this,o,e),!r)return;this.refs[e]=r}return r.validate||this._compileSchemaEnv(r)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let r=yh.call(this,e);return typeof r=="object"&&this._cache.delete(r.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{let r=e;this._cache.delete(r);let n=e[this.opts.schemaId];return n&&(n=(0,ao.normalizeId)(n),delete this.schemas[n],delete this.refs[n]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(let r of e)this.addKeyword(r);return this}addKeyword(e,r){let n;if(typeof e=="string")n=e,typeof r=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),r.keyword=n);else if(typeof e=="object"&&r===void 0){if(r=e,n=r.keyword,Array.isArray(n)&&!n.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if($k.call(this,n,r),!r)return(0,Yu.eachItem)(n,s=>Xu.call(this,s)),this;kk.call(this,r);let o={...r,type:(0,Vs.getJSONTypes)(r.type),schemaType:(0,Vs.getJSONTypes)(r.schemaType)};return(0,Yu.eachItem)(n,o.type.length===0?s=>Xu.call(this,s,o):s=>o.type.forEach(i=>Xu.call(this,s,o,i))),this}getKeyword(e){let r=this.RULES.all[e];return typeof r=="object"?r.definition:!!r}removeKeyword(e){let{RULES:r}=this;delete r.keywords[e],delete r.all[e];for(let n of r.rules){let o=n.rules.findIndex(s=>s.keyword===e);o>=0&&n.rules.splice(o,1)}return this}addFormat(e,r){return typeof r=="string"&&(r=new RegExp(r)),this.formats[e]=r,this}errorsText(e=this.errors,{separator:r=", ",dataVar:n="data"}={}){return!e||e.length===0?"No errors":e.map(o=>`${n}${o.instancePath} ${o.message}`).reduce((o,s)=>o+r+s)}$dataMetaSchema(e,r){let n=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(let o of r){let s=o.split("/").slice(1),i=e;for(let a of s)i=i[a];for(let a in n){let c=n[a];if(typeof c!="object")continue;let{$data:u}=c.definition,l=i[a];u&&l&&(i[a]=bh(l))}}return e}_removeAllSchemas(e,r){for(let n in e){let o=e[n];(!r||r.test(n))&&(typeof o=="string"?delete e[n]:o&&!o.meta&&(this._cache.delete(o.schema),delete e[n]))}}_addSchema(e,r,n,o=this.opts.validateSchema,s=this.opts.addUsedSchema){let i,{schemaId:a}=this.opts;if(typeof e=="object")i=e[a];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof e!="boolean")throw new Error("schema must be object or boolean")}let c=this._cache.get(e);if(c!==void 0)return c;n=(0,ao.normalizeId)(i||n);let u=ao.getSchemaRefs.call(this,e,n);return c=new io.SchemaEnv({schema:e,schemaId:a,meta:r,baseId:n,localRefs:u}),this._cache.set(c.schema,c),s&&!n.startsWith("#")&&(n&&this._checkUnique(n),this.refs[n]=c),o&&this.validateSchema(e,!0),c}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):io.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){let r=this.opts;this.opts=this._metaOpts;try{io.compileSchema.call(this,e)}finally{this.opts=r}}};co.ValidationError=ik.default;co.MissingRefError=_h.default;Se.default=co;function gh(t,e,r,n="error"){for(let o in t){let s=o;s in e&&this.logger[n](`${r}: option ${o}. ${t[s]}`)}}function yh(t){return t=(0,ao.normalizeId)(t),this.schemas[t]||this.refs[t]}function hk(){let t=this.opts.schemas;if(t)if(Array.isArray(t))this.addSchema(t);else for(let e in t)this.addSchema(t[e],e)}function gk(){for(let t in this.opts.formats){let e=this.opts.formats[t];e&&this.addFormat(t,e)}}function yk(t){if(Array.isArray(t)){this.addVocabulary(t);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let e in t){let r=t[e];r.keyword||(r.keyword=e),this.addKeyword(r)}}function _k(){let t={...this.opts};for(let e of lk)delete t[e];return t}var vk={log(){},warn(){},error(){}};function bk(t){if(t===!1)return vk;if(t===void 0)return console;if(t.log&&t.warn&&t.error)return t;throw new Error("logger must implement log, warn and error methods")}var xk=/^[a-z_$][a-z0-9_$:-]*$/i;function $k(t,e){let{RULES:r}=this;if((0,Yu.eachItem)(t,n=>{if(r.keywords[n])throw new Error(`Keyword ${n} is already defined`);if(!xk.test(n))throw new Error(`Keyword ${n} has invalid name`)}),!!e&&e.$data&&!("code"in e||"validate"in e))throw new Error('$data keyword must have "code" or "validate" function')}function Xu(t,e,r){var n;let o=e?.post;if(r&&o)throw new Error('keyword with "post" flag cannot have "type"');let{RULES:s}=this,i=o?s.post:s.rules.find(({type:c})=>c===r);if(i||(i={type:r,rules:[]},s.rules.push(i)),s.keywords[t]=!0,!e)return;let a={keyword:t,definition:{...e,type:(0,Vs.getJSONTypes)(e.type),schemaType:(0,Vs.getJSONTypes)(e.schemaType)}};e.before?wk.call(this,i,a,e.before):i.rules.push(a),s.all[t]=a,(n=e.implements)===null||n===void 0||n.forEach(c=>this.addKeyword(c))}function wk(t,e,r){let n=t.rules.findIndex(o=>o.keyword===r);n>=0?t.rules.splice(n,0,e):(t.rules.push(e),this.logger.warn(`rule ${r} is not defined`))}function kk(t){let{metaSchema:e}=t;e!==void 0&&(t.$data&&this.opts.$data&&(e=bh(e)),t.validateSchema=this.compile(e,!0))}var Sk={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function bh(t){return{anyOf:[t,Sk]}}});var $h=z(Qu=>{"use strict";Object.defineProperty(Qu,"__esModule",{value:!0});var zk={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};Qu.default=zk});var zh=z(Ir=>{"use strict";Object.defineProperty(Ir,"__esModule",{value:!0});Ir.callRef=Ir.getValidate=void 0;var Tk=oo(),wh=tt(),Fe=U(),cn=It(),kh=Ls(),Hs=X(),Ek={keyword:"$ref",schemaType:"string",code(t){let{gen:e,schema:r,it:n}=t,{baseId:o,schemaEnv:s,validateName:i,opts:a,self:c}=n,{root:u}=s;if((r==="#"||r==="#/")&&o===u.baseId)return d();let l=kh.resolveRef.call(c,u,o,r);if(l===void 0)throw new Tk.default(n.opts.uriResolver,o,r);if(l instanceof kh.SchemaEnv)return m(l);return f(l);function d(){if(s===u)return Bs(t,i,s,s.$async);let p=e.scopeValue("root",{ref:u});return Bs(t,(0,Fe._)`${p}.validate`,u,u.$async)}function m(p){let h=Sh(t,p);Bs(t,h,p,p.$async)}function f(p){let h=e.scopeValue("schema",a.code.source===!0?{ref:p,code:(0,Fe.stringify)(p)}:{ref:p}),g=e.name("valid"),v=t.subschema({schema:p,dataTypes:[],schemaPath:Fe.nil,topSchemaRef:h,errSchemaPath:r},g);t.mergeEvaluated(v),t.ok(g)}}};function Sh(t,e){let{gen:r}=t;return e.validate?r.scopeValue("validate",{ref:e.validate}):(0,Fe._)`${r.scopeValue("wrapper",{ref:e})}.validate`}Ir.getValidate=Sh;function Bs(t,e,r,n){let{gen:o,it:s}=t,{allErrors:i,schemaEnv:a,opts:c}=s,u=c.passContext?cn.default.this:Fe.nil;n?l():d();function l(){if(!a.$async)throw new Error("async schema referenced by sync schema");let p=o.let("valid");o.try(()=>{o.code((0,Fe._)`await ${(0,wh.callValidateCode)(t,e,u)}`),f(e),i||o.assign(p,!0)},h=>{o.if((0,Fe._)`!(${h} instanceof ${s.ValidationError})`,()=>o.throw(h)),m(h),i||o.assign(p,!1)}),t.ok(p)}function d(){t.result((0,wh.callValidateCode)(t,e,u),()=>f(e),()=>m(e))}function m(p){let h=(0,Fe._)`${p}.errors`;o.assign(cn.default.vErrors,(0,Fe._)`${cn.default.vErrors} === null ? ${h} : ${cn.default.vErrors}.concat(${h})`),o.assign(cn.default.errors,(0,Fe._)`${cn.default.vErrors}.length`)}function f(p){var h;if(!s.opts.unevaluated)return;let g=(h=r?.validate)===null||h===void 0?void 0:h.evaluated;if(s.props!==!0)if(g&&!g.dynamicProps)g.props!==void 0&&(s.props=Hs.mergeEvaluated.props(o,g.props,s.props));else{let v=o.var("props",(0,Fe._)`${p}.evaluated.props`);s.props=Hs.mergeEvaluated.props(o,v,s.props,Fe.Name)}if(s.items!==!0)if(g&&!g.dynamicItems)g.items!==void 0&&(s.items=Hs.mergeEvaluated.items(o,g.items,s.items));else{let v=o.var("items",(0,Fe._)`${p}.evaluated.items`);s.items=Hs.mergeEvaluated.items(o,v,s.items,Fe.Name)}}}Ir.callRef=Bs;Ir.default=Ek});var Th=z(el=>{"use strict";Object.defineProperty(el,"__esModule",{value:!0});var Pk=$h(),Rk=zh(),Ik=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",Pk.default,Rk.default];el.default=Ik});var Eh=z(tl=>{"use strict";Object.defineProperty(tl,"__esModule",{value:!0});var Ks=U(),Jt=Ks.operators,Ws={maximum:{okStr:"<=",ok:Jt.LTE,fail:Jt.GT},minimum:{okStr:">=",ok:Jt.GTE,fail:Jt.LT},exclusiveMaximum:{okStr:"<",ok:Jt.LT,fail:Jt.GTE},exclusiveMinimum:{okStr:">",ok:Jt.GT,fail:Jt.LTE}},Ok={message:({keyword:t,schemaCode:e})=>(0,Ks.str)`must be ${Ws[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,Ks._)`{comparison: ${Ws[t].okStr}, limit: ${e}}`},Nk={keyword:Object.keys(Ws),type:"number",schemaType:"number",$data:!0,error:Ok,code(t){let{keyword:e,data:r,schemaCode:n}=t;t.fail$data((0,Ks._)`${r} ${Ws[e].fail} ${n} || isNaN(${r})`)}};tl.default=Nk});var Ph=z(rl=>{"use strict";Object.defineProperty(rl,"__esModule",{value:!0});var uo=U(),Ck={message:({schemaCode:t})=>(0,uo.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,uo._)`{multipleOf: ${t}}`},Zk={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:Ck,code(t){let{gen:e,data:r,schemaCode:n,it:o}=t,s=o.opts.multipleOfPrecision,i=e.let("res"),a=s?(0,uo._)`Math.abs(Math.round(${i}) - ${i}) > 1e-${s}`:(0,uo._)`${i} !== parseInt(${i})`;t.fail$data((0,uo._)`(${n} === 0 || (${i} = ${r}/${n}, ${a}))`)}};rl.default=Zk});var Ih=z(nl=>{"use strict";Object.defineProperty(nl,"__esModule",{value:!0});function Rh(t){let e=t.length,r=0,n=0,o;for(;n<e;)r++,o=t.charCodeAt(n++),o>=55296&&o<=56319&&n<e&&(o=t.charCodeAt(n),(o&64512)===56320&&n++);return r}nl.default=Rh;Rh.code='require("ajv/dist/runtime/ucs2length").default'});var Oh=z(ol=>{"use strict";Object.defineProperty(ol,"__esModule",{value:!0});var Or=U(),jk=X(),Ak=Ih(),Mk={message({keyword:t,schemaCode:e}){let r=t==="maxLength"?"more":"fewer";return(0,Or.str)`must NOT have ${r} than ${e} characters`},params:({schemaCode:t})=>(0,Or._)`{limit: ${t}}`},Lk={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:Mk,code(t){let{keyword:e,data:r,schemaCode:n,it:o}=t,s=e==="maxLength"?Or.operators.GT:Or.operators.LT,i=o.opts.unicode===!1?(0,Or._)`${r}.length`:(0,Or._)`${(0,jk.useFunc)(t.gen,Ak.default)}(${r})`;t.fail$data((0,Or._)`${i} ${s} ${n}`)}};ol.default=Lk});var Nh=z(sl=>{"use strict";Object.defineProperty(sl,"__esModule",{value:!0});var Dk=tt(),qk=X(),un=U(),Uk={message:({schemaCode:t})=>(0,un.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,un._)`{pattern: ${t}}`},Fk={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:Uk,code(t){let{gen:e,data:r,$data:n,schema:o,schemaCode:s,it:i}=t,a=i.opts.unicodeRegExp?"u":"";if(n){let{regExp:c}=i.opts.code,u=c.code==="new RegExp"?(0,un._)`new RegExp`:(0,qk.useFunc)(e,c),l=e.let("valid");e.try(()=>e.assign(l,(0,un._)`${u}(${s}, ${a}).test(${r})`),()=>e.assign(l,!1)),t.fail$data((0,un._)`!${l}`)}else{let c=(0,Dk.usePattern)(t,o);t.fail$data((0,un._)`!${c}.test(${r})`)}}};sl.default=Fk});var Ch=z(il=>{"use strict";Object.defineProperty(il,"__esModule",{value:!0});var lo=U(),Vk={message({keyword:t,schemaCode:e}){let r=t==="maxProperties"?"more":"fewer";return(0,lo.str)`must NOT have ${r} than ${e} properties`},params:({schemaCode:t})=>(0,lo._)`{limit: ${t}}`},Hk={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:Vk,code(t){let{keyword:e,data:r,schemaCode:n}=t,o=e==="maxProperties"?lo.operators.GT:lo.operators.LT;t.fail$data((0,lo._)`Object.keys(${r}).length ${o} ${n}`)}};il.default=Hk});var Zh=z(al=>{"use strict";Object.defineProperty(al,"__esModule",{value:!0});var po=tt(),fo=U(),Bk=X(),Kk={message:({params:{missingProperty:t}})=>(0,fo.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,fo._)`{missingProperty: ${t}}`},Wk={keyword:"required",type:"object",schemaType:"array",$data:!0,error:Kk,code(t){let{gen:e,schema:r,schemaCode:n,data:o,$data:s,it:i}=t,{opts:a}=i;if(!s&&r.length===0)return;let c=r.length>=a.loopRequired;if(i.allErrors?u():l(),a.strictRequired){let f=t.parentSchema.properties,{definedProperties:p}=t.it;for(let h of r)if(f?.[h]===void 0&&!p.has(h)){let g=i.schemaEnv.baseId+i.errSchemaPath,v=`required property "${h}" is not defined at "${g}" (strictRequired)`;(0,Bk.checkStrictMode)(i,v,i.opts.strictRequired)}}function u(){if(c||s)t.block$data(fo.nil,d);else for(let f of r)(0,po.checkReportMissingProp)(t,f)}function l(){let f=e.let("missing");if(c||s){let p=e.let("valid",!0);t.block$data(p,()=>m(f,p)),t.ok(p)}else e.if((0,po.checkMissingProp)(t,r,f)),(0,po.reportMissingProp)(t,f),e.else()}function d(){e.forOf("prop",n,f=>{t.setParams({missingProperty:f}),e.if((0,po.noPropertyInData)(e,o,f,a.ownProperties),()=>t.error())})}function m(f,p){t.setParams({missingProperty:f}),e.forOf(f,n,()=>{e.assign(p,(0,po.propertyInData)(e,o,f,a.ownProperties)),e.if((0,fo.not)(p),()=>{t.error(),e.break()})},fo.nil)}}};al.default=Wk});var jh=z(cl=>{"use strict";Object.defineProperty(cl,"__esModule",{value:!0});var mo=U(),Gk={message({keyword:t,schemaCode:e}){let r=t==="maxItems"?"more":"fewer";return(0,mo.str)`must NOT have ${r} than ${e} items`},params:({schemaCode:t})=>(0,mo._)`{limit: ${t}}`},Jk={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:Gk,code(t){let{keyword:e,data:r,schemaCode:n}=t,o=e==="maxItems"?mo.operators.GT:mo.operators.LT;t.fail$data((0,mo._)`${r}.length ${o} ${n}`)}};cl.default=Jk});var Gs=z(ul=>{"use strict";Object.defineProperty(ul,"__esModule",{value:!0});var Ah=Nu();Ah.code='require("ajv/dist/runtime/equal").default';ul.default=Ah});var Mh=z(dl=>{"use strict";Object.defineProperty(dl,"__esModule",{value:!0});var ll=Qn(),ze=U(),Xk=X(),Yk=Gs(),Qk={message:({params:{i:t,j:e}})=>(0,ze.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,ze._)`{i: ${t}, j: ${e}}`},eS={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:Qk,code(t){let{gen:e,data:r,$data:n,schema:o,parentSchema:s,schemaCode:i,it:a}=t;if(!n&&!o)return;let c=e.let("valid"),u=s.items?(0,ll.getSchemaTypes)(s.items):[];t.block$data(c,l,(0,ze._)`${i} === false`),t.ok(c);function l(){let p=e.let("i",(0,ze._)`${r}.length`),h=e.let("j");t.setParams({i:p,j:h}),e.assign(c,!0),e.if((0,ze._)`${p} > 1`,()=>(d()?m:f)(p,h))}function d(){return u.length>0&&!u.some(p=>p==="object"||p==="array")}function m(p,h){let g=e.name("item"),v=(0,ll.checkDataTypes)(u,g,a.opts.strictNumbers,ll.DataType.Wrong),x=e.const("indices",(0,ze._)`{}`);e.for((0,ze._)`;${p}--;`,()=>{e.let(g,(0,ze._)`${r}[${p}]`),e.if(v,(0,ze._)`continue`),u.length>1&&e.if((0,ze._)`typeof ${g} == "string"`,(0,ze._)`${g} += "_"`),e.if((0,ze._)`typeof ${x}[${g}] == "number"`,()=>{e.assign(h,(0,ze._)`${x}[${g}]`),t.error(),e.assign(c,!1).break()}).code((0,ze._)`${x}[${g}] = ${p}`)})}function f(p,h){let g=(0,Xk.useFunc)(e,Yk.default),v=e.name("outer");e.label(v).for((0,ze._)`;${p}--;`,()=>e.for((0,ze._)`${h} = ${p}; ${h}--;`,()=>e.if((0,ze._)`${g}(${r}[${p}], ${r}[${h}])`,()=>{t.error(),e.assign(c,!1).break(v)})))}}};dl.default=eS});var Lh=z(fl=>{"use strict";Object.defineProperty(fl,"__esModule",{value:!0});var pl=U(),tS=X(),rS=Gs(),nS={message:"must be equal to constant",params:({schemaCode:t})=>(0,pl._)`{allowedValue: ${t}}`},oS={keyword:"const",$data:!0,error:nS,code(t){let{gen:e,data:r,$data:n,schemaCode:o,schema:s}=t;n||s&&typeof s=="object"?t.fail$data((0,pl._)`!${(0,tS.useFunc)(e,rS.default)}(${r}, ${o})`):t.fail((0,pl._)`${s} !== ${r}`)}};fl.default=oS});var Dh=z(ml=>{"use strict";Object.defineProperty(ml,"__esModule",{value:!0});var ho=U(),sS=X(),iS=Gs(),aS={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,ho._)`{allowedValues: ${t}}`},cS={keyword:"enum",schemaType:"array",$data:!0,error:aS,code(t){let{gen:e,data:r,$data:n,schema:o,schemaCode:s,it:i}=t;if(!n&&o.length===0)throw new Error("enum must have non-empty array");let a=o.length>=i.opts.loopEnum,c,u=()=>c??(c=(0,sS.useFunc)(e,iS.default)),l;if(a||n)l=e.let("valid"),t.block$data(l,d);else{if(!Array.isArray(o))throw new Error("ajv implementation error");let f=e.const("vSchema",s);l=(0,ho.or)(...o.map((p,h)=>m(f,h)))}t.pass(l);function d(){e.assign(l,!1),e.forOf("v",s,f=>e.if((0,ho._)`${u()}(${r}, ${f})`,()=>e.assign(l,!0).break()))}function m(f,p){let h=o[p];return typeof h=="object"&&h!==null?(0,ho._)`${u()}(${r}, ${f}[${p}])`:(0,ho._)`${r} === ${h}`}}};ml.default=cS});var qh=z(hl=>{"use strict";Object.defineProperty(hl,"__esModule",{value:!0});var uS=Eh(),lS=Ph(),dS=Oh(),pS=Nh(),fS=Ch(),mS=Zh(),hS=jh(),gS=Mh(),yS=Lh(),_S=Dh(),vS=[uS.default,lS.default,dS.default,pS.default,fS.default,mS.default,hS.default,gS.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},yS.default,_S.default];hl.default=vS});var yl=z(go=>{"use strict";Object.defineProperty(go,"__esModule",{value:!0});go.validateAdditionalItems=void 0;var Nr=U(),gl=X(),bS={message:({params:{len:t}})=>(0,Nr.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,Nr._)`{limit: ${t}}`},xS={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:bS,code(t){let{parentSchema:e,it:r}=t,{items:n}=e;if(!Array.isArray(n)){(0,gl.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}Uh(t,n)}};function Uh(t,e){let{gen:r,schema:n,data:o,keyword:s,it:i}=t;i.items=!0;let a=r.const("len",(0,Nr._)`${o}.length`);if(n===!1)t.setParams({len:e.length}),t.pass((0,Nr._)`${a} <= ${e.length}`);else if(typeof n=="object"&&!(0,gl.alwaysValidSchema)(i,n)){let u=r.var("valid",(0,Nr._)`${a} <= ${e.length}`);r.if((0,Nr.not)(u),()=>c(u)),t.ok(u)}function c(u){r.forRange("i",e.length,a,l=>{t.subschema({keyword:s,dataProp:l,dataPropType:gl.Type.Num},u),i.allErrors||r.if((0,Nr.not)(u),()=>r.break())})}}go.validateAdditionalItems=Uh;go.default=xS});var _l=z(yo=>{"use strict";Object.defineProperty(yo,"__esModule",{value:!0});yo.validateTuple=void 0;var Fh=U(),Js=X(),$S=tt(),wS={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){let{schema:e,it:r}=t;if(Array.isArray(e))return Vh(t,"additionalItems",e);r.items=!0,!(0,Js.alwaysValidSchema)(r,e)&&t.ok((0,$S.validateArray)(t))}};function Vh(t,e,r=t.schema){let{gen:n,parentSchema:o,data:s,keyword:i,it:a}=t;l(o),a.opts.unevaluated&&r.length&&a.items!==!0&&(a.items=Js.mergeEvaluated.items(n,r.length,a.items));let c=n.name("valid"),u=n.const("len",(0,Fh._)`${s}.length`);r.forEach((d,m)=>{(0,Js.alwaysValidSchema)(a,d)||(n.if((0,Fh._)`${u} > ${m}`,()=>t.subschema({keyword:i,schemaProp:m,dataProp:m},c)),t.ok(c))});function l(d){let{opts:m,errSchemaPath:f}=a,p=r.length,h=p===d.minItems&&(p===d.maxItems||d[e]===!1);if(m.strictTuples&&!h){let g=`"${i}" is ${p}-tuple, but minItems or maxItems/${e} are not specified or different at path "${f}"`;(0,Js.checkStrictMode)(a,g,m.strictTuples)}}}yo.validateTuple=Vh;yo.default=wS});var Hh=z(vl=>{"use strict";Object.defineProperty(vl,"__esModule",{value:!0});var kS=_l(),SS={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,kS.validateTuple)(t,"items")};vl.default=SS});var Kh=z(bl=>{"use strict";Object.defineProperty(bl,"__esModule",{value:!0});var Bh=U(),zS=X(),TS=tt(),ES=yl(),PS={message:({params:{len:t}})=>(0,Bh.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,Bh._)`{limit: ${t}}`},RS={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:PS,code(t){let{schema:e,parentSchema:r,it:n}=t,{prefixItems:o}=r;n.items=!0,!(0,zS.alwaysValidSchema)(n,e)&&(o?(0,ES.validateAdditionalItems)(t,o):t.ok((0,TS.validateArray)(t)))}};bl.default=RS});var Wh=z(xl=>{"use strict";Object.defineProperty(xl,"__esModule",{value:!0});var nt=U(),Xs=X(),IS={message:({params:{min:t,max:e}})=>e===void 0?(0,nt.str)`must contain at least ${t} valid item(s)`:(0,nt.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,nt._)`{minContains: ${t}}`:(0,nt._)`{minContains: ${t}, maxContains: ${e}}`},OS={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:IS,code(t){let{gen:e,schema:r,parentSchema:n,data:o,it:s}=t,i,a,{minContains:c,maxContains:u}=n;s.opts.next?(i=c===void 0?1:c,a=u):i=1;let l=e.const("len",(0,nt._)`${o}.length`);if(t.setParams({min:i,max:a}),a===void 0&&i===0){(0,Xs.checkStrictMode)(s,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&i>a){(0,Xs.checkStrictMode)(s,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,Xs.alwaysValidSchema)(s,r)){let h=(0,nt._)`${l} >= ${i}`;a!==void 0&&(h=(0,nt._)`${h} && ${l} <= ${a}`),t.pass(h);return}s.items=!0;let d=e.name("valid");a===void 0&&i===1?f(d,()=>e.if(d,()=>e.break())):i===0?(e.let(d,!0),a!==void 0&&e.if((0,nt._)`${o}.length > 0`,m)):(e.let(d,!1),m()),t.result(d,()=>t.reset());function m(){let h=e.name("_valid"),g=e.let("count",0);f(h,()=>e.if(h,()=>p(g)))}function f(h,g){e.forRange("i",0,l,v=>{t.subschema({keyword:"contains",dataProp:v,dataPropType:Xs.Type.Num,compositeRule:!0},h),g()})}function p(h){e.code((0,nt._)`${h}++`),a===void 0?e.if((0,nt._)`${h} >= ${i}`,()=>e.assign(d,!0).break()):(e.if((0,nt._)`${h} > ${a}`,()=>e.assign(d,!1).break()),i===1?e.assign(d,!0):e.if((0,nt._)`${h} >= ${i}`,()=>e.assign(d,!0)))}}};xl.default=OS});var Xh=z(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});bt.validateSchemaDeps=bt.validatePropertyDeps=bt.error=void 0;var $l=U(),NS=X(),_o=tt();bt.error={message:({params:{property:t,depsCount:e,deps:r}})=>{let n=e===1?"property":"properties";return(0,$l.str)`must have ${n} ${r} when property ${t} is present`},params:({params:{property:t,depsCount:e,deps:r,missingProperty:n}})=>(0,$l._)`{property: ${t},
    missingProperty: ${n},
    depsCount: ${e},
    deps: ${r}}`};var CS={keyword:"dependencies",type:"object",schemaType:"object",error:bt.error,code(t){let[e,r]=ZS(t);Gh(t,e),Jh(t,r)}};function ZS({schema:t}){let e={},r={};for(let n in t){if(n==="__proto__")continue;let o=Array.isArray(t[n])?e:r;o[n]=t[n]}return[e,r]}function Gh(t,e=t.schema){let{gen:r,data:n,it:o}=t;if(Object.keys(e).length===0)return;let s=r.let("missing");for(let i in e){let a=e[i];if(a.length===0)continue;let c=(0,_o.propertyInData)(r,n,i,o.opts.ownProperties);t.setParams({property:i,depsCount:a.length,deps:a.join(", ")}),o.allErrors?r.if(c,()=>{for(let u of a)(0,_o.checkReportMissingProp)(t,u)}):(r.if((0,$l._)`${c} && (${(0,_o.checkMissingProp)(t,a,s)})`),(0,_o.reportMissingProp)(t,s),r.else())}}bt.validatePropertyDeps=Gh;function Jh(t,e=t.schema){let{gen:r,data:n,keyword:o,it:s}=t,i=r.name("valid");for(let a in e)(0,NS.alwaysValidSchema)(s,e[a])||(r.if((0,_o.propertyInData)(r,n,a,s.opts.ownProperties),()=>{let c=t.subschema({keyword:o,schemaProp:a},i);t.mergeValidEvaluated(c,i)},()=>r.var(i,!0)),t.ok(i))}bt.validateSchemaDeps=Jh;bt.default=CS});var Qh=z(wl=>{"use strict";Object.defineProperty(wl,"__esModule",{value:!0});var Yh=U(),jS=X(),AS={message:"property name must be valid",params:({params:t})=>(0,Yh._)`{propertyName: ${t.propertyName}}`},MS={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:AS,code(t){let{gen:e,schema:r,data:n,it:o}=t;if((0,jS.alwaysValidSchema)(o,r))return;let s=e.name("valid");e.forIn("key",n,i=>{t.setParams({propertyName:i}),t.subschema({keyword:"propertyNames",data:i,dataTypes:["string"],propertyName:i,compositeRule:!0},s),e.if((0,Yh.not)(s),()=>{t.error(!0),o.allErrors||e.break()})}),t.ok(s)}};wl.default=MS});var Sl=z(kl=>{"use strict";Object.defineProperty(kl,"__esModule",{value:!0});var Ys=tt(),dt=U(),LS=It(),Qs=X(),DS={message:"must NOT have additional properties",params:({params:t})=>(0,dt._)`{additionalProperty: ${t.additionalProperty}}`},qS={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:DS,code(t){let{gen:e,schema:r,parentSchema:n,data:o,errsCount:s,it:i}=t;if(!s)throw new Error("ajv implementation error");let{allErrors:a,opts:c}=i;if(i.props=!0,c.removeAdditional!=="all"&&(0,Qs.alwaysValidSchema)(i,r))return;let u=(0,Ys.allSchemaProperties)(n.properties),l=(0,Ys.allSchemaProperties)(n.patternProperties);d(),t.ok((0,dt._)`${s} === ${LS.default.errors}`);function d(){e.forIn("key",o,g=>{!u.length&&!l.length?p(g):e.if(m(g),()=>p(g))})}function m(g){let v;if(u.length>8){let x=(0,Qs.schemaRefOrVal)(i,n.properties,"properties");v=(0,Ys.isOwnProperty)(e,x,g)}else u.length?v=(0,dt.or)(...u.map(x=>(0,dt._)`${g} === ${x}`)):v=dt.nil;return l.length&&(v=(0,dt.or)(v,...l.map(x=>(0,dt._)`${(0,Ys.usePattern)(t,x)}.test(${g})`))),(0,dt.not)(v)}function f(g){e.code((0,dt._)`delete ${o}[${g}]`)}function p(g){if(c.removeAdditional==="all"||c.removeAdditional&&r===!1){f(g);return}if(r===!1){t.setParams({additionalProperty:g}),t.error(),a||e.break();return}if(typeof r=="object"&&!(0,Qs.alwaysValidSchema)(i,r)){let v=e.name("valid");c.removeAdditional==="failing"?(h(g,v,!1),e.if((0,dt.not)(v),()=>{t.reset(),f(g)})):(h(g,v),a||e.if((0,dt.not)(v),()=>e.break()))}}function h(g,v,x){let b={keyword:"additionalProperties",dataProp:g,dataPropType:Qs.Type.Str};x===!1&&Object.assign(b,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema(b,v)}}};kl.default=qS});var rg=z(Tl=>{"use strict";Object.defineProperty(Tl,"__esModule",{value:!0});var US=no(),eg=tt(),zl=X(),tg=Sl(),FS={keyword:"properties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,parentSchema:n,data:o,it:s}=t;s.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&tg.default.code(new US.KeywordCxt(s,tg.default,"additionalProperties"));let i=(0,eg.allSchemaProperties)(r);for(let d of i)s.definedProperties.add(d);s.opts.unevaluated&&i.length&&s.props!==!0&&(s.props=zl.mergeEvaluated.props(e,(0,zl.toHash)(i),s.props));let a=i.filter(d=>!(0,zl.alwaysValidSchema)(s,r[d]));if(a.length===0)return;let c=e.name("valid");for(let d of a)u(d)?l(d):(e.if((0,eg.propertyInData)(e,o,d,s.opts.ownProperties)),l(d),s.allErrors||e.else().var(c,!0),e.endIf()),t.it.definedProperties.add(d),t.ok(c);function u(d){return s.opts.useDefaults&&!s.compositeRule&&r[d].default!==void 0}function l(d){t.subschema({keyword:"properties",schemaProp:d,dataProp:d},c)}}};Tl.default=FS});var ig=z(El=>{"use strict";Object.defineProperty(El,"__esModule",{value:!0});var ng=tt(),ei=U(),og=X(),sg=X(),VS={keyword:"patternProperties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,data:n,parentSchema:o,it:s}=t,{opts:i}=s,a=(0,ng.allSchemaProperties)(r),c=a.filter(h=>(0,og.alwaysValidSchema)(s,r[h]));if(a.length===0||c.length===a.length&&(!s.opts.unevaluated||s.props===!0))return;let u=i.strictSchema&&!i.allowMatchingProperties&&o.properties,l=e.name("valid");s.props!==!0&&!(s.props instanceof ei.Name)&&(s.props=(0,sg.evaluatedPropsToName)(e,s.props));let{props:d}=s;m();function m(){for(let h of a)u&&f(h),s.allErrors?p(h):(e.var(l,!0),p(h),e.if(l))}function f(h){for(let g in u)new RegExp(h).test(g)&&(0,og.checkStrictMode)(s,`property ${g} matches pattern ${h} (use allowMatchingProperties)`)}function p(h){e.forIn("key",n,g=>{e.if((0,ei._)`${(0,ng.usePattern)(t,h)}.test(${g})`,()=>{let v=c.includes(h);v||t.subschema({keyword:"patternProperties",schemaProp:h,dataProp:g,dataPropType:sg.Type.Str},l),s.opts.unevaluated&&d!==!0?e.assign((0,ei._)`${d}[${g}]`,!0):!v&&!s.allErrors&&e.if((0,ei.not)(l),()=>e.break())})})}}};El.default=VS});var ag=z(Pl=>{"use strict";Object.defineProperty(Pl,"__esModule",{value:!0});var HS=X(),BS={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){let{gen:e,schema:r,it:n}=t;if((0,HS.alwaysValidSchema)(n,r)){t.fail();return}let o=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},o),t.failResult(o,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};Pl.default=BS});var cg=z(Rl=>{"use strict";Object.defineProperty(Rl,"__esModule",{value:!0});var KS=tt(),WS={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:KS.validateUnion,error:{message:"must match a schema in anyOf"}};Rl.default=WS});var ug=z(Il=>{"use strict";Object.defineProperty(Il,"__esModule",{value:!0});var ti=U(),GS=X(),JS={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,ti._)`{passingSchemas: ${t.passing}}`},XS={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:JS,code(t){let{gen:e,schema:r,parentSchema:n,it:o}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(o.opts.discriminator&&n.discriminator)return;let s=r,i=e.let("valid",!1),a=e.let("passing",null),c=e.name("_valid");t.setParams({passing:a}),e.block(u),t.result(i,()=>t.reset(),()=>t.error(!0));function u(){s.forEach((l,d)=>{let m;(0,GS.alwaysValidSchema)(o,l)?e.var(c,!0):m=t.subschema({keyword:"oneOf",schemaProp:d,compositeRule:!0},c),d>0&&e.if((0,ti._)`${c} && ${i}`).assign(i,!1).assign(a,(0,ti._)`[${a}, ${d}]`).else(),e.if(c,()=>{e.assign(i,!0),e.assign(a,d),m&&t.mergeEvaluated(m,ti.Name)})})}}};Il.default=XS});var lg=z(Ol=>{"use strict";Object.defineProperty(Ol,"__esModule",{value:!0});var YS=X(),QS={keyword:"allOf",schemaType:"array",code(t){let{gen:e,schema:r,it:n}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");let o=e.name("valid");r.forEach((s,i)=>{if((0,YS.alwaysValidSchema)(n,s))return;let a=t.subschema({keyword:"allOf",schemaProp:i},o);t.ok(o),t.mergeEvaluated(a)})}};Ol.default=QS});var fg=z(Nl=>{"use strict";Object.defineProperty(Nl,"__esModule",{value:!0});var ri=U(),pg=X(),ez={message:({params:t})=>(0,ri.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,ri._)`{failingKeyword: ${t.ifClause}}`},tz={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:ez,code(t){let{gen:e,parentSchema:r,it:n}=t;r.then===void 0&&r.else===void 0&&(0,pg.checkStrictMode)(n,'"if" without "then" and "else" is ignored');let o=dg(n,"then"),s=dg(n,"else");if(!o&&!s)return;let i=e.let("valid",!0),a=e.name("_valid");if(c(),t.reset(),o&&s){let l=e.let("ifClause");t.setParams({ifClause:l}),e.if(a,u("then",l),u("else",l))}else o?e.if(a,u("then")):e.if((0,ri.not)(a),u("else"));t.pass(i,()=>t.error(!0));function c(){let l=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);t.mergeEvaluated(l)}function u(l,d){return()=>{let m=t.subschema({keyword:l},a);e.assign(i,a),t.mergeValidEvaluated(m,i),d?e.assign(d,(0,ri._)`${l}`):t.setParams({ifClause:l})}}}};function dg(t,e){let r=t.schema[e];return r!==void 0&&!(0,pg.alwaysValidSchema)(t,r)}Nl.default=tz});var mg=z(Cl=>{"use strict";Object.defineProperty(Cl,"__esModule",{value:!0});var rz=X(),nz={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:r}){e.if===void 0&&(0,rz.checkStrictMode)(r,`"${t}" without "if" is ignored`)}};Cl.default=nz});var hg=z(Zl=>{"use strict";Object.defineProperty(Zl,"__esModule",{value:!0});var oz=yl(),sz=Hh(),iz=_l(),az=Kh(),cz=Wh(),uz=Xh(),lz=Qh(),dz=Sl(),pz=rg(),fz=ig(),mz=ag(),hz=cg(),gz=ug(),yz=lg(),_z=fg(),vz=mg();function bz(t=!1){let e=[mz.default,hz.default,gz.default,yz.default,_z.default,vz.default,lz.default,dz.default,uz.default,pz.default,fz.default];return t?e.push(sz.default,az.default):e.push(oz.default,iz.default),e.push(cz.default),e}Zl.default=bz});var gg=z(jl=>{"use strict";Object.defineProperty(jl,"__esModule",{value:!0});var ge=U(),xz={message:({schemaCode:t})=>(0,ge.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,ge._)`{format: ${t}}`},$z={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:xz,code(t,e){let{gen:r,data:n,$data:o,schema:s,schemaCode:i,it:a}=t,{opts:c,errSchemaPath:u,schemaEnv:l,self:d}=a;if(!c.validateFormats)return;o?m():f();function m(){let p=r.scopeValue("formats",{ref:d.formats,code:c.code.formats}),h=r.const("fDef",(0,ge._)`${p}[${i}]`),g=r.let("fType"),v=r.let("format");r.if((0,ge._)`typeof ${h} == "object" && !(${h} instanceof RegExp)`,()=>r.assign(g,(0,ge._)`${h}.type || "string"`).assign(v,(0,ge._)`${h}.validate`),()=>r.assign(g,(0,ge._)`"string"`).assign(v,h)),t.fail$data((0,ge.or)(x(),b()));function x(){return c.strictSchema===!1?ge.nil:(0,ge._)`${i} && !${v}`}function b(){let S=l.$async?(0,ge._)`(${h}.async ? await ${v}(${n}) : ${v}(${n}))`:(0,ge._)`${v}(${n})`,N=(0,ge._)`(typeof ${v} == "function" ? ${S} : ${v}.test(${n}))`;return(0,ge._)`${v} && ${v} !== true && ${g} === ${e} && !${N}`}}function f(){let p=d.formats[s];if(!p){x();return}if(p===!0)return;let[h,g,v]=b(p);h===e&&t.pass(S());function x(){if(c.strictSchema===!1){d.logger.warn(N());return}throw new Error(N());function N(){return`unknown format "${s}" ignored in schema at path "${u}"`}}function b(N){let _e=N instanceof RegExp?(0,ge.regexpCode)(N):c.code.formats?(0,ge._)`${c.code.formats}${(0,ge.getProperty)(s)}`:void 0,We=r.scopeValue("formats",{key:s,ref:N,code:_e});return typeof N=="object"&&!(N instanceof RegExp)?[N.type||"string",N.validate,(0,ge._)`${We}.validate`]:["string",N,We]}function S(){if(typeof p=="object"&&!(p instanceof RegExp)&&p.async){if(!l.$async)throw new Error("async format in sync schema");return(0,ge._)`await ${v}(${n})`}return typeof g=="function"?(0,ge._)`${v}(${n})`:(0,ge._)`${v}.test(${n})`}}}};jl.default=$z});var yg=z(Al=>{"use strict";Object.defineProperty(Al,"__esModule",{value:!0});var wz=gg(),kz=[wz.default];Al.default=kz});var _g=z(ln=>{"use strict";Object.defineProperty(ln,"__esModule",{value:!0});ln.contentVocabulary=ln.metadataVocabulary=void 0;ln.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];ln.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var bg=z(Ml=>{"use strict";Object.defineProperty(Ml,"__esModule",{value:!0});var Sz=Th(),zz=qh(),Tz=hg(),Ez=yg(),vg=_g(),Pz=[Sz.default,zz.default,(0,Tz.default)(),Ez.default,vg.metadataVocabulary,vg.contentVocabulary];Ml.default=Pz});var $g=z(ni=>{"use strict";Object.defineProperty(ni,"__esModule",{value:!0});ni.DiscrError=void 0;var xg;(function(t){t.Tag="tag",t.Mapping="mapping"})(xg||(ni.DiscrError=xg={}))});var kg=z(Dl=>{"use strict";Object.defineProperty(Dl,"__esModule",{value:!0});var dn=U(),Ll=$g(),wg=Ls(),Rz=oo(),Iz=X(),Oz={message:({params:{discrError:t,tagName:e}})=>t===Ll.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:r}})=>(0,dn._)`{error: ${t}, tag: ${r}, tagValue: ${e}}`},Nz={keyword:"discriminator",type:"object",schemaType:"object",error:Oz,code(t){let{gen:e,data:r,schema:n,parentSchema:o,it:s}=t,{oneOf:i}=o;if(!s.opts.discriminator)throw new Error("discriminator: requires discriminator option");let a=n.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!i)throw new Error("discriminator: requires oneOf keyword");let c=e.let("valid",!1),u=e.const("tag",(0,dn._)`${r}${(0,dn.getProperty)(a)}`);e.if((0,dn._)`typeof ${u} == "string"`,()=>l(),()=>t.error(!1,{discrError:Ll.DiscrError.Tag,tag:u,tagName:a})),t.ok(c);function l(){let f=m();e.if(!1);for(let p in f)e.elseIf((0,dn._)`${u} === ${p}`),e.assign(c,d(f[p]));e.else(),t.error(!1,{discrError:Ll.DiscrError.Mapping,tag:u,tagName:a}),e.endIf()}function d(f){let p=e.name("valid"),h=t.subschema({keyword:"oneOf",schemaProp:f},p);return t.mergeEvaluated(h,dn.Name),p}function m(){var f;let p={},h=v(o),g=!0;for(let S=0;S<i.length;S++){let N=i[S];if(N?.$ref&&!(0,Iz.schemaHasRulesButRef)(N,s.self.RULES)){let We=N.$ref;if(N=wg.resolveRef.call(s.self,s.schemaEnv.root,s.baseId,We),N instanceof wg.SchemaEnv&&(N=N.schema),N===void 0)throw new Rz.default(s.opts.uriResolver,s.baseId,We)}let _e=(f=N?.properties)===null||f===void 0?void 0:f[a];if(typeof _e!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);g=g&&(h||v(N)),x(_e,S)}if(!g)throw new Error(`discriminator: "${a}" must be required`);return p;function v({required:S}){return Array.isArray(S)&&S.includes(a)}function x(S,N){if(S.const)b(S.const,N);else if(S.enum)for(let _e of S.enum)b(_e,N);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function b(S,N){if(typeof S!="string"||S in p)throw new Error(`discriminator: "${a}" values must be unique strings`);p[S]=N}}}};Dl.default=Nz});var Sg=z((JN,Cz)=>{Cz.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var Ul=z((ue,ql)=>{"use strict";Object.defineProperty(ue,"__esModule",{value:!0});ue.MissingRefError=ue.ValidationError=ue.CodeGen=ue.Name=ue.nil=ue.stringify=ue.str=ue._=ue.KeywordCxt=ue.Ajv=void 0;var Zz=xh(),jz=bg(),Az=kg(),zg=Sg(),Mz=["/properties"],oi="http://json-schema.org/draft-07/schema",pn=class extends Zz.default{_addVocabularies(){super._addVocabularies(),jz.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(Az.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let e=this.opts.$data?this.$dataMetaSchema(zg,Mz):zg;this.addMetaSchema(e,oi,!1),this.refs["http://json-schema.org/schema"]=oi}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(oi)?oi:void 0)}};ue.Ajv=pn;ql.exports=ue=pn;ql.exports.Ajv=pn;Object.defineProperty(ue,"__esModule",{value:!0});ue.default=pn;var Lz=no();Object.defineProperty(ue,"KeywordCxt",{enumerable:!0,get:function(){return Lz.KeywordCxt}});var fn=U();Object.defineProperty(ue,"_",{enumerable:!0,get:function(){return fn._}});Object.defineProperty(ue,"str",{enumerable:!0,get:function(){return fn.str}});Object.defineProperty(ue,"stringify",{enumerable:!0,get:function(){return fn.stringify}});Object.defineProperty(ue,"nil",{enumerable:!0,get:function(){return fn.nil}});Object.defineProperty(ue,"Name",{enumerable:!0,get:function(){return fn.Name}});Object.defineProperty(ue,"CodeGen",{enumerable:!0,get:function(){return fn.CodeGen}});var Dz=As();Object.defineProperty(ue,"ValidationError",{enumerable:!0,get:function(){return Dz.default}});var qz=oo();Object.defineProperty(ue,"MissingRefError",{enumerable:!0,get:function(){return qz.default}})});var Cg=z($t=>{"use strict";Object.defineProperty($t,"__esModule",{value:!0});$t.formatNames=$t.fastFormats=$t.fullFormats=void 0;function xt(t,e){return{validate:t,compare:e}}$t.fullFormats={date:xt(Rg,Bl),time:xt(Vl(!0),Kl),"date-time":xt(Tg(!0),Og),"iso-time":xt(Vl(),Ig),"iso-date-time":xt(Tg(),Ng),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:Kz,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:eT,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:Wz,int32:{type:"number",validate:Xz},int64:{type:"number",validate:Yz},float:{type:"number",validate:Pg},double:{type:"number",validate:Pg},password:!0,binary:!0};$t.fastFormats={...$t.fullFormats,date:xt(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,Bl),time:xt(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,Kl),"date-time":xt(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,Og),"iso-time":xt(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,Ig),"iso-date-time":xt(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,Ng),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i};$t.formatNames=Object.keys($t.fullFormats);function Uz(t){return t%4===0&&(t%100!==0||t%400===0)}var Fz=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,Vz=[0,31,28,31,30,31,30,31,31,30,31,30,31];function Rg(t){let e=Fz.exec(t);if(!e)return!1;let r=+e[1],n=+e[2],o=+e[3];return n>=1&&n<=12&&o>=1&&o<=(n===2&&Uz(r)?29:Vz[n])}function Bl(t,e){if(t&&e)return t>e?1:t<e?-1:0}var Fl=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function Vl(t){return function(r){let n=Fl.exec(r);if(!n)return!1;let o=+n[1],s=+n[2],i=+n[3],a=n[4],c=n[5]==="-"?-1:1,u=+(n[6]||0),l=+(n[7]||0);if(u>23||l>59||t&&!a)return!1;if(o<=23&&s<=59&&i<60)return!0;let d=s-l*c,m=o-u*c-(d<0?1:0);return(m===23||m===-1)&&(d===59||d===-1)&&i<61}}function Kl(t,e){if(!(t&&e))return;let r=new Date("2020-01-01T"+t).valueOf(),n=new Date("2020-01-01T"+e).valueOf();if(r&&n)return r-n}function Ig(t,e){if(!(t&&e))return;let r=Fl.exec(t),n=Fl.exec(e);if(r&&n)return t=r[1]+r[2]+r[3],e=n[1]+n[2]+n[3],t>e?1:t<e?-1:0}var Hl=/t|\s/i;function Tg(t){let e=Vl(t);return function(n){let o=n.split(Hl);return o.length===2&&Rg(o[0])&&e(o[1])}}function Og(t,e){if(!(t&&e))return;let r=new Date(t).valueOf(),n=new Date(e).valueOf();if(r&&n)return r-n}function Ng(t,e){if(!(t&&e))return;let[r,n]=t.split(Hl),[o,s]=e.split(Hl),i=Bl(r,o);if(i!==void 0)return i||Kl(n,s)}var Hz=/\/|:/,Bz=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function Kz(t){return Hz.test(t)&&Bz.test(t)}var Eg=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function Wz(t){return Eg.lastIndex=0,Eg.test(t)}var Gz=-(2**31),Jz=2**31-1;function Xz(t){return Number.isInteger(t)&&t<=Jz&&t>=Gz}function Yz(t){return Number.isInteger(t)}function Pg(){return!0}var Qz=/[^\\]\\Z/;function eT(t){if(Qz.test(t))return!1;try{return new RegExp(t),!0}catch{return!1}}});var Zg=z(mn=>{"use strict";Object.defineProperty(mn,"__esModule",{value:!0});mn.formatLimitDefinition=void 0;var tT=Ul(),pt=U(),Xt=pt.operators,si={formatMaximum:{okStr:"<=",ok:Xt.LTE,fail:Xt.GT},formatMinimum:{okStr:">=",ok:Xt.GTE,fail:Xt.LT},formatExclusiveMaximum:{okStr:"<",ok:Xt.LT,fail:Xt.GTE},formatExclusiveMinimum:{okStr:">",ok:Xt.GT,fail:Xt.LTE}},rT={message:({keyword:t,schemaCode:e})=>(0,pt.str)`should be ${si[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,pt._)`{comparison: ${si[t].okStr}, limit: ${e}}`};mn.formatLimitDefinition={keyword:Object.keys(si),type:"string",schemaType:"string",$data:!0,error:rT,code(t){let{gen:e,data:r,schemaCode:n,keyword:o,it:s}=t,{opts:i,self:a}=s;if(!i.validateFormats)return;let c=new tT.KeywordCxt(s,a.RULES.all.format.definition,"format");c.$data?u():l();function u(){let m=e.scopeValue("formats",{ref:a.formats,code:i.code.formats}),f=e.const("fmt",(0,pt._)`${m}[${c.schemaCode}]`);t.fail$data((0,pt.or)((0,pt._)`typeof ${f} != "object"`,(0,pt._)`${f} instanceof RegExp`,(0,pt._)`typeof ${f}.compare != "function"`,d(f)))}function l(){let m=c.schema,f=a.formats[m];if(!f||f===!0)return;if(typeof f!="object"||f instanceof RegExp||typeof f.compare!="function")throw new Error(`"${o}": format "${m}" does not define "compare" function`);let p=e.scopeValue("formats",{key:m,ref:f,code:i.code.formats?(0,pt._)`${i.code.formats}${(0,pt.getProperty)(m)}`:void 0});t.fail$data(d(p))}function d(m){return(0,pt._)`${m}.compare(${r}, ${n}) ${si[o].fail} 0`}},dependencies:["format"]};var nT=t=>(t.addKeyword(mn.formatLimitDefinition),t);mn.default=nT});var Lg=z((vo,Mg)=>{"use strict";Object.defineProperty(vo,"__esModule",{value:!0});var hn=Cg(),oT=Zg(),Wl=U(),jg=new Wl.Name("fullFormats"),sT=new Wl.Name("fastFormats"),Gl=(t,e={keywords:!0})=>{if(Array.isArray(e))return Ag(t,e,hn.fullFormats,jg),t;let[r,n]=e.mode==="fast"?[hn.fastFormats,sT]:[hn.fullFormats,jg],o=e.formats||hn.formatNames;return Ag(t,o,r,n),e.keywords&&(0,oT.default)(t),t};Gl.get=(t,e="full")=>{let n=(e==="fast"?hn.fastFormats:hn.fullFormats)[t];if(!n)throw new Error(`Unknown format "${t}"`);return n};function Ag(t,e,r,n){var o,s;(o=(s=t.opts.code).formats)!==null&&o!==void 0||(s.formats=(0,Wl._)`require("ajv-formats/dist/formats").${n}`);for(let i of e)t.addFormat(i,r[i])}Mg.exports=vo=Gl;Object.defineProperty(vo,"__esModule",{value:!0});vo.default=Gl});var K={};xi(K,{BRAND:()=>Hy,DIRTY:()=>tr,EMPTY_PATH:()=>wy,INVALID:()=>Z,NEVER:()=>E_,OK:()=>Te,ParseStatus:()=>be,Schema:()=>q,ZodAny:()=>jt,ZodArray:()=>Tt,ZodBigInt:()=>nr,ZodBoolean:()=>or,ZodBranded:()=>_n,ZodCatch:()=>hr,ZodDate:()=>sr,ZodDefault:()=>mr,ZodDiscriminatedUnion:()=>zo,ZodEffects:()=>Je,ZodEnum:()=>pr,ZodError:()=>je,ZodFirstPartyTypeKind:()=>w,ZodFunction:()=>Eo,ZodIntersection:()=>ur,ZodIssueCode:()=>$,ZodLazy:()=>lr,ZodLiteral:()=>dr,ZodMap:()=>qr,ZodNaN:()=>Fr,ZodNativeEnum:()=>fr,ZodNever:()=>ot,ZodNull:()=>ar,ZodNullable:()=>ht,ZodNumber:()=>rr,ZodObject:()=>Me,ZodOptional:()=>Ae,ZodParsedType:()=>T,ZodPipeline:()=>vn,ZodPromise:()=>At,ZodReadonly:()=>gr,ZodRecord:()=>To,ZodSchema:()=>q,ZodSet:()=>Ur,ZodString:()=>Zt,ZodSymbol:()=>Lr,ZodTransformer:()=>Je,ZodTuple:()=>mt,ZodType:()=>q,ZodUndefined:()=>ir,ZodUnion:()=>cr,ZodUnknown:()=>zt,ZodVoid:()=>Dr,addIssueToContext:()=>k,any:()=>e_,array:()=>o_,bigint:()=>Gy,boolean:()=>gd,coerce:()=>T_,custom:()=>fd,date:()=>Jy,datetimeRegex:()=>dd,defaultErrorMap:()=>kt,discriminatedUnion:()=>a_,effect:()=>v_,enum:()=>g_,function:()=>f_,getErrorMap:()=>jr,getParsedType:()=>ft,instanceof:()=>Ky,intersection:()=>c_,isAborted:()=>ko,isAsync:()=>Ar,isDirty:()=>So,isValid:()=>Ct,late:()=>By,lazy:()=>m_,literal:()=>h_,makeIssue:()=>yn,map:()=>d_,nan:()=>Wy,nativeEnum:()=>y_,never:()=>r_,null:()=>Qy,nullable:()=>x_,number:()=>hd,object:()=>Si,objectUtil:()=>$i,oboolean:()=>z_,onumber:()=>S_,optional:()=>b_,ostring:()=>k_,pipeline:()=>w_,preprocess:()=>$_,promise:()=>__,quotelessJson:()=>by,record:()=>l_,set:()=>p_,setErrorMap:()=>$y,strictObject:()=>s_,string:()=>md,symbol:()=>Xy,transformer:()=>v_,tuple:()=>u_,undefined:()=>Yy,union:()=>i_,unknown:()=>t_,util:()=>H,void:()=>n_});var H;(function(t){t.assertEqual=o=>{};function e(o){}t.assertIs=e;function r(o){throw new Error}t.assertNever=r,t.arrayToEnum=o=>{let s={};for(let i of o)s[i]=i;return s},t.getValidEnumValues=o=>{let s=t.objectKeys(o).filter(a=>typeof o[o[a]]!="number"),i={};for(let a of s)i[a]=o[a];return t.objectValues(i)},t.objectValues=o=>t.objectKeys(o).map(function(s){return o[s]}),t.objectKeys=typeof Object.keys=="function"?o=>Object.keys(o):o=>{let s=[];for(let i in o)Object.prototype.hasOwnProperty.call(o,i)&&s.push(i);return s},t.find=(o,s)=>{for(let i of o)if(s(i))return i},t.isInteger=typeof Number.isInteger=="function"?o=>Number.isInteger(o):o=>typeof o=="number"&&Number.isFinite(o)&&Math.floor(o)===o;function n(o,s=" | "){return o.map(i=>typeof i=="string"?`'${i}'`:i).join(s)}t.joinValues=n,t.jsonStringifyReplacer=(o,s)=>typeof s=="bigint"?s.toString():s})(H||(H={}));var $i;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})($i||($i={}));var T=H.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ft=t=>{switch(typeof t){case"undefined":return T.undefined;case"string":return T.string;case"number":return Number.isNaN(t)?T.nan:T.number;case"boolean":return T.boolean;case"function":return T.function;case"bigint":return T.bigint;case"symbol":return T.symbol;case"object":return Array.isArray(t)?T.array:t===null?T.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?T.promise:typeof Map<"u"&&t instanceof Map?T.map:typeof Set<"u"&&t instanceof Set?T.set:typeof Date<"u"&&t instanceof Date?T.date:T.object;default:return T.unknown}};var $=H.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),by=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),je=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(s){return s.message},n={_errors:[]},o=s=>{for(let i of s.issues)if(i.code==="invalid_union")i.unionErrors.map(o);else if(i.code==="invalid_return_type")o(i.returnTypeError);else if(i.code==="invalid_arguments")o(i.argumentsError);else if(i.path.length===0)n._errors.push(r(i));else{let a=n,c=0;for(;c<i.path.length;){let u=i.path[c];c===i.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(r(i))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return o(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,H.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let o of this.issues)if(o.path.length>0){let s=o.path[0];r[s]=r[s]||[],r[s].push(e(o))}else n.push(e(o));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};je.create=t=>new je(t);var xy=(t,e)=>{let r;switch(t.code){case $.invalid_type:t.received===T.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case $.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,H.jsonStringifyReplacer)}`;break;case $.unrecognized_keys:r=`Unrecognized key(s) in object: ${H.joinValues(t.keys,", ")}`;break;case $.invalid_union:r="Invalid input";break;case $.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${H.joinValues(t.options)}`;break;case $.invalid_enum_value:r=`Invalid enum value. Expected ${H.joinValues(t.options)}, received '${t.received}'`;break;case $.invalid_arguments:r="Invalid function arguments";break;case $.invalid_return_type:r="Invalid function return type";break;case $.invalid_date:r="Invalid date";break;case $.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:H.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case $.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case $.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case $.custom:r="Invalid input";break;case $.invalid_intersection_types:r="Intersection results could not be merged";break;case $.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case $.not_finite:r="Number must be finite";break;default:r=e.defaultError,H.assertNever(t)}return{message:r}},kt=xy;var id=kt;function $y(t){id=t}function jr(){return id}var yn=t=>{let{data:e,path:r,errorMaps:n,issueData:o}=t,s=[...r,...o.path||[]],i={...o,path:s};if(o.message!==void 0)return{...o,path:s,message:o.message};let a="",c=n.filter(u=>!!u).slice().reverse();for(let u of c)a=u(i,{data:e,defaultError:a}).message;return{...o,path:s,message:a}},wy=[];function k(t,e){let r=jr(),n=yn({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===kt?void 0:kt].filter(o=>!!o)});t.common.issues.push(n)}var be=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let n=[];for(let o of r){if(o.status==="aborted")return Z;o.status==="dirty"&&e.dirty(),n.push(o.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let o of r){let s=await o.key,i=await o.value;n.push({key:s,value:i})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let o of r){let{key:s,value:i}=o;if(s.status==="aborted"||i.status==="aborted")return Z;s.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof i.value<"u"||o.alwaysSet)&&(n[s.value]=i.value)}return{status:e.value,value:n}}},Z=Object.freeze({status:"aborted"}),tr=t=>({status:"dirty",value:t}),Te=t=>({status:"valid",value:t}),ko=t=>t.status==="aborted",So=t=>t.status==="dirty",Ct=t=>t.status==="valid",Ar=t=>typeof Promise<"u"&&t instanceof Promise;var P;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(P||(P={}));var Ge=class{constructor(e,r,n,o){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=o}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},ad=(t,e)=>{if(Ct(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new je(t.common.issues);return this._error=r,this._error}}};function L(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:o}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:o}:{errorMap:(i,a)=>{let{message:c}=t;return i.code==="invalid_enum_value"?{message:c??a.defaultError}:typeof a.data>"u"?{message:c??n??a.defaultError}:i.code!=="invalid_type"?{message:a.defaultError}:{message:c??r??a.defaultError}},description:o}}var q=class{get description(){return this._def.description}_getType(e){return ft(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new be,ctx:{common:e.parent.common,data:e.data,parsedType:ft(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(Ar(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ft(e)},o=this._parseSync({data:e,path:n.path,parent:n});return ad(n,o)}"~validate"(e){let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ft(e)};if(!this["~standard"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return Ct(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>Ct(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ft(e)},o=this._parse({data:e,path:n.path,parent:n}),s=await(Ar(o)?o:Promise.resolve(o));return ad(n,s)}refine(e,r){let n=o=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(o):r;return this._refinement((o,s)=>{let i=e(o),a=()=>s.addIssue({code:$.custom,...n(o)});return typeof Promise<"u"&&i instanceof Promise?i.then(c=>c?!0:(a(),!1)):i?!0:(a(),!1)})}refinement(e,r){return this._refinement((n,o)=>e(n)?!0:(o.addIssue(typeof r=="function"?r(n,o):r),!1))}_refinement(e){return new Je({schema:this,typeName:w.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Ae.create(this,this._def)}nullable(){return ht.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Tt.create(this)}promise(){return At.create(this,this._def)}or(e){return cr.create([this,e],this._def)}and(e){return ur.create(this,e,this._def)}transform(e){return new Je({...L(this._def),schema:this,typeName:w.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new mr({...L(this._def),innerType:this,defaultValue:r,typeName:w.ZodDefault})}brand(){return new _n({typeName:w.ZodBranded,type:this,...L(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new hr({...L(this._def),innerType:this,catchValue:r,typeName:w.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return vn.create(this,e)}readonly(){return gr.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},ky=/^c[^\s-]{8,}$/i,Sy=/^[0-9a-z]+$/,zy=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Ty=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Ey=/^[a-z0-9_-]{21}$/i,Py=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Ry=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Iy=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Oy="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",wi,Ny=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Cy=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Zy=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,jy=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Ay=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,My=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,ud="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Ly=new RegExp(`^${ud}$`);function ld(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);let r=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${r}`}function Dy(t){return new RegExp(`^${ld(t)}$`)}function dd(t){let e=`${ud}T${ld(t)}`,r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function qy(t,e){return!!((e==="v4"||!e)&&Ny.test(t)||(e==="v6"||!e)&&Zy.test(t))}function Uy(t,e){if(!Py.test(t))return!1;try{let[r]=t.split(".");if(!r)return!1;let n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),o=JSON.parse(atob(n));return!(typeof o!="object"||o===null||"typ"in o&&o?.typ!=="JWT"||!o.alg||e&&o.alg!==e)}catch{return!1}}function Fy(t,e){return!!((e==="v4"||!e)&&Cy.test(t)||(e==="v6"||!e)&&jy.test(t))}var Zt=class t extends q{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==T.string){let s=this._getOrReturnCtx(e);return k(s,{code:$.invalid_type,expected:T.string,received:s.parsedType}),Z}let n=new be,o;for(let s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(o=this._getOrReturnCtx(e,o),k(o,{code:$.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="max")e.data.length>s.value&&(o=this._getOrReturnCtx(e,o),k(o,{code:$.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="length"){let i=e.data.length>s.value,a=e.data.length<s.value;(i||a)&&(o=this._getOrReturnCtx(e,o),i?k(o,{code:$.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):a&&k(o,{code:$.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),n.dirty())}else if(s.kind==="email")Iy.test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"email",code:$.invalid_string,message:s.message}),n.dirty());else if(s.kind==="emoji")wi||(wi=new RegExp(Oy,"u")),wi.test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"emoji",code:$.invalid_string,message:s.message}),n.dirty());else if(s.kind==="uuid")Ty.test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"uuid",code:$.invalid_string,message:s.message}),n.dirty());else if(s.kind==="nanoid")Ey.test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"nanoid",code:$.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid")ky.test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"cuid",code:$.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid2")Sy.test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"cuid2",code:$.invalid_string,message:s.message}),n.dirty());else if(s.kind==="ulid")zy.test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"ulid",code:$.invalid_string,message:s.message}),n.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{o=this._getOrReturnCtx(e,o),k(o,{validation:"url",code:$.invalid_string,message:s.message}),n.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"regex",code:$.invalid_string,message:s.message}),n.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(o=this._getOrReturnCtx(e,o),k(o,{code:$.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),n.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(o=this._getOrReturnCtx(e,o),k(o,{code:$.invalid_string,validation:{startsWith:s.value},message:s.message}),n.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(o=this._getOrReturnCtx(e,o),k(o,{code:$.invalid_string,validation:{endsWith:s.value},message:s.message}),n.dirty()):s.kind==="datetime"?dd(s).test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{code:$.invalid_string,validation:"datetime",message:s.message}),n.dirty()):s.kind==="date"?Ly.test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{code:$.invalid_string,validation:"date",message:s.message}),n.dirty()):s.kind==="time"?Dy(s).test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{code:$.invalid_string,validation:"time",message:s.message}),n.dirty()):s.kind==="duration"?Ry.test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"duration",code:$.invalid_string,message:s.message}),n.dirty()):s.kind==="ip"?qy(e.data,s.version)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"ip",code:$.invalid_string,message:s.message}),n.dirty()):s.kind==="jwt"?Uy(e.data,s.alg)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"jwt",code:$.invalid_string,message:s.message}),n.dirty()):s.kind==="cidr"?Fy(e.data,s.version)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"cidr",code:$.invalid_string,message:s.message}),n.dirty()):s.kind==="base64"?Ay.test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"base64",code:$.invalid_string,message:s.message}),n.dirty()):s.kind==="base64url"?My.test(e.data)||(o=this._getOrReturnCtx(e,o),k(o,{validation:"base64url",code:$.invalid_string,message:s.message}),n.dirty()):H.assertNever(s);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(o=>e.test(o),{validation:r,code:$.invalid_string,...P.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...P.errToObj(e)})}url(e){return this._addCheck({kind:"url",...P.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...P.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...P.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...P.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...P.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...P.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...P.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...P.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...P.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...P.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...P.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...P.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...P.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...P.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...P.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...P.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...P.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...P.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...P.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...P.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...P.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...P.errToObj(r)})}nonempty(e){return this.min(1,P.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Zt.create=t=>new Zt({checks:[],typeName:w.ZodString,coerce:t?.coerce??!1,...L(t)});function Vy(t,e){let r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,o=r>n?r:n,s=Number.parseInt(t.toFixed(o).replace(".","")),i=Number.parseInt(e.toFixed(o).replace(".",""));return s%i/10**o}var rr=class t extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==T.number){let s=this._getOrReturnCtx(e);return k(s,{code:$.invalid_type,expected:T.number,received:s.parsedType}),Z}let n,o=new be;for(let s of this._def.checks)s.kind==="int"?H.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:$.invalid_type,expected:"integer",received:"float",message:s.message}),o.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:$.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),o.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:$.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),o.dirty()):s.kind==="multipleOf"?Vy(e.data,s.value)!==0&&(n=this._getOrReturnCtx(e,n),k(n,{code:$.not_multiple_of,multipleOf:s.value,message:s.message}),o.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),k(n,{code:$.not_finite,message:s.message}),o.dirty()):H.assertNever(s);return{status:o.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,P.toString(r))}gt(e,r){return this.setLimit("min",e,!1,P.toString(r))}lte(e,r){return this.setLimit("max",e,!0,P.toString(r))}lt(e,r){return this.setLimit("max",e,!1,P.toString(r))}setLimit(e,r,n,o){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:P.toString(o)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:P.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:P.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:P.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:P.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:P.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:P.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:P.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:P.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:P.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&H.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}};rr.create=t=>new rr({checks:[],typeName:w.ZodNumber,coerce:t?.coerce||!1,...L(t)});var nr=class t extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==T.bigint)return this._getInvalidInput(e);let n,o=new be;for(let s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:$.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),o.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),k(n,{code:$.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),o.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),k(n,{code:$.not_multiple_of,multipleOf:s.value,message:s.message}),o.dirty()):H.assertNever(s);return{status:o.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return k(r,{code:$.invalid_type,expected:T.bigint,received:r.parsedType}),Z}gte(e,r){return this.setLimit("min",e,!0,P.toString(r))}gt(e,r){return this.setLimit("min",e,!1,P.toString(r))}lte(e,r){return this.setLimit("max",e,!0,P.toString(r))}lt(e,r){return this.setLimit("max",e,!1,P.toString(r))}setLimit(e,r,n,o){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:P.toString(o)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:P.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:P.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:P.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:P.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:P.toString(r)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};nr.create=t=>new nr({checks:[],typeName:w.ZodBigInt,coerce:t?.coerce??!1,...L(t)});var or=class extends q{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==T.boolean){let n=this._getOrReturnCtx(e);return k(n,{code:$.invalid_type,expected:T.boolean,received:n.parsedType}),Z}return Te(e.data)}};or.create=t=>new or({typeName:w.ZodBoolean,coerce:t?.coerce||!1,...L(t)});var sr=class t extends q{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==T.date){let s=this._getOrReturnCtx(e);return k(s,{code:$.invalid_type,expected:T.date,received:s.parsedType}),Z}if(Number.isNaN(e.data.getTime())){let s=this._getOrReturnCtx(e);return k(s,{code:$.invalid_date}),Z}let n=new be,o;for(let s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(o=this._getOrReturnCtx(e,o),k(o,{code:$.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),n.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(o=this._getOrReturnCtx(e,o),k(o,{code:$.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),n.dirty()):H.assertNever(s);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:P.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:P.toString(r)})}get minDate(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}};sr.create=t=>new sr({checks:[],coerce:t?.coerce||!1,typeName:w.ZodDate,...L(t)});var Lr=class extends q{_parse(e){if(this._getType(e)!==T.symbol){let n=this._getOrReturnCtx(e);return k(n,{code:$.invalid_type,expected:T.symbol,received:n.parsedType}),Z}return Te(e.data)}};Lr.create=t=>new Lr({typeName:w.ZodSymbol,...L(t)});var ir=class extends q{_parse(e){if(this._getType(e)!==T.undefined){let n=this._getOrReturnCtx(e);return k(n,{code:$.invalid_type,expected:T.undefined,received:n.parsedType}),Z}return Te(e.data)}};ir.create=t=>new ir({typeName:w.ZodUndefined,...L(t)});var ar=class extends q{_parse(e){if(this._getType(e)!==T.null){let n=this._getOrReturnCtx(e);return k(n,{code:$.invalid_type,expected:T.null,received:n.parsedType}),Z}return Te(e.data)}};ar.create=t=>new ar({typeName:w.ZodNull,...L(t)});var jt=class extends q{constructor(){super(...arguments),this._any=!0}_parse(e){return Te(e.data)}};jt.create=t=>new jt({typeName:w.ZodAny,...L(t)});var zt=class extends q{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Te(e.data)}};zt.create=t=>new zt({typeName:w.ZodUnknown,...L(t)});var ot=class extends q{_parse(e){let r=this._getOrReturnCtx(e);return k(r,{code:$.invalid_type,expected:T.never,received:r.parsedType}),Z}};ot.create=t=>new ot({typeName:w.ZodNever,...L(t)});var Dr=class extends q{_parse(e){if(this._getType(e)!==T.undefined){let n=this._getOrReturnCtx(e);return k(n,{code:$.invalid_type,expected:T.void,received:n.parsedType}),Z}return Te(e.data)}};Dr.create=t=>new Dr({typeName:w.ZodVoid,...L(t)});var Tt=class t extends q{_parse(e){let{ctx:r,status:n}=this._processInputParams(e),o=this._def;if(r.parsedType!==T.array)return k(r,{code:$.invalid_type,expected:T.array,received:r.parsedType}),Z;if(o.exactLength!==null){let i=r.data.length>o.exactLength.value,a=r.data.length<o.exactLength.value;(i||a)&&(k(r,{code:i?$.too_big:$.too_small,minimum:a?o.exactLength.value:void 0,maximum:i?o.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:o.exactLength.message}),n.dirty())}if(o.minLength!==null&&r.data.length<o.minLength.value&&(k(r,{code:$.too_small,minimum:o.minLength.value,type:"array",inclusive:!0,exact:!1,message:o.minLength.message}),n.dirty()),o.maxLength!==null&&r.data.length>o.maxLength.value&&(k(r,{code:$.too_big,maximum:o.maxLength.value,type:"array",inclusive:!0,exact:!1,message:o.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((i,a)=>o.type._parseAsync(new Ge(r,i,r.path,a)))).then(i=>be.mergeArray(n,i));let s=[...r.data].map((i,a)=>o.type._parseSync(new Ge(r,i,r.path,a)));return be.mergeArray(n,s)}get element(){return this._def.type}min(e,r){return new t({...this._def,minLength:{value:e,message:P.toString(r)}})}max(e,r){return new t({...this._def,maxLength:{value:e,message:P.toString(r)}})}length(e,r){return new t({...this._def,exactLength:{value:e,message:P.toString(r)}})}nonempty(e){return this.min(1,e)}};Tt.create=(t,e)=>new Tt({type:t,minLength:null,maxLength:null,exactLength:null,typeName:w.ZodArray,...L(e)});function Mr(t){if(t instanceof Me){let e={};for(let r in t.shape){let n=t.shape[r];e[r]=Ae.create(Mr(n))}return new Me({...t._def,shape:()=>e})}else return t instanceof Tt?new Tt({...t._def,type:Mr(t.element)}):t instanceof Ae?Ae.create(Mr(t.unwrap())):t instanceof ht?ht.create(Mr(t.unwrap())):t instanceof mt?mt.create(t.items.map(e=>Mr(e))):t}var Me=class t extends q{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),r=H.objectKeys(e);return this._cached={shape:e,keys:r},this._cached}_parse(e){if(this._getType(e)!==T.object){let u=this._getOrReturnCtx(e);return k(u,{code:$.invalid_type,expected:T.object,received:u.parsedType}),Z}let{status:n,ctx:o}=this._processInputParams(e),{shape:s,keys:i}=this._getCached(),a=[];if(!(this._def.catchall instanceof ot&&this._def.unknownKeys==="strip"))for(let u in o.data)i.includes(u)||a.push(u);let c=[];for(let u of i){let l=s[u],d=o.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new Ge(o,d,o.path,u)),alwaysSet:u in o.data})}if(this._def.catchall instanceof ot){let u=this._def.unknownKeys;if(u==="passthrough")for(let l of a)c.push({key:{status:"valid",value:l},value:{status:"valid",value:o.data[l]}});else if(u==="strict")a.length>0&&(k(o,{code:$.unrecognized_keys,keys:a}),n.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let l of a){let d=o.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new Ge(o,d,o.path,l)),alwaysSet:l in o.data})}}return o.common.async?Promise.resolve().then(async()=>{let u=[];for(let l of c){let d=await l.key,m=await l.value;u.push({key:d,value:m,alwaysSet:l.alwaysSet})}return u}).then(u=>be.mergeObjectSync(n,u)):be.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(e){return P.errToObj,new t({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,n)=>{let o=this._def.errorMap?.(r,n).message??n.defaultError;return r.code==="unrecognized_keys"?{message:P.errToObj(e).message??o}:{message:o}}}:{}})}strip(){return new t({...this._def,unknownKeys:"strip"})}passthrough(){return new t({...this._def,unknownKeys:"passthrough"})}extend(e){return new t({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new t({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:w.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new t({...this._def,catchall:e})}pick(e){let r={};for(let n of H.objectKeys(e))e[n]&&this.shape[n]&&(r[n]=this.shape[n]);return new t({...this._def,shape:()=>r})}omit(e){let r={};for(let n of H.objectKeys(this.shape))e[n]||(r[n]=this.shape[n]);return new t({...this._def,shape:()=>r})}deepPartial(){return Mr(this)}partial(e){let r={};for(let n of H.objectKeys(this.shape)){let o=this.shape[n];e&&!e[n]?r[n]=o:r[n]=o.optional()}return new t({...this._def,shape:()=>r})}required(e){let r={};for(let n of H.objectKeys(this.shape))if(e&&!e[n])r[n]=this.shape[n];else{let s=this.shape[n];for(;s instanceof Ae;)s=s._def.innerType;r[n]=s}return new t({...this._def,shape:()=>r})}keyof(){return pd(H.objectKeys(this.shape))}};Me.create=(t,e)=>new Me({shape:()=>t,unknownKeys:"strip",catchall:ot.create(),typeName:w.ZodObject,...L(e)});Me.strictCreate=(t,e)=>new Me({shape:()=>t,unknownKeys:"strict",catchall:ot.create(),typeName:w.ZodObject,...L(e)});Me.lazycreate=(t,e)=>new Me({shape:t,unknownKeys:"strip",catchall:ot.create(),typeName:w.ZodObject,...L(e)});var cr=class extends q{_parse(e){let{ctx:r}=this._processInputParams(e),n=this._def.options;function o(s){for(let a of s)if(a.result.status==="valid")return a.result;for(let a of s)if(a.result.status==="dirty")return r.common.issues.push(...a.ctx.common.issues),a.result;let i=s.map(a=>new je(a.ctx.common.issues));return k(r,{code:$.invalid_union,unionErrors:i}),Z}if(r.common.async)return Promise.all(n.map(async s=>{let i={...r,common:{...r.common,issues:[]},parent:null};return{result:await s._parseAsync({data:r.data,path:r.path,parent:i}),ctx:i}})).then(o);{let s,i=[];for(let c of n){let u={...r,common:{...r.common,issues:[]},parent:null},l=c._parseSync({data:r.data,path:r.path,parent:u});if(l.status==="valid")return l;l.status==="dirty"&&!s&&(s={result:l,ctx:u}),u.common.issues.length&&i.push(u.common.issues)}if(s)return r.common.issues.push(...s.ctx.common.issues),s.result;let a=i.map(c=>new je(c));return k(r,{code:$.invalid_union,unionErrors:a}),Z}}get options(){return this._def.options}};cr.create=(t,e)=>new cr({options:t,typeName:w.ZodUnion,...L(e)});var St=t=>t instanceof lr?St(t.schema):t instanceof Je?St(t.innerType()):t instanceof dr?[t.value]:t instanceof pr?t.options:t instanceof fr?H.objectValues(t.enum):t instanceof mr?St(t._def.innerType):t instanceof ir?[void 0]:t instanceof ar?[null]:t instanceof Ae?[void 0,...St(t.unwrap())]:t instanceof ht?[null,...St(t.unwrap())]:t instanceof _n||t instanceof gr?St(t.unwrap()):t instanceof hr?St(t._def.innerType):[],zo=class t extends q{_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==T.object)return k(r,{code:$.invalid_type,expected:T.object,received:r.parsedType}),Z;let n=this.discriminator,o=r.data[n],s=this.optionsMap.get(o);return s?r.common.async?s._parseAsync({data:r.data,path:r.path,parent:r}):s._parseSync({data:r.data,path:r.path,parent:r}):(k(r,{code:$.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),Z)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,n){let o=new Map;for(let s of r){let i=St(s.shape[e]);if(!i.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of i){if(o.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);o.set(a,s)}}return new t({typeName:w.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:o,...L(n)})}};function ki(t,e){let r=ft(t),n=ft(e);if(t===e)return{valid:!0,data:t};if(r===T.object&&n===T.object){let o=H.objectKeys(e),s=H.objectKeys(t).filter(a=>o.indexOf(a)!==-1),i={...t,...e};for(let a of s){let c=ki(t[a],e[a]);if(!c.valid)return{valid:!1};i[a]=c.data}return{valid:!0,data:i}}else if(r===T.array&&n===T.array){if(t.length!==e.length)return{valid:!1};let o=[];for(let s=0;s<t.length;s++){let i=t[s],a=e[s],c=ki(i,a);if(!c.valid)return{valid:!1};o.push(c.data)}return{valid:!0,data:o}}else return r===T.date&&n===T.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var ur=class extends q{_parse(e){let{status:r,ctx:n}=this._processInputParams(e),o=(s,i)=>{if(ko(s)||ko(i))return Z;let a=ki(s.value,i.value);return a.valid?((So(s)||So(i))&&r.dirty(),{status:r.value,value:a.data}):(k(n,{code:$.invalid_intersection_types}),Z)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([s,i])=>o(s,i)):o(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};ur.create=(t,e,r)=>new ur({left:t,right:e,typeName:w.ZodIntersection,...L(r)});var mt=class t extends q{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==T.array)return k(n,{code:$.invalid_type,expected:T.array,received:n.parsedType}),Z;if(n.data.length<this._def.items.length)return k(n,{code:$.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Z;!this._def.rest&&n.data.length>this._def.items.length&&(k(n,{code:$.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());let s=[...n.data].map((i,a)=>{let c=this._def.items[a]||this._def.rest;return c?c._parse(new Ge(n,i,n.path,a)):null}).filter(i=>!!i);return n.common.async?Promise.all(s).then(i=>be.mergeArray(r,i)):be.mergeArray(r,s)}get items(){return this._def.items}rest(e){return new t({...this._def,rest:e})}};mt.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new mt({items:t,typeName:w.ZodTuple,rest:null,...L(e)})};var To=class t extends q{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==T.object)return k(n,{code:$.invalid_type,expected:T.object,received:n.parsedType}),Z;let o=[],s=this._def.keyType,i=this._def.valueType;for(let a in n.data)o.push({key:s._parse(new Ge(n,a,n.path,a)),value:i._parse(new Ge(n,n.data[a],n.path,a)),alwaysSet:a in n.data});return n.common.async?be.mergeObjectAsync(r,o):be.mergeObjectSync(r,o)}get element(){return this._def.valueType}static create(e,r,n){return r instanceof q?new t({keyType:e,valueType:r,typeName:w.ZodRecord,...L(n)}):new t({keyType:Zt.create(),valueType:e,typeName:w.ZodRecord,...L(r)})}},qr=class extends q{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==T.map)return k(n,{code:$.invalid_type,expected:T.map,received:n.parsedType}),Z;let o=this._def.keyType,s=this._def.valueType,i=[...n.data.entries()].map(([a,c],u)=>({key:o._parse(new Ge(n,a,n.path,[u,"key"])),value:s._parse(new Ge(n,c,n.path,[u,"value"]))}));if(n.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of i){let u=await c.key,l=await c.value;if(u.status==="aborted"||l.status==="aborted")return Z;(u.status==="dirty"||l.status==="dirty")&&r.dirty(),a.set(u.value,l.value)}return{status:r.value,value:a}})}else{let a=new Map;for(let c of i){let u=c.key,l=c.value;if(u.status==="aborted"||l.status==="aborted")return Z;(u.status==="dirty"||l.status==="dirty")&&r.dirty(),a.set(u.value,l.value)}return{status:r.value,value:a}}}};qr.create=(t,e,r)=>new qr({valueType:e,keyType:t,typeName:w.ZodMap,...L(r)});var Ur=class t extends q{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==T.set)return k(n,{code:$.invalid_type,expected:T.set,received:n.parsedType}),Z;let o=this._def;o.minSize!==null&&n.data.size<o.minSize.value&&(k(n,{code:$.too_small,minimum:o.minSize.value,type:"set",inclusive:!0,exact:!1,message:o.minSize.message}),r.dirty()),o.maxSize!==null&&n.data.size>o.maxSize.value&&(k(n,{code:$.too_big,maximum:o.maxSize.value,type:"set",inclusive:!0,exact:!1,message:o.maxSize.message}),r.dirty());let s=this._def.valueType;function i(c){let u=new Set;for(let l of c){if(l.status==="aborted")return Z;l.status==="dirty"&&r.dirty(),u.add(l.value)}return{status:r.value,value:u}}let a=[...n.data.values()].map((c,u)=>s._parse(new Ge(n,c,n.path,u)));return n.common.async?Promise.all(a).then(c=>i(c)):i(a)}min(e,r){return new t({...this._def,minSize:{value:e,message:P.toString(r)}})}max(e,r){return new t({...this._def,maxSize:{value:e,message:P.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}};Ur.create=(t,e)=>new Ur({valueType:t,minSize:null,maxSize:null,typeName:w.ZodSet,...L(e)});var Eo=class t extends q{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==T.function)return k(r,{code:$.invalid_type,expected:T.function,received:r.parsedType}),Z;function n(a,c){return yn({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,jr(),kt].filter(u=>!!u),issueData:{code:$.invalid_arguments,argumentsError:c}})}function o(a,c){return yn({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,jr(),kt].filter(u=>!!u),issueData:{code:$.invalid_return_type,returnTypeError:c}})}let s={errorMap:r.common.contextualErrorMap},i=r.data;if(this._def.returns instanceof At){let a=this;return Te(async function(...c){let u=new je([]),l=await a._def.args.parseAsync(c,s).catch(f=>{throw u.addIssue(n(c,f)),u}),d=await Reflect.apply(i,this,l);return await a._def.returns._def.type.parseAsync(d,s).catch(f=>{throw u.addIssue(o(d,f)),u})})}else{let a=this;return Te(function(...c){let u=a._def.args.safeParse(c,s);if(!u.success)throw new je([n(c,u.error)]);let l=Reflect.apply(i,this,u.data),d=a._def.returns.safeParse(l,s);if(!d.success)throw new je([o(l,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new t({...this._def,args:mt.create(e).rest(zt.create())})}returns(e){return new t({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,n){return new t({args:e||mt.create([]).rest(zt.create()),returns:r||zt.create(),typeName:w.ZodFunction,...L(n)})}},lr=class extends q{get schema(){return this._def.getter()}_parse(e){let{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}};lr.create=(t,e)=>new lr({getter:t,typeName:w.ZodLazy,...L(e)});var dr=class extends q{_parse(e){if(e.data!==this._def.value){let r=this._getOrReturnCtx(e);return k(r,{received:r.data,code:$.invalid_literal,expected:this._def.value}),Z}return{status:"valid",value:e.data}}get value(){return this._def.value}};dr.create=(t,e)=>new dr({value:t,typeName:w.ZodLiteral,...L(e)});function pd(t,e){return new pr({values:t,typeName:w.ZodEnum,...L(e)})}var pr=class t extends q{_parse(e){if(typeof e.data!="string"){let r=this._getOrReturnCtx(e),n=this._def.values;return k(r,{expected:H.joinValues(n),received:r.parsedType,code:$.invalid_type}),Z}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let r=this._getOrReturnCtx(e),n=this._def.values;return k(r,{received:r.data,code:$.invalid_enum_value,options:n}),Z}return Te(e.data)}get options(){return this._def.values}get enum(){let e={};for(let r of this._def.values)e[r]=r;return e}get Values(){let e={};for(let r of this._def.values)e[r]=r;return e}get Enum(){let e={};for(let r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return t.create(e,{...this._def,...r})}exclude(e,r=this._def){return t.create(this.options.filter(n=>!e.includes(n)),{...this._def,...r})}};pr.create=pd;var fr=class extends q{_parse(e){let r=H.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==T.string&&n.parsedType!==T.number){let o=H.objectValues(r);return k(n,{expected:H.joinValues(o),received:n.parsedType,code:$.invalid_type}),Z}if(this._cache||(this._cache=new Set(H.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let o=H.objectValues(r);return k(n,{received:n.data,code:$.invalid_enum_value,options:o}),Z}return Te(e.data)}get enum(){return this._def.values}};fr.create=(t,e)=>new fr({values:t,typeName:w.ZodNativeEnum,...L(e)});var At=class extends q{unwrap(){return this._def.type}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==T.promise&&r.common.async===!1)return k(r,{code:$.invalid_type,expected:T.promise,received:r.parsedType}),Z;let n=r.parsedType===T.promise?r.data:Promise.resolve(r.data);return Te(n.then(o=>this._def.type.parseAsync(o,{path:r.path,errorMap:r.common.contextualErrorMap})))}};At.create=(t,e)=>new At({type:t,typeName:w.ZodPromise,...L(e)});var Je=class extends q{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===w.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:r,ctx:n}=this._processInputParams(e),o=this._def.effect||null,s={addIssue:i=>{k(n,i),i.fatal?r.abort():r.dirty()},get path(){return n.path}};if(s.addIssue=s.addIssue.bind(s),o.type==="preprocess"){let i=o.transform(n.data,s);if(n.common.async)return Promise.resolve(i).then(async a=>{if(r.value==="aborted")return Z;let c=await this._def.schema._parseAsync({data:a,path:n.path,parent:n});return c.status==="aborted"?Z:c.status==="dirty"?tr(c.value):r.value==="dirty"?tr(c.value):c});{if(r.value==="aborted")return Z;let a=this._def.schema._parseSync({data:i,path:n.path,parent:n});return a.status==="aborted"?Z:a.status==="dirty"?tr(a.value):r.value==="dirty"?tr(a.value):a}}if(o.type==="refinement"){let i=a=>{let c=o.refinement(a,s);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(n.common.async===!1){let a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?Z:(a.status==="dirty"&&r.dirty(),i(a.value),{status:r.value,value:a.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>a.status==="aborted"?Z:(a.status==="dirty"&&r.dirty(),i(a.value).then(()=>({status:r.value,value:a.value}))))}if(o.type==="transform")if(n.common.async===!1){let i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Ct(i))return Z;let a=o.transform(i.value,s);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:a}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>Ct(i)?Promise.resolve(o.transform(i.value,s)).then(a=>({status:r.value,value:a})):Z);H.assertNever(o)}};Je.create=(t,e,r)=>new Je({schema:t,typeName:w.ZodEffects,effect:e,...L(r)});Je.createWithPreprocess=(t,e,r)=>new Je({schema:e,effect:{type:"preprocess",transform:t},typeName:w.ZodEffects,...L(r)});var Ae=class extends q{_parse(e){return this._getType(e)===T.undefined?Te(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Ae.create=(t,e)=>new Ae({innerType:t,typeName:w.ZodOptional,...L(e)});var ht=class extends q{_parse(e){return this._getType(e)===T.null?Te(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};ht.create=(t,e)=>new ht({innerType:t,typeName:w.ZodNullable,...L(e)});var mr=class extends q{_parse(e){let{ctx:r}=this._processInputParams(e),n=r.data;return r.parsedType===T.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}};mr.create=(t,e)=>new mr({innerType:t,typeName:w.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...L(e)});var hr=class extends q{_parse(e){let{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},o=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Ar(o)?o.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new je(n.common.issues)},input:n.data})})):{status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new je(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};hr.create=(t,e)=>new hr({innerType:t,typeName:w.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...L(e)});var Fr=class extends q{_parse(e){if(this._getType(e)!==T.nan){let n=this._getOrReturnCtx(e);return k(n,{code:$.invalid_type,expected:T.nan,received:n.parsedType}),Z}return{status:"valid",value:e.data}}};Fr.create=t=>new Fr({typeName:w.ZodNaN,...L(t)});var Hy=Symbol("zod_brand"),_n=class extends q{_parse(e){let{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}},vn=class t extends q{_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{let s=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?Z:s.status==="dirty"?(r.dirty(),tr(s.value)):this._def.out._parseAsync({data:s.value,path:n.path,parent:n})})();{let o=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?Z:o.status==="dirty"?(r.dirty(),{status:"dirty",value:o.value}):this._def.out._parseSync({data:o.value,path:n.path,parent:n})}}static create(e,r){return new t({in:e,out:r,typeName:w.ZodPipeline})}},gr=class extends q{_parse(e){let r=this._def.innerType._parse(e),n=o=>(Ct(o)&&(o.value=Object.freeze(o.value)),o);return Ar(r)?r.then(o=>n(o)):n(r)}unwrap(){return this._def.innerType}};gr.create=(t,e)=>new gr({innerType:t,typeName:w.ZodReadonly,...L(e)});function cd(t,e){let r=typeof t=="function"?t(e):typeof t=="string"?{message:t}:t;return typeof r=="string"?{message:r}:r}function fd(t,e={},r){return t?jt.create().superRefine((n,o)=>{let s=t(n);if(s instanceof Promise)return s.then(i=>{if(!i){let a=cd(e,n),c=a.fatal??r??!0;o.addIssue({code:"custom",...a,fatal:c})}});if(!s){let i=cd(e,n),a=i.fatal??r??!0;o.addIssue({code:"custom",...i,fatal:a})}}):jt.create()}var By={object:Me.lazycreate},w;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(w||(w={}));var Ky=(t,e={message:`Input not instance of ${t.name}`})=>fd(r=>r instanceof t,e),md=Zt.create,hd=rr.create,Wy=Fr.create,Gy=nr.create,gd=or.create,Jy=sr.create,Xy=Lr.create,Yy=ir.create,Qy=ar.create,e_=jt.create,t_=zt.create,r_=ot.create,n_=Dr.create,o_=Tt.create,Si=Me.create,s_=Me.strictCreate,i_=cr.create,a_=zo.create,c_=ur.create,u_=mt.create,l_=To.create,d_=qr.create,p_=Ur.create,f_=Eo.create,m_=lr.create,h_=dr.create,g_=pr.create,y_=fr.create,__=At.create,v_=Je.create,b_=Ae.create,x_=ht.create,$_=Je.createWithPreprocess,w_=vn.create,k_=()=>md().optional(),S_=()=>hd().optional(),z_=()=>gd().optional(),T_={string:(t=>Zt.create({...t,coerce:!0})),number:(t=>rr.create({...t,coerce:!0})),boolean:(t=>or.create({...t,coerce:!0})),bigint:(t=>nr.create({...t,coerce:!0})),date:(t=>sr.create({...t,coerce:!0}))};var E_=Z;var P_=Object.freeze({status:"aborted"});function _(t,e,r){function n(a,c){var u;Object.defineProperty(a,"_zod",{value:a._zod??{},enumerable:!1}),(u=a._zod).traits??(u.traits=new Set),a._zod.traits.add(t),e(a,c);for(let l in i.prototype)l in a||Object.defineProperty(a,l,{value:i.prototype[l].bind(a)});a._zod.constr=i,a._zod.def=c}let o=r?.Parent??Object;class s extends o{}Object.defineProperty(s,"name",{value:t});function i(a){var c;let u=r?.Parent?new s:this;n(u,a),(c=u._zod).deferred??(c.deferred=[]);for(let l of u._zod.deferred)l();return u}return Object.defineProperty(i,"init",{value:n}),Object.defineProperty(i,Symbol.hasInstance,{value:a=>r?.Parent&&a instanceof r.Parent?!0:a?._zod?.traits?.has(t)}),Object.defineProperty(i,"name",{value:t}),i}var Et=class extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}},Po={};function He(t){return t&&Object.assign(Po,t),Po}var B={};xi(B,{BIGINT_FORMAT_RANGES:()=>_d,Class:()=>Ti,NUMBER_FORMAT_RANGES:()=>Ci,aborted:()=>_r,allowsEval:()=>Ii,assert:()=>C_,assertEqual:()=>R_,assertIs:()=>O_,assertNever:()=>N_,assertNotEqual:()=>I_,assignProp:()=>Ri,cached:()=>$n,captureStackTrace:()=>Io,cleanEnum:()=>K_,cleanRegex:()=>kn,clone:()=>Be,createTransparentProxy:()=>D_,defineLazy:()=>se,esc:()=>yr,escapeRegex:()=>Mt,extend:()=>F_,finalizeIssue:()=>st,floatSafeRemainder:()=>Pi,getElementAtPath:()=>Z_,getEnumValues:()=>xn,getLengthableOrigin:()=>Sn,getParsedType:()=>L_,getSizableOrigin:()=>vd,isObject:()=>Vr,isPlainObject:()=>Hr,issue:()=>Zi,joinValues:()=>Ro,jsonStringifyReplacer:()=>Ei,merge:()=>V_,normalizeParams:()=>j,nullish:()=>wn,numKeys:()=>M_,omit:()=>U_,optionalKeys:()=>Ni,partial:()=>H_,pick:()=>q_,prefixIssues:()=>gt,primitiveTypes:()=>yd,promiseAllObject:()=>j_,propertyKeyTypes:()=>Oi,randomString:()=>A_,required:()=>B_,stringifyPrimitive:()=>Oo,unwrapMessage:()=>bn});function R_(t){return t}function I_(t){return t}function O_(t){}function N_(t){throw new Error}function C_(t){}function xn(t){let e=Object.values(t).filter(n=>typeof n=="number");return Object.entries(t).filter(([n,o])=>e.indexOf(+n)===-1).map(([n,o])=>o)}function Ro(t,e="|"){return t.map(r=>Oo(r)).join(e)}function Ei(t,e){return typeof e=="bigint"?e.toString():e}function $n(t){return{get value(){{let r=t();return Object.defineProperty(this,"value",{value:r}),r}throw new Error("cached value already set")}}}function wn(t){return t==null}function kn(t){let e=t.startsWith("^")?1:0,r=t.endsWith("$")?t.length-1:t.length;return t.slice(e,r)}function Pi(t,e){let r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,o=r>n?r:n,s=Number.parseInt(t.toFixed(o).replace(".","")),i=Number.parseInt(e.toFixed(o).replace(".",""));return s%i/10**o}function se(t,e,r){Object.defineProperty(t,e,{get(){{let o=r();return t[e]=o,o}throw new Error("cached value already set")},set(o){Object.defineProperty(t,e,{value:o})},configurable:!0})}function Ri(t,e,r){Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0})}function Z_(t,e){return e?e.reduce((r,n)=>r?.[n],t):t}function j_(t){let e=Object.keys(t),r=e.map(n=>t[n]);return Promise.all(r).then(n=>{let o={};for(let s=0;s<e.length;s++)o[e[s]]=n[s];return o})}function A_(t=10){let e="abcdefghijklmnopqrstuvwxyz",r="";for(let n=0;n<t;n++)r+=e[Math.floor(Math.random()*e.length)];return r}function yr(t){return JSON.stringify(t)}var Io=Error.captureStackTrace?Error.captureStackTrace:(...t)=>{};function Vr(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}var Ii=$n(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{let t=Function;return new t(""),!0}catch{return!1}});function Hr(t){if(Vr(t)===!1)return!1;let e=t.constructor;if(e===void 0)return!0;let r=e.prototype;return!(Vr(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function M_(t){let e=0;for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}var L_=t=>{let e=typeof t;switch(e){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(t)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":return Array.isArray(t)?"array":t===null?"null":t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?"promise":typeof Map<"u"&&t instanceof Map?"map":typeof Set<"u"&&t instanceof Set?"set":typeof Date<"u"&&t instanceof Date?"date":typeof File<"u"&&t instanceof File?"file":"object";default:throw new Error(`Unknown data type: ${e}`)}},Oi=new Set(["string","number","symbol"]),yd=new Set(["string","number","bigint","boolean","symbol","undefined"]);function Mt(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Be(t,e,r){let n=new t._zod.constr(e??t._zod.def);return(!e||r?.parent)&&(n._zod.parent=t),n}function j(t){let e=t;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function D_(t){let e;return new Proxy({},{get(r,n,o){return e??(e=t()),Reflect.get(e,n,o)},set(r,n,o,s){return e??(e=t()),Reflect.set(e,n,o,s)},has(r,n){return e??(e=t()),Reflect.has(e,n)},deleteProperty(r,n){return e??(e=t()),Reflect.deleteProperty(e,n)},ownKeys(r){return e??(e=t()),Reflect.ownKeys(e)},getOwnPropertyDescriptor(r,n){return e??(e=t()),Reflect.getOwnPropertyDescriptor(e,n)},defineProperty(r,n,o){return e??(e=t()),Reflect.defineProperty(e,n,o)}})}function Oo(t){return typeof t=="bigint"?t.toString()+"n":typeof t=="string"?`"${t}"`:`${t}`}function Ni(t){return Object.keys(t).filter(e=>t[e]._zod.optin==="optional"&&t[e]._zod.optout==="optional")}var Ci={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},_d={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function q_(t,e){let r={},n=t._zod.def;for(let o in e){if(!(o in n.shape))throw new Error(`Unrecognized key: "${o}"`);e[o]&&(r[o]=n.shape[o])}return Be(t,{...t._zod.def,shape:r,checks:[]})}function U_(t,e){let r={...t._zod.def.shape},n=t._zod.def;for(let o in e){if(!(o in n.shape))throw new Error(`Unrecognized key: "${o}"`);e[o]&&delete r[o]}return Be(t,{...t._zod.def,shape:r,checks:[]})}function F_(t,e){if(!Hr(e))throw new Error("Invalid input to extend: expected a plain object");let r={...t._zod.def,get shape(){let n={...t._zod.def.shape,...e};return Ri(this,"shape",n),n},checks:[]};return Be(t,r)}function V_(t,e){return Be(t,{...t._zod.def,get shape(){let r={...t._zod.def.shape,...e._zod.def.shape};return Ri(this,"shape",r),r},catchall:e._zod.def.catchall,checks:[]})}function H_(t,e,r){let n=e._zod.def.shape,o={...n};if(r)for(let s in r){if(!(s in n))throw new Error(`Unrecognized key: "${s}"`);r[s]&&(o[s]=t?new t({type:"optional",innerType:n[s]}):n[s])}else for(let s in n)o[s]=t?new t({type:"optional",innerType:n[s]}):n[s];return Be(e,{...e._zod.def,shape:o,checks:[]})}function B_(t,e,r){let n=e._zod.def.shape,o={...n};if(r)for(let s in r){if(!(s in o))throw new Error(`Unrecognized key: "${s}"`);r[s]&&(o[s]=new t({type:"nonoptional",innerType:n[s]}))}else for(let s in n)o[s]=new t({type:"nonoptional",innerType:n[s]});return Be(e,{...e._zod.def,shape:o,checks:[]})}function _r(t,e=0){for(let r=e;r<t.issues.length;r++)if(t.issues[r]?.continue!==!0)return!0;return!1}function gt(t,e){return e.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(t),r})}function bn(t){return typeof t=="string"?t:t?.message}function st(t,e,r){let n={...t,path:t.path??[]};if(!t.message){let o=bn(t.inst?._zod.def?.error?.(t))??bn(e?.error?.(t))??bn(r.customError?.(t))??bn(r.localeError?.(t))??"Invalid input";n.message=o}return delete n.inst,delete n.continue,e?.reportInput||delete n.input,n}function vd(t){return t instanceof Set?"set":t instanceof Map?"map":t instanceof File?"file":"unknown"}function Sn(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function Zi(...t){let[e,r,n]=t;return typeof e=="string"?{message:e,code:"custom",input:r,inst:n}:{...e}}function K_(t){return Object.entries(t).filter(([e,r])=>Number.isNaN(Number.parseInt(e,10))).map(e=>e[1])}var Ti=class{constructor(...e){}};var bd=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),Object.defineProperty(t,"message",{get(){return JSON.stringify(e,Ei,2)},enumerable:!0}),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},No=_("$ZodError",bd),zn=_("$ZodError",bd,{Parent:Error});function ji(t,e=r=>r.message){let r={},n=[];for(let o of t.issues)o.path.length>0?(r[o.path[0]]=r[o.path[0]]||[],r[o.path[0]].push(e(o))):n.push(e(o));return{formErrors:n,fieldErrors:r}}function Ai(t,e){let r=e||function(s){return s.message},n={_errors:[]},o=s=>{for(let i of s.issues)if(i.code==="invalid_union"&&i.errors.length)i.errors.map(a=>o({issues:a}));else if(i.code==="invalid_key")o({issues:i.issues});else if(i.code==="invalid_element")o({issues:i.issues});else if(i.path.length===0)n._errors.push(r(i));else{let a=n,c=0;for(;c<i.path.length;){let u=i.path[c];c===i.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(r(i))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return o(t),n}var Mi=t=>(e,r,n,o)=>{let s=n?Object.assign(n,{async:!1}):{async:!1},i=e._zod.run({value:r,issues:[]},s);if(i instanceof Promise)throw new Et;if(i.issues.length){let a=new(o?.Err??t)(i.issues.map(c=>st(c,s,He())));throw Io(a,o?.callee),a}return i.value},Li=Mi(zn),Di=t=>async(e,r,n,o)=>{let s=n?Object.assign(n,{async:!0}):{async:!0},i=e._zod.run({value:r,issues:[]},s);if(i instanceof Promise&&(i=await i),i.issues.length){let a=new(o?.Err??t)(i.issues.map(c=>st(c,s,He())));throw Io(a,o?.callee),a}return i.value},qi=Di(zn),Ui=t=>(e,r,n)=>{let o=n?{...n,async:!1}:{async:!1},s=e._zod.run({value:r,issues:[]},o);if(s instanceof Promise)throw new Et;return s.issues.length?{success:!1,error:new(t??No)(s.issues.map(i=>st(i,o,He())))}:{success:!0,data:s.value}},vr=Ui(zn),Fi=t=>async(e,r,n)=>{let o=n?Object.assign(n,{async:!0}):{async:!0},s=e._zod.run({value:r,issues:[]},o);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new t(s.issues.map(i=>st(i,o,He())))}:{success:!0,data:s.value}},br=Fi(zn);var xd=/^[cC][^\s-]{8,}$/,$d=/^[0-9a-z]+$/,wd=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,kd=/^[0-9a-vA-V]{20}$/,Sd=/^[A-Za-z0-9]{27}$/,zd=/^[a-zA-Z0-9_-]{21}$/,Td=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/;var Ed=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Vi=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/;var Pd=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/;var G_="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function Rd(){return new RegExp(G_,"u")}var Id=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Od=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,Nd=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Cd=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Zd=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Hi=/^[A-Za-z0-9_-]*$/,jd=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/;var Ad=/^\+(?:[0-9]){6,14}[0-9]$/,Md="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Ld=new RegExp(`^${Md}$`);function Dd(t){let e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${e}`:t.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function qd(t){return new RegExp(`^${Dd(t)}$`)}function Ud(t){let e=Dd({precision:t.precision}),r=["Z"];t.local&&r.push(""),t.offset&&r.push("([+-]\\d{2}:\\d{2})");let n=`${e}(?:${r.join("|")})`;return new RegExp(`^${Md}T(?:${n})$`)}var Fd=t=>{let e=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)};var Vd=/^\d+$/,Hd=/^-?\d+(?:\.\d+)?/i,Bd=/true|false/i,Kd=/null/i;var Wd=/^[^A-Z]*$/,Gd=/^[^a-z]*$/;var xe=_("$ZodCheck",(t,e)=>{var r;t._zod??(t._zod={}),t._zod.def=e,(r=t._zod).onattach??(r.onattach=[])}),Jd={number:"number",bigint:"bigint",object:"date"},Bi=_("$ZodCheckLessThan",(t,e)=>{xe.init(t,e);let r=Jd[typeof e.value];t._zod.onattach.push(n=>{let o=n._zod.bag,s=(e.inclusive?o.maximum:o.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<s&&(e.inclusive?o.maximum=e.value:o.exclusiveMaximum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value<=e.value:n.value<e.value)||n.issues.push({origin:r,code:"too_big",maximum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),Ki=_("$ZodCheckGreaterThan",(t,e)=>{xe.init(t,e);let r=Jd[typeof e.value];t._zod.onattach.push(n=>{let o=n._zod.bag,s=(e.inclusive?o.minimum:o.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>s&&(e.inclusive?o.minimum=e.value:o.exclusiveMinimum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value>=e.value:n.value>e.value)||n.issues.push({origin:r,code:"too_small",minimum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),Xd=_("$ZodCheckMultipleOf",(t,e)=>{xe.init(t,e),t._zod.onattach.push(r=>{var n;(n=r._zod.bag).multipleOf??(n.multipleOf=e.value)}),t._zod.check=r=>{if(typeof r.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%e.value===BigInt(0):Pi(r.value,e.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:e.value,input:r.value,inst:t,continue:!e.abort})}}),Yd=_("$ZodCheckNumberFormat",(t,e)=>{xe.init(t,e),e.format=e.format||"float64";let r=e.format?.includes("int"),n=r?"int":"number",[o,s]=Ci[e.format];t._zod.onattach.push(i=>{let a=i._zod.bag;a.format=e.format,a.minimum=o,a.maximum=s,r&&(a.pattern=Vd)}),t._zod.check=i=>{let a=i.value;if(r){if(!Number.isInteger(a)){i.issues.push({expected:n,format:e.format,code:"invalid_type",input:a,inst:t});return}if(!Number.isSafeInteger(a)){a>0?i.issues.push({input:a,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort}):i.issues.push({input:a,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort});return}}a<o&&i.issues.push({origin:"number",input:a,code:"too_small",minimum:o,inclusive:!0,inst:t,continue:!e.abort}),a>s&&i.issues.push({origin:"number",input:a,code:"too_big",maximum:s,inst:t})}});var Qd=_("$ZodCheckMaxLength",(t,e)=>{var r;xe.init(t,e),(r=t._zod.def).when??(r.when=n=>{let o=n.value;return!wn(o)&&o.length!==void 0}),t._zod.onattach.push(n=>{let o=n._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<o&&(n._zod.bag.maximum=e.maximum)}),t._zod.check=n=>{let o=n.value;if(o.length<=e.maximum)return;let i=Sn(o);n.issues.push({origin:i,code:"too_big",maximum:e.maximum,inclusive:!0,input:o,inst:t,continue:!e.abort})}}),ep=_("$ZodCheckMinLength",(t,e)=>{var r;xe.init(t,e),(r=t._zod.def).when??(r.when=n=>{let o=n.value;return!wn(o)&&o.length!==void 0}),t._zod.onattach.push(n=>{let o=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>o&&(n._zod.bag.minimum=e.minimum)}),t._zod.check=n=>{let o=n.value;if(o.length>=e.minimum)return;let i=Sn(o);n.issues.push({origin:i,code:"too_small",minimum:e.minimum,inclusive:!0,input:o,inst:t,continue:!e.abort})}}),tp=_("$ZodCheckLengthEquals",(t,e)=>{var r;xe.init(t,e),(r=t._zod.def).when??(r.when=n=>{let o=n.value;return!wn(o)&&o.length!==void 0}),t._zod.onattach.push(n=>{let o=n._zod.bag;o.minimum=e.length,o.maximum=e.length,o.length=e.length}),t._zod.check=n=>{let o=n.value,s=o.length;if(s===e.length)return;let i=Sn(o),a=s>e.length;n.issues.push({origin:i,...a?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:n.value,inst:t,continue:!e.abort})}}),Tn=_("$ZodCheckStringFormat",(t,e)=>{var r,n;xe.init(t,e),t._zod.onattach.push(o=>{let s=o._zod.bag;s.format=e.format,e.pattern&&(s.patterns??(s.patterns=new Set),s.patterns.add(e.pattern))}),e.pattern?(r=t._zod).check??(r.check=o=>{e.pattern.lastIndex=0,!e.pattern.test(o.value)&&o.issues.push({origin:"string",code:"invalid_format",format:e.format,input:o.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(n=t._zod).check??(n.check=()=>{})}),rp=_("$ZodCheckRegex",(t,e)=>{Tn.init(t,e),t._zod.check=r=>{e.pattern.lastIndex=0,!e.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),np=_("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=Wd),Tn.init(t,e)}),op=_("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=Gd),Tn.init(t,e)}),sp=_("$ZodCheckIncludes",(t,e)=>{xe.init(t,e);let r=Mt(e.includes),n=new RegExp(typeof e.position=="number"?`^.{${e.position}}${r}`:r);e.pattern=n,t._zod.onattach.push(o=>{let s=o._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(n)}),t._zod.check=o=>{o.value.includes(e.includes,e.position)||o.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:o.value,inst:t,continue:!e.abort})}}),ip=_("$ZodCheckStartsWith",(t,e)=>{xe.init(t,e);let r=new RegExp(`^${Mt(e.prefix)}.*`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{let o=n._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(r)}),t._zod.check=n=>{n.value.startsWith(e.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:n.value,inst:t,continue:!e.abort})}}),ap=_("$ZodCheckEndsWith",(t,e)=>{xe.init(t,e);let r=new RegExp(`.*${Mt(e.suffix)}$`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{let o=n._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(r)}),t._zod.check=n=>{n.value.endsWith(e.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:n.value,inst:t,continue:!e.abort})}});var cp=_("$ZodCheckOverwrite",(t,e)=>{xe.init(t,e),t._zod.check=r=>{r.value=e.tx(r.value)}});var Zo=class{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}let n=e.split(`
`).filter(i=>i),o=Math.min(...n.map(i=>i.length-i.trimStart().length)),s=n.map(i=>i.slice(o)).map(i=>" ".repeat(this.indent*2)+i);for(let i of s)this.content.push(i)}compile(){let e=Function,r=this?.args,o=[...(this?.content??[""]).map(s=>`  ${s}`)];return new e(...r,o.join(`
`))}};var lp={major:4,minor:0,patch:0};var te=_("$ZodType",(t,e)=>{var r;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=lp;let n=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&n.unshift(t);for(let o of n)for(let s of o._zod.onattach)s(t);if(n.length===0)(r=t._zod).deferred??(r.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{let o=(s,i,a)=>{let c=_r(s),u;for(let l of i){if(l._zod.def.when){if(!l._zod.def.when(s))continue}else if(c)continue;let d=s.issues.length,m=l._zod.check(s);if(m instanceof Promise&&a?.async===!1)throw new Et;if(u||m instanceof Promise)u=(u??Promise.resolve()).then(async()=>{await m,s.issues.length!==d&&(c||(c=_r(s,d)))});else{if(s.issues.length===d)continue;c||(c=_r(s,d))}}return u?u.then(()=>s):s};t._zod.run=(s,i)=>{let a=t._zod.parse(s,i);if(a instanceof Promise){if(i.async===!1)throw new Et;return a.then(c=>o(c,n,i))}return o(a,n,i)}}t["~standard"]={validate:o=>{try{let s=vr(t,o);return s.success?{value:s.data}:{issues:s.error?.issues}}catch{return br(t,o).then(i=>i.success?{value:i.data}:{issues:i.error?.issues})}},vendor:"zod",version:1}}),En=_("$ZodString",(t,e)=>{te.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??Fd(t._zod.bag),t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:t}),r}}),ie=_("$ZodStringFormat",(t,e)=>{Tn.init(t,e),En.init(t,e)}),Gi=_("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=Ed),ie.init(t,e)}),Ji=_("$ZodUUID",(t,e)=>{if(e.version){let n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(n===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=Vi(n))}else e.pattern??(e.pattern=Vi());ie.init(t,e)}),Xi=_("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=Pd),ie.init(t,e)}),Yi=_("$ZodURL",(t,e)=>{ie.init(t,e),t._zod.check=r=>{try{let n=r.value,o=new URL(n),s=o.href;e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(o.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:jd.source,input:r.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(o.protocol.endsWith(":")?o.protocol.slice(0,-1):o.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:r.value,inst:t,continue:!e.abort})),!n.endsWith("/")&&s.endsWith("/")?r.value=s.slice(0,-1):r.value=s;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:t,continue:!e.abort})}}}),Qi=_("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=Rd()),ie.init(t,e)}),ea=_("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=zd),ie.init(t,e)}),ta=_("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=xd),ie.init(t,e)}),ra=_("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=$d),ie.init(t,e)}),na=_("$ZodULID",(t,e)=>{e.pattern??(e.pattern=wd),ie.init(t,e)}),oa=_("$ZodXID",(t,e)=>{e.pattern??(e.pattern=kd),ie.init(t,e)}),sa=_("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=Sd),ie.init(t,e)}),bp=_("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=Ud(e)),ie.init(t,e)}),xp=_("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=Ld),ie.init(t,e)}),$p=_("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=qd(e)),ie.init(t,e)}),wp=_("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=Td),ie.init(t,e)}),ia=_("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=Id),ie.init(t,e),t._zod.onattach.push(r=>{let n=r._zod.bag;n.format="ipv4"})}),aa=_("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=Od),ie.init(t,e),t._zod.onattach.push(r=>{let n=r._zod.bag;n.format="ipv6"}),t._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:t,continue:!e.abort})}}}),ca=_("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=Nd),ie.init(t,e)}),ua=_("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=Cd),ie.init(t,e),t._zod.check=r=>{let[n,o]=r.value.split("/");try{if(!o)throw new Error;let s=Number(o);if(`${s}`!==o)throw new Error;if(s<0||s>128)throw new Error;new URL(`http://[${n}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:t,continue:!e.abort})}}});function kp(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}var la=_("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=Zd),ie.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64"}),t._zod.check=r=>{kp(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:t,continue:!e.abort})}});function J_(t){if(!Hi.test(t))return!1;let e=t.replace(/[-_]/g,n=>n==="-"?"+":"/"),r=e.padEnd(Math.ceil(e.length/4)*4,"=");return kp(r)}var da=_("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=Hi),ie.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64url"}),t._zod.check=r=>{J_(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:t,continue:!e.abort})}}),pa=_("$ZodE164",(t,e)=>{e.pattern??(e.pattern=Ad),ie.init(t,e)});function X_(t,e=null){try{let r=t.split(".");if(r.length!==3)return!1;let[n]=r;if(!n)return!1;let o=JSON.parse(atob(n));return!("typ"in o&&o?.typ!=="JWT"||!o.alg||e&&(!("alg"in o)||o.alg!==e))}catch{return!1}}var fa=_("$ZodJWT",(t,e)=>{ie.init(t,e),t._zod.check=r=>{X_(r.value,e.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:t,continue:!e.abort})}});var Ao=_("$ZodNumber",(t,e)=>{te.init(t,e),t._zod.pattern=t._zod.bag.pattern??Hd,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=Number(r.value)}catch{}let o=r.value;if(typeof o=="number"&&!Number.isNaN(o)&&Number.isFinite(o))return r;let s=typeof o=="number"?Number.isNaN(o)?"NaN":Number.isFinite(o)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:o,inst:t,...s?{received:s}:{}}),r}}),ma=_("$ZodNumber",(t,e)=>{Yd.init(t,e),Ao.init(t,e)}),ha=_("$ZodBoolean",(t,e)=>{te.init(t,e),t._zod.pattern=Bd,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=!!r.value}catch{}let o=r.value;return typeof o=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:o,inst:t}),r}});var ga=_("$ZodNull",(t,e)=>{te.init(t,e),t._zod.pattern=Kd,t._zod.values=new Set([null]),t._zod.parse=(r,n)=>{let o=r.value;return o===null||r.issues.push({expected:"null",code:"invalid_type",input:o,inst:t}),r}});var ya=_("$ZodUnknown",(t,e)=>{te.init(t,e),t._zod.parse=r=>r}),_a=_("$ZodNever",(t,e)=>{te.init(t,e),t._zod.parse=(r,n)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:t}),r)});function dp(t,e,r){t.issues.length&&e.issues.push(...gt(r,t.issues)),e.value[r]=t.value}var va=_("$ZodArray",(t,e)=>{te.init(t,e),t._zod.parse=(r,n)=>{let o=r.value;if(!Array.isArray(o))return r.issues.push({expected:"array",code:"invalid_type",input:o,inst:t}),r;r.value=Array(o.length);let s=[];for(let i=0;i<o.length;i++){let a=o[i],c=e.element._zod.run({value:a,issues:[]},n);c instanceof Promise?s.push(c.then(u=>dp(u,r,i))):dp(c,r,i)}return s.length?Promise.all(s).then(()=>r):r}});function jo(t,e,r){t.issues.length&&e.issues.push(...gt(r,t.issues)),e.value[r]=t.value}function pp(t,e,r,n){t.issues.length?n[r]===void 0?r in n?e.value[r]=void 0:e.value[r]=t.value:e.issues.push(...gt(r,t.issues)):t.value===void 0?r in n&&(e.value[r]=void 0):e.value[r]=t.value}var Mo=_("$ZodObject",(t,e)=>{te.init(t,e);let r=$n(()=>{let d=Object.keys(e.shape);for(let f of d)if(!(e.shape[f]instanceof te))throw new Error(`Invalid element at key "${f}": expected a Zod schema`);let m=Ni(e.shape);return{shape:e.shape,keys:d,keySet:new Set(d),numKeys:d.length,optionalKeys:new Set(m)}});se(t._zod,"propValues",()=>{let d=e.shape,m={};for(let f in d){let p=d[f]._zod;if(p.values){m[f]??(m[f]=new Set);for(let h of p.values)m[f].add(h)}}return m});let n=d=>{let m=new Zo(["shape","payload","ctx"]),f=r.value,p=x=>{let b=yr(x);return`shape[${b}]._zod.run({ value: input[${b}], issues: [] }, ctx)`};m.write("const input = payload.value;");let h=Object.create(null),g=0;for(let x of f.keys)h[x]=`key_${g++}`;m.write("const newResult = {}");for(let x of f.keys)if(f.optionalKeys.has(x)){let b=h[x];m.write(`const ${b} = ${p(x)};`);let S=yr(x);m.write(`
        if (${b}.issues.length) {
          if (input[${S}] === undefined) {
            if (${S} in input) {
              newResult[${S}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${b}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${S}, ...iss.path] : [${S}],
              }))
            );
          }
        } else if (${b}.value === undefined) {
          if (${S} in input) newResult[${S}] = undefined;
        } else {
          newResult[${S}] = ${b}.value;
        }
        `)}else{let b=h[x];m.write(`const ${b} = ${p(x)};`),m.write(`
          if (${b}.issues.length) payload.issues = payload.issues.concat(${b}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${yr(x)}, ...iss.path] : [${yr(x)}]
          })));`),m.write(`newResult[${yr(x)}] = ${b}.value`)}m.write("payload.value = newResult;"),m.write("return payload;");let v=m.compile();return(x,b)=>v(d,x,b)},o,s=Vr,i=!Po.jitless,c=i&&Ii.value,u=e.catchall,l;t._zod.parse=(d,m)=>{l??(l=r.value);let f=d.value;if(!s(f))return d.issues.push({expected:"object",code:"invalid_type",input:f,inst:t}),d;let p=[];if(i&&c&&m?.async===!1&&m.jitless!==!0)o||(o=n(e.shape)),d=o(d,m);else{d.value={};let b=l.shape;for(let S of l.keys){let N=b[S],_e=N._zod.run({value:f[S],issues:[]},m),We=N._zod.optin==="optional"&&N._zod.optout==="optional";_e instanceof Promise?p.push(_e.then(Zr=>We?pp(Zr,d,S,f):jo(Zr,d,S))):We?pp(_e,d,S,f):jo(_e,d,S)}}if(!u)return p.length?Promise.all(p).then(()=>d):d;let h=[],g=l.keySet,v=u._zod,x=v.def.type;for(let b of Object.keys(f)){if(g.has(b))continue;if(x==="never"){h.push(b);continue}let S=v.run({value:f[b],issues:[]},m);S instanceof Promise?p.push(S.then(N=>jo(N,d,b))):jo(S,d,b)}return h.length&&d.issues.push({code:"unrecognized_keys",keys:h,input:f,inst:t}),p.length?Promise.all(p).then(()=>d):d}});function fp(t,e,r,n){for(let o of t)if(o.issues.length===0)return e.value=o.value,e;return e.issues.push({code:"invalid_union",input:e.value,inst:r,errors:t.map(o=>o.issues.map(s=>st(s,n,He())))}),e}var Lo=_("$ZodUnion",(t,e)=>{te.init(t,e),se(t._zod,"optin",()=>e.options.some(r=>r._zod.optin==="optional")?"optional":void 0),se(t._zod,"optout",()=>e.options.some(r=>r._zod.optout==="optional")?"optional":void 0),se(t._zod,"values",()=>{if(e.options.every(r=>r._zod.values))return new Set(e.options.flatMap(r=>Array.from(r._zod.values)))}),se(t._zod,"pattern",()=>{if(e.options.every(r=>r._zod.pattern)){let r=e.options.map(n=>n._zod.pattern);return new RegExp(`^(${r.map(n=>kn(n.source)).join("|")})$`)}}),t._zod.parse=(r,n)=>{let o=!1,s=[];for(let i of e.options){let a=i._zod.run({value:r.value,issues:[]},n);if(a instanceof Promise)s.push(a),o=!0;else{if(a.issues.length===0)return a;s.push(a)}}return o?Promise.all(s).then(i=>fp(i,r,t,n)):fp(s,r,t,n)}}),ba=_("$ZodDiscriminatedUnion",(t,e)=>{Lo.init(t,e);let r=t._zod.parse;se(t._zod,"propValues",()=>{let o={};for(let s of e.options){let i=s._zod.propValues;if(!i||Object.keys(i).length===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(s)}"`);for(let[a,c]of Object.entries(i)){o[a]||(o[a]=new Set);for(let u of c)o[a].add(u)}}return o});let n=$n(()=>{let o=e.options,s=new Map;for(let i of o){let a=i._zod.propValues[e.discriminator];if(!a||a.size===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(i)}"`);for(let c of a){if(s.has(c))throw new Error(`Duplicate discriminator value "${String(c)}"`);s.set(c,i)}}return s});t._zod.parse=(o,s)=>{let i=o.value;if(!Vr(i))return o.issues.push({code:"invalid_type",expected:"object",input:i,inst:t}),o;let a=n.value.get(i?.[e.discriminator]);return a?a._zod.run(o,s):e.unionFallback?r(o,s):(o.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:i,path:[e.discriminator],inst:t}),o)}}),xa=_("$ZodIntersection",(t,e)=>{te.init(t,e),t._zod.parse=(r,n)=>{let o=r.value,s=e.left._zod.run({value:o,issues:[]},n),i=e.right._zod.run({value:o,issues:[]},n);return s instanceof Promise||i instanceof Promise?Promise.all([s,i]).then(([c,u])=>mp(r,c,u)):mp(r,s,i)}});function Wi(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t==+e)return{valid:!0,data:t};if(Hr(t)&&Hr(e)){let r=Object.keys(e),n=Object.keys(t).filter(s=>r.indexOf(s)!==-1),o={...t,...e};for(let s of n){let i=Wi(t[s],e[s]);if(!i.valid)return{valid:!1,mergeErrorPath:[s,...i.mergeErrorPath]};o[s]=i.data}return{valid:!0,data:o}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};let r=[];for(let n=0;n<t.length;n++){let o=t[n],s=e[n],i=Wi(o,s);if(!i.valid)return{valid:!1,mergeErrorPath:[n,...i.mergeErrorPath]};r.push(i.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function mp(t,e,r){if(e.issues.length&&t.issues.push(...e.issues),r.issues.length&&t.issues.push(...r.issues),_r(t))return t;let n=Wi(e.value,r.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return t.value=n.data,t}var $a=_("$ZodRecord",(t,e)=>{te.init(t,e),t._zod.parse=(r,n)=>{let o=r.value;if(!Hr(o))return r.issues.push({expected:"record",code:"invalid_type",input:o,inst:t}),r;let s=[];if(e.keyType._zod.values){let i=e.keyType._zod.values;r.value={};for(let c of i)if(typeof c=="string"||typeof c=="number"||typeof c=="symbol"){let u=e.valueType._zod.run({value:o[c],issues:[]},n);u instanceof Promise?s.push(u.then(l=>{l.issues.length&&r.issues.push(...gt(c,l.issues)),r.value[c]=l.value})):(u.issues.length&&r.issues.push(...gt(c,u.issues)),r.value[c]=u.value)}let a;for(let c in o)i.has(c)||(a=a??[],a.push(c));a&&a.length>0&&r.issues.push({code:"unrecognized_keys",input:o,inst:t,keys:a})}else{r.value={};for(let i of Reflect.ownKeys(o)){if(i==="__proto__")continue;let a=e.keyType._zod.run({value:i,issues:[]},n);if(a instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(a.issues.length){r.issues.push({origin:"record",code:"invalid_key",issues:a.issues.map(u=>st(u,n,He())),input:i,path:[i],inst:t}),r.value[a.value]=a.value;continue}let c=e.valueType._zod.run({value:o[i],issues:[]},n);c instanceof Promise?s.push(c.then(u=>{u.issues.length&&r.issues.push(...gt(i,u.issues)),r.value[a.value]=u.value})):(c.issues.length&&r.issues.push(...gt(i,c.issues)),r.value[a.value]=c.value)}}return s.length?Promise.all(s).then(()=>r):r}});var wa=_("$ZodEnum",(t,e)=>{te.init(t,e);let r=xn(e.entries);t._zod.values=new Set(r),t._zod.pattern=new RegExp(`^(${r.filter(n=>Oi.has(typeof n)).map(n=>typeof n=="string"?Mt(n):n.toString()).join("|")})$`),t._zod.parse=(n,o)=>{let s=n.value;return t._zod.values.has(s)||n.issues.push({code:"invalid_value",values:r,input:s,inst:t}),n}}),ka=_("$ZodLiteral",(t,e)=>{te.init(t,e),t._zod.values=new Set(e.values),t._zod.pattern=new RegExp(`^(${e.values.map(r=>typeof r=="string"?Mt(r):r?r.toString():String(r)).join("|")})$`),t._zod.parse=(r,n)=>{let o=r.value;return t._zod.values.has(o)||r.issues.push({code:"invalid_value",values:e.values,input:o,inst:t}),r}});var Sa=_("$ZodTransform",(t,e)=>{te.init(t,e),t._zod.parse=(r,n)=>{let o=e.transform(r.value,r);if(n.async)return(o instanceof Promise?o:Promise.resolve(o)).then(i=>(r.value=i,r));if(o instanceof Promise)throw new Et;return r.value=o,r}}),za=_("$ZodOptional",(t,e)=>{te.init(t,e),t._zod.optin="optional",t._zod.optout="optional",se(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),se(t._zod,"pattern",()=>{let r=e.innerType._zod.pattern;return r?new RegExp(`^(${kn(r.source)})?$`):void 0}),t._zod.parse=(r,n)=>e.innerType._zod.optin==="optional"?e.innerType._zod.run(r,n):r.value===void 0?r:e.innerType._zod.run(r,n)}),Ta=_("$ZodNullable",(t,e)=>{te.init(t,e),se(t._zod,"optin",()=>e.innerType._zod.optin),se(t._zod,"optout",()=>e.innerType._zod.optout),se(t._zod,"pattern",()=>{let r=e.innerType._zod.pattern;return r?new RegExp(`^(${kn(r.source)}|null)$`):void 0}),se(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(r,n)=>r.value===null?r:e.innerType._zod.run(r,n)}),Ea=_("$ZodDefault",(t,e)=>{te.init(t,e),t._zod.optin="optional",se(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{if(r.value===void 0)return r.value=e.defaultValue,r;let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>hp(s,e)):hp(o,e)}});function hp(t,e){return t.value===void 0&&(t.value=e.defaultValue),t}var Pa=_("$ZodPrefault",(t,e)=>{te.init(t,e),t._zod.optin="optional",se(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>(r.value===void 0&&(r.value=e.defaultValue),e.innerType._zod.run(r,n))}),Ra=_("$ZodNonOptional",(t,e)=>{te.init(t,e),se(t._zod,"values",()=>{let r=e.innerType._zod.values;return r?new Set([...r].filter(n=>n!==void 0)):void 0}),t._zod.parse=(r,n)=>{let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>gp(s,t)):gp(o,t)}});function gp(t,e){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}var Ia=_("$ZodCatch",(t,e)=>{te.init(t,e),t._zod.optin="optional",se(t._zod,"optout",()=>e.innerType._zod.optout),se(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>(r.value=s.value,s.issues.length&&(r.value=e.catchValue({...r,error:{issues:s.issues.map(i=>st(i,n,He()))},input:r.value}),r.issues=[]),r)):(r.value=o.value,o.issues.length&&(r.value=e.catchValue({...r,error:{issues:o.issues.map(s=>st(s,n,He()))},input:r.value}),r.issues=[]),r)}});var Oa=_("$ZodPipe",(t,e)=>{te.init(t,e),se(t._zod,"values",()=>e.in._zod.values),se(t._zod,"optin",()=>e.in._zod.optin),se(t._zod,"optout",()=>e.out._zod.optout),t._zod.parse=(r,n)=>{let o=e.in._zod.run(r,n);return o instanceof Promise?o.then(s=>yp(s,e,n)):yp(o,e,n)}});function yp(t,e,r){return _r(t)?t:e.out._zod.run({value:t.value,issues:t.issues},r)}var Na=_("$ZodReadonly",(t,e)=>{te.init(t,e),se(t._zod,"propValues",()=>e.innerType._zod.propValues),se(t._zod,"values",()=>e.innerType._zod.values),se(t._zod,"optin",()=>e.innerType._zod.optin),se(t._zod,"optout",()=>e.innerType._zod.optout),t._zod.parse=(r,n)=>{let o=e.innerType._zod.run(r,n);return o instanceof Promise?o.then(_p):_p(o)}});function _p(t){return t.value=Object.freeze(t.value),t}var Ca=_("$ZodCustom",(t,e)=>{xe.init(t,e),te.init(t,e),t._zod.parse=(r,n)=>r,t._zod.check=r=>{let n=r.value,o=e.fn(n);if(o instanceof Promise)return o.then(s=>vp(s,r,n,t));vp(o,r,n,t)}});function vp(t,e,r,n){if(!t){let o={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(o.params=n._zod.def.params),e.issues.push(Zi(o))}}var Y_=t=>{let e=typeof t;switch(e){case"number":return Number.isNaN(t)?"NaN":"number";case"object":{if(Array.isArray(t))return"array";if(t===null)return"null";if(Object.getPrototypeOf(t)!==Object.prototype&&t.constructor)return t.constructor.name}}return e},Q_=()=>{let t={string:{unit:"characters",verb:"to have"},file:{unit:"bytes",verb:"to have"},array:{unit:"items",verb:"to have"},set:{unit:"items",verb:"to have"}};function e(n){return t[n]??null}let r={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"};return n=>{switch(n.code){case"invalid_type":return`Invalid input: expected ${n.expected}, received ${Y_(n.input)}`;case"invalid_value":return n.values.length===1?`Invalid input: expected ${Oo(n.values[0])}`:`Invalid option: expected one of ${Ro(n.values,"|")}`;case"too_big":{let o=n.inclusive?"<=":"<",s=e(n.origin);return s?`Too big: expected ${n.origin??"value"} to have ${o}${n.maximum.toString()} ${s.unit??"elements"}`:`Too big: expected ${n.origin??"value"} to be ${o}${n.maximum.toString()}`}case"too_small":{let o=n.inclusive?">=":">",s=e(n.origin);return s?`Too small: expected ${n.origin} to have ${o}${n.minimum.toString()} ${s.unit}`:`Too small: expected ${n.origin} to be ${o}${n.minimum.toString()}`}case"invalid_format":{let o=n;return o.format==="starts_with"?`Invalid string: must start with "${o.prefix}"`:o.format==="ends_with"?`Invalid string: must end with "${o.suffix}"`:o.format==="includes"?`Invalid string: must include "${o.includes}"`:o.format==="regex"?`Invalid string: must match pattern ${o.pattern}`:`Invalid ${r[o.format]??n.format}`}case"not_multiple_of":return`Invalid number: must be a multiple of ${n.divisor}`;case"unrecognized_keys":return`Unrecognized key${n.keys.length>1?"s":""}: ${Ro(n.keys,", ")}`;case"invalid_key":return`Invalid key in ${n.origin}`;case"invalid_union":return"Invalid input";case"invalid_element":return`Invalid value in ${n.origin}`;default:return"Invalid input"}}};function Sp(){return{localeError:Q_()}}var Pn=class{constructor(){this._map=new Map,this._idmap=new Map}add(e,...r){let n=r[0];if(this._map.set(e,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){let r=this._map.get(e);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(e),this}get(e){let r=e._zod.parent;if(r){let n={...this.get(r)??{}};return delete n.id,{...n,...this._map.get(e)}}return this._map.get(e)}has(e){return this._map.has(e)}};function zp(){return new Pn}var Lt=zp();function Za(t,e){return new t({type:"string",...j(e)})}function ja(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,...j(e)})}function Do(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...j(e)})}function Aa(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...j(e)})}function Ma(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...j(e)})}function La(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...j(e)})}function Da(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...j(e)})}function qa(t,e){return new t({type:"string",format:"url",check:"string_format",abort:!1,...j(e)})}function Ua(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...j(e)})}function Fa(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...j(e)})}function Va(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...j(e)})}function Ha(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...j(e)})}function Ba(t,e){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...j(e)})}function Ka(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...j(e)})}function Wa(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...j(e)})}function Ga(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...j(e)})}function Ja(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...j(e)})}function Xa(t,e){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...j(e)})}function Ya(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...j(e)})}function Qa(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...j(e)})}function ec(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...j(e)})}function tc(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...j(e)})}function rc(t,e){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...j(e)})}function Tp(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...j(e)})}function Ep(t,e){return new t({type:"string",format:"date",check:"string_format",...j(e)})}function Pp(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,...j(e)})}function Rp(t,e){return new t({type:"string",format:"duration",check:"string_format",...j(e)})}function nc(t,e){return new t({type:"number",checks:[],...j(e)})}function oc(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...j(e)})}function sc(t,e){return new t({type:"boolean",...j(e)})}function ic(t,e){return new t({type:"null",...j(e)})}function ac(t){return new t({type:"unknown"})}function cc(t,e){return new t({type:"never",...j(e)})}function qo(t,e){return new Bi({check:"less_than",...j(e),value:t,inclusive:!1})}function Rn(t,e){return new Bi({check:"less_than",...j(e),value:t,inclusive:!0})}function Uo(t,e){return new Ki({check:"greater_than",...j(e),value:t,inclusive:!1})}function In(t,e){return new Ki({check:"greater_than",...j(e),value:t,inclusive:!0})}function Fo(t,e){return new Xd({check:"multiple_of",...j(e),value:t})}function Vo(t,e){return new Qd({check:"max_length",...j(e),maximum:t})}function Br(t,e){return new ep({check:"min_length",...j(e),minimum:t})}function Ho(t,e){return new tp({check:"length_equals",...j(e),length:t})}function uc(t,e){return new rp({check:"string_format",format:"regex",...j(e),pattern:t})}function lc(t){return new np({check:"string_format",format:"lowercase",...j(t)})}function dc(t){return new op({check:"string_format",format:"uppercase",...j(t)})}function pc(t,e){return new sp({check:"string_format",format:"includes",...j(e),includes:t})}function fc(t,e){return new ip({check:"string_format",format:"starts_with",...j(e),prefix:t})}function mc(t,e){return new ap({check:"string_format",format:"ends_with",...j(e),suffix:t})}function xr(t){return new cp({check:"overwrite",tx:t})}function hc(t){return xr(e=>e.normalize(t))}function gc(){return xr(t=>t.trim())}function yc(){return xr(t=>t.toLowerCase())}function _c(){return xr(t=>t.toUpperCase())}function Ip(t,e,r){return new t({type:"array",element:e,...j(r)})}function vc(t,e,r){let n=j(r);return n.abort??(n.abort=!0),new t({type:"custom",check:"custom",fn:e,...n})}function bc(t,e,r){return new t({type:"custom",check:"custom",fn:e,...j(r)})}var Bo=class{constructor(e){this.counter=0,this.metadataRegistry=e?.metadata??Lt,this.target=e?.target??"draft-2020-12",this.unrepresentable=e?.unrepresentable??"throw",this.override=e?.override??(()=>{}),this.io=e?.io??"output",this.seen=new Map}process(e,r={path:[],schemaPath:[]}){var n;let o=e._zod.def,s={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},i=this.seen.get(e);if(i)return i.count++,r.schemaPath.includes(e)&&(i.cycle=r.path),i.schema;let a={schema:{},count:1,cycle:void 0,path:r.path};this.seen.set(e,a);let c=e._zod.toJSONSchema?.();if(c)a.schema=c;else{let d={...r,schemaPath:[...r.schemaPath,e],path:r.path},m=e._zod.parent;if(m)a.ref=m,this.process(m,d),this.seen.get(m).isParent=!0;else{let f=a.schema;switch(o.type){case"string":{let p=f;p.type="string";let{minimum:h,maximum:g,format:v,patterns:x,contentEncoding:b}=e._zod.bag;if(typeof h=="number"&&(p.minLength=h),typeof g=="number"&&(p.maxLength=g),v&&(p.format=s[v]??v,p.format===""&&delete p.format),b&&(p.contentEncoding=b),x&&x.size>0){let S=[...x];S.length===1?p.pattern=S[0].source:S.length>1&&(a.schema.allOf=[...S.map(N=>({...this.target==="draft-7"?{type:"string"}:{},pattern:N.source}))])}break}case"number":{let p=f,{minimum:h,maximum:g,format:v,multipleOf:x,exclusiveMaximum:b,exclusiveMinimum:S}=e._zod.bag;typeof v=="string"&&v.includes("int")?p.type="integer":p.type="number",typeof S=="number"&&(p.exclusiveMinimum=S),typeof h=="number"&&(p.minimum=h,typeof S=="number"&&(S>=h?delete p.minimum:delete p.exclusiveMinimum)),typeof b=="number"&&(p.exclusiveMaximum=b),typeof g=="number"&&(p.maximum=g,typeof b=="number"&&(b<=g?delete p.maximum:delete p.exclusiveMaximum)),typeof x=="number"&&(p.multipleOf=x);break}case"boolean":{let p=f;p.type="boolean";break}case"bigint":{if(this.unrepresentable==="throw")throw new Error("BigInt cannot be represented in JSON Schema");break}case"symbol":{if(this.unrepresentable==="throw")throw new Error("Symbols cannot be represented in JSON Schema");break}case"null":{f.type="null";break}case"any":break;case"unknown":break;case"undefined":{if(this.unrepresentable==="throw")throw new Error("Undefined cannot be represented in JSON Schema");break}case"void":{if(this.unrepresentable==="throw")throw new Error("Void cannot be represented in JSON Schema");break}case"never":{f.not={};break}case"date":{if(this.unrepresentable==="throw")throw new Error("Date cannot be represented in JSON Schema");break}case"array":{let p=f,{minimum:h,maximum:g}=e._zod.bag;typeof h=="number"&&(p.minItems=h),typeof g=="number"&&(p.maxItems=g),p.type="array",p.items=this.process(o.element,{...d,path:[...d.path,"items"]});break}case"object":{let p=f;p.type="object",p.properties={};let h=o.shape;for(let x in h)p.properties[x]=this.process(h[x],{...d,path:[...d.path,"properties",x]});let g=new Set(Object.keys(h)),v=new Set([...g].filter(x=>{let b=o.shape[x]._zod;return this.io==="input"?b.optin===void 0:b.optout===void 0}));v.size>0&&(p.required=Array.from(v)),o.catchall?._zod.def.type==="never"?p.additionalProperties=!1:o.catchall?o.catchall&&(p.additionalProperties=this.process(o.catchall,{...d,path:[...d.path,"additionalProperties"]})):this.io==="output"&&(p.additionalProperties=!1);break}case"union":{let p=f;p.anyOf=o.options.map((h,g)=>this.process(h,{...d,path:[...d.path,"anyOf",g]}));break}case"intersection":{let p=f,h=this.process(o.left,{...d,path:[...d.path,"allOf",0]}),g=this.process(o.right,{...d,path:[...d.path,"allOf",1]}),v=b=>"allOf"in b&&Object.keys(b).length===1,x=[...v(h)?h.allOf:[h],...v(g)?g.allOf:[g]];p.allOf=x;break}case"tuple":{let p=f;p.type="array";let h=o.items.map((x,b)=>this.process(x,{...d,path:[...d.path,"prefixItems",b]}));if(this.target==="draft-2020-12"?p.prefixItems=h:p.items=h,o.rest){let x=this.process(o.rest,{...d,path:[...d.path,"items"]});this.target==="draft-2020-12"?p.items=x:p.additionalItems=x}o.rest&&(p.items=this.process(o.rest,{...d,path:[...d.path,"items"]}));let{minimum:g,maximum:v}=e._zod.bag;typeof g=="number"&&(p.minItems=g),typeof v=="number"&&(p.maxItems=v);break}case"record":{let p=f;p.type="object",p.propertyNames=this.process(o.keyType,{...d,path:[...d.path,"propertyNames"]}),p.additionalProperties=this.process(o.valueType,{...d,path:[...d.path,"additionalProperties"]});break}case"map":{if(this.unrepresentable==="throw")throw new Error("Map cannot be represented in JSON Schema");break}case"set":{if(this.unrepresentable==="throw")throw new Error("Set cannot be represented in JSON Schema");break}case"enum":{let p=f,h=xn(o.entries);h.every(g=>typeof g=="number")&&(p.type="number"),h.every(g=>typeof g=="string")&&(p.type="string"),p.enum=h;break}case"literal":{let p=f,h=[];for(let g of o.values)if(g===void 0){if(this.unrepresentable==="throw")throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof g=="bigint"){if(this.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");h.push(Number(g))}else h.push(g);if(h.length!==0)if(h.length===1){let g=h[0];p.type=g===null?"null":typeof g,p.const=g}else h.every(g=>typeof g=="number")&&(p.type="number"),h.every(g=>typeof g=="string")&&(p.type="string"),h.every(g=>typeof g=="boolean")&&(p.type="string"),h.every(g=>g===null)&&(p.type="null"),p.enum=h;break}case"file":{let p=f,h={type:"string",format:"binary",contentEncoding:"binary"},{minimum:g,maximum:v,mime:x}=e._zod.bag;g!==void 0&&(h.minLength=g),v!==void 0&&(h.maxLength=v),x?x.length===1?(h.contentMediaType=x[0],Object.assign(p,h)):p.anyOf=x.map(b=>({...h,contentMediaType:b})):Object.assign(p,h);break}case"transform":{if(this.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema");break}case"nullable":{let p=this.process(o.innerType,d);f.anyOf=[p,{type:"null"}];break}case"nonoptional":{this.process(o.innerType,d),a.ref=o.innerType;break}case"success":{let p=f;p.type="boolean";break}case"default":{this.process(o.innerType,d),a.ref=o.innerType,f.default=JSON.parse(JSON.stringify(o.defaultValue));break}case"prefault":{this.process(o.innerType,d),a.ref=o.innerType,this.io==="input"&&(f._prefault=JSON.parse(JSON.stringify(o.defaultValue)));break}case"catch":{this.process(o.innerType,d),a.ref=o.innerType;let p;try{p=o.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}f.default=p;break}case"nan":{if(this.unrepresentable==="throw")throw new Error("NaN cannot be represented in JSON Schema");break}case"template_literal":{let p=f,h=e._zod.pattern;if(!h)throw new Error("Pattern not found in template literal");p.type="string",p.pattern=h.source;break}case"pipe":{let p=this.io==="input"?o.in._zod.def.type==="transform"?o.out:o.in:o.out;this.process(p,d),a.ref=p;break}case"readonly":{this.process(o.innerType,d),a.ref=o.innerType,f.readOnly=!0;break}case"promise":{this.process(o.innerType,d),a.ref=o.innerType;break}case"optional":{this.process(o.innerType,d),a.ref=o.innerType;break}case"lazy":{let p=e._zod.innerType;this.process(p,d),a.ref=p;break}case"custom":{if(this.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema");break}default:}}}let u=this.metadataRegistry.get(e);return u&&Object.assign(a.schema,u),this.io==="input"&&ye(e)&&(delete a.schema.examples,delete a.schema.default),this.io==="input"&&a.schema._prefault&&((n=a.schema).default??(n.default=a.schema._prefault)),delete a.schema._prefault,this.seen.get(e).schema}emit(e,r){let n={cycles:r?.cycles??"ref",reused:r?.reused??"inline",external:r?.external??void 0},o=this.seen.get(e);if(!o)throw new Error("Unprocessed schema. This is a bug in Zod.");let s=l=>{let d=this.target==="draft-2020-12"?"$defs":"definitions";if(n.external){let h=n.external.registry.get(l[0])?.id,g=n.external.uri??(x=>x);if(h)return{ref:g(h)};let v=l[1].defId??l[1].schema.id??`schema${this.counter++}`;return l[1].defId=v,{defId:v,ref:`${g("__shared")}#/${d}/${v}`}}if(l[1]===o)return{ref:"#"};let f=`#/${d}/`,p=l[1].schema.id??`__schema${this.counter++}`;return{defId:p,ref:f+p}},i=l=>{if(l[1].schema.$ref)return;let d=l[1],{ref:m,defId:f}=s(l);d.def={...d.schema},f&&(d.defId=f);let p=d.schema;for(let h in p)delete p[h];p.$ref=m};if(n.cycles==="throw")for(let l of this.seen.entries()){let d=l[1];if(d.cycle)throw new Error(`Cycle detected: #/${d.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(let l of this.seen.entries()){let d=l[1];if(e===l[0]){i(l);continue}if(n.external){let f=n.external.registry.get(l[0])?.id;if(e!==l[0]&&f){i(l);continue}}if(this.metadataRegistry.get(l[0])?.id){i(l);continue}if(d.cycle){i(l);continue}if(d.count>1&&n.reused==="ref"){i(l);continue}}let a=(l,d)=>{let m=this.seen.get(l),f=m.def??m.schema,p={...f};if(m.ref===null)return;let h=m.ref;if(m.ref=null,h){a(h,d);let g=this.seen.get(h).schema;g.$ref&&d.target==="draft-7"?(f.allOf=f.allOf??[],f.allOf.push(g)):(Object.assign(f,g),Object.assign(f,p))}m.isParent||this.override({zodSchema:l,jsonSchema:f,path:m.path??[]})};for(let l of[...this.seen.entries()].reverse())a(l[0],{target:this.target});let c={};if(this.target==="draft-2020-12"?c.$schema="https://json-schema.org/draft/2020-12/schema":this.target==="draft-7"?c.$schema="http://json-schema.org/draft-07/schema#":console.warn(`Invalid target: ${this.target}`),n.external?.uri){let l=n.external.registry.get(e)?.id;if(!l)throw new Error("Schema is missing an `id` property");c.$id=n.external.uri(l)}Object.assign(c,o.def);let u=n.external?.defs??{};for(let l of this.seen.entries()){let d=l[1];d.def&&d.defId&&(u[d.defId]=d.def)}n.external||Object.keys(u).length>0&&(this.target==="draft-2020-12"?c.$defs=u:c.definitions=u);try{return JSON.parse(JSON.stringify(c))}catch{throw new Error("Error converting schema to JSON.")}}};function xc(t,e){if(t instanceof Pn){let n=new Bo(e),o={};for(let a of t._idmap.entries()){let[c,u]=a;n.process(u)}let s={},i={registry:t,uri:e?.uri,defs:o};for(let a of t._idmap.entries()){let[c,u]=a;s[c]=n.emit(u,{...e,external:i})}if(Object.keys(o).length>0){let a=n.target==="draft-2020-12"?"$defs":"definitions";s.__shared={[a]:o}}return{schemas:s}}let r=new Bo(e);return r.process(t),r.emit(t,e)}function ye(t,e){let r=e??{seen:new Set};if(r.seen.has(t))return!1;r.seen.add(t);let o=t._zod.def;switch(o.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":return!1;case"array":return ye(o.element,r);case"object":{for(let s in o.shape)if(ye(o.shape[s],r))return!0;return!1}case"union":{for(let s of o.options)if(ye(s,r))return!0;return!1}case"intersection":return ye(o.left,r)||ye(o.right,r);case"tuple":{for(let s of o.items)if(ye(s,r))return!0;return!!(o.rest&&ye(o.rest,r))}case"record":return ye(o.keyType,r)||ye(o.valueType,r);case"map":return ye(o.keyType,r)||ye(o.valueType,r);case"set":return ye(o.valueType,r);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":return ye(o.innerType,r);case"lazy":return ye(o.getter(),r);case"default":return ye(o.innerType,r);case"prefault":return ye(o.innerType,r);case"custom":return!1;case"transform":return!0;case"pipe":return ye(o.in,r)||ye(o.out,r);case"success":return!1;case"catch":return!1;default:}throw new Error(`Unknown schema type: ${o.type}`)}var Cv=_("ZodMiniType",(t,e)=>{if(!t._zod)throw new Error("Uninitialized schema in ZodMiniType.");te.init(t,e),t.def=e,t.parse=(r,n)=>Li(t,r,n,{callee:t.parse}),t.safeParse=(r,n)=>vr(t,r,n),t.parseAsync=async(r,n)=>qi(t,r,n,{callee:t.parseAsync}),t.safeParseAsync=async(r,n)=>br(t,r,n),t.check=(...r)=>t.clone({...e,checks:[...e.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]}),t.clone=(r,n)=>Be(t,r,n),t.brand=()=>t,t.register=((r,n)=>(r.add(t,n),t))});var Zv=_("ZodMiniObject",(t,e)=>{Mo.init(t,e),Cv.init(t,e),B.defineLazy(t,"shape",()=>e.shape)});function $c(t,e){let r={type:"object",get shape(){return B.assignProp(this,"shape",{...t}),this.shape},...B.normalizeParams(e)};return new Zv(r)}function Xe(t){return!!t._zod}function wr(t){let e=Object.values(t);if(e.length===0)return $c({});let r=e.every(Xe),n=e.every(o=>!Xe(o));if(r)return $c(t);if(n)return Si(t);throw new Error("Mixed Zod versions detected in object shape.")}function Dt(t,e){return Xe(t)?vr(t,e):t.safeParse(e)}async function Ko(t,e){return Xe(t)?await br(t,e):await t.safeParseAsync(e)}function qt(t){if(!t)return;let e;if(Xe(t)?e=t._zod?.def?.shape:e=t.shape,!!e){if(typeof e=="function")try{return e()}catch{return}return e}}function Kr(t){if(t){if(typeof t=="object"){let e=t,r=t;if(!e._def&&!r._zod){let n=Object.values(t);if(n.length>0&&n.every(o=>typeof o=="object"&&o!==null&&(o._def!==void 0||o._zod!==void 0||typeof o.parse=="function")))return wr(t)}}if(Xe(t)){let r=t._zod?.def;if(r&&(r.type==="object"||r.shape!==void 0))return t}else if(t.shape!==void 0)return t}}function Wo(t){if(t&&typeof t=="object"){if("message"in t&&typeof t.message=="string")return t.message;if("issues"in t&&Array.isArray(t.issues)&&t.issues.length>0){let e=t.issues[0];if(e&&typeof e=="object"&&"message"in e)return String(e.message)}try{return JSON.stringify(t)}catch{return String(t)}}return String(t)}function Np(t){return t.description}function Cp(t){if(Xe(t))return t._zod?.def?.type==="optional";let e=t;return typeof t.isOptional=="function"?t.isOptional():e._def?.typeName==="ZodOptional"}function Go(t){if(Xe(t)){let s=t._zod?.def;if(s){if(s.value!==void 0)return s.value;if(Array.isArray(s.values)&&s.values.length>0)return s.values[0]}}let r=t._def;if(r){if(r.value!==void 0)return r.value;if(Array.isArray(r.values)&&r.values.length>0)return r.values[0]}let n=t.value;if(n!==void 0)return n}var On={};xi(On,{ZodISODate:()=>jp,ZodISODateTime:()=>Zp,ZodISODuration:()=>Mp,ZodISOTime:()=>Ap,date:()=>kc,datetime:()=>wc,duration:()=>zc,time:()=>Sc});var Zp=_("ZodISODateTime",(t,e)=>{bp.init(t,e),le.init(t,e)});function wc(t){return Tp(Zp,t)}var jp=_("ZodISODate",(t,e)=>{xp.init(t,e),le.init(t,e)});function kc(t){return Ep(jp,t)}var Ap=_("ZodISOTime",(t,e)=>{$p.init(t,e),le.init(t,e)});function Sc(t){return Pp(Ap,t)}var Mp=_("ZodISODuration",(t,e)=>{wp.init(t,e),le.init(t,e)});function zc(t){return Rp(Mp,t)}var Lp=(t,e)=>{No.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:r=>Ai(t,r)},flatten:{value:r=>ji(t,r)},addIssue:{value:r=>t.issues.push(r)},addIssues:{value:r=>t.issues.push(...r)},isEmpty:{get(){return t.issues.length===0}}})},pP=_("ZodError",Lp),Nn=_("ZodError",Lp,{Parent:Error});var Dp=Mi(Nn),qp=Di(Nn),Up=Ui(Nn),Fp=Fi(Nn);var he=_("ZodType",(t,e)=>(te.init(t,e),t.def=e,Object.defineProperty(t,"_def",{value:e}),t.check=(...r)=>t.clone({...e,checks:[...e.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]}),t.clone=(r,n)=>Be(t,r,n),t.brand=()=>t,t.register=((r,n)=>(r.add(t,n),t)),t.parse=(r,n)=>Dp(t,r,n,{callee:t.parse}),t.safeParse=(r,n)=>Up(t,r,n),t.parseAsync=async(r,n)=>qp(t,r,n,{callee:t.parseAsync}),t.safeParseAsync=async(r,n)=>Fp(t,r,n),t.spa=t.safeParseAsync,t.refine=(r,n)=>t.check(Ob(r,n)),t.superRefine=r=>t.check(Nb(r)),t.overwrite=r=>t.check(xr(r)),t.optional=()=>me(t),t.nullable=()=>Bp(t),t.nullish=()=>me(Bp(t)),t.nonoptional=r=>Sb(t,r),t.array=()=>W(t),t.or=r=>ae([t,r]),t.and=r=>Xo(t,r),t.transform=r=>Ec(t,Xp(r)),t.default=r=>$b(t,r),t.prefault=r=>kb(t,r),t.catch=r=>Tb(t,r),t.pipe=r=>Ec(t,r),t.readonly=()=>Rb(t),t.describe=r=>{let n=t.clone();return Lt.add(n,{description:r}),n},Object.defineProperty(t,"description",{get(){return Lt.get(t)?.description},configurable:!0}),t.meta=(...r)=>{if(r.length===0)return Lt.get(t);let n=t.clone();return Lt.add(n,r[0]),n},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),Kp=_("_ZodString",(t,e)=>{En.init(t,e),he.init(t,e);let r=t._zod.bag;t.format=r.format??null,t.minLength=r.minimum??null,t.maxLength=r.maximum??null,t.regex=(...n)=>t.check(uc(...n)),t.includes=(...n)=>t.check(pc(...n)),t.startsWith=(...n)=>t.check(fc(...n)),t.endsWith=(...n)=>t.check(mc(...n)),t.min=(...n)=>t.check(Br(...n)),t.max=(...n)=>t.check(Vo(...n)),t.length=(...n)=>t.check(Ho(...n)),t.nonempty=(...n)=>t.check(Br(1,...n)),t.lowercase=n=>t.check(lc(n)),t.uppercase=n=>t.check(dc(n)),t.trim=()=>t.check(gc()),t.normalize=(...n)=>t.check(hc(...n)),t.toLowerCase=()=>t.check(yc()),t.toUpperCase=()=>t.check(_c())}),Vv=_("ZodString",(t,e)=>{En.init(t,e),Kp.init(t,e),t.email=r=>t.check(ja(Hv,r)),t.url=r=>t.check(qa(Bv,r)),t.jwt=r=>t.check(rc(ab,r)),t.emoji=r=>t.check(Ua(Kv,r)),t.guid=r=>t.check(Do(Vp,r)),t.uuid=r=>t.check(Aa(Jo,r)),t.uuidv4=r=>t.check(Ma(Jo,r)),t.uuidv6=r=>t.check(La(Jo,r)),t.uuidv7=r=>t.check(Da(Jo,r)),t.nanoid=r=>t.check(Fa(Wv,r)),t.guid=r=>t.check(Do(Vp,r)),t.cuid=r=>t.check(Va(Gv,r)),t.cuid2=r=>t.check(Ha(Jv,r)),t.ulid=r=>t.check(Ba(Xv,r)),t.base64=r=>t.check(Qa(ob,r)),t.base64url=r=>t.check(ec(sb,r)),t.xid=r=>t.check(Ka(Yv,r)),t.ksuid=r=>t.check(Wa(Qv,r)),t.ipv4=r=>t.check(Ga(eb,r)),t.ipv6=r=>t.check(Ja(tb,r)),t.cidrv4=r=>t.check(Xa(rb,r)),t.cidrv6=r=>t.check(Ya(nb,r)),t.e164=r=>t.check(tc(ib,r)),t.datetime=r=>t.check(wc(r)),t.date=r=>t.check(kc(r)),t.time=r=>t.check(Sc(r)),t.duration=r=>t.check(zc(r))});function y(t){return Za(Vv,t)}var le=_("ZodStringFormat",(t,e)=>{ie.init(t,e),Kp.init(t,e)}),Hv=_("ZodEmail",(t,e)=>{Xi.init(t,e),le.init(t,e)});var Vp=_("ZodGUID",(t,e)=>{Gi.init(t,e),le.init(t,e)});var Jo=_("ZodUUID",(t,e)=>{Ji.init(t,e),le.init(t,e)});var Bv=_("ZodURL",(t,e)=>{Yi.init(t,e),le.init(t,e)});var Kv=_("ZodEmoji",(t,e)=>{Qi.init(t,e),le.init(t,e)});var Wv=_("ZodNanoID",(t,e)=>{ea.init(t,e),le.init(t,e)});var Gv=_("ZodCUID",(t,e)=>{ta.init(t,e),le.init(t,e)});var Jv=_("ZodCUID2",(t,e)=>{ra.init(t,e),le.init(t,e)});var Xv=_("ZodULID",(t,e)=>{na.init(t,e),le.init(t,e)});var Yv=_("ZodXID",(t,e)=>{oa.init(t,e),le.init(t,e)});var Qv=_("ZodKSUID",(t,e)=>{sa.init(t,e),le.init(t,e)});var eb=_("ZodIPv4",(t,e)=>{ia.init(t,e),le.init(t,e)});var tb=_("ZodIPv6",(t,e)=>{aa.init(t,e),le.init(t,e)});var rb=_("ZodCIDRv4",(t,e)=>{ca.init(t,e),le.init(t,e)});var nb=_("ZodCIDRv6",(t,e)=>{ua.init(t,e),le.init(t,e)});var ob=_("ZodBase64",(t,e)=>{la.init(t,e),le.init(t,e)});var sb=_("ZodBase64URL",(t,e)=>{da.init(t,e),le.init(t,e)});var ib=_("ZodE164",(t,e)=>{pa.init(t,e),le.init(t,e)});var ab=_("ZodJWT",(t,e)=>{fa.init(t,e),le.init(t,e)});var Wp=_("ZodNumber",(t,e)=>{Ao.init(t,e),he.init(t,e),t.gt=(n,o)=>t.check(Uo(n,o)),t.gte=(n,o)=>t.check(In(n,o)),t.min=(n,o)=>t.check(In(n,o)),t.lt=(n,o)=>t.check(qo(n,o)),t.lte=(n,o)=>t.check(Rn(n,o)),t.max=(n,o)=>t.check(Rn(n,o)),t.int=n=>t.check(Hp(n)),t.safe=n=>t.check(Hp(n)),t.positive=n=>t.check(Uo(0,n)),t.nonnegative=n=>t.check(In(0,n)),t.negative=n=>t.check(qo(0,n)),t.nonpositive=n=>t.check(Rn(0,n)),t.multipleOf=(n,o)=>t.check(Fo(n,o)),t.step=(n,o)=>t.check(Fo(n,o)),t.finite=()=>t;let r=t._zod.bag;t.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),t.isFinite=!0,t.format=r.format??null});function ee(t){return nc(Wp,t)}var cb=_("ZodNumberFormat",(t,e)=>{ma.init(t,e),Wp.init(t,e)});function Hp(t){return oc(cb,t)}var ub=_("ZodBoolean",(t,e)=>{ha.init(t,e),he.init(t,e)});function ve(t){return sc(ub,t)}var lb=_("ZodNull",(t,e)=>{ga.init(t,e),he.init(t,e)});function Pc(t){return ic(lb,t)}var db=_("ZodUnknown",(t,e)=>{ya.init(t,e),he.init(t,e)});function de(){return ac(db)}var pb=_("ZodNever",(t,e)=>{_a.init(t,e),he.init(t,e)});function fb(t){return cc(pb,t)}var mb=_("ZodArray",(t,e)=>{va.init(t,e),he.init(t,e),t.element=e.element,t.min=(r,n)=>t.check(Br(r,n)),t.nonempty=r=>t.check(Br(1,r)),t.max=(r,n)=>t.check(Vo(r,n)),t.length=(r,n)=>t.check(Ho(r,n)),t.unwrap=()=>t.element});function W(t,e){return Ip(mb,t,e)}var Gp=_("ZodObject",(t,e)=>{Mo.init(t,e),he.init(t,e),B.defineLazy(t,"shape",()=>e.shape),t.keyof=()=>Le(Object.keys(t._zod.def.shape)),t.catchall=r=>t.clone({...t._zod.def,catchall:r}),t.passthrough=()=>t.clone({...t._zod.def,catchall:de()}),t.loose=()=>t.clone({...t._zod.def,catchall:de()}),t.strict=()=>t.clone({...t._zod.def,catchall:fb()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=r=>B.extend(t,r),t.merge=r=>B.merge(t,r),t.pick=r=>B.pick(t,r),t.omit=r=>B.omit(t,r),t.partial=(...r)=>B.partial(Yp,t,r[0]),t.required=(...r)=>B.required(Qp,t,r[0])});function E(t,e){let r={type:"object",get shape(){return B.assignProp(this,"shape",{...t}),this.shape},...B.normalizeParams(e)};return new Gp(r)}function Ie(t,e){return new Gp({type:"object",get shape(){return B.assignProp(this,"shape",{...t}),this.shape},catchall:de(),...B.normalizeParams(e)})}var Jp=_("ZodUnion",(t,e)=>{Lo.init(t,e),he.init(t,e),t.options=e.options});function ae(t,e){return new Jp({type:"union",options:t,...B.normalizeParams(e)})}var hb=_("ZodDiscriminatedUnion",(t,e)=>{Jp.init(t,e),ba.init(t,e)});function Rc(t,e,r){return new hb({type:"union",options:e,discriminator:t,...B.normalizeParams(r)})}var gb=_("ZodIntersection",(t,e)=>{xa.init(t,e),he.init(t,e)});function Xo(t,e){return new gb({type:"intersection",left:t,right:e})}var yb=_("ZodRecord",(t,e)=>{$a.init(t,e),he.init(t,e),t.keyType=e.keyType,t.valueType=e.valueType});function pe(t,e,r){return new yb({type:"record",keyType:t,valueType:e,...B.normalizeParams(r)})}var Tc=_("ZodEnum",(t,e)=>{wa.init(t,e),he.init(t,e),t.enum=e.entries,t.options=Object.values(e.entries);let r=new Set(Object.keys(e.entries));t.extract=(n,o)=>{let s={};for(let i of n)if(r.has(i))s[i]=e.entries[i];else throw new Error(`Key ${i} not found in enum`);return new Tc({...e,checks:[],...B.normalizeParams(o),entries:s})},t.exclude=(n,o)=>{let s={...e.entries};for(let i of n)if(r.has(i))delete s[i];else throw new Error(`Key ${i} not found in enum`);return new Tc({...e,checks:[],...B.normalizeParams(o),entries:s})}});function Le(t,e){let r=Array.isArray(t)?Object.fromEntries(t.map(n=>[n,n])):t;return new Tc({type:"enum",entries:r,...B.normalizeParams(e)})}var _b=_("ZodLiteral",(t,e)=>{ka.init(t,e),he.init(t,e),t.values=new Set(e.values),Object.defineProperty(t,"value",{get(){if(e.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return e.values[0]}})});function I(t,e){return new _b({type:"literal",values:Array.isArray(t)?t:[t],...B.normalizeParams(e)})}var vb=_("ZodTransform",(t,e)=>{Sa.init(t,e),he.init(t,e),t._zod.parse=(r,n)=>{r.addIssue=s=>{if(typeof s=="string")r.issues.push(B.issue(s,r.value,e));else{let i=s;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=r.value),i.inst??(i.inst=t),i.continue??(i.continue=!0),r.issues.push(B.issue(i))}};let o=e.transform(r.value,r);return o instanceof Promise?o.then(s=>(r.value=s,r)):(r.value=o,r)}});function Xp(t){return new vb({type:"transform",transform:t})}var Yp=_("ZodOptional",(t,e)=>{za.init(t,e),he.init(t,e),t.unwrap=()=>t._zod.def.innerType});function me(t){return new Yp({type:"optional",innerType:t})}var bb=_("ZodNullable",(t,e)=>{Ta.init(t,e),he.init(t,e),t.unwrap=()=>t._zod.def.innerType});function Bp(t){return new bb({type:"nullable",innerType:t})}var xb=_("ZodDefault",(t,e)=>{Ea.init(t,e),he.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function $b(t,e){return new xb({type:"default",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}var wb=_("ZodPrefault",(t,e)=>{Pa.init(t,e),he.init(t,e),t.unwrap=()=>t._zod.def.innerType});function kb(t,e){return new wb({type:"prefault",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}var Qp=_("ZodNonOptional",(t,e)=>{Ra.init(t,e),he.init(t,e),t.unwrap=()=>t._zod.def.innerType});function Sb(t,e){return new Qp({type:"nonoptional",innerType:t,...B.normalizeParams(e)})}var zb=_("ZodCatch",(t,e)=>{Ia.init(t,e),he.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function Tb(t,e){return new zb({type:"catch",innerType:t,catchValue:typeof e=="function"?e:()=>e})}var Eb=_("ZodPipe",(t,e)=>{Oa.init(t,e),he.init(t,e),t.in=e.in,t.out=e.out});function Ec(t,e){return new Eb({type:"pipe",in:t,out:e})}var Pb=_("ZodReadonly",(t,e)=>{Na.init(t,e),he.init(t,e)});function Rb(t){return new Pb({type:"readonly",innerType:t})}var ef=_("ZodCustom",(t,e)=>{Ca.init(t,e),he.init(t,e)});function Ib(t){let e=new xe({check:"custom"});return e._zod.check=t,e}function tf(t,e){return vc(ef,t??(()=>!0),e)}function Ob(t,e={}){return bc(ef,t,e)}function Nb(t){let e=Ib(r=>(r.addIssue=n=>{if(typeof n=="string")r.issues.push(B.issue(n,r.value,e._zod.def));else{let o=n;o.fatal&&(o.continue=!1),o.code??(o.code="custom"),o.input??(o.input=r.value),o.inst??(o.inst=e),o.continue??(o.continue=!e._zod.def.abort),r.issues.push(B.issue(o))}},t(r.value,r)));return e}function Ic(t,e){return Ec(Xp(t),e)}He(Sp());var Nc="2025-11-25";var rf=[Nc,"2025-06-18","2025-03-26","2024-11-05","2024-10-07"],Ut="io.modelcontextprotocol/related-task",Qo="2.0",$e=tf(t=>t!==null&&(typeof t=="object"||typeof t=="function")),nf=ae([y(),ee().int()]),of=y(),zP=Ie({ttl:ae([ee(),Pc()]).optional(),pollInterval:ee().optional()}),Cb=E({ttl:ee().optional()}),Zb=E({taskId:y()}),Cc=Ie({progressToken:nf.optional(),[Ut]:Zb.optional()}),Ke=E({_meta:Cc.optional()}),Cn=Ke.extend({task:Cb.optional()}),sf=t=>Cn.safeParse(t).success,we=E({method:y(),params:Ke.loose().optional()}),Ye=E({_meta:Cc.optional()}),Qe=E({method:y(),params:Ye.loose().optional()}),ke=Ie({_meta:Cc.optional()}),es=ae([y(),ee().int()]),af=E({jsonrpc:I(Qo),id:es,...we.shape}).strict(),Zc=t=>af.safeParse(t).success,cf=E({jsonrpc:I(Qo),...Qe.shape}).strict(),uf=t=>cf.safeParse(t).success,jc=E({jsonrpc:I(Qo),id:es,result:ke}).strict(),Zn=t=>jc.safeParse(t).success;var C;(function(t){t[t.ConnectionClosed=-32e3]="ConnectionClosed",t[t.RequestTimeout=-32001]="RequestTimeout",t[t.ParseError=-32700]="ParseError",t[t.InvalidRequest=-32600]="InvalidRequest",t[t.MethodNotFound=-32601]="MethodNotFound",t[t.InvalidParams=-32602]="InvalidParams",t[t.InternalError=-32603]="InternalError",t[t.UrlElicitationRequired=-32042]="UrlElicitationRequired"})(C||(C={}));var Ac=E({jsonrpc:I(Qo),id:es.optional(),error:E({code:ee().int(),message:y(),data:de().optional()})}).strict();var lf=t=>Ac.safeParse(t).success;var df=ae([af,cf,jc,Ac]),TP=ae([jc,Ac]),ts=ke.strict(),jb=Ye.extend({requestId:es.optional(),reason:y().optional()}),rs=Qe.extend({method:I("notifications/cancelled"),params:jb}),Ab=E({src:y(),mimeType:y().optional(),sizes:W(y()).optional(),theme:Le(["light","dark"]).optional()}),jn=E({icons:W(Ab).optional()}),Wr=E({name:y(),title:y().optional()}),pf=Wr.extend({...Wr.shape,...jn.shape,version:y(),websiteUrl:y().optional(),description:y().optional()}),Mb=Xo(E({applyDefaults:ve().optional()}),pe(y(),de())),Lb=Ic(t=>t&&typeof t=="object"&&!Array.isArray(t)&&Object.keys(t).length===0?{form:{}}:t,Xo(E({form:Mb.optional(),url:$e.optional()}),pe(y(),de()).optional())),Db=Ie({list:$e.optional(),cancel:$e.optional(),requests:Ie({sampling:Ie({createMessage:$e.optional()}).optional(),elicitation:Ie({create:$e.optional()}).optional()}).optional()}),qb=Ie({list:$e.optional(),cancel:$e.optional(),requests:Ie({tools:Ie({call:$e.optional()}).optional()}).optional()}),Ub=E({experimental:pe(y(),$e).optional(),sampling:E({context:$e.optional(),tools:$e.optional()}).optional(),elicitation:Lb.optional(),roots:E({listChanged:ve().optional()}).optional(),tasks:Db.optional()}),Fb=Ke.extend({protocolVersion:y(),capabilities:Ub,clientInfo:pf}),Mc=we.extend({method:I("initialize"),params:Fb});var Vb=E({experimental:pe(y(),$e).optional(),logging:$e.optional(),completions:$e.optional(),prompts:E({listChanged:ve().optional()}).optional(),resources:E({subscribe:ve().optional(),listChanged:ve().optional()}).optional(),tools:E({listChanged:ve().optional()}).optional(),tasks:qb.optional()}),Hb=ke.extend({protocolVersion:y(),capabilities:Vb,serverInfo:pf,instructions:y().optional()}),Lc=Qe.extend({method:I("notifications/initialized"),params:Ye.optional()});var ns=we.extend({method:I("ping"),params:Ke.optional()}),Bb=E({progress:ee(),total:me(ee()),message:me(y())}),Kb=E({...Ye.shape,...Bb.shape,progressToken:nf}),os=Qe.extend({method:I("notifications/progress"),params:Kb}),Wb=Ke.extend({cursor:of.optional()}),An=we.extend({params:Wb.optional()}),Mn=ke.extend({nextCursor:of.optional()}),Gb=Le(["working","input_required","completed","failed","cancelled"]),Ln=E({taskId:y(),status:Gb,ttl:ae([ee(),Pc()]),createdAt:y(),lastUpdatedAt:y(),pollInterval:me(ee()),statusMessage:me(y())}),Gr=ke.extend({task:Ln}),Jb=Ye.merge(Ln),Dn=Qe.extend({method:I("notifications/tasks/status"),params:Jb}),ss=we.extend({method:I("tasks/get"),params:Ke.extend({taskId:y()})}),is=ke.merge(Ln),as=we.extend({method:I("tasks/result"),params:Ke.extend({taskId:y()})}),EP=ke.loose(),cs=An.extend({method:I("tasks/list")}),us=Mn.extend({tasks:W(Ln)}),ls=we.extend({method:I("tasks/cancel"),params:Ke.extend({taskId:y()})}),ff=ke.merge(Ln),mf=E({uri:y(),mimeType:me(y()),_meta:pe(y(),de()).optional()}),hf=mf.extend({text:y()}),Dc=y().refine(t=>{try{return atob(t),!0}catch{return!1}},{message:"Invalid Base64 string"}),gf=mf.extend({blob:Dc}),qn=Le(["user","assistant"]),Jr=E({audience:W(qn).optional(),priority:ee().min(0).max(1).optional(),lastModified:On.datetime({offset:!0}).optional()}),yf=E({...Wr.shape,...jn.shape,uri:y(),description:me(y()),mimeType:me(y()),annotations:Jr.optional(),_meta:me(Ie({}))}),Xb=E({...Wr.shape,...jn.shape,uriTemplate:y(),description:me(y()),mimeType:me(y()),annotations:Jr.optional(),_meta:me(Ie({}))}),ds=An.extend({method:I("resources/list")}),Yb=Mn.extend({resources:W(yf)}),ps=An.extend({method:I("resources/templates/list")}),Qb=Mn.extend({resourceTemplates:W(Xb)}),qc=Ke.extend({uri:y()}),ex=qc,fs=we.extend({method:I("resources/read"),params:ex}),tx=ke.extend({contents:W(ae([hf,gf]))}),rx=Qe.extend({method:I("notifications/resources/list_changed"),params:Ye.optional()}),nx=qc,ox=we.extend({method:I("resources/subscribe"),params:nx}),sx=qc,ix=we.extend({method:I("resources/unsubscribe"),params:sx}),ax=Ye.extend({uri:y()}),cx=Qe.extend({method:I("notifications/resources/updated"),params:ax}),ux=E({name:y(),description:me(y()),required:me(ve())}),lx=E({...Wr.shape,...jn.shape,description:me(y()),arguments:me(W(ux)),_meta:me(Ie({}))}),ms=An.extend({method:I("prompts/list")}),dx=Mn.extend({prompts:W(lx)}),px=Ke.extend({name:y(),arguments:pe(y(),y()).optional()}),hs=we.extend({method:I("prompts/get"),params:px}),Uc=E({type:I("text"),text:y(),annotations:Jr.optional(),_meta:pe(y(),de()).optional()}),Fc=E({type:I("image"),data:Dc,mimeType:y(),annotations:Jr.optional(),_meta:pe(y(),de()).optional()}),Vc=E({type:I("audio"),data:Dc,mimeType:y(),annotations:Jr.optional(),_meta:pe(y(),de()).optional()}),fx=E({type:I("tool_use"),name:y(),id:y(),input:pe(y(),de()),_meta:pe(y(),de()).optional()}),mx=E({type:I("resource"),resource:ae([hf,gf]),annotations:Jr.optional(),_meta:pe(y(),de()).optional()}),hx=yf.extend({type:I("resource_link")}),Hc=ae([Uc,Fc,Vc,hx,mx]),gx=E({role:qn,content:Hc}),yx=ke.extend({description:y().optional(),messages:W(gx)}),_x=Qe.extend({method:I("notifications/prompts/list_changed"),params:Ye.optional()}),vx=E({title:y().optional(),readOnlyHint:ve().optional(),destructiveHint:ve().optional(),idempotentHint:ve().optional(),openWorldHint:ve().optional()}),bx=E({taskSupport:Le(["required","optional","forbidden"]).optional()}),_f=E({...Wr.shape,...jn.shape,description:y().optional(),inputSchema:E({type:I("object"),properties:pe(y(),$e).optional(),required:W(y()).optional()}).catchall(de()),outputSchema:E({type:I("object"),properties:pe(y(),$e).optional(),required:W(y()).optional()}).catchall(de()).optional(),annotations:vx.optional(),execution:bx.optional(),_meta:pe(y(),de()).optional()}),gs=An.extend({method:I("tools/list")}),xx=Mn.extend({tools:W(_f)}),ys=ke.extend({content:W(Hc).default([]),structuredContent:pe(y(),de()).optional(),isError:ve().optional()}),PP=ys.or(ke.extend({toolResult:de()})),$x=Cn.extend({name:y(),arguments:pe(y(),de()).optional()}),Xr=we.extend({method:I("tools/call"),params:$x}),wx=Qe.extend({method:I("notifications/tools/list_changed"),params:Ye.optional()}),RP=E({autoRefresh:ve().default(!0),debounceMs:ee().int().nonnegative().default(300)}),Un=Le(["debug","info","notice","warning","error","critical","alert","emergency"]),kx=Ke.extend({level:Un}),Bc=we.extend({method:I("logging/setLevel"),params:kx}),Sx=Ye.extend({level:Un,logger:y().optional(),data:de()}),zx=Qe.extend({method:I("notifications/message"),params:Sx}),Tx=E({name:y().optional()}),Ex=E({hints:W(Tx).optional(),costPriority:ee().min(0).max(1).optional(),speedPriority:ee().min(0).max(1).optional(),intelligencePriority:ee().min(0).max(1).optional()}),Px=E({mode:Le(["auto","required","none"]).optional()}),Rx=E({type:I("tool_result"),toolUseId:y().describe("The unique identifier for the corresponding tool call."),content:W(Hc).default([]),structuredContent:E({}).loose().optional(),isError:ve().optional(),_meta:pe(y(),de()).optional()}),Ix=Rc("type",[Uc,Fc,Vc]),Yo=Rc("type",[Uc,Fc,Vc,fx,Rx]),Ox=E({role:qn,content:ae([Yo,W(Yo)]),_meta:pe(y(),de()).optional()}),Nx=Cn.extend({messages:W(Ox),modelPreferences:Ex.optional(),systemPrompt:y().optional(),includeContext:Le(["none","thisServer","allServers"]).optional(),temperature:ee().optional(),maxTokens:ee().int(),stopSequences:W(y()).optional(),metadata:$e.optional(),tools:W(_f).optional(),toolChoice:Px.optional()}),Cx=we.extend({method:I("sampling/createMessage"),params:Nx}),Kc=ke.extend({model:y(),stopReason:me(Le(["endTurn","stopSequence","maxTokens"]).or(y())),role:qn,content:Ix}),Wc=ke.extend({model:y(),stopReason:me(Le(["endTurn","stopSequence","maxTokens","toolUse"]).or(y())),role:qn,content:ae([Yo,W(Yo)])}),Zx=E({type:I("boolean"),title:y().optional(),description:y().optional(),default:ve().optional()}),jx=E({type:I("string"),title:y().optional(),description:y().optional(),minLength:ee().optional(),maxLength:ee().optional(),format:Le(["email","uri","date","date-time"]).optional(),default:y().optional()}),Ax=E({type:Le(["number","integer"]),title:y().optional(),description:y().optional(),minimum:ee().optional(),maximum:ee().optional(),default:ee().optional()}),Mx=E({type:I("string"),title:y().optional(),description:y().optional(),enum:W(y()),default:y().optional()}),Lx=E({type:I("string"),title:y().optional(),description:y().optional(),oneOf:W(E({const:y(),title:y()})),default:y().optional()}),Dx=E({type:I("string"),title:y().optional(),description:y().optional(),enum:W(y()),enumNames:W(y()).optional(),default:y().optional()}),qx=ae([Mx,Lx]),Ux=E({type:I("array"),title:y().optional(),description:y().optional(),minItems:ee().optional(),maxItems:ee().optional(),items:E({type:I("string"),enum:W(y())}),default:W(y()).optional()}),Fx=E({type:I("array"),title:y().optional(),description:y().optional(),minItems:ee().optional(),maxItems:ee().optional(),items:E({anyOf:W(E({const:y(),title:y()}))}),default:W(y()).optional()}),Vx=ae([Ux,Fx]),Hx=ae([Dx,qx,Vx]),Bx=ae([Hx,Zx,jx,Ax]),Kx=Cn.extend({mode:I("form").optional(),message:y(),requestedSchema:E({type:I("object"),properties:pe(y(),Bx),required:W(y()).optional()})}),Wx=Cn.extend({mode:I("url"),message:y(),elicitationId:y(),url:y().url()}),Gx=ae([Kx,Wx]),Jx=we.extend({method:I("elicitation/create"),params:Gx}),Xx=Ye.extend({elicitationId:y()}),Yx=Qe.extend({method:I("notifications/elicitation/complete"),params:Xx}),_s=ke.extend({action:Le(["accept","decline","cancel"]),content:Ic(t=>t===null?void 0:t,pe(y(),ae([y(),ee(),ve(),W(y())])).optional())}),Qx=E({type:I("ref/resource"),uri:y()});var e$=E({type:I("ref/prompt"),name:y()}),t$=Ke.extend({ref:ae([e$,Qx]),argument:E({name:y(),value:y()}),context:E({arguments:pe(y(),y()).optional()}).optional()}),vs=we.extend({method:I("completion/complete"),params:t$});function vf(t){if(t.params.ref.type!=="ref/prompt")throw new TypeError(`Expected CompleteRequestPrompt, but got ${t.params.ref.type}`)}function bf(t){if(t.params.ref.type!=="ref/resource")throw new TypeError(`Expected CompleteRequestResourceTemplate, but got ${t.params.ref.type}`)}var r$=ke.extend({completion:Ie({values:W(y()).max(100),total:me(ee().int()),hasMore:me(ve())})}),n$=E({uri:y().startsWith("file://"),name:y().optional(),_meta:pe(y(),de()).optional()}),o$=we.extend({method:I("roots/list"),params:Ke.optional()}),Gc=ke.extend({roots:W(n$)}),s$=Qe.extend({method:I("notifications/roots/list_changed"),params:Ye.optional()}),IP=ae([ns,Mc,vs,Bc,hs,ms,ds,ps,fs,ox,ix,Xr,gs,ss,as,cs,ls]),OP=ae([rs,os,Lc,s$,Dn]),NP=ae([ts,Kc,Wc,_s,Gc,is,us,Gr]),CP=ae([ns,Cx,Jx,o$,ss,as,cs,ls]),ZP=ae([rs,os,zx,cx,rx,wx,_x,Dn,Yx]),jP=ae([ts,Hb,r$,yx,dx,Yb,Qb,tx,ys,xx,is,us,Gr]),R=class t extends Error{constructor(e,r,n){super(`MCP error ${e}: ${r}`),this.code=e,this.data=n,this.name="McpError"}static fromError(e,r,n){if(e===C.UrlElicitationRequired&&n){let o=n;if(o.elicitations)return new Oc(o.elicitations,r)}return new t(e,r,n)}},Oc=class extends R{constructor(e,r=`URL elicitation${e.length>1?"s":""} required`){super(C.UrlElicitationRequired,r,{elicitations:e})}get elicitations(){return this.data?.elicitations??[]}};function Ft(t){return t==="completed"||t==="failed"||t==="cancelled"}var $f=Symbol("Let zodToJsonSchema decide on which parser to use");var xf={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},wf=t=>typeof t=="string"?{...xf,name:t}:{...xf,...t};var kf=t=>{let e=wf(t),r=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,flags:{hasReferencedOpenAiAnyType:!1},currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([n,o])=>[o._def,{def:o._def,path:[...e.basePath,e.definitionPath,n],jsonSchema:void 0}]))}};function Jc(t,e,r,n){n?.errorMessages&&r&&(t.errorMessage={...t.errorMessage,[e]:r})}function G(t,e,r,n,o){t[e]=r,Jc(t,e,n,o)}var bs=(t,e)=>{let r=0;for(;r<t.length&&r<e.length&&t[r]===e[r];r++);return[(t.length-r).toString(),...e.slice(r)].join("/")};function fe(t){if(t.target!=="openAi")return{};let e=[...t.basePath,t.definitionPath,t.openAiAnyTypeName];return t.flags.hasReferencedOpenAiAnyType=!0,{$ref:t.$refStrategy==="relative"?bs(e,t.currentPath):e.join("/")}}function Sf(t,e){let r={type:"array"};return t.type?._def&&t.type?._def?.typeName!==w.ZodAny&&(r.items=A(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&G(r,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&G(r,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&(G(r,"minItems",t.exactLength.value,t.exactLength.message,e),G(r,"maxItems",t.exactLength.value,t.exactLength.message,e)),r}function zf(t,e){let r={type:"integer",format:"int64"};if(!t.checks)return r;for(let n of t.checks)switch(n.kind){case"min":e.target==="jsonSchema7"?n.inclusive?G(r,"minimum",n.value,n.message,e):G(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),G(r,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?G(r,"maximum",n.value,n.message,e):G(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),G(r,"maximum",n.value,n.message,e));break;case"multipleOf":G(r,"multipleOf",n.value,n.message,e);break}return r}function Tf(){return{type:"boolean"}}function xs(t,e){return A(t.type._def,e)}var Ef=(t,e)=>A(t.innerType._def,e);function Xc(t,e,r){let n=r??e.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((o,s)=>Xc(t,e,o))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return i$(t,e)}}var i$=(t,e)=>{let r={type:"integer",format:"unix-time"};if(e.target==="openApi3")return r;for(let n of t.checks)switch(n.kind){case"min":G(r,"minimum",n.value,n.message,e);break;case"max":G(r,"maximum",n.value,n.message,e);break}return r};function Pf(t,e){return{...A(t.innerType._def,e),default:t.defaultValue()}}function Rf(t,e){return e.effectStrategy==="input"?A(t.schema._def,e):fe(e)}function If(t){return{type:"string",enum:Array.from(t.values)}}var a$=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function Of(t,e){let r=[A(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),A(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(s=>!!s),n=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0,o=[];return r.forEach(s=>{if(a$(s))o.push(...s.allOf),s.unevaluatedProperties===void 0&&(n=void 0);else{let i=s;if("additionalProperties"in s&&s.additionalProperties===!1){let{additionalProperties:a,...c}=s;i=c}else n=void 0;o.push(i)}}),o.length?{allOf:o,...n}:void 0}function Nf(t,e){let r=typeof t.value;return r!=="bigint"&&r!=="number"&&r!=="boolean"&&r!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:r==="bigint"?"integer":r,enum:[t.value]}:{type:r==="bigint"?"integer":r,const:t.value}}var Yc,it={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Yc===void 0&&(Yc=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Yc),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function $s(t,e){let r={type:"string"};if(t.checks)for(let n of t.checks)switch(n.kind){case"min":G(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,n.value):n.value,n.message,e);break;case"max":G(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,n.value):n.value,n.message,e);break;case"email":switch(e.emailStrategy){case"format:email":at(r,"email",n.message,e);break;case"format:idn-email":at(r,"idn-email",n.message,e);break;case"pattern:zod":Oe(r,it.email,n.message,e);break}break;case"url":at(r,"uri",n.message,e);break;case"uuid":at(r,"uuid",n.message,e);break;case"regex":Oe(r,n.regex,n.message,e);break;case"cuid":Oe(r,it.cuid,n.message,e);break;case"cuid2":Oe(r,it.cuid2,n.message,e);break;case"startsWith":Oe(r,RegExp(`^${Qc(n.value,e)}`),n.message,e);break;case"endsWith":Oe(r,RegExp(`${Qc(n.value,e)}$`),n.message,e);break;case"datetime":at(r,"date-time",n.message,e);break;case"date":at(r,"date",n.message,e);break;case"time":at(r,"time",n.message,e);break;case"duration":at(r,"duration",n.message,e);break;case"length":G(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,n.value):n.value,n.message,e),G(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,n.value):n.value,n.message,e);break;case"includes":{Oe(r,RegExp(Qc(n.value,e)),n.message,e);break}case"ip":{n.version!=="v6"&&at(r,"ipv4",n.message,e),n.version!=="v4"&&at(r,"ipv6",n.message,e);break}case"base64url":Oe(r,it.base64url,n.message,e);break;case"jwt":Oe(r,it.jwt,n.message,e);break;case"cidr":{n.version!=="v6"&&Oe(r,it.ipv4Cidr,n.message,e),n.version!=="v4"&&Oe(r,it.ipv6Cidr,n.message,e);break}case"emoji":Oe(r,it.emoji(),n.message,e);break;case"ulid":{Oe(r,it.ulid,n.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{at(r,"binary",n.message,e);break}case"contentEncoding:base64":{G(r,"contentEncoding","base64",n.message,e);break}case"pattern:zod":{Oe(r,it.base64,n.message,e);break}}break}case"nanoid":Oe(r,it.nanoid,n.message,e);case"toLowerCase":case"toUpperCase":case"trim":break;default:}return r}function Qc(t,e){return e.patternStrategy==="escape"?u$(t):t}var c$=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function u$(t){let e="";for(let r=0;r<t.length;r++)c$.has(t[r])||(e+="\\"),e+=t[r];return e}function at(t,e,r,n){t.format||t.anyOf?.some(o=>o.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&n.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...r&&n.errorMessages&&{errorMessage:{format:r}}})):G(t,"format",e,r,n)}function Oe(t,e,r,n){t.pattern||t.allOf?.some(o=>o.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push({pattern:t.pattern,...t.errorMessage&&n.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:Cf(e,n),...r&&n.errorMessages&&{errorMessage:{pattern:r}}})):G(t,"pattern",Cf(e,n),r,n)}function Cf(t,e){if(!e.applyRegexFlags||!t.flags)return t.source;let r={i:t.flags.includes("i"),m:t.flags.includes("m"),s:t.flags.includes("s")},n=r.i?t.source.toLowerCase():t.source,o="",s=!1,i=!1,a=!1;for(let c=0;c<n.length;c++){if(s){o+=n[c],s=!1;continue}if(r.i){if(i){if(n[c].match(/[a-z]/)){a?(o+=n[c],o+=`${n[c-2]}-${n[c]}`.toUpperCase(),a=!1):n[c+1]==="-"&&n[c+2]?.match(/[a-z]/)?(o+=n[c],a=!0):o+=`${n[c]}${n[c].toUpperCase()}`;continue}}else if(n[c].match(/[a-z]/)){o+=`[${n[c]}${n[c].toUpperCase()}]`;continue}}if(r.m){if(n[c]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(n[c]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&n[c]==="."){o+=i?`${n[c]}\r
`:`[${n[c]}\r
]`;continue}o+=n[c],n[c]==="\\"?s=!0:i&&n[c]==="]"?i=!1:!i&&n[c]==="["&&(i=!0)}try{new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),t.source}return o}function ws(t,e){if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&t.keyType?._def.typeName===w.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((n,o)=>({...n,[o]:A(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",o]})??fe(e)}),{}),additionalProperties:e.rejectedAdditionalProperties};let r={type:"object",additionalProperties:A(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??e.allowedAdditionalProperties};if(e.target==="openApi3")return r;if(t.keyType?._def.typeName===w.ZodString&&t.keyType._def.checks?.length){let{type:n,...o}=$s(t.keyType._def,e);return{...r,propertyNames:o}}else{if(t.keyType?._def.typeName===w.ZodEnum)return{...r,propertyNames:{enum:t.keyType._def.values}};if(t.keyType?._def.typeName===w.ZodBranded&&t.keyType._def.type._def.typeName===w.ZodString&&t.keyType._def.type._def.checks?.length){let{type:n,...o}=xs(t.keyType._def,e);return{...r,propertyNames:o}}}return r}function Zf(t,e){if(e.mapStrategy==="record")return ws(t,e);let r=A(t.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||fe(e),n=A(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||fe(e);return{type:"array",maxItems:125,items:{type:"array",items:[r,n],minItems:2,maxItems:2}}}function jf(t){let e=t.values,n=Object.keys(t.values).filter(s=>typeof e[e[s]]!="number").map(s=>e[s]),o=Array.from(new Set(n.map(s=>typeof s)));return{type:o.length===1?o[0]==="string"?"string":"number":["string","number"],enum:n}}function Af(t){return t.target==="openAi"?void 0:{not:fe({...t,currentPath:[...t.currentPath,"not"]})}}function Mf(t){return t.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}var Fn={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Df(t,e){if(e.target==="openApi3")return Lf(t,e);let r=t.options instanceof Map?Array.from(t.options.values()):t.options;if(r.every(n=>n._def.typeName in Fn&&(!n._def.checks||!n._def.checks.length))){let n=r.reduce((o,s)=>{let i=Fn[s._def.typeName];return i&&!o.includes(i)?[...o,i]:o},[]);return{type:n.length>1?n:n[0]}}else if(r.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){let n=r.reduce((o,s)=>{let i=typeof s._def.value;switch(i){case"string":case"number":case"boolean":return[...o,i];case"bigint":return[...o,"integer"];case"object":if(s._def.value===null)return[...o,"null"];default:return o}},[]);if(n.length===r.length){let o=n.filter((s,i,a)=>a.indexOf(s)===i);return{type:o.length>1?o:o[0],enum:r.reduce((s,i)=>s.includes(i._def.value)?s:[...s,i._def.value],[])}}}else if(r.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:r.reduce((n,o)=>[...n,...o._def.values.filter(s=>!n.includes(s))],[])};return Lf(t,e)}var Lf=(t,e)=>{let r=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((n,o)=>A(n._def,{...e,currentPath:[...e.currentPath,"anyOf",`${o}`]})).filter(n=>!!n&&(!e.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return r.length?{anyOf:r}:void 0};function qf(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"?{type:Fn[t.innerType._def.typeName],nullable:!0}:{type:[Fn[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){let n=A(t.innerType._def,{...e,currentPath:[...e.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}let r=A(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}function Uf(t,e){let r={type:"number"};if(!t.checks)return r;for(let n of t.checks)switch(n.kind){case"int":r.type="integer",Jc(r,"type",n.message,e);break;case"min":e.target==="jsonSchema7"?n.inclusive?G(r,"minimum",n.value,n.message,e):G(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),G(r,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?G(r,"maximum",n.value,n.message,e):G(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),G(r,"maximum",n.value,n.message,e));break;case"multipleOf":G(r,"multipleOf",n.value,n.message,e);break}return r}function Ff(t,e){let r=e.target==="openAi",n={type:"object",properties:{}},o=[],s=t.shape();for(let a in s){let c=s[a];if(c===void 0||c._def===void 0)continue;let u=d$(c);u&&r&&(c._def.typeName==="ZodOptional"&&(c=c._def.innerType),c.isNullable()||(c=c.nullable()),u=!1);let l=A(c._def,{...e,currentPath:[...e.currentPath,"properties",a],propertyPath:[...e.currentPath,"properties",a]});l!==void 0&&(n.properties[a]=l,u||o.push(a))}o.length&&(n.required=o);let i=l$(t,e);return i!==void 0&&(n.additionalProperties=i),n}function l$(t,e){if(t.catchall._def.typeName!=="ZodNever")return A(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]});switch(t.unknownKeys){case"passthrough":return e.allowedAdditionalProperties;case"strict":return e.rejectedAdditionalProperties;case"strip":return e.removeAdditionalStrategy==="strict"?e.allowedAdditionalProperties:e.rejectedAdditionalProperties}}function d$(t){try{return t.isOptional()}catch{return!0}}var Vf=(t,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return A(t.innerType._def,e);let r=A(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return r?{anyOf:[{not:fe(e)},r]}:fe(e)};var Hf=(t,e)=>{if(e.pipeStrategy==="input")return A(t.in._def,e);if(e.pipeStrategy==="output")return A(t.out._def,e);let r=A(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),n=A(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,n].filter(o=>o!==void 0)}};function Bf(t,e){return A(t.type._def,e)}function Kf(t,e){let n={type:"array",uniqueItems:!0,items:A(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&G(n,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&G(n,"maxItems",t.maxSize.value,t.maxSize.message,e),n}function Wf(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((r,n)=>A(r._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[]),additionalItems:A(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((r,n)=>A(r._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[])}}function Gf(t){return{not:fe(t)}}function Jf(t){return fe(t)}var Xf=(t,e)=>A(t.innerType._def,e);var Yf=(t,e,r)=>{switch(e){case w.ZodString:return $s(t,r);case w.ZodNumber:return Uf(t,r);case w.ZodObject:return Ff(t,r);case w.ZodBigInt:return zf(t,r);case w.ZodBoolean:return Tf();case w.ZodDate:return Xc(t,r);case w.ZodUndefined:return Gf(r);case w.ZodNull:return Mf(r);case w.ZodArray:return Sf(t,r);case w.ZodUnion:case w.ZodDiscriminatedUnion:return Df(t,r);case w.ZodIntersection:return Of(t,r);case w.ZodTuple:return Wf(t,r);case w.ZodRecord:return ws(t,r);case w.ZodLiteral:return Nf(t,r);case w.ZodEnum:return If(t);case w.ZodNativeEnum:return jf(t);case w.ZodNullable:return qf(t,r);case w.ZodOptional:return Vf(t,r);case w.ZodMap:return Zf(t,r);case w.ZodSet:return Kf(t,r);case w.ZodLazy:return()=>t.getter()._def;case w.ZodPromise:return Bf(t,r);case w.ZodNaN:case w.ZodNever:return Af(r);case w.ZodEffects:return Rf(t,r);case w.ZodAny:return fe(r);case w.ZodUnknown:return Jf(r);case w.ZodDefault:return Pf(t,r);case w.ZodBranded:return xs(t,r);case w.ZodReadonly:return Xf(t,r);case w.ZodCatch:return Ef(t,r);case w.ZodPipeline:return Hf(t,r);case w.ZodFunction:case w.ZodVoid:case w.ZodSymbol:return;default:return(n=>{})(e)}};function A(t,e,r=!1){let n=e.seen.get(t);if(e.override){let a=e.override?.(t,e,n,r);if(a!==$f)return a}if(n&&!r){let a=p$(n,e);if(a!==void 0)return a}let o={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,o);let s=Yf(t,t.typeName,e),i=typeof s=="function"?A(s(),e):s;if(i&&f$(t,e,i),e.postProcess){let a=e.postProcess(i,t,e);return o.jsonSchema=i,a}return o.jsonSchema=i,i}var p$=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"relative":return{$ref:bs(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((r,n)=>e.currentPath[n]===r)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),fe(e)):e.$refStrategy==="seen"?fe(e):void 0}},f$=(t,e,r)=>(t.description&&(r.description=t.description,e.markdownDescription&&(r.markdownDescription=t.description)),r);var eu=(t,e)=>{let r=kf(e),n=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((c,[u,l])=>({...c,[u]:A(l._def,{...r,currentPath:[...r.basePath,r.definitionPath,u]},!0)??fe(r)}),{}):void 0,o=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,s=A(t._def,o===void 0?r:{...r,currentPath:[...r.basePath,r.definitionPath,o]},!1)??fe(r),i=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;i!==void 0&&(s.title=i),r.flags.hasReferencedOpenAiAnyType&&(n||(n={}),n[r.openAiAnyTypeName]||(n[r.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:r.$refStrategy==="relative"?"1":[...r.basePath,r.definitionPath,r.openAiAnyTypeName].join("/")}}));let a=o===void 0?n?{...s,[r.definitionPath]:n}:s:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,o].join("/"),[r.definitionPath]:{...n,[o]:s}};return r.target==="jsonSchema7"?a.$schema="http://json-schema.org/draft-07/schema#":(r.target==="jsonSchema2019-09"||r.target==="openAi")&&(a.$schema="https://json-schema.org/draft/2019-09/schema#"),r.target==="openAi"&&("anyOf"in a||"oneOf"in a||"allOf"in a||"type"in a&&Array.isArray(a.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),a};function m$(t){return!t||t==="jsonSchema7"||t==="draft-7"?"draft-7":t==="jsonSchema2019-09"||t==="draft-2020-12"?"draft-2020-12":"draft-7"}function tu(t,e){return Xe(t)?xc(t,{target:m$(e?.target),io:e?.pipeStrategy??"input"}):eu(t,{strictUnions:e?.strictUnions??!0,pipeStrategy:e?.pipeStrategy??"input"})}function ru(t){let r=qt(t)?.method;if(!r)throw new Error("Schema is missing a method literal");let n=Go(r);if(typeof n!="string")throw new Error("Schema method literal must be a string");return n}function nu(t,e){let r=Dt(t,e);if(!r.success)throw r.error;return r.data}var h$=6e4,ks=class{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this._taskProgressTokens=new Map,this._requestResolvers=new Map,this.setNotificationHandler(rs,r=>{this._oncancel(r)}),this.setNotificationHandler(os,r=>{this._onprogress(r)}),this.setRequestHandler(ns,r=>({})),this._taskStore=e?.taskStore,this._taskMessageQueue=e?.taskMessageQueue,this._taskStore&&(this.setRequestHandler(ss,async(r,n)=>{let o=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!o)throw new R(C.InvalidParams,"Failed to retrieve task: Task not found");return{...o}}),this.setRequestHandler(as,async(r,n)=>{let o=async()=>{let s=r.params.taskId;if(this._taskMessageQueue){let a;for(;a=await this._taskMessageQueue.dequeue(s,n.sessionId);){if(a.type==="response"||a.type==="error"){let c=a.message,u=c.id,l=this._requestResolvers.get(u);if(l)if(this._requestResolvers.delete(u),a.type==="response")l(c);else{let d=c,m=new R(d.error.code,d.error.message,d.error.data);l(m)}else{let d=a.type==="response"?"Response":"Error";this._onerror(new Error(`${d} handler missing for request ${u}`))}continue}await this._transport?.send(a.message,{relatedRequestId:n.requestId})}}let i=await this._taskStore.getTask(s,n.sessionId);if(!i)throw new R(C.InvalidParams,`Task not found: ${s}`);if(!Ft(i.status))return await this._waitForTaskUpdate(s,n.signal),await o();if(Ft(i.status)){let a=await this._taskStore.getTaskResult(s,n.sessionId);return this._clearTaskQueue(s),{...a,_meta:{...a._meta,[Ut]:{taskId:s}}}}return await o()};return await o()}),this.setRequestHandler(cs,async(r,n)=>{try{let{tasks:o,nextCursor:s}=await this._taskStore.listTasks(r.params?.cursor,n.sessionId);return{tasks:o,nextCursor:s,_meta:{}}}catch(o){throw new R(C.InvalidParams,`Failed to list tasks: ${o instanceof Error?o.message:String(o)}`)}}),this.setRequestHandler(ls,async(r,n)=>{try{let o=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!o)throw new R(C.InvalidParams,`Task not found: ${r.params.taskId}`);if(Ft(o.status))throw new R(C.InvalidParams,`Cannot cancel task in terminal status: ${o.status}`);await this._taskStore.updateTaskStatus(r.params.taskId,"cancelled","Client cancelled task execution.",n.sessionId),this._clearTaskQueue(r.params.taskId);let s=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!s)throw new R(C.InvalidParams,`Task not found after cancellation: ${r.params.taskId}`);return{_meta:{},...s}}catch(o){throw o instanceof R?o:new R(C.InvalidRequest,`Failed to cancel task: ${o instanceof Error?o.message:String(o)}`)}}))}async _oncancel(e){if(!e.params.requestId)return;this._requestHandlerAbortControllers.get(e.params.requestId)?.abort(e.params.reason)}_setupTimeout(e,r,n,o,s=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(o,r),startTime:Date.now(),timeout:r,maxTotalTimeout:n,resetTimeoutOnProgress:s,onTimeout:o})}_resetTimeout(e){let r=this._timeoutInfo.get(e);if(!r)return!1;let n=Date.now()-r.startTime;if(r.maxTotalTimeout&&n>=r.maxTotalTimeout)throw this._timeoutInfo.delete(e),R.fromError(C.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:r.maxTotalTimeout,totalElapsed:n});return clearTimeout(r.timeoutId),r.timeoutId=setTimeout(r.onTimeout,r.timeout),!0}_cleanupTimeout(e){let r=this._timeoutInfo.get(e);r&&(clearTimeout(r.timeoutId),this._timeoutInfo.delete(e))}async connect(e){if(this._transport)throw new Error("Already connected to a transport. Call close() before connecting to a new transport, or use a separate Protocol instance per connection.");this._transport=e;let r=this.transport?.onclose;this._transport.onclose=()=>{r?.(),this._onclose()};let n=this.transport?.onerror;this._transport.onerror=s=>{n?.(s),this._onerror(s)};let o=this._transport?.onmessage;this._transport.onmessage=(s,i)=>{o?.(s,i),Zn(s)||lf(s)?this._onresponse(s):Zc(s)?this._onrequest(s,i):uf(s)?this._onnotification(s):this._onerror(new Error(`Unknown message type: ${JSON.stringify(s)}`))},await this._transport.start()}_onclose(){let e=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._taskProgressTokens.clear(),this._pendingDebouncedNotifications.clear();for(let n of this._requestHandlerAbortControllers.values())n.abort();this._requestHandlerAbortControllers.clear();let r=R.fromError(C.ConnectionClosed,"Connection closed");this._transport=void 0,this.onclose?.();for(let n of e.values())n(r)}_onerror(e){this.onerror?.(e)}_onnotification(e){let r=this._notificationHandlers.get(e.method)??this.fallbackNotificationHandler;r!==void 0&&Promise.resolve().then(()=>r(e)).catch(n=>this._onerror(new Error(`Uncaught error in notification handler: ${n}`)))}_onrequest(e,r){let n=this._requestHandlers.get(e.method)??this.fallbackRequestHandler,o=this._transport,s=e.params?._meta?.[Ut]?.taskId;if(n===void 0){let l={jsonrpc:"2.0",id:e.id,error:{code:C.MethodNotFound,message:"Method not found"}};s&&this._taskMessageQueue?this._enqueueTaskMessage(s,{type:"error",message:l,timestamp:Date.now()},o?.sessionId).catch(d=>this._onerror(new Error(`Failed to enqueue error response: ${d}`))):o?.send(l).catch(d=>this._onerror(new Error(`Failed to send an error response: ${d}`)));return}let i=new AbortController;this._requestHandlerAbortControllers.set(e.id,i);let a=sf(e.params)?e.params.task:void 0,c=this._taskStore?this.requestTaskStore(e,o?.sessionId):void 0,u={signal:i.signal,sessionId:o?.sessionId,_meta:e.params?._meta,sendNotification:async l=>{if(i.signal.aborted)return;let d={relatedRequestId:e.id};s&&(d.relatedTask={taskId:s}),await this.notification(l,d)},sendRequest:async(l,d,m)=>{if(i.signal.aborted)throw new R(C.ConnectionClosed,"Request was cancelled");let f={...m,relatedRequestId:e.id};s&&!f.relatedTask&&(f.relatedTask={taskId:s});let p=f.relatedTask?.taskId??s;return p&&c&&await c.updateTaskStatus(p,"input_required"),await this.request(l,d,f)},authInfo:r?.authInfo,requestId:e.id,requestInfo:r?.requestInfo,taskId:s,taskStore:c,taskRequestedTtl:a?.ttl,closeSSEStream:r?.closeSSEStream,closeStandaloneSSEStream:r?.closeStandaloneSSEStream};Promise.resolve().then(()=>{a&&this.assertTaskHandlerCapability(e.method)}).then(()=>n(e,u)).then(async l=>{if(i.signal.aborted)return;let d={result:l,jsonrpc:"2.0",id:e.id};s&&this._taskMessageQueue?await this._enqueueTaskMessage(s,{type:"response",message:d,timestamp:Date.now()},o?.sessionId):await o?.send(d)},async l=>{if(i.signal.aborted)return;let d={jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(l.code)?l.code:C.InternalError,message:l.message??"Internal error",...l.data!==void 0&&{data:l.data}}};s&&this._taskMessageQueue?await this._enqueueTaskMessage(s,{type:"error",message:d,timestamp:Date.now()},o?.sessionId):await o?.send(d)}).catch(l=>this._onerror(new Error(`Failed to send response: ${l}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){let{progressToken:r,...n}=e.params,o=Number(r),s=this._progressHandlers.get(o);if(!s){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}let i=this._responseHandlers.get(o),a=this._timeoutInfo.get(o);if(a&&i&&a.resetTimeoutOnProgress)try{this._resetTimeout(o)}catch(c){this._responseHandlers.delete(o),this._progressHandlers.delete(o),this._cleanupTimeout(o),i(c);return}s(n)}_onresponse(e){let r=Number(e.id),n=this._requestResolvers.get(r);if(n){if(this._requestResolvers.delete(r),Zn(e))n(e);else{let i=new R(e.error.code,e.error.message,e.error.data);n(i)}return}let o=this._responseHandlers.get(r);if(o===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}this._responseHandlers.delete(r),this._cleanupTimeout(r);let s=!1;if(Zn(e)&&e.result&&typeof e.result=="object"){let i=e.result;if(i.task&&typeof i.task=="object"){let a=i.task;typeof a.taskId=="string"&&(s=!0,this._taskProgressTokens.set(a.taskId,r))}}if(s||this._progressHandlers.delete(r),Zn(e))o(e);else{let i=R.fromError(e.error.code,e.error.message,e.error.data);o(i)}}get transport(){return this._transport}async close(){await this._transport?.close()}async*requestStream(e,r,n){let{task:o}=n??{};if(!o){try{yield{type:"result",result:await this.request(e,r,n)}}catch(i){yield{type:"error",error:i instanceof R?i:new R(C.InternalError,String(i))}}return}let s;try{let i=await this.request(e,Gr,n);if(i.task)s=i.task.taskId,yield{type:"taskCreated",task:i.task};else throw new R(C.InternalError,"Task creation did not return a task");for(;;){let a=await this.getTask({taskId:s},n);if(yield{type:"taskStatus",task:a},Ft(a.status)){a.status==="completed"?yield{type:"result",result:await this.getTaskResult({taskId:s},r,n)}:a.status==="failed"?yield{type:"error",error:new R(C.InternalError,`Task ${s} failed`)}:a.status==="cancelled"&&(yield{type:"error",error:new R(C.InternalError,`Task ${s} was cancelled`)});return}if(a.status==="input_required"){yield{type:"result",result:await this.getTaskResult({taskId:s},r,n)};return}let c=a.pollInterval??this._options?.defaultTaskPollInterval??1e3;await new Promise(u=>setTimeout(u,c)),n?.signal?.throwIfAborted()}}catch(i){yield{type:"error",error:i instanceof R?i:new R(C.InternalError,String(i))}}}request(e,r,n){let{relatedRequestId:o,resumptionToken:s,onresumptiontoken:i,task:a,relatedTask:c}=n??{};return new Promise((u,l)=>{let d=x=>{l(x)};if(!this._transport){d(new Error("Not connected"));return}if(this._options?.enforceStrictCapabilities===!0)try{this.assertCapabilityForMethod(e.method),a&&this.assertTaskCapability(e.method)}catch(x){d(x);return}n?.signal?.throwIfAborted();let m=this._requestMessageId++,f={...e,jsonrpc:"2.0",id:m};n?.onprogress&&(this._progressHandlers.set(m,n.onprogress),f.params={...e.params,_meta:{...e.params?._meta||{},progressToken:m}}),a&&(f.params={...f.params,task:a}),c&&(f.params={...f.params,_meta:{...f.params?._meta||{},[Ut]:c}});let p=x=>{this._responseHandlers.delete(m),this._progressHandlers.delete(m),this._cleanupTimeout(m),this._transport?.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:m,reason:String(x)}},{relatedRequestId:o,resumptionToken:s,onresumptiontoken:i}).catch(S=>this._onerror(new Error(`Failed to send cancellation: ${S}`)));let b=x instanceof R?x:new R(C.RequestTimeout,String(x));l(b)};this._responseHandlers.set(m,x=>{if(!n?.signal?.aborted){if(x instanceof Error)return l(x);try{let b=Dt(r,x.result);b.success?u(b.data):l(b.error)}catch(b){l(b)}}}),n?.signal?.addEventListener("abort",()=>{p(n?.signal?.reason)});let h=n?.timeout??h$,g=()=>p(R.fromError(C.RequestTimeout,"Request timed out",{timeout:h}));this._setupTimeout(m,h,n?.maxTotalTimeout,g,n?.resetTimeoutOnProgress??!1);let v=c?.taskId;if(v){let x=b=>{let S=this._responseHandlers.get(m);S?S(b):this._onerror(new Error(`Response handler missing for side-channeled request ${m}`))};this._requestResolvers.set(m,x),this._enqueueTaskMessage(v,{type:"request",message:f,timestamp:Date.now()}).catch(b=>{this._cleanupTimeout(m),l(b)})}else this._transport.send(f,{relatedRequestId:o,resumptionToken:s,onresumptiontoken:i}).catch(x=>{this._cleanupTimeout(m),l(x)})})}async getTask(e,r){return this.request({method:"tasks/get",params:e},is,r)}async getTaskResult(e,r,n){return this.request({method:"tasks/result",params:e},r,n)}async listTasks(e,r){return this.request({method:"tasks/list",params:e},us,r)}async cancelTask(e,r){return this.request({method:"tasks/cancel",params:e},ff,r)}async notification(e,r){if(!this._transport)throw new Error("Not connected");this.assertNotificationCapability(e.method);let n=r?.relatedTask?.taskId;if(n){let a={...e,jsonrpc:"2.0",params:{...e.params,_meta:{...e.params?._meta||{},[Ut]:r.relatedTask}}};await this._enqueueTaskMessage(n,{type:"notification",message:a,timestamp:Date.now()});return}if((this._options?.debouncedNotificationMethods??[]).includes(e.method)&&!e.params&&!r?.relatedRequestId&&!r?.relatedTask){if(this._pendingDebouncedNotifications.has(e.method))return;this._pendingDebouncedNotifications.add(e.method),Promise.resolve().then(()=>{if(this._pendingDebouncedNotifications.delete(e.method),!this._transport)return;let a={...e,jsonrpc:"2.0"};r?.relatedTask&&(a={...a,params:{...a.params,_meta:{...a.params?._meta||{},[Ut]:r.relatedTask}}}),this._transport?.send(a,r).catch(c=>this._onerror(c))});return}let i={...e,jsonrpc:"2.0"};r?.relatedTask&&(i={...i,params:{...i.params,_meta:{...i.params?._meta||{},[Ut]:r.relatedTask}}}),await this._transport.send(i,r)}setRequestHandler(e,r){let n=ru(e);this.assertRequestHandlerCapability(n),this._requestHandlers.set(n,(o,s)=>{let i=nu(e,o);return Promise.resolve(r(i,s))})}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,r){let n=ru(e);this._notificationHandlers.set(n,o=>{let s=nu(e,o);return Promise.resolve(r(s))})}removeNotificationHandler(e){this._notificationHandlers.delete(e)}_cleanupTaskProgressHandler(e){let r=this._taskProgressTokens.get(e);r!==void 0&&(this._progressHandlers.delete(r),this._taskProgressTokens.delete(e))}async _enqueueTaskMessage(e,r,n){if(!this._taskStore||!this._taskMessageQueue)throw new Error("Cannot enqueue task message: taskStore and taskMessageQueue are not configured");let o=this._options?.maxTaskQueueSize;await this._taskMessageQueue.enqueue(e,r,n,o)}async _clearTaskQueue(e,r){if(this._taskMessageQueue){let n=await this._taskMessageQueue.dequeueAll(e,r);for(let o of n)if(o.type==="request"&&Zc(o.message)){let s=o.message.id,i=this._requestResolvers.get(s);i?(i(new R(C.InternalError,"Task cancelled or completed")),this._requestResolvers.delete(s)):this._onerror(new Error(`Resolver missing for request ${s} during task ${e} cleanup`))}}}async _waitForTaskUpdate(e,r){let n=this._options?.defaultTaskPollInterval??1e3;try{let o=await this._taskStore?.getTask(e);o?.pollInterval&&(n=o.pollInterval)}catch{}return new Promise((o,s)=>{if(r.aborted){s(new R(C.InvalidRequest,"Request cancelled"));return}let i=setTimeout(o,n);r.addEventListener("abort",()=>{clearTimeout(i),s(new R(C.InvalidRequest,"Request cancelled"))},{once:!0})})}requestTaskStore(e,r){let n=this._taskStore;if(!n)throw new Error("No task store configured");return{createTask:async o=>{if(!e)throw new Error("No request provided");return await n.createTask(o,e.id,{method:e.method,params:e.params},r)},getTask:async o=>{let s=await n.getTask(o,r);if(!s)throw new R(C.InvalidParams,"Failed to retrieve task: Task not found");return s},storeTaskResult:async(o,s,i)=>{await n.storeTaskResult(o,s,i,r);let a=await n.getTask(o,r);if(a){let c=Dn.parse({method:"notifications/tasks/status",params:a});await this.notification(c),Ft(a.status)&&this._cleanupTaskProgressHandler(o)}},getTaskResult:o=>n.getTaskResult(o,r),updateTaskStatus:async(o,s,i)=>{let a=await n.getTask(o,r);if(!a)throw new R(C.InvalidParams,`Task "${o}" not found - it may have been cleaned up`);if(Ft(a.status))throw new R(C.InvalidParams,`Cannot update task "${o}" from terminal status "${a.status}" to "${s}". Terminal states (completed, failed, cancelled) cannot transition to other states.`);await n.updateTaskStatus(o,s,i,r);let c=await n.getTask(o,r);if(c){let u=Dn.parse({method:"notifications/tasks/status",params:c});await this.notification(u),Ft(c.status)&&this._cleanupTaskProgressHandler(o)}},listTasks:o=>n.listTasks(o,r)}}};function Qf(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function em(t,e){let r={...t};for(let n in e){let o=n,s=e[o];if(s===void 0)continue;let i=r[o];Qf(i)&&Qf(s)?r[o]={...i,...s}:r[o]=s}return r}var Dg=sd(Ul(),1),qg=sd(Lg(),1);function iT(){let t=new Dg.default({strict:!1,validateFormats:!0,validateSchema:!1,allErrors:!0});return(0,qg.default)(t),t}var ii=class{constructor(e){this._ajv=e??iT()}getValidator(e){let r="$id"in e&&typeof e.$id=="string"?this._ajv.getSchema(e.$id)??this._ajv.compile(e):this._ajv.compile(e);return n=>r(n)?{valid:!0,data:n,errorMessage:void 0}:{valid:!1,data:void 0,errorMessage:this._ajv.errorsText(r.errors)}}};var ai=class{constructor(e){this._server=e}requestStream(e,r,n){return this._server.requestStream(e,r,n)}async getTask(e,r){return this._server.getTask({taskId:e},r)}async getTaskResult(e,r,n){return this._server.getTaskResult({taskId:e},r,n)}async listTasks(e,r){return this._server.listTasks(e?{cursor:e}:void 0,r)}async cancelTask(e,r){return this._server.cancelTask({taskId:e},r)}};function Ug(t,e,r){if(!t)throw new Error(`${r} does not support task creation (required for ${e})`);switch(e){case"tools/call":if(!t.tools?.call)throw new Error(`${r} does not support task creation for tools/call (required for ${e})`);break;default:break}}function Fg(t,e,r){if(!t)throw new Error(`${r} does not support task creation (required for ${e})`);switch(e){case"sampling/createMessage":if(!t.sampling?.createMessage)throw new Error(`${r} does not support task creation for sampling/createMessage (required for ${e})`);break;case"elicitation/create":if(!t.elicitation?.create)throw new Error(`${r} does not support task creation for elicitation/create (required for ${e})`);break;default:break}}var ci=class extends ks{constructor(e,r){super(r),this._serverInfo=e,this._loggingLevels=new Map,this.LOG_LEVEL_SEVERITY=new Map(Un.options.map((n,o)=>[n,o])),this.isMessageIgnored=(n,o)=>{let s=this._loggingLevels.get(o);return s?this.LOG_LEVEL_SEVERITY.get(n)<this.LOG_LEVEL_SEVERITY.get(s):!1},this._capabilities=r?.capabilities??{},this._instructions=r?.instructions,this._jsonSchemaValidator=r?.jsonSchemaValidator??new ii,this.setRequestHandler(Mc,n=>this._oninitialize(n)),this.setNotificationHandler(Lc,()=>this.oninitialized?.()),this._capabilities.logging&&this.setRequestHandler(Bc,async(n,o)=>{let s=o.sessionId||o.requestInfo?.headers["mcp-session-id"]||void 0,{level:i}=n.params,a=Un.safeParse(i);return a.success&&this._loggingLevels.set(s,a.data),{}})}get experimental(){return this._experimental||(this._experimental={tasks:new ai(this)}),this._experimental}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=em(this._capabilities,e)}setRequestHandler(e,r){let o=qt(e)?.method;if(!o)throw new Error("Schema is missing a method literal");let s;if(Xe(o)){let a=o;s=a._zod?.def?.value??a.value}else{let a=o;s=a._def?.value??a.value}if(typeof s!="string")throw new Error("Schema method literal must be a string");if(s==="tools/call"){let a=async(c,u)=>{let l=Dt(Xr,c);if(!l.success){let p=l.error instanceof Error?l.error.message:String(l.error);throw new R(C.InvalidParams,`Invalid tools/call request: ${p}`)}let{params:d}=l.data,m=await Promise.resolve(r(c,u));if(d.task){let p=Dt(Gr,m);if(!p.success){let h=p.error instanceof Error?p.error.message:String(p.error);throw new R(C.InvalidParams,`Invalid task creation result: ${h}`)}return p.data}let f=Dt(ys,m);if(!f.success){let p=f.error instanceof Error?f.error.message:String(f.error);throw new R(C.InvalidParams,`Invalid tools/call result: ${p}`)}return f.data};return super.setRequestHandler(e,a)}return super.setRequestHandler(e,r)}assertCapabilityForMethod(e){switch(e){case"sampling/createMessage":if(!this._clientCapabilities?.sampling)throw new Error(`Client does not support sampling (required for ${e})`);break;case"elicitation/create":if(!this._clientCapabilities?.elicitation)throw new Error(`Client does not support elicitation (required for ${e})`);break;case"roots/list":if(!this._clientCapabilities?.roots)throw new Error(`Client does not support listing roots (required for ${e})`);break;case"ping":break}}assertNotificationCapability(e){switch(e){case"notifications/message":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"notifications/resources/updated":case"notifications/resources/list_changed":if(!this._capabilities.resources)throw new Error(`Server does not support notifying about resources (required for ${e})`);break;case"notifications/tools/list_changed":if(!this._capabilities.tools)throw new Error(`Server does not support notifying of tool list changes (required for ${e})`);break;case"notifications/prompts/list_changed":if(!this._capabilities.prompts)throw new Error(`Server does not support notifying of prompt list changes (required for ${e})`);break;case"notifications/elicitation/complete":if(!this._clientCapabilities?.elicitation?.url)throw new Error(`Client does not support URL elicitation (required for ${e})`);break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(e){if(this._capabilities)switch(e){case"completion/complete":if(!this._capabilities.completions)throw new Error(`Server does not support completions (required for ${e})`);break;case"logging/setLevel":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!this._capabilities.prompts)throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":if(!this._capabilities.resources)throw new Error(`Server does not support resources (required for ${e})`);break;case"tools/call":case"tools/list":if(!this._capabilities.tools)throw new Error(`Server does not support tools (required for ${e})`);break;case"tasks/get":case"tasks/list":case"tasks/result":case"tasks/cancel":if(!this._capabilities.tasks)throw new Error(`Server does not support tasks capability (required for ${e})`);break;case"ping":case"initialize":break}}assertTaskCapability(e){Fg(this._clientCapabilities?.tasks?.requests,e,"Client")}assertTaskHandlerCapability(e){this._capabilities&&Ug(this._capabilities.tasks?.requests,e,"Server")}async _oninitialize(e){let r=e.params.protocolVersion;return this._clientCapabilities=e.params.capabilities,this._clientVersion=e.params.clientInfo,{protocolVersion:rf.includes(r)?r:Nc,capabilities:this.getCapabilities(),serverInfo:this._serverInfo,...this._instructions&&{instructions:this._instructions}}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return this._capabilities}async ping(){return this.request({method:"ping"},ts)}async createMessage(e,r){if((e.tools||e.toolChoice)&&!this._clientCapabilities?.sampling?.tools)throw new Error("Client does not support sampling tools capability.");if(e.messages.length>0){let n=e.messages[e.messages.length-1],o=Array.isArray(n.content)?n.content:[n.content],s=o.some(u=>u.type==="tool_result"),i=e.messages.length>1?e.messages[e.messages.length-2]:void 0,a=i?Array.isArray(i.content)?i.content:[i.content]:[],c=a.some(u=>u.type==="tool_use");if(s){if(o.some(u=>u.type!=="tool_result"))throw new Error("The last message must contain only tool_result content if any is present");if(!c)throw new Error("tool_result blocks are not matching any tool_use from the previous message")}if(c){let u=new Set(a.filter(d=>d.type==="tool_use").map(d=>d.id)),l=new Set(o.filter(d=>d.type==="tool_result").map(d=>d.toolUseId));if(u.size!==l.size||![...u].every(d=>l.has(d)))throw new Error("ids of tool_result blocks and tool_use blocks from previous message do not match")}}return e.tools?this.request({method:"sampling/createMessage",params:e},Wc,r):this.request({method:"sampling/createMessage",params:e},Kc,r)}async elicitInput(e,r){switch(e.mode??"form"){case"url":{if(!this._clientCapabilities?.elicitation?.url)throw new Error("Client does not support url elicitation.");let o=e;return this.request({method:"elicitation/create",params:o},_s,r)}case"form":{if(!this._clientCapabilities?.elicitation?.form)throw new Error("Client does not support form elicitation.");let o=e.mode==="form"?e:{...e,mode:"form"},s=await this.request({method:"elicitation/create",params:o},_s,r);if(s.action==="accept"&&s.content&&o.requestedSchema)try{let a=this._jsonSchemaValidator.getValidator(o.requestedSchema)(s.content);if(!a.valid)throw new R(C.InvalidParams,`Elicitation response content does not match requested schema: ${a.errorMessage}`)}catch(i){throw i instanceof R?i:new R(C.InternalError,`Error validating elicitation response: ${i instanceof Error?i.message:String(i)}`)}return s}}}createElicitationCompletionNotifier(e,r){if(!this._clientCapabilities?.elicitation?.url)throw new Error("Client does not support URL elicitation (required for notifications/elicitation/complete)");return()=>this.notification({method:"notifications/elicitation/complete",params:{elicitationId:e}},r)}async listRoots(e,r){return this.request({method:"roots/list",params:e},Gc,r)}async sendLoggingMessage(e,r){if(this._capabilities.logging&&!this.isMessageIgnored(e.level,r))return this.notification({method:"notifications/message",params:e})}async sendResourceUpdated(e){return this.notification({method:"notifications/resources/updated",params:e})}async sendResourceListChanged(){return this.notification({method:"notifications/resources/list_changed"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}};var Hg=Symbol.for("mcp.completable");function Jl(t){return!!t&&typeof t=="object"&&Hg in t}function Bg(t){return t[Hg]?.complete}var Vg;(function(t){t.Completable="McpCompletable"})(Vg||(Vg={}));var aT=/^[A-Za-z0-9._-]{1,128}$/;function cT(t){let e=[];if(t.length===0)return{isValid:!1,warnings:["Tool name cannot be empty"]};if(t.length>128)return{isValid:!1,warnings:[`Tool name exceeds maximum length of 128 characters (current: ${t.length})`]};if(t.includes(" ")&&e.push("Tool name contains spaces, which may cause parsing issues"),t.includes(",")&&e.push("Tool name contains commas, which may cause parsing issues"),(t.startsWith("-")||t.endsWith("-"))&&e.push("Tool name starts or ends with a dash, which may cause parsing issues in some contexts"),(t.startsWith(".")||t.endsWith("."))&&e.push("Tool name starts or ends with a dot, which may cause parsing issues in some contexts"),!aT.test(t)){let r=t.split("").filter(n=>!/[A-Za-z0-9._-]/.test(n)).filter((n,o,s)=>s.indexOf(n)===o);return e.push(`Tool name contains invalid characters: ${r.map(n=>`"${n}"`).join(", ")}`,"Allowed characters are: A-Z, a-z, 0-9, underscore (_), dash (-), and dot (.)"),{isValid:!1,warnings:e}}return{isValid:!0,warnings:e}}function uT(t,e){if(e.length>0){console.warn(`Tool name validation warning for "${t}":`);for(let r of e)console.warn(`  - ${r}`);console.warn("Tool registration will proceed, but this may cause compatibility issues."),console.warn("Consider updating the tool name to conform to the MCP tool naming standard."),console.warn("See SEP: Specify Format for Tool Names (https://github.com/modelcontextprotocol/modelcontextprotocol/issues/986) for more details.")}}function Xl(t){let e=cT(t);return uT(t,e.warnings),e.isValid}var ui=class{constructor(e){this._mcpServer=e}registerToolTask(e,r,n){let o={taskSupport:"required",...r.execution};if(o.taskSupport==="forbidden")throw new Error(`Cannot register task-based tool '${e}' with taskSupport 'forbidden'. Use registerTool() instead.`);return this._mcpServer._createRegisteredTool(e,r.title,r.description,r.inputSchema,r.outputSchema,r.annotations,o,r._meta,n)}};var li=class{constructor(e,r){this._registeredResources={},this._registeredResourceTemplates={},this._registeredTools={},this._registeredPrompts={},this._toolHandlersInitialized=!1,this._completionHandlerInitialized=!1,this._resourceHandlersInitialized=!1,this._promptHandlersInitialized=!1,this.server=new ci(e,r)}get experimental(){return this._experimental||(this._experimental={tasks:new ui(this)}),this._experimental}async connect(e){return await this.server.connect(e)}async close(){await this.server.close()}setToolRequestHandlers(){this._toolHandlersInitialized||(this.server.assertCanSetRequestHandler(Yt(gs)),this.server.assertCanSetRequestHandler(Yt(Xr)),this.server.registerCapabilities({tools:{listChanged:!0}}),this.server.setRequestHandler(gs,()=>({tools:Object.entries(this._registeredTools).filter(([,e])=>e.enabled).map(([e,r])=>{let n={name:e,title:r.title,description:r.description,inputSchema:(()=>{let o=Kr(r.inputSchema);return o?tu(o,{strictUnions:!0,pipeStrategy:"input"}):lT})(),annotations:r.annotations,execution:r.execution,_meta:r._meta};if(r.outputSchema){let o=Kr(r.outputSchema);o&&(n.outputSchema=tu(o,{strictUnions:!0,pipeStrategy:"output"}))}return n})})),this.server.setRequestHandler(Xr,async(e,r)=>{try{let n=this._registeredTools[e.params.name];if(!n)throw new R(C.InvalidParams,`Tool ${e.params.name} not found`);if(!n.enabled)throw new R(C.InvalidParams,`Tool ${e.params.name} disabled`);let o=!!e.params.task,s=n.execution?.taskSupport,i="createTask"in n.handler;if((s==="required"||s==="optional")&&!i)throw new R(C.InternalError,`Tool ${e.params.name} has taskSupport '${s}' but was not registered with registerToolTask`);if(s==="required"&&!o)throw new R(C.MethodNotFound,`Tool ${e.params.name} requires task augmentation (taskSupport: 'required')`);if(s==="optional"&&!o&&i)return await this.handleAutomaticTaskPolling(n,e,r);let a=await this.validateToolInput(n,e.params.arguments,e.params.name),c=await this.executeToolHandler(n,a,r);return o||await this.validateToolOutput(n,c,e.params.name),c}catch(n){if(n instanceof R&&n.code===C.UrlElicitationRequired)throw n;return this.createToolError(n instanceof Error?n.message:String(n))}}),this._toolHandlersInitialized=!0)}createToolError(e){return{content:[{type:"text",text:e}],isError:!0}}async validateToolInput(e,r,n){if(!e.inputSchema)return;let s=Kr(e.inputSchema)??e.inputSchema,i=await Ko(s,r);if(!i.success){let a="error"in i?i.error:"Unknown error",c=Wo(a);throw new R(C.InvalidParams,`Input validation error: Invalid arguments for tool ${n}: ${c}`)}return i.data}async validateToolOutput(e,r,n){if(!e.outputSchema||!("content"in r)||r.isError)return;if(!r.structuredContent)throw new R(C.InvalidParams,`Output validation error: Tool ${n} has an output schema but no structured content was provided`);let o=Kr(e.outputSchema),s=await Ko(o,r.structuredContent);if(!s.success){let i="error"in s?s.error:"Unknown error",a=Wo(i);throw new R(C.InvalidParams,`Output validation error: Invalid structured content for tool ${n}: ${a}`)}}async executeToolHandler(e,r,n){let o=e.handler;if("createTask"in o){if(!n.taskStore)throw new Error("No task store provided.");let i={...n,taskStore:n.taskStore};if(e.inputSchema){let a=o;return await Promise.resolve(a.createTask(r,i))}else{let a=o;return await Promise.resolve(a.createTask(i))}}if(e.inputSchema){let i=o;return await Promise.resolve(i(r,n))}else{let i=o;return await Promise.resolve(i(n))}}async handleAutomaticTaskPolling(e,r,n){if(!n.taskStore)throw new Error("No task store provided for task-capable tool.");let o=await this.validateToolInput(e,r.params.arguments,r.params.name),s=e.handler,i={...n,taskStore:n.taskStore},a=o?await Promise.resolve(s.createTask(o,i)):await Promise.resolve(s.createTask(i)),c=a.task.taskId,u=a.task,l=u.pollInterval??5e3;for(;u.status!=="completed"&&u.status!=="failed"&&u.status!=="cancelled";){await new Promise(m=>setTimeout(m,l));let d=await n.taskStore.getTask(c);if(!d)throw new R(C.InternalError,`Task ${c} not found during polling`);u=d}return await n.taskStore.getTaskResult(c)}setCompletionRequestHandler(){this._completionHandlerInitialized||(this.server.assertCanSetRequestHandler(Yt(vs)),this.server.registerCapabilities({completions:{}}),this.server.setRequestHandler(vs,async e=>{switch(e.params.ref.type){case"ref/prompt":return vf(e),this.handlePromptCompletion(e,e.params.ref);case"ref/resource":return bf(e),this.handleResourceCompletion(e,e.params.ref);default:throw new R(C.InvalidParams,`Invalid completion reference: ${e.params.ref}`)}}),this._completionHandlerInitialized=!0)}async handlePromptCompletion(e,r){let n=this._registeredPrompts[r.name];if(!n)throw new R(C.InvalidParams,`Prompt ${r.name} not found`);if(!n.enabled)throw new R(C.InvalidParams,`Prompt ${r.name} disabled`);if(!n.argsSchema)return bo;let s=qt(n.argsSchema)?.[e.params.argument.name];if(!Jl(s))return bo;let i=Bg(s);if(!i)return bo;let a=await i(e.params.argument.value,e.params.context);return Wg(a)}async handleResourceCompletion(e,r){let n=Object.values(this._registeredResourceTemplates).find(i=>i.resourceTemplate.uriTemplate.toString()===r.uri);if(!n){if(this._registeredResources[r.uri])return bo;throw new R(C.InvalidParams,`Resource template ${e.params.ref.uri} not found`)}let o=n.resourceTemplate.completeCallback(e.params.argument.name);if(!o)return bo;let s=await o(e.params.argument.value,e.params.context);return Wg(s)}setResourceRequestHandlers(){this._resourceHandlersInitialized||(this.server.assertCanSetRequestHandler(Yt(ds)),this.server.assertCanSetRequestHandler(Yt(ps)),this.server.assertCanSetRequestHandler(Yt(fs)),this.server.registerCapabilities({resources:{listChanged:!0}}),this.server.setRequestHandler(ds,async(e,r)=>{let n=Object.entries(this._registeredResources).filter(([s,i])=>i.enabled).map(([s,i])=>({uri:s,name:i.name,...i.metadata})),o=[];for(let s of Object.values(this._registeredResourceTemplates)){if(!s.resourceTemplate.listCallback)continue;let i=await s.resourceTemplate.listCallback(r);for(let a of i.resources)o.push({...s.metadata,...a})}return{resources:[...n,...o]}}),this.server.setRequestHandler(ps,async()=>({resourceTemplates:Object.entries(this._registeredResourceTemplates).map(([r,n])=>({name:r,uriTemplate:n.resourceTemplate.uriTemplate.toString(),...n.metadata}))})),this.server.setRequestHandler(fs,async(e,r)=>{let n=new URL(e.params.uri),o=this._registeredResources[n.toString()];if(o){if(!o.enabled)throw new R(C.InvalidParams,`Resource ${n} disabled`);return o.readCallback(n,r)}for(let s of Object.values(this._registeredResourceTemplates)){let i=s.resourceTemplate.uriTemplate.match(n.toString());if(i)return s.readCallback(n,i,r)}throw new R(C.InvalidParams,`Resource ${n} not found`)}),this._resourceHandlersInitialized=!0)}setPromptRequestHandlers(){this._promptHandlersInitialized||(this.server.assertCanSetRequestHandler(Yt(ms)),this.server.assertCanSetRequestHandler(Yt(hs)),this.server.registerCapabilities({prompts:{listChanged:!0}}),this.server.setRequestHandler(ms,()=>({prompts:Object.entries(this._registeredPrompts).filter(([,e])=>e.enabled).map(([e,r])=>({name:e,title:r.title,description:r.description,arguments:r.argsSchema?pT(r.argsSchema):void 0}))})),this.server.setRequestHandler(hs,async(e,r)=>{let n=this._registeredPrompts[e.params.name];if(!n)throw new R(C.InvalidParams,`Prompt ${e.params.name} not found`);if(!n.enabled)throw new R(C.InvalidParams,`Prompt ${e.params.name} disabled`);if(n.argsSchema){let o=Kr(n.argsSchema),s=await Ko(o,e.params.arguments);if(!s.success){let c="error"in s?s.error:"Unknown error",u=Wo(c);throw new R(C.InvalidParams,`Invalid arguments for prompt ${e.params.name}: ${u}`)}let i=s.data,a=n.callback;return await Promise.resolve(a(i,r))}else{let o=n.callback;return await Promise.resolve(o(r))}}),this._promptHandlersInitialized=!0)}resource(e,r,...n){let o;typeof n[0]=="object"&&(o=n.shift());let s=n[0];if(typeof r=="string"){if(this._registeredResources[r])throw new Error(`Resource ${r} is already registered`);let i=this._createRegisteredResource(e,void 0,r,o,s);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),i}else{if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);let i=this._createRegisteredResourceTemplate(e,void 0,r,o,s);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),i}}registerResource(e,r,n,o){if(typeof r=="string"){if(this._registeredResources[r])throw new Error(`Resource ${r} is already registered`);let s=this._createRegisteredResource(e,n.title,r,n,o);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),s}else{if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);let s=this._createRegisteredResourceTemplate(e,n.title,r,n,o);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),s}}_createRegisteredResource(e,r,n,o,s){let i={name:e,title:r,metadata:o,readCallback:s,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({uri:null}),update:a=>{typeof a.uri<"u"&&a.uri!==n&&(delete this._registeredResources[n],a.uri&&(this._registeredResources[a.uri]=i)),typeof a.name<"u"&&(i.name=a.name),typeof a.title<"u"&&(i.title=a.title),typeof a.metadata<"u"&&(i.metadata=a.metadata),typeof a.callback<"u"&&(i.readCallback=a.callback),typeof a.enabled<"u"&&(i.enabled=a.enabled),this.sendResourceListChanged()}};return this._registeredResources[n]=i,i}_createRegisteredResourceTemplate(e,r,n,o,s){let i={resourceTemplate:n,title:r,metadata:o,readCallback:s,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({name:null}),update:u=>{typeof u.name<"u"&&u.name!==e&&(delete this._registeredResourceTemplates[e],u.name&&(this._registeredResourceTemplates[u.name]=i)),typeof u.title<"u"&&(i.title=u.title),typeof u.template<"u"&&(i.resourceTemplate=u.template),typeof u.metadata<"u"&&(i.metadata=u.metadata),typeof u.callback<"u"&&(i.readCallback=u.callback),typeof u.enabled<"u"&&(i.enabled=u.enabled),this.sendResourceListChanged()}};this._registeredResourceTemplates[e]=i;let a=n.uriTemplate.variableNames;return Array.isArray(a)&&a.some(u=>!!n.completeCallback(u))&&this.setCompletionRequestHandler(),i}_createRegisteredPrompt(e,r,n,o,s){let i={title:r,description:n,argsSchema:o===void 0?void 0:wr(o),callback:s,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({name:null}),update:a=>{typeof a.name<"u"&&a.name!==e&&(delete this._registeredPrompts[e],a.name&&(this._registeredPrompts[a.name]=i)),typeof a.title<"u"&&(i.title=a.title),typeof a.description<"u"&&(i.description=a.description),typeof a.argsSchema<"u"&&(i.argsSchema=wr(a.argsSchema)),typeof a.callback<"u"&&(i.callback=a.callback),typeof a.enabled<"u"&&(i.enabled=a.enabled),this.sendPromptListChanged()}};return this._registeredPrompts[e]=i,o&&Object.values(o).some(c=>{let u=c instanceof Ae?c._def?.innerType:c;return Jl(u)})&&this.setCompletionRequestHandler(),i}_createRegisteredTool(e,r,n,o,s,i,a,c,u){Xl(e);let l={title:r,description:n,inputSchema:Kg(o),outputSchema:Kg(s),annotations:i,execution:a,_meta:c,handler:u,enabled:!0,disable:()=>l.update({enabled:!1}),enable:()=>l.update({enabled:!0}),remove:()=>l.update({name:null}),update:d=>{typeof d.name<"u"&&d.name!==e&&(typeof d.name=="string"&&Xl(d.name),delete this._registeredTools[e],d.name&&(this._registeredTools[d.name]=l)),typeof d.title<"u"&&(l.title=d.title),typeof d.description<"u"&&(l.description=d.description),typeof d.paramsSchema<"u"&&(l.inputSchema=wr(d.paramsSchema)),typeof d.outputSchema<"u"&&(l.outputSchema=wr(d.outputSchema)),typeof d.callback<"u"&&(l.handler=d.callback),typeof d.annotations<"u"&&(l.annotations=d.annotations),typeof d._meta<"u"&&(l._meta=d._meta),typeof d.enabled<"u"&&(l.enabled=d.enabled),this.sendToolListChanged()}};return this._registeredTools[e]=l,this.setToolRequestHandlers(),this.sendToolListChanged(),l}tool(e,...r){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);let n,o,s,i;if(typeof r[0]=="string"&&(n=r.shift()),r.length>1){let c=r[0];Yl(c)?(o=r.shift(),r.length>1&&typeof r[0]=="object"&&r[0]!==null&&!Yl(r[0])&&(i=r.shift())):typeof c=="object"&&c!==null&&(i=r.shift())}let a=r[0];return this._createRegisteredTool(e,void 0,n,o,s,i,{taskSupport:"forbidden"},void 0,a)}registerTool(e,r,n){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);let{title:o,description:s,inputSchema:i,outputSchema:a,annotations:c,_meta:u}=r;return this._createRegisteredTool(e,o,s,i,a,c,{taskSupport:"forbidden"},u,n)}prompt(e,...r){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);let n;typeof r[0]=="string"&&(n=r.shift());let o;r.length>1&&(o=r.shift());let s=r[0],i=this._createRegisteredPrompt(e,void 0,n,o,s);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),i}registerPrompt(e,r,n){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);let{title:o,description:s,argsSchema:i}=r,a=this._createRegisteredPrompt(e,o,s,i,n);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),a}isConnected(){return this.server.transport!==void 0}async sendLoggingMessage(e,r){return this.server.sendLoggingMessage(e,r)}sendResourceListChanged(){this.isConnected()&&this.server.sendResourceListChanged()}sendToolListChanged(){this.isConnected()&&this.server.sendToolListChanged()}sendPromptListChanged(){this.isConnected()&&this.server.sendPromptListChanged()}};var lT={type:"object",properties:{}};function Gg(t){return t!==null&&typeof t=="object"&&"parse"in t&&typeof t.parse=="function"&&"safeParse"in t&&typeof t.safeParse=="function"}function dT(t){return"_def"in t||"_zod"in t||Gg(t)}function Yl(t){return typeof t!="object"||t===null||dT(t)?!1:Object.keys(t).length===0?!0:Object.values(t).some(Gg)}function Kg(t){if(t)return Yl(t)?wr(t):t}function pT(t){let e=qt(t);return e?Object.entries(e).map(([r,n])=>{let o=Np(n),s=Cp(n);return{name:r,description:o,required:!s}}):[]}function Yt(t){let r=qt(t)?.method;if(!r)throw new Error("Schema is missing a method literal");let n=Go(r);if(typeof n=="string")return n;throw new Error("Schema method literal must be a string")}function Wg(t){return{completion:{values:t.slice(0,100),total:t.length,hasMore:t.length>100}}}var bo={completion:{values:[],hasMore:!1}};import Xg from"node:process";var di=class{append(e){this._buffer=this._buffer?Buffer.concat([this._buffer,e]):e}readMessage(){if(!this._buffer)return null;let e=this._buffer.indexOf(`
`);if(e===-1)return null;let r=this._buffer.toString("utf8",0,e).replace(/\r$/,"");return this._buffer=this._buffer.subarray(e+1),fT(r)}clear(){this._buffer=void 0}};function fT(t){return df.parse(JSON.parse(t))}function Jg(t){return JSON.stringify(t)+`
`}var pi=class{constructor(e=Xg.stdin,r=Xg.stdout){this._stdin=e,this._stdout=r,this._readBuffer=new di,this._started=!1,this._ondata=n=>{this._readBuffer.append(n),this.processReadBuffer()},this._onerror=n=>{this.onerror?.(n)}}async start(){if(this._started)throw new Error("StdioServerTransport already started! If using Server class, note that connect() calls start() automatically.");this._started=!0,this._stdin.on("data",this._ondata),this._stdin.on("error",this._onerror)}processReadBuffer(){for(;;)try{let e=this._readBuffer.readMessage();if(e===null)break;this.onmessage?.(e)}catch(e){this.onerror?.(e)}}async close(){this._stdin.off("data",this._ondata),this._stdin.off("error",this._onerror),this._stdin.listenerCount("data")===0&&this._stdin.pause(),this._readBuffer.clear(),this.onclose?.()}send(e){return new Promise(r=>{let n=Jg(e);this._stdout.write(n)?r():this._stdout.once("drain",r)})}};import{spawn as mT,execSync as hT}from"node:child_process";import{mkdtempSync as gT,writeFileSync as ry,rmSync as yT}from"node:fs";import{join as ny,resolve as _T}from"node:path";import{tmpdir as vT}from"node:os";import{execSync as Yg}from"node:child_process";function Ve(t){try{return Yg(`command -v ${t} 2>/dev/null`,{stdio:"pipe"}),!0}catch{return!1}}function wt(t){try{return Yg(`${t} --version 2>/dev/null`,{encoding:"utf-8",timeout:5e3}).trim().split(`
`)[0]}catch{return"unknown"}}function fi(){let t=Ve("bun");return{javascript:t?"bun":"node",typescript:t?"bun":Ve("tsx")?"tsx":Ve("ts-node")?"ts-node":null,python:Ve("python3")?"python3":Ve("python")?"python":null,shell:Ve("bash")?"bash":"sh",ruby:Ve("ruby")?"ruby":null,go:Ve("go")?"go":null,rust:Ve("rustc")?"rustc":null,php:Ve("php")?"php":null,perl:Ve("perl")?"perl":null,r:Ve("Rscript")?"Rscript":Ve("r")?"r":null}}function Ql(){return Ve("bun")}function Qg(t){let e=[],r=t.javascript==="bun";return e.push(`  JavaScript: ${t.javascript} (${wt(t.javascript)})${r?" \u26A1":""}`),t.typescript?e.push(`  TypeScript: ${t.typescript} (${wt(t.typescript)})`):e.push("  TypeScript: not available (install bun, tsx, or ts-node)"),t.python?e.push(`  Python:     ${t.python} (${wt(t.python)})`):e.push("  Python:     not available"),e.push(`  Shell:      ${t.shell} (${wt(t.shell)})`),t.ruby&&e.push(`  Ruby:       ${t.ruby} (${wt(t.ruby)})`),t.go&&e.push(`  Go:         ${t.go} (${wt(t.go)})`),t.rust&&e.push(`  Rust:       ${t.rust} (${wt(t.rust)})`),t.php&&e.push(`  PHP:        ${t.php} (${wt(t.php)})`),t.perl&&e.push(`  Perl:       ${t.perl} (${wt(t.perl)})`),t.r&&e.push(`  R:          ${t.r} (${wt(t.r)})`),r||(e.push(""),e.push("  Tip: Install Bun for 3-5x faster JS/TS execution \u2192 https://bun.sh")),e.join(`
`)}function ey(t){let e=["javascript","shell"];return t.typescript&&e.push("typescript"),t.python&&e.push("python"),t.ruby&&e.push("ruby"),t.go&&e.push("go"),t.rust&&e.push("rust"),t.php&&e.push("php"),t.perl&&e.push("perl"),t.r&&e.push("r"),e}function ty(t,e,r){switch(e){case"javascript":return t.javascript==="bun"?["bun","run",r]:["node",r];case"typescript":if(!t.typescript)throw new Error("No TypeScript runtime available. Install one of: bun (recommended), tsx (npm i -g tsx), or ts-node.");return t.typescript==="bun"?["bun","run",r]:t.typescript==="tsx"?["tsx",r]:["ts-node",r];case"python":if(!t.python)throw new Error("No Python runtime available. Install python3 or python.");return[t.python,r];case"shell":return[t.shell,r];case"ruby":if(!t.ruby)throw new Error("Ruby not available. Install ruby.");return[t.ruby,r];case"go":if(!t.go)throw new Error("Go not available. Install go.");return["go","run",r];case"rust":{if(!t.rust)throw new Error("Rust not available. Install rustc via https://rustup.rs");return["__rust_compile_run__",r]}case"php":if(!t.php)throw new Error("PHP not available. Install php.");return["php",r];case"perl":if(!t.perl)throw new Error("Perl not available. Install perl.");return["perl",r];case"r":if(!t.r)throw new Error("R not available. Install R / Rscript.");return[t.r,r]}}var mi=class t{#e;#t;#r;constructor(e){this.#e=e?.maxOutputBytes??102400,this.#t=e?.projectRoot??process.cwd(),this.#r=e?.runtimes??fi()}get runtimes(){return{...this.#r}}async execute(e){let{language:r,code:n,timeout:o=3e4}=e,s=gT(ny(vT(),"ctx-mode-"));try{let i=this.#n(s,n,r),a=ty(this.#r,r,i);return a[0]==="__rust_compile_run__"?await this.#i(i,s,o):await this.#s(a,s,o)}finally{yT(s,{recursive:!0,force:!0})}}async executeFile(e){let{path:r,language:n,code:o,timeout:s=3e4}=e,i=_T(this.#t,r),a=this.#c(i,n,o);return this.execute({language:n,code:a,timeout:s})}#n(e,r,n){let o={javascript:"js",typescript:"ts",python:"py",shell:"sh",ruby:"rb",go:"go",rust:"rs",php:"php",perl:"pl",r:"R"};n==="go"&&!r.includes("package ")&&(r=`package main

import "fmt"

func main() {
${r}
}
`),n==="php"&&!r.trimStart().startsWith("<?")&&(r=`<?php
${r}`);let s=ny(e,`script.${o[n]}`);return n==="shell"?ry(s,r,{encoding:"utf-8",mode:448}):ry(s,r,"utf-8"),s}async#i(e,r,n){let o=e.replace(/\.rs$/,"");try{hT(`rustc ${e} -o ${o} 2>&1`,{cwd:r,timeout:Math.min(n,3e4),encoding:"utf-8"})}catch(s){return{stdout:"",stderr:`Compilation failed:
${s instanceof Error?s.stderr||s.message:String(s)}`,exitCode:1,timedOut:!1}}return this.#s([o],r,n)}static#o(e,r){if(Buffer.byteLength(e)<=r)return e;let n=e.split(`
`),o=Math.floor(r*.6),s=r-o,i=[],a=0;for(let f of n){let p=Buffer.byteLength(f)+1;if(a+p>o)break;i.push(f),a+=p}let c=[],u=0;for(let f=n.length-1;f>=i.length;f--){let p=Buffer.byteLength(n[f])+1;if(u+p>s)break;c.unshift(n[f]),u+=p}let l=n.length-i.length-c.length,d=Buffer.byteLength(e)-a-u,m=`

... [${l} lines / ${(d/1024).toFixed(1)}KB truncated \u2014 showing first ${i.length} + last ${c.length} lines] ...

`;return i.join(`
`)+m+c.join(`
`)}async#s(e,r,n){return new Promise(o=>{let s=mT(e[0],e.slice(1),{cwd:r,stdio:["ignore","pipe","pipe"],env:this.#a(r)}),i=!1,a=setTimeout(()=>{i=!0,s.kill("SIGKILL")},n),c=[],u=[];s.stdout.on("data",l=>{c.push(l)}),s.stderr.on("data",l=>{u.push(l)}),s.on("close",l=>{clearTimeout(a);let d=Buffer.concat(c).toString("utf-8"),m=Buffer.concat(u).toString("utf-8"),f=this.#e,p=t.#o(d,f),h=t.#o(m,f);o({stdout:p,stderr:h,exitCode:i?1:l??1,timedOut:i})}),s.on("error",l=>{clearTimeout(a),o({stdout:"",stderr:l.message,exitCode:1,timedOut:!1})})})}#a(e){let r=process.env.HOME??process.env.USERPROFILE??e,n=["GH_TOKEN","GITHUB_TOKEN","GH_HOST","AWS_ACCESS_KEY_ID","AWS_SECRET_ACCESS_KEY","AWS_SESSION_TOKEN","AWS_REGION","AWS_DEFAULT_REGION","AWS_PROFILE","GOOGLE_APPLICATION_CREDENTIALS","CLOUDSDK_CONFIG","DOCKER_HOST","KUBECONFIG","NPM_TOKEN","NODE_AUTH_TOKEN","npm_config_registry","HTTP_PROXY","HTTPS_PROXY","NO_PROXY","SSL_CERT_FILE","CURL_CA_BUNDLE","XDG_CONFIG_HOME","XDG_DATA_HOME"],o={PATH:process.env.PATH??"/usr/local/bin:/usr/bin:/bin",HOME:r,TMPDIR:e,LANG:"en_US.UTF-8",PYTHONDONTWRITEBYTECODE:"1",PYTHONUNBUFFERED:"1",NO_COLOR:"1"};for(let s of n)process.env[s]&&(o[s]=process.env[s]);return o}#c(e,r,n){let o=JSON.stringify(e);switch(r){case"javascript":case"typescript":return`const FILE_CONTENT_PATH = ${o};
const FILE_CONTENT = require("fs").readFileSync(FILE_CONTENT_PATH, "utf-8");
${n}`;case"python":return`FILE_CONTENT_PATH = ${o}
with open(FILE_CONTENT_PATH, "r") as _f:
    FILE_CONTENT = _f.read()
${n}`;case"shell":return`FILE_CONTENT_PATH=${o}
FILE_CONTENT=$(cat ${o})
${n}`;case"ruby":return`FILE_CONTENT_PATH = ${o}
FILE_CONTENT = File.read(FILE_CONTENT_PATH)
${n}`;case"go":return`package main

import (
	"fmt"
	"os"
)

var FILE_CONTENT_PATH = ${o}

func main() {
	b, _ := os.ReadFile(FILE_CONTENT_PATH)
	FILE_CONTENT := string(b)
	_ = FILE_CONTENT
	_ = fmt.Sprint()
${n}
}
`;case"rust":return`use std::fs;

fn main() {
    let file_content_path = ${o};
    let file_content = fs::read_to_string(file_content_path).unwrap();
${n}
}
`;case"php":return`<?php
$FILE_CONTENT_PATH = ${o};
$FILE_CONTENT = file_get_contents($FILE_CONTENT_PATH);
${n}`;case"perl":return`my $FILE_CONTENT_PATH = ${o};
open(my $fh, '<', $FILE_CONTENT_PATH) or die "Cannot open: $!";
my $FILE_CONTENT = do { local $/; <$fh> };
close($fh);
${n}`;case"r":return`FILE_CONTENT_PATH <- ${o}
FILE_CONTENT <- readLines(FILE_CONTENT_PATH, warn=FALSE)
FILE_CONTENT <- paste(FILE_CONTENT, collapse="\\n")
${n}`}}};import{createRequire as bT}from"node:module";import{readFileSync as xT,readdirSync as $T,unlinkSync as sy}from"node:fs";import{tmpdir as iy}from"node:os";import{join as ay}from"node:path";var ed=null;function wT(){return ed||(ed=bT(import.meta.url)("better-sqlite3")),ed}var oy=new Set(["the","and","for","are","but","not","you","all","can","had","her","was","one","our","out","has","his","how","its","may","new","now","old","see","way","who","did","get","got","let","say","she","too","use","will","with","this","that","from","they","been","have","many","some","them","than","each","make","like","just","over","such","take","into","year","your","good","could","would","about","which","their","there","other","after","should","through","also","more","most","only","very","when","what","then","these","those","being","does","done","both","same","still","while","where","here","were","much","update","updates","updated","deps","dev","tests","test","add","added","fix","fixed","run","running","using"]);function kT(t){let e=t.replace(/['"(){}[\]*:^~]/g," ").split(/\s+/).filter(r=>r.length>0&&!["AND","OR","NOT","NEAR"].includes(r.toUpperCase()));return e.length===0?'""':e.map(r=>`"${r}"`).join(" OR ")}function ST(t){let e=t.replace(/["'(){}[\]*:^~]/g,"").trim();if(e.length<3)return"";let r=e.split(/\s+/).filter(n=>n.length>=3);return r.length===0?"":r.map(n=>`"${n}"`).join(" OR ")}function zT(t,e){if(t.length===0)return e.length;if(e.length===0)return t.length;let r=Array.from({length:e.length+1},(n,o)=>o);for(let n=1;n<=t.length;n++){let o=[n];for(let s=1;s<=e.length;s++)o[s]=t[n-1]===e[s-1]?r[s-1]:1+Math.min(r[s],o[s-1],r[s-1]);r=o}return r[e.length]}function TT(t){return t<=4?1:t<=12?2:3}function cy(){let t=iy(),e=0;try{let r=$T(t);for(let n of r){let o=n.match(/^context-mode-(\d+)\.db$/);if(!o)continue;let s=parseInt(o[1],10);if(s!==process.pid)try{process.kill(s,0)}catch{let i=ay(t,n);for(let a of["","-wal","-shm"])try{sy(i+a)}catch{}e++}}}catch{}return e}var xo=class{#e;#t;constructor(e){let r=wT();this.#t=e??ay(iy(),`context-mode-${process.pid}.db`),this.#e=new r(this.#t,{timeout:5e3}),this.#e.pragma("journal_mode = WAL"),this.#e.pragma("synchronous = NORMAL"),this.#r()}cleanup(){try{this.#e.close()}catch{}for(let e of["","-wal","-shm"])try{sy(this.#t+e)}catch{}}#r(){this.#e.exec(`
      CREATE TABLE IF NOT EXISTS sources (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        label TEXT NOT NULL,
        chunk_count INTEGER NOT NULL DEFAULT 0,
        code_chunk_count INTEGER NOT NULL DEFAULT 0,
        indexed_at TEXT NOT NULL DEFAULT (datetime('now'))
      );

      CREATE VIRTUAL TABLE IF NOT EXISTS chunks USING fts5(
        title,
        content,
        source_id UNINDEXED,
        content_type UNINDEXED,
        tokenize='porter unicode61'
      );

      CREATE VIRTUAL TABLE IF NOT EXISTS chunks_trigram USING fts5(
        title,
        content,
        source_id UNINDEXED,
        content_type UNINDEXED,
        tokenize='trigram'
      );

      CREATE TABLE IF NOT EXISTS vocabulary (
        word TEXT PRIMARY KEY
      );
    `)}index(e){let{content:r,path:n,source:o}=e;if(!r&&!n)throw new Error("Either content or path must be provided");let s=r??xT(n,"utf-8"),i=o??n??"untitled",a=this.#i(s);if(a.length===0){let h=this.#e.prepare("INSERT INTO sources (label, chunk_count, code_chunk_count) VALUES (?, 0, 0)").run(i);return{sourceId:Number(h.lastInsertRowid),label:i,totalChunks:0,codeChunks:0}}let c=a.filter(p=>p.hasCode).length,u=this.#e.prepare("INSERT INTO sources (label, chunk_count, code_chunk_count) VALUES (?, ?, ?)"),l=this.#e.prepare("INSERT INTO chunks (title, content, source_id, content_type) VALUES (?, ?, ?, ?)"),d=this.#e.prepare("INSERT INTO chunks_trigram (title, content, source_id, content_type) VALUES (?, ?, ?, ?)"),f=this.#e.transaction(()=>{let p=u.run(i,a.length,c),h=Number(p.lastInsertRowid);for(let g of a){let v=g.hasCode?"code":"prose";l.run(g.title,g.content,h,v),d.run(g.title,g.content,h,v)}return h})();return this.#n(s),{sourceId:f,label:i,totalChunks:a.length,codeChunks:c}}indexPlainText(e,r,n=20){if(!e||e.trim().length===0){let d=this.#e.prepare("INSERT INTO sources (label, chunk_count, code_chunk_count) VALUES (?, 0, 0)").run(r);return{sourceId:Number(d.lastInsertRowid),label:r,totalChunks:0,codeChunks:0}}let o=this.#o(e,n),s=this.#e.prepare("INSERT INTO sources (label, chunk_count, code_chunk_count) VALUES (?, ?, ?)"),i=this.#e.prepare("INSERT INTO chunks (title, content, source_id, content_type) VALUES (?, ?, ?, ?)"),a=this.#e.prepare("INSERT INTO chunks_trigram (title, content, source_id, content_type) VALUES (?, ?, ?, ?)"),u=this.#e.transaction(()=>{let l=s.run(r,o.length,0),d=Number(l.lastInsertRowid);for(let m of o)i.run(m.title,m.content,d,"prose"),a.run(m.title,m.content,d,"prose");return d})();return this.#n(e),{sourceId:u,label:r,totalChunks:o.length,codeChunks:0}}search(e,r=3,n){let o=kT(e),s=n?"AND sources.label LIKE ?":"",i=this.#e.prepare(`
      SELECT
        chunks.title,
        chunks.content,
        chunks.content_type,
        sources.label,
        bm25(chunks, 2.0, 1.0) AS rank
      FROM chunks
      JOIN sources ON sources.id = chunks.source_id
      WHERE chunks MATCH ? ${s}
      ORDER BY rank
      LIMIT ?
    `),a=n?[o,`%${n}%`,r]:[o,r];return i.all(...a).map(u=>({title:u.title,content:u.content,source:u.label,rank:u.rank,contentType:u.content_type}))}searchTrigram(e,r=3,n){let o=ST(e);if(!o)return[];let s=n?"AND sources.label LIKE ?":"",i=this.#e.prepare(`
      SELECT
        chunks_trigram.title,
        chunks_trigram.content,
        chunks_trigram.content_type,
        sources.label,
        bm25(chunks_trigram, 2.0, 1.0) AS rank
      FROM chunks_trigram
      JOIN sources ON sources.id = chunks_trigram.source_id
      WHERE chunks_trigram MATCH ? ${s}
      ORDER BY rank
      LIMIT ?
    `),a=n?[o,`%${n}%`,r]:[o,r];return i.all(...a).map(u=>({title:u.title,content:u.content,source:u.label,rank:u.rank,contentType:u.content_type}))}fuzzyCorrect(e){let r=e.toLowerCase().trim();if(r.length<3)return null;let n=TT(r.length),o=this.#e.prepare("SELECT word FROM vocabulary WHERE length(word) BETWEEN ? AND ?").all(r.length-n,r.length+n),s=null,i=n+1;for(let{word:a}of o){if(a===r)return null;let c=zT(r,a);c<i&&(i=c,s=a)}return i<=n?s:null}searchWithFallback(e,r=3,n){let o=this.search(e,r,n);if(o.length>0)return o.map(l=>({...l,matchLayer:"porter"}));let s=this.searchTrigram(e,r,n);if(s.length>0)return s.map(l=>({...l,matchLayer:"trigram"}));let i=e.toLowerCase().trim().split(/\s+/).filter(l=>l.length>=3),a=i.join(" "),u=i.map(l=>this.fuzzyCorrect(l)??l).join(" ");if(u!==a){let l=this.search(u,r,n);if(l.length>0)return l.map(m=>({...m,matchLayer:"fuzzy"}));let d=this.searchTrigram(u,r,n);if(d.length>0)return d.map(m=>({...m,matchLayer:"fuzzy"}))}return[]}listSources(){return this.#e.prepare("SELECT label, chunk_count as chunkCount FROM sources ORDER BY id DESC").all()}getChunksBySource(e){return this.#e.prepare(`SELECT c.title, c.content, c.content_type, s.label
         FROM chunks c
         JOIN sources s ON s.id = c.source_id
         WHERE c.source_id = ?
         ORDER BY c.rowid`).all(e).map(n=>({title:n.title,content:n.content,source:n.label,rank:0,contentType:n.content_type}))}getDistinctiveTerms(e,r=40){let n=this.#e.prepare("SELECT chunk_count FROM sources WHERE id = ?").get(e);if(!n||n.chunk_count<3)return[];let o=n.chunk_count,s=2,i=Math.max(3,Math.ceil(o*.4)),a=this.#e.prepare("SELECT content FROM chunks WHERE source_id = ?").all(e),c=new Map;for(let d of a){let m=new Set(d.content.toLowerCase().split(/[^\p{L}\p{N}_-]+/u).filter(f=>f.length>=3&&!oy.has(f)));for(let f of m)c.set(f,(c.get(f)??0)+1)}return Array.from(c.entries()).filter(([,d])=>d>=s&&d<=i).map(([d,m])=>{let f=Math.log(o/m),p=Math.min(d.length/20,.5),h=/[_]/.test(d),g=d.length>=12,v=h?1.5:g?.8:0;return{word:d,score:f+p+v}}).sort((d,m)=>m.score-d.score).slice(0,r).map(d=>d.word)}getStats(){let e=this.#e.prepare("SELECT COUNT(*) as c FROM sources").get()?.c??0,r=this.#e.prepare("SELECT COUNT(*) as c FROM chunks").get()?.c??0,n=this.#e.prepare("SELECT COUNT(*) as c FROM chunks WHERE content_type = 'code'").get()?.c??0;return{sources:e,chunks:r,codeChunks:n}}close(){this.#e.close()}#n(e){let r=e.toLowerCase().split(/[^\p{L}\p{N}_-]+/u).filter(s=>s.length>=3&&!oy.has(s)),n=[...new Set(r)],o=this.#e.prepare("INSERT OR IGNORE INTO vocabulary (word) VALUES (?)");for(let s of n)o.run(s)}#i(e){let r=[],n=e.split(`
`),o=[],s=[],i="",a=()=>{let u=s.join(`
`).trim();u.length!==0&&(r.push({title:this.#s(o,i),content:u,hasCode:s.some(l=>/^`{3,}/.test(l))}),s=[])},c=0;for(;c<n.length;){let u=n[c];if(/^[-_*]{3,}\s*$/.test(u)){a(),c++;continue}let l=u.match(/^(#{1,4})\s+(.+)$/);if(l){a();let m=l[1].length,f=l[2].trim();for(;o.length>0&&o[o.length-1].level>=m;)o.pop();o.push({level:m,text:f}),i=f,s.push(u),c++;continue}let d=u.match(/^(`{3,})(.*)?$/);if(d){let m=d[1],f=[u];for(c++;c<n.length;){if(f.push(n[c]),n[c].startsWith(m)&&n[c].trim()===m){c++;break}c++}s.push(...f);continue}s.push(u),c++}return a(),r}#o(e,r){let n=e.split(/\n\s*\n/);if(n.length>=3&&n.length<=200&&n.every(c=>Buffer.byteLength(c)<5e3))return n.map((c,u)=>{let l=c.trim();return{title:l.split(`
`)[0].slice(0,80)||`Section ${u+1}`,content:l}}).filter(c=>c.content.length>0);let o=e.split(`
`);if(o.length<=r)return[{title:"Output",content:e}];let s=[],a=Math.max(r-2,1);for(let c=0;c<o.length;c+=a){let u=o.slice(c,c+r);if(u.length===0)break;let l=c+1,d=Math.min(c+u.length,o.length),m=u[0]?.trim().slice(0,80);s.push({title:m||`Lines ${l}-${d}`,content:u.join(`
`)})}return s}#s(e,r){return e.length===0?r||"Untitled":e.map(n=>n.text).join(" > ")}};var dy="0.7.3",rd=fi(),ET=ey(rd),er=new li({name:"context-mode",version:dy}),yi=new mi({runtimes:rd}),$o=null;function wo(){return $o||($o=new xo),$o}var Ze={calls:{},bytesReturned:{},bytesIndexed:0,bytesSandboxed:0,sessionStart:Date.now()};function ne(t,e){let r=e.content.reduce((n,o)=>n+Buffer.byteLength(o.text),0);return Ze.calls[t]=(Ze.calls[t]||0)+1,Ze.bytesReturned[t]=(Ze.bytesReturned[t]||0)+r,e}function Qt(t){Ze.bytesIndexed+=t}var PT=ET.join(", "),RT=Ql()?" (Bun detected \u2014 JS/TS runs 3-5x faster)":"";function py(t,e,r=1500){if(t.length<=r)return t;let n=e.toLowerCase().split(/\s+/).filter(l=>l.length>2),o=t.toLowerCase(),s=[];for(let l of n){let d=o.indexOf(l);for(;d!==-1;)s.push(d),d=o.indexOf(l,d+1)}if(s.length===0)return t.slice(0,r)+`
\u2026`;s.sort((l,d)=>l-d);let i=300,a=[];for(let l of s){let d=Math.max(0,l-i),m=Math.min(t.length,l+i);a.length>0&&d<=a[a.length-1][1]?a[a.length-1][1]=m:a.push([d,m])}let c=[],u=0;for(let[l,d]of a){if(u>=r)break;let m=t.slice(l,Math.min(d,l+(r-u)));c.push((l>0?"\u2026":"")+m+(d<t.length?"\u2026":"")),u+=m.length}return c.join(`

`)}er.registerTool("execute",{title:"Execute Code",description:`Execute code in a sandboxed subprocess. Only stdout enters context \u2014 raw data stays in the subprocess. Use instead of bash/cat when output would exceed 20 lines.${RT} Available: ${PT}.

PREFER THIS OVER BASH for: API calls (gh, curl, aws), test runners (npm test, pytest), git queries (git log, git diff), data processing, and ANY CLI command that may produce large output. Bash should only be used for file mutations, git writes, and navigation.`,inputSchema:K.object({language:K.enum(["javascript","typescript","python","shell","ruby","go","rust","php","perl","r"]).describe("Runtime language"),code:K.string().describe("Source code to execute. Use console.log (JS/TS), print (Python/Ruby/Perl/R), echo (Shell), echo (PHP), or fmt.Println (Go) to output a summary to context."),timeout:K.number().optional().default(3e4).describe("Max execution time in ms"),intent:K.string().optional().describe(`What you're looking for in the output. When provided and output is large (>5KB), indexes output into knowledge base and returns section titles + previews \u2014 not full content. Use search(queries: [...]) to retrieve specific sections. Example: 'failing tests', 'HTTP 500 errors'.

TIP: Use specific technical terms, not just concepts. Check 'Searchable terms' in the response for available vocabulary.`)})},async({language:t,code:e,timeout:r,intent:n})=>{try{let o=e;(t==="javascript"||t==="typescript")&&(o=`
let __cm_net=0;const __cm_f=globalThis.fetch;
globalThis.fetch=async(...a)=>{const r=await __cm_f(...a);
try{const cl=r.clone();const b=await cl.arrayBuffer();__cm_net+=b.byteLength}catch{}
return r};
async function __cm_main(){
${e}
}
__cm_main().catch(e=>{console.error(e);process.exitCode=1}).finally(()=>{
if(__cm_net>0)process.stderr.write('__CM_NET__:'+__cm_net+'\\n');
});`);let s=await yi.execute({language:t,code:o,timeout:r}),i=s.stderr?.match(/__CM_NET__:(\d+)/);if(i&&(Ze.bytesSandboxed+=parseInt(i[1]),s.stderr=s.stderr.replace(/\n?__CM_NET__:\d+\n?/g,"")),s.timedOut)return ne("execute",{content:[{type:"text",text:`Execution timed out after ${r}ms

Partial stdout:
${s.stdout}

stderr:
${s.stderr}`}],isError:!0});if(s.exitCode!==0){let c=`Exit code: ${s.exitCode}

stdout:
${s.stdout}

stderr:
${s.stderr}`;return n&&n.trim().length>0&&Buffer.byteLength(c)>hi?(Qt(Buffer.byteLength(c)),ne("execute",{content:[{type:"text",text:gi(c,n,`execute:${t}:error`)}],isError:!0})):ne("execute",{content:[{type:"text",text:c}],isError:!0})}let a=s.stdout||"(no output)";return n&&n.trim().length>0&&Buffer.byteLength(a)>hi?(Qt(Buffer.byteLength(a)),ne("execute",{content:[{type:"text",text:gi(a,n,`execute:${t}`)}]})):ne("execute",{content:[{type:"text",text:a}]})}catch(o){let s=o instanceof Error?o.message:String(o);return ne("execute",{content:[{type:"text",text:`Runtime error: ${s}`}],isError:!0})}});var hi=5e3;function gi(t,e,r,n=5){let o=t.split(`
`).length,s=Buffer.byteLength(t),i=wo(),a=i.indexPlainText(t,r),c=new xo(":memory:");try{c.indexPlainText(t,r);let u=c.search(e,n);if(u.length===0){let m=e.trim().split(/\s+/).filter(f=>f.length>2).slice(0,20);if(m.length>0){let f=new Map;for(let p of m){let h=c.search(p,10);for(let g of h){let v=f.get(g.title);v?(v.score+=1,g.rank<v.bestRank&&(v.bestRank=g.rank,v.result=g)):f.set(g.title,{result:g,score:1,bestRank:g.rank})}}u=Array.from(f.values()).sort((p,h)=>h.score-p.score||p.bestRank-h.bestRank).slice(0,n).map(p=>p.result)}}let l=i.getDistinctiveTerms(a.sourceId);if(u.length===0){let m=[`Indexed ${a.totalChunks} sections from "${r}" into knowledge base.`,`No sections matched intent "${e}" in ${o}-line output (${(s/1024).toFixed(1)}KB).`];return l.length>0&&(m.push(""),m.push(`Searchable terms: ${l.join(", ")}`)),m.push(""),m.push("Use search() to explore the indexed content."),m.join(`
`)}let d=[`Indexed ${a.totalChunks} sections from "${r}" into knowledge base.`,`${u.length} sections matched "${e}" (${o} lines, ${(s/1024).toFixed(1)}KB):`,""];for(let m of u){let f=m.content.split(`
`)[0].slice(0,120);d.push(`  - ${m.title}: ${f}`)}return l.length>0&&(d.push(""),d.push(`Searchable terms: ${l.join(", ")}`)),d.push(""),d.push("Use search(queries: [...]) to retrieve full content of any section."),d.join(`
`)}finally{c.close()}}er.registerTool("execute_file",{title:"Execute File Processing",description:`Read a file and process it without loading contents into context. The file is read into a FILE_CONTENT variable inside the sandbox. Only your printed summary enters context.

PREFER THIS OVER Read/cat for: log files, data files (CSV, JSON, XML), large source files for analysis, and any file where you need to extract specific information rather than read the entire content.`,inputSchema:K.object({path:K.string().describe("Absolute file path or relative to project root"),language:K.enum(["javascript","typescript","python","shell","ruby","go","rust","php","perl","r"]).describe("Runtime language"),code:K.string().describe("Code to process FILE_CONTENT. Print summary via console.log/print/echo."),timeout:K.number().optional().default(3e4).describe("Max execution time in ms"),intent:K.string().optional().describe("What you're looking for in the output. When provided and output is large (>5KB), returns only matching sections via BM25 search instead of truncated output.")})},async({path:t,language:e,code:r,timeout:n,intent:o})=>{try{let s=await yi.executeFile({path:t,language:e,code:r,timeout:n});if(s.timedOut)return ne("execute_file",{content:[{type:"text",text:`Timed out processing ${t} after ${n}ms`}],isError:!0});if(s.exitCode!==0){let a=`Error processing ${t} (exit ${s.exitCode}):
${s.stderr||s.stdout}`;return o&&o.trim().length>0&&Buffer.byteLength(a)>hi?(Qt(Buffer.byteLength(a)),ne("execute_file",{content:[{type:"text",text:gi(a,o,`file:${t}:error`)}],isError:!0})):ne("execute_file",{content:[{type:"text",text:a}],isError:!0})}let i=s.stdout||"(no output)";return o&&o.trim().length>0&&Buffer.byteLength(i)>hi?(Qt(Buffer.byteLength(i)),ne("execute_file",{content:[{type:"text",text:gi(i,o,`file:${t}`)}]})):ne("execute_file",{content:[{type:"text",text:i}]})}catch(s){let i=s instanceof Error?s.message:String(s);return ne("execute_file",{content:[{type:"text",text:`Runtime error: ${i}`}],isError:!0})}});er.registerTool("index",{title:"Index Content",description:`Index documentation or knowledge content into a searchable BM25 knowledge base. Chunks markdown by headings (keeping code blocks intact) and stores in ephemeral FTS5 database. The full content does NOT stay in context \u2014 only a brief summary is returned.

WHEN TO USE:
- Documentation from Context7, Skills, or MCP tools (API docs, framework guides, code examples)
- API references (endpoint details, parameter specs, response schemas)
- MCP tools/list output (exact tool signatures and descriptions)
- Skill prompts and instructions that are too large for context
- README files, migration guides, changelog entries
- Any content with code examples you may need to reference precisely

After indexing, use 'search' to retrieve specific sections on-demand.
Do NOT use for: log files, test output, CSV, build output \u2014 use 'execute_file' for those.`,inputSchema:K.object({content:K.string().optional().describe("Raw text/markdown to index. Provide this OR path, not both."),path:K.string().optional().describe("File path to read and index (content never enters context). Provide this OR content."),source:K.string().optional().describe("Label for the indexed content (e.g., 'Context7: React useEffect', 'Skill: frontend-design')")})},async({content:t,path:e,source:r})=>{if(!t&&!e)return ne("index",{content:[{type:"text",text:"Error: Either content or path must be provided"}],isError:!0});try{if(t)Qt(Buffer.byteLength(t));else if(e)try{let s=await import("fs");Qt(s.readFileSync(e).byteLength)}catch{}let o=wo().index({content:t,path:e,source:r});return ne("index",{content:[{type:"text",text:`Indexed ${o.totalChunks} sections (${o.codeChunks} with code) from: ${o.label}
Use search(queries: ["..."]) to query this content. Use source: "${o.label}" to scope results.`}]})}catch(n){let o=n instanceof Error?n.message:String(n);return ne("index",{content:[{type:"text",text:`Index error: ${o}`}],isError:!0})}});var Cr=0,td=Date.now(),IT=6e4,uy=3,ly=8;er.registerTool("search",{title:"Search Indexed Content",description:`Search indexed content. Pass ALL search questions as queries array in ONE call.

TIPS: 2-4 specific terms per query. Use 'source' to scope results.`,inputSchema:K.object({queries:K.array(K.string()).optional().describe("Array of search queries. Batch ALL questions in one call."),limit:K.number().optional().default(3).describe("Results per query (default: 3)"),source:K.string().optional().describe("Filter to a specific indexed source (partial match).")})},async t=>{try{let e=wo(),r=t,n=[];if(Array.isArray(r.queries)&&r.queries.length>0?n.push(...r.queries):typeof r.query=="string"&&r.query.length>0&&n.push(r.query),n.length===0)return ne("search",{content:[{type:"text",text:"Error: provide query or queries."}],isError:!0});let{limit:o=3,source:s}=t,i=Date.now();if(i-td>IT&&(Cr=0,td=i),Cr++,Cr>ly)return ne("search",{content:[{type:"text",text:`BLOCKED: ${Cr} search calls in ${Math.round((i-td)/1e3)}s. You're flooding context. STOP making individual search calls. Use batch_execute(commands, queries) for your next research step.`}],isError:!0});let a=Cr>uy?1:Math.min(o,2),c=40*1024,u=0,l=[];for(let m of n){if(u>c){l.push(`## ${m}
(output cap reached)
`);continue}let f=e.search(m,a,s);if(f.length===0){l.push(`## ${m}
No results found.`);continue}let p=f.map((h,g)=>{let v=`--- [${h.source}] ---`,x=`### ${h.title}`,b=py(h.content,m);return`${v}
${x}

${b}`}).join(`

`);l.push(`## ${m}

${p}`),u+=p.length}let d=l.join(`

---

`);if(Cr>=uy&&(d+=`

\u26A0 search call #${Cr}/${ly} in this window. Results limited to ${a}/query. Batch queries: search(queries: ["q1","q2","q3"]) or use batch_execute.`),d.trim().length===0){let m=e.listSources(),f=m.length>0?`
Indexed sources: ${m.map(p=>`"${p.label}" (${p.chunkCount} sections)`).join(", ")}`:"";return ne("search",{content:[{type:"text",text:`No results found.${f}`}]})}return ne("search",{content:[{type:"text",text:d}]})}catch(e){let r=e instanceof Error?e.message:String(e);return ne("search",{content:[{type:"text",text:`Search error: ${r}`}],isError:!0})}});var OT=`
const url = process.argv[1];
if (!url) { console.error("No URL provided"); process.exit(1); }

async function main() {
  const resp = await fetch(url);
  if (!resp.ok) { console.error("HTTP " + resp.status); process.exit(1); }

  let html = await resp.text();

  // Strip script, style, nav, header, footer tags with content
  html = html.replace(/<script[^>]*>[\\s\\S]*?<\\/script>/gi, "");
  html = html.replace(/<style[^>]*>[\\s\\S]*?<\\/style>/gi, "");
  html = html.replace(/<nav[^>]*>[\\s\\S]*?<\\/nav>/gi, "");
  html = html.replace(/<header[^>]*>[\\s\\S]*?<\\/header>/gi, "");
  html = html.replace(/<footer[^>]*>[\\s\\S]*?<\\/footer>/gi, "");

  // Convert headings to markdown
  html = html.replace(/<h1[^>]*>(.*?)<\\/h1>/gi, "\\n# $1\\n");
  html = html.replace(/<h2[^>]*>(.*?)<\\/h2>/gi, "\\n## $1\\n");
  html = html.replace(/<h3[^>]*>(.*?)<\\/h3>/gi, "\\n### $1\\n");
  html = html.replace(/<h4[^>]*>(.*?)<\\/h4>/gi, "\\n#### $1\\n");

  // Convert code blocks
  html = html.replace(/<pre[^>]*><code[^>]*class="[^"]*language-(\\w+)"[^>]*>([\\s\\S]*?)<\\/code><\\/pre>/gi,
    (_, lang, code) => "\\n\\\`\\\`\\\`" + lang + "\\n" + decodeEntities(code) + "\\n\\\`\\\`\\\`\\n");
  html = html.replace(/<pre[^>]*><code[^>]*>([\\s\\S]*?)<\\/code><\\/pre>/gi,
    (_, code) => "\\n\\\`\\\`\\\`\\n" + decodeEntities(code) + "\\n\\\`\\\`\\\`\\n");
  html = html.replace(/<code[^>]*>([^<]*)<\\/code>/gi, "\\\`$1\\\`");

  // Convert links
  html = html.replace(/<a[^>]*href="([^"]*)"[^>]*>(.*?)<\\/a>/gi, "[$2]($1)");

  // Convert lists
  html = html.replace(/<li[^>]*>(.*?)<\\/li>/gi, "- $1\\n");

  // Convert paragraphs and line breaks
  html = html.replace(/<p[^>]*>(.*?)<\\/p>/gi, "\\n$1\\n");
  html = html.replace(/<br\\s*\\/?>/gi, "\\n");
  html = html.replace(/<hr\\s*\\/?>/gi, "\\n---\\n");

  // Strip remaining HTML tags
  html = html.replace(/<[^>]+>/g, "");

  // Decode HTML entities
  html = decodeEntities(html);

  // Clean up whitespace
  html = html.replace(/\\n{3,}/g, "\\n\\n").trim();

  console.log(html);
}

function decodeEntities(s) {
  return s
    .replace(/&amp;/g, "&")
    .replace(/&lt;/g, "<")
    .replace(/&gt;/g, ">")
    .replace(/&quot;/g, '"')
    .replace(/&#39;/g, "'")
    .replace(/&#x27;/g, "'")
    .replace(/&#x2F;/g, "/")
    .replace(/&nbsp;/g, " ");
}

main();
`;er.registerTool("fetch_and_index",{title:"Fetch & Index URL",description:`Fetches URL content, converts HTML to markdown, indexes into searchable knowledge base, and returns a ~3KB preview. Full content stays in sandbox \u2014 use search() for deeper lookups.

Better than WebFetch: preview is immediate, full content is searchable, raw HTML never enters context.`,inputSchema:K.object({url:K.string().describe("The URL to fetch and index"),source:K.string().optional().describe("Label for the indexed content (e.g., 'React useEffect docs', 'Supabase Auth API')")})},async({url:t,source:e})=>{try{let r=`process.argv[1] = ${JSON.stringify(t)};
${OT}`,n=await yi.execute({language:"javascript",code:r,timeout:3e4});if(n.exitCode!==0)return ne("fetch_and_index",{content:[{type:"text",text:`Failed to fetch ${t}: ${n.stderr||n.stdout}`}],isError:!0});if(!n.stdout||n.stdout.trim().length===0)return ne("fetch_and_index",{content:[{type:"text",text:`Fetched ${t} but got empty content after HTML conversion`}],isError:!0});let o=wo(),s=n.stdout.trim();Qt(Buffer.byteLength(s));let i=o.index({content:s,source:e??t}),a=3072,c=s.length>a?s.slice(0,a)+`

\u2026[truncated \u2014 use search() for full content]`:s,u=(Buffer.byteLength(s)/1024).toFixed(1),l=[`Fetched and indexed **${i.totalChunks} sections** (${u}KB) from: ${i.label}`,`Full content indexed in sandbox \u2014 use search(queries: [...], source: "${i.label}") for specific lookups.`,"","---","",c].join(`
`);return ne("fetch_and_index",{content:[{type:"text",text:l}]})}catch(r){let n=r instanceof Error?r.message:String(r);return ne("fetch_and_index",{content:[{type:"text",text:`Fetch error: ${n}`}],isError:!0})}});er.registerTool("batch_execute",{title:"Batch Execute & Search",description:`Execute multiple commands in ONE call, auto-index all output, and search with multiple queries. Returns search results directly \u2014 no follow-up calls needed.

THIS IS THE PRIMARY TOOL. Use this instead of multiple execute() calls.

One batch_execute call replaces 30+ execute calls + 10+ search calls.
Provide all commands to run and all queries to search \u2014 everything happens in one round trip.`,inputSchema:K.object({commands:K.array(K.object({label:K.string().describe("Section header for this command's output (e.g., 'README', 'Package.json', 'Source Tree')"),command:K.string().describe("Shell command to execute")})).min(1).describe("Commands to execute as a batch. Each runs sequentially, output is labeled with the section header."),queries:K.array(K.string()).min(1).describe("Search queries to extract information from indexed output. Use 5-8 comprehensive queries. Each returns top 5 matching sections with full content. This is your ONLY chance \u2014 put ALL your questions here. No follow-up calls needed."),timeout:K.number().optional().default(6e4).describe("Max execution time in ms (default: 60s)")})},async({commands:t,queries:e,timeout:r})=>{try{let n=t.map(b=>`echo '# ${b.label.replace(/'/g,"'\\''")}'
echo ''
${b.command} 2>&1
echo ''`).join(`
`),o=await yi.execute({language:"shell",code:n,timeout:r});if(o.timedOut)return ne("batch_execute",{content:[{type:"text",text:`Batch timed out after ${r}ms. Partial output:
${o.stdout?.slice(0,2e3)||"(none)"}`}],isError:!0});let s=o.stdout||"(no output)",i=Buffer.byteLength(s),a=s.split(`
`).length;Qt(i);let c=wo(),u=`batch:${t.map(b=>b.label).join(",").slice(0,80)}`,l=c.index({content:s,source:u}),d=c.getChunksBySource(l.sourceId),m=["## Indexed Sections",""],f=[];for(let b of d){let S=Buffer.byteLength(b.content);m.push(`- ${b.title} (${(S/1024).toFixed(1)}KB)`),f.push(b.title)}let p=80*1024,h=[],g=0;for(let b of e){if(g>p){h.push(`## ${b}
(output cap reached \u2014 use search(queries: ["${b}"]) for details)
`);continue}let S=c.search(b,3,u);if(S.length===0&&f.length>0){let N=`${b} ${f.join(" ")}`;S=c.search(N,3,u)}if(S.length===0&&(S=c.search(b,3)),h.push(`## ${b}`),h.push(""),S.length>0)for(let N of S){let _e=py(N.content,b);h.push(`### ${N.title}`),h.push(_e),h.push(""),g+=_e.length+N.title.length}else h.push("No matching sections found."),h.push("")}let v=c.getDistinctiveTerms?c.getDistinctiveTerms(l.sourceId):[],x=[`Executed ${t.length} commands (${a} lines, ${(i/1024).toFixed(1)}KB). Indexed ${l.totalChunks} sections. Searched ${e.length} queries.`,"",...m,"",...h,v.length>0?`
Searchable terms for follow-up: ${v.join(", ")}`:""].join(`
`);return ne("batch_execute",{content:[{type:"text",text:x}]})}catch(n){let o=n instanceof Error?n.message:String(n);return ne("batch_execute",{content:[{type:"text",text:`Batch execution error: ${o}`}],isError:!0})}});er.registerTool("stats",{title:"Session Statistics",description:"Returns context consumption statistics for the current session. Shows total bytes returned to context, breakdown by tool, call counts, estimated token usage, and context savings ratio.",inputSchema:K.object({})},async()=>{let t=Object.values(Ze.bytesReturned).reduce((f,p)=>f+p,0),e=Object.values(Ze.calls).reduce((f,p)=>f+p,0),n=((Date.now()-Ze.sessionStart)/6e4).toFixed(1),o=Ze.bytesIndexed+Ze.bytesSandboxed,s=o+t,i=s/Math.max(t,1),a=s>0?((1-t/s)*100).toFixed(0):"0",c=f=>f>=1024*1024?`${(f/1024/1024).toFixed(1)}MB`:`${(f/1024).toFixed(1)}KB`,u=["## context-mode session stats","","| Metric | Value |","|--------|------:|",`| Session | ${n} min |`,`| Tool calls | ${e} |`,`| Total data processed | **${c(s)}** |`,`| Kept in sandbox | **${c(o)}** |`,`| Entered context | ${c(t)} |`,`| Tokens consumed | ~${Math.round(t/4).toLocaleString()} |`,`| **Context savings** | **${i.toFixed(1)}x (${a}% reduction)** |`],l=new Set([...Object.keys(Ze.calls),...Object.keys(Ze.bytesReturned)]);if(l.size>0){u.push("","| Tool | Calls | Context | Tokens |","|------|------:|--------:|-------:|");for(let f of Array.from(l).sort()){let p=Ze.calls[f]||0,h=Ze.bytesReturned[f]||0,g=Math.round(h/4);u.push(`| ${f} | ${p} | ${c(h)} | ~${g.toLocaleString()} |`)}u.push(`| **Total** | **${e}** | **${c(t)}** | **~${Math.round(t/4).toLocaleString()}** |`)}let d=Math.round(o/4);e===0?u.push("","> No context-mode calls this session. Use `batch_execute` to run commands, `fetch_and_index` for URLs, or `execute` to process data in sandbox."):o===0?u.push("",`> context-mode handled **${e}** tool calls. All outputs were compact enough to enter context directly. Process larger data or batch multiple commands for bigger savings.`):u.push("",`> Without context-mode, **${c(s)}** of raw tool output would flood your context window. Instead, **${c(o)}** (${a}%) stayed in sandbox \u2014 saving **~${d.toLocaleString()} tokens** of context space.`);let m=u.join(`
`);return ne("stats",{content:[{type:"text",text:m}]})});async function NT(){let t=cy();t>0&&console.error(`Cleaned up ${t} stale DB file(s) from previous sessions`);let e=()=>{$o&&$o.cleanup()};process.on("exit",e),process.on("SIGINT",()=>{e(),process.exit(0)}),process.on("SIGTERM",()=>{e(),process.exit(0)});let r=new pi;await er.connect(r),console.error(`Context Mode MCP server v${dy} running on stdio`),console.error(`Detected runtimes:
${Qg(rd)}`),Ql()||(console.error(`
Performance tip: Install Bun for 3-5x faster JS/TS execution`),console.error("  curl -fsSL https://bun.sh/install | bash"))}NT().catch(t=>{console.error("Fatal:",t),process.exit(1)});
